var wb=r=>{throw TypeError(r)};var Tm=(r,t,e)=>t.has(r)||wb("Cannot "+e);var Be=(r,t,e)=>(Tm(r,t,"read from private field"),e?e.call(r):t.get(r)),br=(r,t,e)=>t.has(r)?wb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),li=(r,t,e,n)=>(Tm(r,t,"write to private field"),n?n.call(r,e):t.set(r,e),e),Tr=(r,t,e)=>(Tm(r,t,"access private method"),e);var Sb=(r,t,e,n)=>({set _(i){li(r,t,i,e)},get _(){return Be(r,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=e(i);fetch(i.href,a)}})();var _m={exports:{}},su={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rb;function vI(){if(Rb)return su;Rb=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,i,a){var l=null;if(a!==void 0&&(l=""+a),i.key!==void 0&&(l=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:r,type:n,key:l,ref:i!==void 0?i:null,props:a}}return su.Fragment=t,su.jsx=e,su.jsxs=e,su}var Cb;function EI(){return Cb||(Cb=1,_m.exports=vI()),_m.exports}var Y=EI(),wm={exports:{}},Jt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ib;function AI(){if(Ib)return Jt;Ib=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function v(W){return W===null||typeof W!="object"?null:(W=m&&W[m]||W["@@iterator"],typeof W=="function"?W:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,T={};function S(W,lt,q){this.props=W,this.context=lt,this.refs=T,this.updater=q||E}S.prototype.isReactComponent={},S.prototype.setState=function(W,lt){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,lt,"setState")},S.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function C(){}C.prototype=S.prototype;function D(W,lt,q){this.props=W,this.context=lt,this.refs=T,this.updater=q||E}var O=D.prototype=new C;O.constructor=D,b(O,S.prototype),O.isPureReactComponent=!0;var F=Array.isArray,k={H:null,A:null,T:null,S:null,V:null},z=Object.prototype.hasOwnProperty;function P(W,lt,q,it,yt,_t){return q=_t.ref,{$$typeof:r,type:W,key:lt,ref:q!==void 0?q:null,props:_t}}function N(W,lt){return P(W.type,lt,void 0,void 0,void 0,W.props)}function M(W){return typeof W=="object"&&W!==null&&W.$$typeof===r}function V(W){var lt={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(q){return lt[q]})}var H=/\/+/g;function $(W,lt){return typeof W=="object"&&W!==null&&W.key!=null?V(""+W.key):lt.toString(36)}function j(){}function Tt(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(j,j):(W.status="pending",W.then(function(lt){W.status==="pending"&&(W.status="fulfilled",W.value=lt)},function(lt){W.status==="pending"&&(W.status="rejected",W.reason=lt)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function St(W,lt,q,it,yt){var _t=typeof W;(_t==="undefined"||_t==="boolean")&&(W=null);var ut=!1;if(W===null)ut=!0;else switch(_t){case"bigint":case"string":case"number":ut=!0;break;case"object":switch(W.$$typeof){case r:case t:ut=!0;break;case p:return ut=W._init,St(ut(W._payload),lt,q,it,yt)}}if(ut)return yt=yt(W),ut=it===""?"."+$(W,0):it,F(yt)?(q="",ut!=null&&(q=ut.replace(H,"$&/")+"/"),St(yt,lt,q,"",function(Ct){return Ct})):yt!=null&&(M(yt)&&(yt=N(yt,q+(yt.key==null||W&&W.key===yt.key?"":(""+yt.key).replace(H,"$&/")+"/")+ut)),lt.push(yt)),1;ut=0;var ft=it===""?".":it+":";if(F(W))for(var pt=0;pt<W.length;pt++)it=W[pt],_t=ft+$(it,pt),ut+=St(it,lt,q,_t,yt);else if(pt=v(W),typeof pt=="function")for(W=pt.call(W),pt=0;!(it=W.next()).done;)it=it.value,_t=ft+$(it,pt++),ut+=St(it,lt,q,_t,yt);else if(_t==="object"){if(typeof W.then=="function")return St(Tt(W),lt,q,it,yt);throw lt=String(W),Error("Objects are not valid as a React child (found: "+(lt==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":lt)+"). If you meant to render a collection of children, use an array instead.")}return ut}function X(W,lt,q){if(W==null)return W;var it=[],yt=0;return St(W,it,"","",function(_t){return lt.call(q,_t,yt++)}),it}function Z(W){if(W._status===-1){var lt=W._result;lt=lt(),lt.then(function(q){(W._status===0||W._status===-1)&&(W._status=1,W._result=q)},function(q){(W._status===0||W._status===-1)&&(W._status=2,W._result=q)}),W._status===-1&&(W._status=0,W._result=lt)}if(W._status===1)return W._result.default;throw W._result}var ht=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var lt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(lt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",W);return}console.error(W)};function Rt(){}return Jt.Children={map:X,forEach:function(W,lt,q){X(W,function(){lt.apply(this,arguments)},q)},count:function(W){var lt=0;return X(W,function(){lt++}),lt},toArray:function(W){return X(W,function(lt){return lt})||[]},only:function(W){if(!M(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},Jt.Component=S,Jt.Fragment=e,Jt.Profiler=i,Jt.PureComponent=D,Jt.StrictMode=n,Jt.Suspense=h,Jt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,Jt.__COMPILER_RUNTIME={__proto__:null,c:function(W){return k.H.useMemoCache(W)}},Jt.cache=function(W){return function(){return W.apply(null,arguments)}},Jt.cloneElement=function(W,lt,q){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var it=b({},W.props),yt=W.key,_t=void 0;if(lt!=null)for(ut in lt.ref!==void 0&&(_t=void 0),lt.key!==void 0&&(yt=""+lt.key),lt)!z.call(lt,ut)||ut==="key"||ut==="__self"||ut==="__source"||ut==="ref"&&lt.ref===void 0||(it[ut]=lt[ut]);var ut=arguments.length-2;if(ut===1)it.children=q;else if(1<ut){for(var ft=Array(ut),pt=0;pt<ut;pt++)ft[pt]=arguments[pt+2];it.children=ft}return P(W.type,yt,void 0,void 0,_t,it)},Jt.createContext=function(W){return W={$$typeof:l,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:a,_context:W},W},Jt.createElement=function(W,lt,q){var it,yt={},_t=null;if(lt!=null)for(it in lt.key!==void 0&&(_t=""+lt.key),lt)z.call(lt,it)&&it!=="key"&&it!=="__self"&&it!=="__source"&&(yt[it]=lt[it]);var ut=arguments.length-2;if(ut===1)yt.children=q;else if(1<ut){for(var ft=Array(ut),pt=0;pt<ut;pt++)ft[pt]=arguments[pt+2];yt.children=ft}if(W&&W.defaultProps)for(it in ut=W.defaultProps,ut)yt[it]===void 0&&(yt[it]=ut[it]);return P(W,_t,void 0,void 0,null,yt)},Jt.createRef=function(){return{current:null}},Jt.forwardRef=function(W){return{$$typeof:c,render:W}},Jt.isValidElement=M,Jt.lazy=function(W){return{$$typeof:p,_payload:{_status:-1,_result:W},_init:Z}},Jt.memo=function(W,lt){return{$$typeof:d,type:W,compare:lt===void 0?null:lt}},Jt.startTransition=function(W){var lt=k.T,q={};k.T=q;try{var it=W(),yt=k.S;yt!==null&&yt(q,it),typeof it=="object"&&it!==null&&typeof it.then=="function"&&it.then(Rt,ht)}catch(_t){ht(_t)}finally{k.T=lt}},Jt.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},Jt.use=function(W){return k.H.use(W)},Jt.useActionState=function(W,lt,q){return k.H.useActionState(W,lt,q)},Jt.useCallback=function(W,lt){return k.H.useCallback(W,lt)},Jt.useContext=function(W){return k.H.useContext(W)},Jt.useDebugValue=function(){},Jt.useDeferredValue=function(W,lt){return k.H.useDeferredValue(W,lt)},Jt.useEffect=function(W,lt,q){var it=k.H;if(typeof q=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return it.useEffect(W,lt)},Jt.useId=function(){return k.H.useId()},Jt.useImperativeHandle=function(W,lt,q){return k.H.useImperativeHandle(W,lt,q)},Jt.useInsertionEffect=function(W,lt){return k.H.useInsertionEffect(W,lt)},Jt.useLayoutEffect=function(W,lt){return k.H.useLayoutEffect(W,lt)},Jt.useMemo=function(W,lt){return k.H.useMemo(W,lt)},Jt.useOptimistic=function(W,lt){return k.H.useOptimistic(W,lt)},Jt.useReducer=function(W,lt,q){return k.H.useReducer(W,lt,q)},Jt.useRef=function(W){return k.H.useRef(W)},Jt.useState=function(W){return k.H.useState(W)},Jt.useSyncExternalStore=function(W,lt,q){return k.H.useSyncExternalStore(W,lt,q)},Jt.useTransition=function(){return k.H.useTransition()},Jt.version="19.1.1",Jt}var xb;function Hy(){return xb||(xb=1,wm.exports=AI()),wm.exports}var at=Hy(),Sm={exports:{}},au={},Rm={exports:{}},Cm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Db;function bI(){return Db||(Db=1,(function(r){function t(X,Z){var ht=X.length;X.push(Z);t:for(;0<ht;){var Rt=ht-1>>>1,W=X[Rt];if(0<i(W,Z))X[Rt]=Z,X[ht]=W,ht=Rt;else break t}}function e(X){return X.length===0?null:X[0]}function n(X){if(X.length===0)return null;var Z=X[0],ht=X.pop();if(ht!==Z){X[0]=ht;t:for(var Rt=0,W=X.length,lt=W>>>1;Rt<lt;){var q=2*(Rt+1)-1,it=X[q],yt=q+1,_t=X[yt];if(0>i(it,ht))yt<W&&0>i(_t,it)?(X[Rt]=_t,X[yt]=ht,Rt=yt):(X[Rt]=it,X[q]=ht,Rt=q);else if(yt<W&&0>i(_t,ht))X[Rt]=_t,X[yt]=ht,Rt=yt;else break t}}return Z}function i(X,Z){var ht=X.sortIndex-Z.sortIndex;return ht!==0?ht:X.id-Z.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;r.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();r.unstable_now=function(){return l.now()-c}}var h=[],d=[],p=1,m=null,v=3,E=!1,b=!1,T=!1,S=!1,C=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function F(X){for(var Z=e(d);Z!==null;){if(Z.callback===null)n(d);else if(Z.startTime<=X)n(d),Z.sortIndex=Z.expirationTime,t(h,Z);else break;Z=e(d)}}function k(X){if(T=!1,F(X),!b)if(e(h)!==null)b=!0,z||(z=!0,$());else{var Z=e(d);Z!==null&&St(k,Z.startTime-X)}}var z=!1,P=-1,N=5,M=-1;function V(){return S?!0:!(r.unstable_now()-M<N)}function H(){if(S=!1,z){var X=r.unstable_now();M=X;var Z=!0;try{t:{b=!1,T&&(T=!1,D(P),P=-1),E=!0;var ht=v;try{e:{for(F(X),m=e(h);m!==null&&!(m.expirationTime>X&&V());){var Rt=m.callback;if(typeof Rt=="function"){m.callback=null,v=m.priorityLevel;var W=Rt(m.expirationTime<=X);if(X=r.unstable_now(),typeof W=="function"){m.callback=W,F(X),Z=!0;break e}m===e(h)&&n(h),F(X)}else n(h);m=e(h)}if(m!==null)Z=!0;else{var lt=e(d);lt!==null&&St(k,lt.startTime-X),Z=!1}}break t}finally{m=null,v=ht,E=!1}Z=void 0}}finally{Z?$():z=!1}}}var $;if(typeof O=="function")$=function(){O(H)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,Tt=j.port2;j.port1.onmessage=H,$=function(){Tt.postMessage(null)}}else $=function(){C(H,0)};function St(X,Z){P=C(function(){X(r.unstable_now())},Z)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(X){X.callback=null},r.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<X?Math.floor(1e3/X):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_next=function(X){switch(v){case 1:case 2:case 3:var Z=3;break;default:Z=v}var ht=v;v=Z;try{return X()}finally{v=ht}},r.unstable_requestPaint=function(){S=!0},r.unstable_runWithPriority=function(X,Z){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var ht=v;v=X;try{return Z()}finally{v=ht}},r.unstable_scheduleCallback=function(X,Z,ht){var Rt=r.unstable_now();switch(typeof ht=="object"&&ht!==null?(ht=ht.delay,ht=typeof ht=="number"&&0<ht?Rt+ht:Rt):ht=Rt,X){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=ht+W,X={id:p++,callback:Z,priorityLevel:X,startTime:ht,expirationTime:W,sortIndex:-1},ht>Rt?(X.sortIndex=ht,t(d,X),e(h)===null&&X===e(d)&&(T?(D(P),P=-1):T=!0,St(k,ht-Rt))):(X.sortIndex=W,t(h,X),b||E||(b=!0,z||(z=!0,$()))),X},r.unstable_shouldYield=V,r.unstable_wrapCallback=function(X){var Z=v;return function(){var ht=v;v=Z;try{return X.apply(this,arguments)}finally{v=ht}}}})(Cm)),Cm}var Ob;function TI(){return Ob||(Ob=1,Rm.exports=bI()),Rm.exports}var Im={exports:{}},jn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nb;function _I(){if(Nb)return jn;Nb=1;var r=Hy();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(h,d,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:m==null?null:""+m,children:h,containerInfo:d,implementation:p}}var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return jn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,jn.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return a(h,d,null,p)},jn.flushSync=function(h){var d=l.T,p=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=d,n.p=p,n.d.f()}},jn.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},jn.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},jn.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,m=c(p,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,E=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:m,integrity:v,fetchPriority:E}):p==="script"&&n.d.X(h,{crossOrigin:m,integrity:v,fetchPriority:E,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},jn.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=c(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},jn.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,m=c(p,d.crossOrigin);n.d.L(h,p,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},jn.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=c(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},jn.requestFormReset=function(h){n.d.r(h)},jn.unstable_batchedUpdates=function(h,d){return h(d)},jn.useFormState=function(h,d,p){return l.H.useFormState(h,d,p)},jn.useFormStatus=function(){return l.H.useHostTransitionStatus()},jn.version="19.1.1",jn}var Pb;function wI(){if(Pb)return Im.exports;Pb=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),Im.exports=_I(),Im.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mb;function SI(){if(Mb)return au;Mb=1;var r=TI(),t=Hy(),e=wI();function n(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var o=s,u=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(u=o.return),s=o.return;while(s)}return o.tag===3?u:null}function l(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function c(s){if(a(s)!==s)throw Error(n(188))}function h(s){var o=s.alternate;if(!o){if(o=a(s),o===null)throw Error(n(188));return o!==s?null:s}for(var u=s,f=o;;){var y=u.return;if(y===null)break;var A=y.alternate;if(A===null){if(f=y.return,f!==null){u=f;continue}break}if(y.child===A.child){for(A=y.child;A;){if(A===u)return c(y),s;if(A===f)return c(y),o;A=A.sibling}throw Error(n(188))}if(u.return!==f.return)u=y,f=A;else{for(var x=!1,B=y.child;B;){if(B===u){x=!0,u=y,f=A;break}if(B===f){x=!0,f=y,u=A;break}B=B.sibling}if(!x){for(B=A.child;B;){if(B===u){x=!0,u=A,f=y;break}if(B===f){x=!0,f=A,u=y;break}B=B.sibling}if(!x)throw Error(n(189))}}if(u.alternate!==f)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?s:o}function d(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=d(s),o!==null)return o;s=s.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),D=Symbol.for("react.consumer"),O=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function $(s){return s===null||typeof s!="object"?null:(s=H&&s[H]||s["@@iterator"],typeof s=="function"?s:null)}var j=Symbol.for("react.client.reference");function Tt(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===j?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case S:return"Profiler";case T:return"StrictMode";case k:return"Suspense";case z:return"SuspenseList";case M:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case E:return"Portal";case O:return(s.displayName||"Context")+".Provider";case D:return(s._context.displayName||"Context")+".Consumer";case F:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case P:return o=s.displayName||null,o!==null?o:Tt(s.type)||"Memo";case N:o=s._payload,s=s._init;try{return Tt(s(o))}catch{}}return null}var St=Array.isArray,X=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ht={pending:!1,data:null,method:null,action:null},Rt=[],W=-1;function lt(s){return{current:s}}function q(s){0>W||(s.current=Rt[W],Rt[W]=null,W--)}function it(s,o){W++,Rt[W]=s.current,s.current=o}var yt=lt(null),_t=lt(null),ut=lt(null),ft=lt(null);function pt(s,o){switch(it(ut,o),it(_t,s),it(yt,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?JA(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=JA(o),s=ZA(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}q(yt),it(yt,s)}function Ct(){q(yt),q(_t),q(ut)}function Vt(s){s.memoizedState!==null&&it(ft,s);var o=yt.current,u=ZA(o,s.type);o!==u&&(it(_t,s),it(yt,u))}function It(s){_t.current===s&&(q(yt),q(_t)),ft.current===s&&(q(ft),tu._currentValue=ht)}var qt=Object.prototype.hasOwnProperty,Xt=r.unstable_scheduleCallback,ne=r.unstable_cancelCallback,Te=r.unstable_shouldYield,me=r.unstable_requestPaint,_e=r.unstable_now,Yi=r.unstable_getCurrentPriorityLevel,ii=r.unstable_ImmediatePriority,Wi=r.unstable_UserBlockingPriority,ri=r.unstable_NormalPriority,Un=r.unstable_LowPriority,Si=r.unstable_IdlePriority,Vr=r.log,fi=r.unstable_setDisableYieldValue,Me=null,L=null;function w(s){if(typeof Vr=="function"&&fi(s),L&&typeof L.setStrictMode=="function")try{L.setStrictMode(Me,s)}catch{}}var R=Math.clz32?Math.clz32:ot,G=Math.log,J=Math.LN2;function ot(s){return s>>>=0,s===0?32:31-(G(s)/J|0)|0}var mt=256,Yt=4194304;function ce(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ye(s,o,u){var f=s.pendingLanes;if(f===0)return 0;var y=0,A=s.suspendedLanes,x=s.pingedLanes;s=s.warmLanes;var B=f&134217727;return B!==0?(f=B&~A,f!==0?y=ce(f):(x&=B,x!==0?y=ce(x):u||(u=B&~s,u!==0&&(y=ce(u))))):(B=f&~A,B!==0?y=ce(B):x!==0?y=ce(x):u||(u=f&~s,u!==0&&(y=ce(u)))),y===0?0:o!==0&&o!==y&&(o&A)===0&&(A=y&-y,u=o&-o,A>=u||A===32&&(u&4194048)!==0)?o:y}function Ee(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function pe(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ec(){var s=mt;return mt<<=1,(mt&4194048)===0&&(mt=256),s}function nc(){var s=Yt;return Yt<<=1,(Yt&62914560)===0&&(Yt=4194304),s}function jr(s){for(var o=[],u=0;31>u;u++)o.push(s);return o}function Hr(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function ic(s,o,u,f,y,A){var x=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var B=s.entanglements,K=s.expirationTimes,rt=s.hiddenUpdates;for(u=x&~u;0<u;){var gt=31-R(u),Et=1<<gt;B[gt]=0,K[gt]=-1;var st=rt[gt];if(st!==null)for(rt[gt]=null,gt=0;gt<st.length;gt++){var ct=st[gt];ct!==null&&(ct.lane&=-536870913)}u&=~Et}f!==0&&sr(s,f,0),A!==0&&y===0&&s.tag!==0&&(s.suspendedLanes|=A&~(x&~o))}function sr(s,o,u){s.pendingLanes|=o,s.suspendedLanes&=~o;var f=31-R(o);s.entangledLanes|=o,s.entanglements[f]=s.entanglements[f]|1073741824|u&4194090}function rc(s,o){var u=s.entangledLanes|=o;for(s=s.entanglements;u;){var f=31-R(u),y=1<<f;y&o|s[f]&o&&(s[f]|=o),u&=~y}}function xs(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Oo(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ds(){var s=Z.p;return s!==0?s:(s=window.event,s===void 0?32:vb(s.type))}function Ah(s,o){var u=Z.p;try{return Z.p=s,o()}finally{Z.p=u}}var Le=Math.random().toString(36).slice(2),dn="__reactFiber$"+Le,en="__reactProps$"+Le,Ri="__reactContainer$"+Le,sc="__reactEvents$"+Le,Sp="__reactListeners$"+Le,Os="__reactHandles$"+Le,bh="__reactResources$"+Le,Ia="__reactMarker$"+Le;function Ns(s){delete s[dn],delete s[en],delete s[sc],delete s[Sp],delete s[Os]}function zr(s){var o=s[dn];if(o)return o;for(var u=s.parentNode;u;){if(o=u[Ri]||u[dn]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(s=ib(s);s!==null;){if(u=s[dn])return u;s=ib(s)}return o}s=u,u=s.parentNode}return null}function ar(s){if(s=s[dn]||s[Ri]){var o=s.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return s}return null}function or(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(n(33))}function Wn(s){var o=s[bh];return o||(o=s[bh]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Ke(s){s[Ia]=!0}var ac=new Set,No={};function Ki(s,o){Gr(s,o),Gr(s+"Capture",o)}function Gr(s,o){for(No[s]=o,s=0;s<o.length;s++)ac.add(o[s])}var Th=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),_h={},xa={};function wh(s){return qt.call(xa,s)?!0:qt.call(_h,s)?!1:Th.test(s)?xa[s]=!0:(_h[s]=!0,!1)}function Ps(s,o,u){if(wh(o))if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+u)}}function lr(s,o,u){if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+u)}}function Cn(s,o,u,f){if(f===null)s.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(o,u,""+f)}}var Da,Sh;function $r(s){if(Da===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);Da=o&&o[1]||"",Sh=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Da+s+Sh}var Po=!1;function Mo(s,o){if(!s||Po)return"";Po=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var Et=function(){throw Error()};if(Object.defineProperty(Et.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Et,[])}catch(ct){var st=ct}Reflect.construct(s,[],Et)}else{try{Et.call()}catch(ct){st=ct}s.call(Et.prototype)}}else{try{throw Error()}catch(ct){st=ct}(Et=s())&&typeof Et.catch=="function"&&Et.catch(function(){})}}catch(ct){if(ct&&st&&typeof ct.stack=="string")return[ct.stack,st.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=f.DetermineComponentFrameRoot(),x=A[0],B=A[1];if(x&&B){var K=x.split(`
`),rt=B.split(`
`);for(y=f=0;f<K.length&&!K[f].includes("DetermineComponentFrameRoot");)f++;for(;y<rt.length&&!rt[y].includes("DetermineComponentFrameRoot");)y++;if(f===K.length||y===rt.length)for(f=K.length-1,y=rt.length-1;1<=f&&0<=y&&K[f]!==rt[y];)y--;for(;1<=f&&0<=y;f--,y--)if(K[f]!==rt[y]){if(f!==1||y!==1)do if(f--,y--,0>y||K[f]!==rt[y]){var gt=`
`+K[f].replace(" at new "," at ");return s.displayName&&gt.includes("<anonymous>")&&(gt=gt.replace("<anonymous>",s.displayName)),gt}while(1<=f&&0<=y);break}}}finally{Po=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?$r(u):""}function oc(s){switch(s.tag){case 26:case 27:case 5:return $r(s.type);case 16:return $r("Lazy");case 13:return $r("Suspense");case 19:return $r("SuspenseList");case 0:case 15:return Mo(s.type,!1);case 11:return Mo(s.type.render,!1);case 1:return Mo(s.type,!0);case 31:return $r("Activity");default:return""}}function Lo(s){try{var o="";do o+=oc(s),s=s.return;while(s);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function Kn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function lc(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Rp(s){var o=lc(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),f=""+s[o];if(!s.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var y=u.get,A=u.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return y.call(this)},set:function(x){f=""+x,A.call(this,x)}}),Object.defineProperty(s,o,{enumerable:u.enumerable}),{getValue:function(){return f},setValue:function(x){f=""+x},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function ko(s){s._valueTracker||(s._valueTracker=Rp(s))}function cc(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var u=o.getValue(),f="";return s&&(f=lc(s)?s.checked?"true":"false":s.value),s=f,s!==u?(o.setValue(s),!0):!1}function Oa(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Cp=/[\n"\\]/g;function nn(s){return s.replace(Cp,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function pi(s,o,u,f,y,A,x,B){s.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?s.type=x:s.removeAttribute("type"),o!=null?x==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+Kn(o)):s.value!==""+Kn(o)&&(s.value=""+Kn(o)):x!=="submit"&&x!=="reset"||s.removeAttribute("value"),o!=null?Ms(s,x,Kn(o)):u!=null?Ms(s,x,Kn(u)):f!=null&&s.removeAttribute("value"),y==null&&A!=null&&(s.defaultChecked=!!A),y!=null&&(s.checked=y&&typeof y!="function"&&typeof y!="symbol"),B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?s.name=""+Kn(B):s.removeAttribute("name")}function Na(s,o,u,f,y,A,x,B){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.type=A),o!=null||u!=null){if(!(A!=="submit"&&A!=="reset"||o!=null))return;u=u!=null?""+Kn(u):"",o=o!=null?""+Kn(o):u,B||o===s.value||(s.value=o),s.defaultValue=o}f=f??y,f=typeof f!="function"&&typeof f!="symbol"&&!!f,s.checked=B?s.checked:!!f,s.defaultChecked=!!f,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.name=x)}function Ms(s,o,u){o==="number"&&Oa(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function Yr(s,o,u,f){if(s=s.options,o){o={};for(var y=0;y<u.length;y++)o["$"+u[y]]=!0;for(u=0;u<s.length;u++)y=o.hasOwnProperty("$"+s[u].value),s[u].selected!==y&&(s[u].selected=y),y&&f&&(s[u].defaultSelected=!0)}else{for(u=""+Kn(u),o=null,y=0;y<s.length;y++){if(s[y].value===u){s[y].selected=!0,f&&(s[y].defaultSelected=!0);return}o!==null||s[y].disabled||(o=s[y])}o!==null&&(o.selected=!0)}}function Re(s,o,u){if(o!=null&&(o=""+Kn(o),o!==s.value&&(s.value=o),u==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=u!=null?""+Kn(u):""}function Pa(s,o,u,f){if(o==null){if(f!=null){if(u!=null)throw Error(n(92));if(St(f)){if(1<f.length)throw Error(n(93));f=f[0]}u=f}u==null&&(u=""),o=u}u=Kn(o),s.defaultValue=u,f=s.textContent,f===u&&f!==""&&f!==null&&(s.value=f)}function Ci(s,o){if(o){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=o;return}}s.textContent=o}var Ma=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Rh(s,o,u){var f=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":f?s.setProperty(o,u):typeof u!="number"||u===0||Ma.has(o)?o==="float"?s.cssFloat=u:s[o]=(""+u).trim():s[o]=u+"px"}function uc(s,o,u){if(o!=null&&typeof o!="object")throw Error(n(62));if(s=s.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?s.setProperty(f,""):f==="float"?s.cssFloat="":s[f]="");for(var y in o)f=o[y],o.hasOwnProperty(y)&&u[y]!==f&&Rh(s,y,f)}else for(var A in o)o.hasOwnProperty(A)&&Rh(s,A,o[A])}function hc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ip=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Bo(s){return xp.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var Wr=null;function Ii(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Kr=null,Xr=null;function dc(s){var o=ar(s);if(o&&(s=o.stateNode)){var u=s[en]||null;t:switch(s=o.stateNode,o.type){case"input":if(pi(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+nn(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var f=u[o];if(f!==s&&f.form===s.form){var y=f[en]||null;if(!y)throw Error(n(90));pi(f,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<u.length;o++)f=u[o],f.form===s.form&&cc(f)}break t;case"textarea":Re(s,u.value,u.defaultValue);break t;case"select":o=u.value,o!=null&&Yr(s,!!u.multiple,o,!1)}}}var cr=!1;function Ch(s,o,u){if(cr)return s(o,u);cr=!0;try{var f=s(o);return f}finally{if(cr=!1,(Kr!==null||Xr!==null)&&(Ad(),Kr&&(o=Kr,s=Xr,Xr=Kr=null,dc(o),s)))for(o=0;o<s.length;o++)dc(s[o])}}function La(s,o){var u=s.stateNode;if(u===null)return null;var f=u[en]||null;if(f===null)return null;u=f[o];t:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break t;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(n(231,o,typeof u));return u}var Xi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xi=!1;if(Xi)try{var ka={};Object.defineProperty(ka,"passive",{get:function(){xi=!0}}),window.addEventListener("test",ka,ka),window.removeEventListener("test",ka,ka)}catch{xi=!1}var ur=null,Ls=null,qr=null;function fc(){if(qr)return qr;var s,o=Ls,u=o.length,f,y="value"in ur?ur.value:ur.textContent,A=y.length;for(s=0;s<u&&o[s]===y[s];s++);var x=u-s;for(f=1;f<=x&&o[u-f]===y[A-f];f++);return qr=y.slice(s,1<f?1-f:void 0)}function hr(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function dr(){return!0}function pc(){return!1}function En(s){function o(u,f,y,A,x){this._reactName=u,this._targetInst=y,this.type=f,this.nativeEvent=A,this.target=x,this.currentTarget=null;for(var B in s)s.hasOwnProperty(B)&&(u=s[B],this[B]=u?u(A):A[B]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?dr:pc,this.isPropagationStopped=pc,this}return p(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=dr)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=dr)},persist:function(){},isPersistent:dr}),o}var Ae={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fo=En(Ae),Ba=p({},Ae,{view:0,detail:0}),Ih=En(Ba),Uo,Vo,fr,Fa=p({},Ba,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ja,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==fr&&(fr&&s.type==="mousemove"?(Uo=s.screenX-fr.screenX,Vo=s.screenY-fr.screenY):Vo=Uo=0,fr=s),Uo)},movementY:function(s){return"movementY"in s?s.movementY:Vo}}),Di=En(Fa),xh=p({},Fa,{dataTransfer:0}),Dp=En(xh),Ua=p({},Ba,{relatedTarget:0}),jo=En(Ua),gc=p({},Ae,{animationName:0,elapsedTime:0,pseudoElement:0}),Ho=En(gc),Dh=p({},Ae,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),zo=En(Dh),Op=p({},Ae,{data:0}),mc=En(Op),Va={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Oh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yc(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=Nh[s])?!!o[s]:!1}function ja(){return yc}var Ph=p({},Ba,{key:function(s){if(s.key){var o=Va[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=hr(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Oh[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ja,charCode:function(s){return s.type==="keypress"?hr(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?hr(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Go=En(Ph),Mh=p({},Fa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vc=En(Mh),Qr=p({},Ba,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ja}),Lh=En(Qr),kh=p({},Ae,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bh=En(kh),Fh=p({},Fa,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),$o=En(Fh),Xn=p({},Ae,{newState:0,oldState:0}),Uh=En(Xn),Vh=[9,13,27,32],pr=Xi&&"CompositionEvent"in window,g=null;Xi&&"documentMode"in document&&(g=document.documentMode);var _=Xi&&"TextEvent"in window&&!g,I=Xi&&(!pr||g&&8<g&&11>=g),U=" ",et=!1;function dt(s,o){switch(s){case"keyup":return Vh.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wt(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ue=!1;function fn(s,o){switch(s){case"compositionend":return wt(o);case"keypress":return o.which!==32?null:(et=!0,U);case"textInput":return s=o.data,s===U&&et?null:s;default:return null}}function he(s,o){if(ue)return s==="compositionend"||!pr&&dt(s,o)?(s=fc(),qr=Ls=ur=null,ue=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return I&&o.locale!=="ko"?null:o.data;default:return null}}var An={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pn(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!An[s.type]:o==="textarea"}function Jr(s,o,u,f){Kr?Xr?Xr.push(f):Xr=[f]:Kr=f,o=Rd(o,"onChange"),0<o.length&&(u=new Fo("onChange","change",null,u,f),s.push({event:u,listeners:o}))}var In=null,gr=null;function Ec(s){WA(s,0)}function jh(s){var o=or(s);if(cc(o))return s}function p0(s,o){if(s==="change")return o}var g0=!1;if(Xi){var Np;if(Xi){var Pp="oninput"in document;if(!Pp){var m0=document.createElement("div");m0.setAttribute("oninput","return;"),Pp=typeof m0.oninput=="function"}Np=Pp}else Np=!1;g0=Np&&(!document.documentMode||9<document.documentMode)}function y0(){In&&(In.detachEvent("onpropertychange",v0),gr=In=null)}function v0(s){if(s.propertyName==="value"&&jh(gr)){var o=[];Jr(o,gr,s,Ii(s)),Ch(Ec,o)}}function KR(s,o,u){s==="focusin"?(y0(),In=o,gr=u,In.attachEvent("onpropertychange",v0)):s==="focusout"&&y0()}function XR(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return jh(gr)}function qR(s,o){if(s==="click")return jh(o)}function QR(s,o){if(s==="input"||s==="change")return jh(o)}function JR(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var gi=typeof Object.is=="function"?Object.is:JR;function Ac(s,o){if(gi(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var u=Object.keys(s),f=Object.keys(o);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var y=u[f];if(!qt.call(o,y)||!gi(s[y],o[y]))return!1}return!0}function E0(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function A0(s,o){var u=E0(s);s=0;for(var f;u;){if(u.nodeType===3){if(f=s+u.textContent.length,s<=o&&f>=o)return{node:u,offset:o-s};s=f}t:{for(;u;){if(u.nextSibling){u=u.nextSibling;break t}u=u.parentNode}u=void 0}u=E0(u)}}function b0(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?b0(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function T0(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Oa(s.document);o instanceof s.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)s=o.contentWindow;else break;o=Oa(s.document)}return o}function Mp(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var ZR=Xi&&"documentMode"in document&&11>=document.documentMode,Yo=null,Lp=null,bc=null,kp=!1;function _0(s,o,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;kp||Yo==null||Yo!==Oa(f)||(f=Yo,"selectionStart"in f&&Mp(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),bc&&Ac(bc,f)||(bc=f,f=Rd(Lp,"onSelect"),0<f.length&&(o=new Fo("onSelect","select",null,o,u),s.push({event:o,listeners:f}),o.target=Yo)))}function Ha(s,o){var u={};return u[s.toLowerCase()]=o.toLowerCase(),u["Webkit"+s]="webkit"+o,u["Moz"+s]="moz"+o,u}var Wo={animationend:Ha("Animation","AnimationEnd"),animationiteration:Ha("Animation","AnimationIteration"),animationstart:Ha("Animation","AnimationStart"),transitionrun:Ha("Transition","TransitionRun"),transitionstart:Ha("Transition","TransitionStart"),transitioncancel:Ha("Transition","TransitionCancel"),transitionend:Ha("Transition","TransitionEnd")},Bp={},w0={};Xi&&(w0=document.createElement("div").style,"AnimationEvent"in window||(delete Wo.animationend.animation,delete Wo.animationiteration.animation,delete Wo.animationstart.animation),"TransitionEvent"in window||delete Wo.transitionend.transition);function za(s){if(Bp[s])return Bp[s];if(!Wo[s])return s;var o=Wo[s],u;for(u in o)if(o.hasOwnProperty(u)&&u in w0)return Bp[s]=o[u];return s}var S0=za("animationend"),R0=za("animationiteration"),C0=za("animationstart"),tC=za("transitionrun"),eC=za("transitionstart"),nC=za("transitioncancel"),I0=za("transitionend"),x0=new Map,Fp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Fp.push("scrollEnd");function qi(s,o){x0.set(s,o),Ki(o,[s])}var D0=new WeakMap;function Oi(s,o){if(typeof s=="object"&&s!==null){var u=D0.get(s);return u!==void 0?u:(o={value:s,source:o,stack:Lo(o)},D0.set(s,o),o)}return{value:s,source:o,stack:Lo(o)}}var Ni=[],Ko=0,Up=0;function Hh(){for(var s=Ko,o=Up=Ko=0;o<s;){var u=Ni[o];Ni[o++]=null;var f=Ni[o];Ni[o++]=null;var y=Ni[o];Ni[o++]=null;var A=Ni[o];if(Ni[o++]=null,f!==null&&y!==null){var x=f.pending;x===null?y.next=y:(y.next=x.next,x.next=y),f.pending=y}A!==0&&O0(u,y,A)}}function zh(s,o,u,f){Ni[Ko++]=s,Ni[Ko++]=o,Ni[Ko++]=u,Ni[Ko++]=f,Up|=f,s.lanes|=f,s=s.alternate,s!==null&&(s.lanes|=f)}function Vp(s,o,u,f){return zh(s,o,u,f),Gh(s)}function Xo(s,o){return zh(s,null,null,o),Gh(s)}function O0(s,o,u){s.lanes|=u;var f=s.alternate;f!==null&&(f.lanes|=u);for(var y=!1,A=s.return;A!==null;)A.childLanes|=u,f=A.alternate,f!==null&&(f.childLanes|=u),A.tag===22&&(s=A.stateNode,s===null||s._visibility&1||(y=!0)),s=A,A=A.return;return s.tag===3?(A=s.stateNode,y&&o!==null&&(y=31-R(u),s=A.hiddenUpdates,f=s[y],f===null?s[y]=[o]:f.push(o),o.lane=u|536870912),A):null}function Gh(s){if(50<Yc)throw Yc=0,Yg=null,Error(n(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var qo={};function iC(s,o,u,f){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mi(s,o,u,f){return new iC(s,o,u,f)}function jp(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Zr(s,o){var u=s.alternate;return u===null?(u=mi(s.tag,o,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=o,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,o=s.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function N0(s,o){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,o=u.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function $h(s,o,u,f,y,A){var x=0;if(f=s,typeof s=="function")jp(s)&&(x=1);else if(typeof s=="string")x=sI(s,u,yt.current)?26:s==="html"||s==="head"||s==="body"?27:5;else t:switch(s){case M:return s=mi(31,u,o,y),s.elementType=M,s.lanes=A,s;case b:return Ga(u.children,y,A,o);case T:x=8,y|=24;break;case S:return s=mi(12,u,o,y|2),s.elementType=S,s.lanes=A,s;case k:return s=mi(13,u,o,y),s.elementType=k,s.lanes=A,s;case z:return s=mi(19,u,o,y),s.elementType=z,s.lanes=A,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case C:case O:x=10;break t;case D:x=9;break t;case F:x=11;break t;case P:x=14;break t;case N:x=16,f=null;break t}x=29,u=Error(n(130,s===null?"null":typeof s,"")),f=null}return o=mi(x,u,o,y),o.elementType=s,o.type=f,o.lanes=A,o}function Ga(s,o,u,f){return s=mi(7,s,f,o),s.lanes=u,s}function Hp(s,o,u){return s=mi(6,s,null,o),s.lanes=u,s}function zp(s,o,u){return o=mi(4,s.children!==null?s.children:[],s.key,o),o.lanes=u,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var Qo=[],Jo=0,Yh=null,Wh=0,Pi=[],Mi=0,$a=null,ts=1,es="";function Ya(s,o){Qo[Jo++]=Wh,Qo[Jo++]=Yh,Yh=s,Wh=o}function P0(s,o,u){Pi[Mi++]=ts,Pi[Mi++]=es,Pi[Mi++]=$a,$a=s;var f=ts;s=es;var y=32-R(f)-1;f&=~(1<<y),u+=1;var A=32-R(o)+y;if(30<A){var x=y-y%5;A=(f&(1<<x)-1).toString(32),f>>=x,y-=x,ts=1<<32-R(o)+y|u<<y|f,es=A+s}else ts=1<<A|u<<y|f,es=s}function Gp(s){s.return!==null&&(Ya(s,1),P0(s,1,0))}function $p(s){for(;s===Yh;)Yh=Qo[--Jo],Qo[Jo]=null,Wh=Qo[--Jo],Qo[Jo]=null;for(;s===$a;)$a=Pi[--Mi],Pi[Mi]=null,es=Pi[--Mi],Pi[Mi]=null,ts=Pi[--Mi],Pi[Mi]=null}var qn=null,Ge=null,ve=!1,Wa=null,mr=!1,Yp=Error(n(519));function Ka(s){var o=Error(n(418,""));throw wc(Oi(o,s)),Yp}function M0(s){var o=s.stateNode,u=s.type,f=s.memoizedProps;switch(o[dn]=s,o[en]=f,u){case"dialog":re("cancel",o),re("close",o);break;case"iframe":case"object":case"embed":re("load",o);break;case"video":case"audio":for(u=0;u<Kc.length;u++)re(Kc[u],o);break;case"source":re("error",o);break;case"img":case"image":case"link":re("error",o),re("load",o);break;case"details":re("toggle",o);break;case"input":re("invalid",o),Na(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),ko(o);break;case"select":re("invalid",o);break;case"textarea":re("invalid",o),Pa(o,f.value,f.defaultValue,f.children),ko(o)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||f.suppressHydrationWarning===!0||QA(o.textContent,u)?(f.popover!=null&&(re("beforetoggle",o),re("toggle",o)),f.onScroll!=null&&re("scroll",o),f.onScrollEnd!=null&&re("scrollend",o),f.onClick!=null&&(o.onclick=Cd),o=!0):o=!1,o||Ka(s)}function L0(s){for(qn=s.return;qn;)switch(qn.tag){case 5:case 13:mr=!1;return;case 27:case 3:mr=!0;return;default:qn=qn.return}}function Tc(s){if(s!==qn)return!1;if(!ve)return L0(s),ve=!0,!1;var o=s.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||lm(s.type,s.memoizedProps)),u=!u),u&&Ge&&Ka(s),L0(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));t:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8)if(u=s.data,u==="/$"){if(o===0){Ge=Ji(s.nextSibling);break t}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;s=s.nextSibling}Ge=null}}else o===27?(o=Ge,Qs(s.type)?(s=dm,dm=null,Ge=s):Ge=o):Ge=qn?Ji(s.stateNode.nextSibling):null;return!0}function _c(){Ge=qn=null,ve=!1}function k0(){var s=Wa;return s!==null&&(oi===null?oi=s:oi.push.apply(oi,s),Wa=null),s}function wc(s){Wa===null?Wa=[s]:Wa.push(s)}var Wp=lt(null),Xa=null,ns=null;function ks(s,o,u){it(Wp,o._currentValue),o._currentValue=u}function is(s){s._currentValue=Wp.current,q(Wp)}function Kp(s,o,u){for(;s!==null;){var f=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),s===u)break;s=s.return}}function Xp(s,o,u,f){var y=s.child;for(y!==null&&(y.return=s);y!==null;){var A=y.dependencies;if(A!==null){var x=y.child;A=A.firstContext;t:for(;A!==null;){var B=A;A=y;for(var K=0;K<o.length;K++)if(B.context===o[K]){A.lanes|=u,B=A.alternate,B!==null&&(B.lanes|=u),Kp(A.return,u,s),f||(x=null);break t}A=B.next}}else if(y.tag===18){if(x=y.return,x===null)throw Error(n(341));x.lanes|=u,A=x.alternate,A!==null&&(A.lanes|=u),Kp(x,u,s),x=null}else x=y.child;if(x!==null)x.return=y;else for(x=y;x!==null;){if(x===s){x=null;break}if(y=x.sibling,y!==null){y.return=x.return,x=y;break}x=x.return}y=x}}function Sc(s,o,u,f){s=null;for(var y=o,A=!1;y!==null;){if(!A){if((y.flags&524288)!==0)A=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var x=y.alternate;if(x===null)throw Error(n(387));if(x=x.memoizedProps,x!==null){var B=y.type;gi(y.pendingProps.value,x.value)||(s!==null?s.push(B):s=[B])}}else if(y===ft.current){if(x=y.alternate,x===null)throw Error(n(387));x.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(s!==null?s.push(tu):s=[tu])}y=y.return}s!==null&&Xp(o,s,u,f),o.flags|=262144}function Kh(s){for(s=s.firstContext;s!==null;){if(!gi(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function qa(s){Xa=s,ns=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Vn(s){return B0(Xa,s)}function Xh(s,o){return Xa===null&&qa(s),B0(s,o)}function B0(s,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},ns===null){if(s===null)throw Error(n(308));ns=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else ns=ns.next=o;return u}var rC=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(u,f){s.push(f)}};this.abort=function(){o.aborted=!0,s.forEach(function(u){return u()})}},sC=r.unstable_scheduleCallback,aC=r.unstable_NormalPriority,gn={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function qp(){return{controller:new rC,data:new Map,refCount:0}}function Rc(s){s.refCount--,s.refCount===0&&sC(aC,function(){s.controller.abort()})}var Cc=null,Qp=0,Zo=0,tl=null;function oC(s,o){if(Cc===null){var u=Cc=[];Qp=0,Zo=Zg(),tl={status:"pending",value:void 0,then:function(f){u.push(f)}}}return Qp++,o.then(F0,F0),o}function F0(){if(--Qp===0&&Cc!==null){tl!==null&&(tl.status="fulfilled");var s=Cc;Cc=null,Zo=0,tl=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function lC(s,o){var u=[],f={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return s.then(function(){f.status="fulfilled",f.value=o;for(var y=0;y<u.length;y++)(0,u[y])(o)},function(y){for(f.status="rejected",f.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),f}var U0=X.S;X.S=function(s,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&oC(s,o),U0!==null&&U0(s,o)};var Qa=lt(null);function Jp(){var s=Qa.current;return s!==null?s:Ne.pooledCache}function qh(s,o){o===null?it(Qa,Qa.current):it(Qa,o.pool)}function V0(){var s=Jp();return s===null?null:{parent:gn._currentValue,pool:s}}var Ic=Error(n(460)),j0=Error(n(474)),Qh=Error(n(542)),Zp={then:function(){}};function H0(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Jh(){}function z0(s,o,u){switch(u=s[u],u===void 0?s.push(o):u!==o&&(o.then(Jh,Jh),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,$0(s),s;default:if(typeof o.status=="string")o.then(Jh,Jh);else{if(s=Ne,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=o,s.status="pending",s.then(function(f){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=f}},function(f){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,$0(s),s}throw xc=o,Ic}}var xc=null;function G0(){if(xc===null)throw Error(n(459));var s=xc;return xc=null,s}function $0(s){if(s===Ic||s===Qh)throw Error(n(483))}var Bs=!1;function tg(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function eg(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Fs(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Us(s,o,u){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(we&2)!==0){var y=f.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),f.pending=o,o=Gh(s),O0(s,null,u),o}return zh(s,f,o,u),Gh(s)}function Dc(s,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var f=o.lanes;f&=s.pendingLanes,u|=f,o.lanes=u,rc(s,u)}}function ng(s,o){var u=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var y=null,A=null;if(u=u.firstBaseUpdate,u!==null){do{var x={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};A===null?y=A=x:A=A.next=x,u=u.next}while(u!==null);A===null?y=A=o:A=A.next=o}else y=A=o;u={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:A,shared:f.shared,callbacks:f.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=o:s.next=o,u.lastBaseUpdate=o}var ig=!1;function Oc(){if(ig){var s=tl;if(s!==null)throw s}}function Nc(s,o,u,f){ig=!1;var y=s.updateQueue;Bs=!1;var A=y.firstBaseUpdate,x=y.lastBaseUpdate,B=y.shared.pending;if(B!==null){y.shared.pending=null;var K=B,rt=K.next;K.next=null,x===null?A=rt:x.next=rt,x=K;var gt=s.alternate;gt!==null&&(gt=gt.updateQueue,B=gt.lastBaseUpdate,B!==x&&(B===null?gt.firstBaseUpdate=rt:B.next=rt,gt.lastBaseUpdate=K))}if(A!==null){var Et=y.baseState;x=0,gt=rt=K=null,B=A;do{var st=B.lane&-536870913,ct=st!==B.lane;if(ct?(de&st)===st:(f&st)===st){st!==0&&st===Zo&&(ig=!0),gt!==null&&(gt=gt.next={lane:0,tag:B.tag,payload:B.payload,callback:null,next:null});t:{var zt=s,Bt=B;st=o;var xe=u;switch(Bt.tag){case 1:if(zt=Bt.payload,typeof zt=="function"){Et=zt.call(xe,Et,st);break t}Et=zt;break t;case 3:zt.flags=zt.flags&-65537|128;case 0:if(zt=Bt.payload,st=typeof zt=="function"?zt.call(xe,Et,st):zt,st==null)break t;Et=p({},Et,st);break t;case 2:Bs=!0}}st=B.callback,st!==null&&(s.flags|=64,ct&&(s.flags|=8192),ct=y.callbacks,ct===null?y.callbacks=[st]:ct.push(st))}else ct={lane:st,tag:B.tag,payload:B.payload,callback:B.callback,next:null},gt===null?(rt=gt=ct,K=Et):gt=gt.next=ct,x|=st;if(B=B.next,B===null){if(B=y.shared.pending,B===null)break;ct=B,B=ct.next,ct.next=null,y.lastBaseUpdate=ct,y.shared.pending=null}}while(!0);gt===null&&(K=Et),y.baseState=K,y.firstBaseUpdate=rt,y.lastBaseUpdate=gt,A===null&&(y.shared.lanes=0),Ws|=x,s.lanes=x,s.memoizedState=Et}}function Y0(s,o){if(typeof s!="function")throw Error(n(191,s));s.call(o)}function W0(s,o){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)Y0(u[s],o)}var el=lt(null),Zh=lt(0);function K0(s,o){s=us,it(Zh,s),it(el,o),us=s|o.baseLanes}function rg(){it(Zh,us),it(el,el.current)}function sg(){us=Zh.current,q(el),q(Zh)}var Vs=0,Zt=null,Ce=null,rn=null,td=!1,nl=!1,Ja=!1,ed=0,Pc=0,il=null,cC=0;function Xe(){throw Error(n(321))}function ag(s,o){if(o===null)return!1;for(var u=0;u<o.length&&u<s.length;u++)if(!gi(s[u],o[u]))return!1;return!0}function og(s,o,u,f,y,A){return Vs=A,Zt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,X.H=s===null||s.memoizedState===null?OE:NE,Ja=!1,A=u(f,y),Ja=!1,nl&&(A=q0(o,u,f,y)),X0(s),A}function X0(s){X.H=od;var o=Ce!==null&&Ce.next!==null;if(Vs=0,rn=Ce=Zt=null,td=!1,Pc=0,il=null,o)throw Error(n(300));s===null||bn||(s=s.dependencies,s!==null&&Kh(s)&&(bn=!0))}function q0(s,o,u,f){Zt=s;var y=0;do{if(nl&&(il=null),Pc=0,nl=!1,25<=y)throw Error(n(301));if(y+=1,rn=Ce=null,s.updateQueue!=null){var A=s.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}X.H=mC,A=o(u,f)}while(nl);return A}function uC(){var s=X.H,o=s.useState()[0];return o=typeof o.then=="function"?Mc(o):o,s=s.useState()[0],(Ce!==null?Ce.memoizedState:null)!==s&&(Zt.flags|=1024),o}function lg(){var s=ed!==0;return ed=0,s}function cg(s,o,u){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~u}function ug(s){if(td){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}td=!1}Vs=0,rn=Ce=Zt=null,nl=!1,Pc=ed=0,il=null}function si(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rn===null?Zt.memoizedState=rn=s:rn=rn.next=s,rn}function sn(){if(Ce===null){var s=Zt.alternate;s=s!==null?s.memoizedState:null}else s=Ce.next;var o=rn===null?Zt.memoizedState:rn.next;if(o!==null)rn=o,Ce=s;else{if(s===null)throw Zt.alternate===null?Error(n(467)):Error(n(310));Ce=s,s={memoizedState:Ce.memoizedState,baseState:Ce.baseState,baseQueue:Ce.baseQueue,queue:Ce.queue,next:null},rn===null?Zt.memoizedState=rn=s:rn=rn.next=s}return rn}function hg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Mc(s){var o=Pc;return Pc+=1,il===null&&(il=[]),s=z0(il,s,o),o=Zt,(rn===null?o.memoizedState:rn.next)===null&&(o=o.alternate,X.H=o===null||o.memoizedState===null?OE:NE),s}function nd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Mc(s);if(s.$$typeof===O)return Vn(s)}throw Error(n(438,String(s)))}function dg(s){var o=null,u=Zt.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var f=Zt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=hg(),Zt.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(s),f=0;f<s;f++)u[f]=V;return o.index++,u}function rs(s,o){return typeof o=="function"?o(s):o}function id(s){var o=sn();return fg(o,Ce,s)}function fg(s,o,u){var f=s.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=u;var y=s.baseQueue,A=f.pending;if(A!==null){if(y!==null){var x=y.next;y.next=A.next,A.next=x}o.baseQueue=y=A,f.pending=null}if(A=s.baseState,y===null)s.memoizedState=A;else{o=y.next;var B=x=null,K=null,rt=o,gt=!1;do{var Et=rt.lane&-536870913;if(Et!==rt.lane?(de&Et)===Et:(Vs&Et)===Et){var st=rt.revertLane;if(st===0)K!==null&&(K=K.next={lane:0,revertLane:0,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null}),Et===Zo&&(gt=!0);else if((Vs&st)===st){rt=rt.next,st===Zo&&(gt=!0);continue}else Et={lane:0,revertLane:rt.revertLane,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null},K===null?(B=K=Et,x=A):K=K.next=Et,Zt.lanes|=st,Ws|=st;Et=rt.action,Ja&&u(A,Et),A=rt.hasEagerState?rt.eagerState:u(A,Et)}else st={lane:Et,revertLane:rt.revertLane,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null},K===null?(B=K=st,x=A):K=K.next=st,Zt.lanes|=Et,Ws|=Et;rt=rt.next}while(rt!==null&&rt!==o);if(K===null?x=A:K.next=B,!gi(A,s.memoizedState)&&(bn=!0,gt&&(u=tl,u!==null)))throw u;s.memoizedState=A,s.baseState=x,s.baseQueue=K,f.lastRenderedState=A}return y===null&&(f.lanes=0),[s.memoizedState,f.dispatch]}function pg(s){var o=sn(),u=o.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=s;var f=u.dispatch,y=u.pending,A=o.memoizedState;if(y!==null){u.pending=null;var x=y=y.next;do A=s(A,x.action),x=x.next;while(x!==y);gi(A,o.memoizedState)||(bn=!0),o.memoizedState=A,o.baseQueue===null&&(o.baseState=A),u.lastRenderedState=A}return[A,f]}function Q0(s,o,u){var f=Zt,y=sn(),A=ve;if(A){if(u===void 0)throw Error(n(407));u=u()}else u=o();var x=!gi((Ce||y).memoizedState,u);x&&(y.memoizedState=u,bn=!0),y=y.queue;var B=tE.bind(null,f,y,s);if(Lc(2048,8,B,[s]),y.getSnapshot!==o||x||rn!==null&&rn.memoizedState.tag&1){if(f.flags|=2048,rl(9,rd(),Z0.bind(null,f,y,u,o),null),Ne===null)throw Error(n(349));A||(Vs&124)!==0||J0(f,o,u)}return u}function J0(s,o,u){s.flags|=16384,s={getSnapshot:o,value:u},o=Zt.updateQueue,o===null?(o=hg(),Zt.updateQueue=o,o.stores=[s]):(u=o.stores,u===null?o.stores=[s]:u.push(s))}function Z0(s,o,u,f){o.value=u,o.getSnapshot=f,eE(o)&&nE(s)}function tE(s,o,u){return u(function(){eE(o)&&nE(s)})}function eE(s){var o=s.getSnapshot;s=s.value;try{var u=o();return!gi(s,u)}catch{return!0}}function nE(s){var o=Xo(s,2);o!==null&&bi(o,s,2)}function gg(s){var o=si();if(typeof s=="function"){var u=s;if(s=u(),Ja){w(!0);try{u()}finally{w(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rs,lastRenderedState:s},o}function iE(s,o,u,f){return s.baseState=u,fg(s,Ce,typeof f=="function"?f:rs)}function hC(s,o,u,f,y){if(ad(s))throw Error(n(485));if(s=o.action,s!==null){var A={payload:y,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){A.listeners.push(x)}};X.T!==null?u(!0):A.isTransition=!1,f(A),u=o.pending,u===null?(A.next=o.pending=A,rE(o,A)):(A.next=u.next,o.pending=u.next=A)}}function rE(s,o){var u=o.action,f=o.payload,y=s.state;if(o.isTransition){var A=X.T,x={};X.T=x;try{var B=u(y,f),K=X.S;K!==null&&K(x,B),sE(s,o,B)}catch(rt){mg(s,o,rt)}finally{X.T=A}}else try{A=u(y,f),sE(s,o,A)}catch(rt){mg(s,o,rt)}}function sE(s,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){aE(s,o,f)},function(f){return mg(s,o,f)}):aE(s,o,u)}function aE(s,o,u){o.status="fulfilled",o.value=u,oE(o),s.state=u,o=s.pending,o!==null&&(u=o.next,u===o?s.pending=null:(u=u.next,o.next=u,rE(s,u)))}function mg(s,o,u){var f=s.pending;if(s.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=u,oE(o),o=o.next;while(o!==f)}s.action=null}function oE(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function lE(s,o){return o}function cE(s,o){if(ve){var u=Ne.formState;if(u!==null){t:{var f=Zt;if(ve){if(Ge){e:{for(var y=Ge,A=mr;y.nodeType!==8;){if(!A){y=null;break e}if(y=Ji(y.nextSibling),y===null){y=null;break e}}A=y.data,y=A==="F!"||A==="F"?y:null}if(y){Ge=Ji(y.nextSibling),f=y.data==="F!";break t}}Ka(f)}f=!1}f&&(o=u[0])}}return u=si(),u.memoizedState=u.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:lE,lastRenderedState:o},u.queue=f,u=IE.bind(null,Zt,f),f.dispatch=u,f=gg(!1),A=bg.bind(null,Zt,!1,f.queue),f=si(),y={state:o,dispatch:null,action:s,pending:null},f.queue=y,u=hC.bind(null,Zt,y,A,u),y.dispatch=u,f.memoizedState=s,[o,u,!1]}function uE(s){var o=sn();return hE(o,Ce,s)}function hE(s,o,u){if(o=fg(s,o,lE)[0],s=id(rs)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=Mc(o)}catch(x){throw x===Ic?Qh:x}else f=o;o=sn();var y=o.queue,A=y.dispatch;return u!==o.memoizedState&&(Zt.flags|=2048,rl(9,rd(),dC.bind(null,y,u),null)),[f,A,s]}function dC(s,o){s.action=o}function dE(s){var o=sn(),u=Ce;if(u!==null)return hE(o,u,s);sn(),o=o.memoizedState,u=sn();var f=u.queue.dispatch;return u.memoizedState=s,[o,f,!1]}function rl(s,o,u,f){return s={tag:s,create:u,deps:f,inst:o,next:null},o=Zt.updateQueue,o===null&&(o=hg(),Zt.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=s.next=s:(f=u.next,u.next=s,s.next=f,o.lastEffect=s),s}function rd(){return{destroy:void 0,resource:void 0}}function fE(){return sn().memoizedState}function sd(s,o,u,f){var y=si();f=f===void 0?null:f,Zt.flags|=s,y.memoizedState=rl(1|o,rd(),u,f)}function Lc(s,o,u,f){var y=sn();f=f===void 0?null:f;var A=y.memoizedState.inst;Ce!==null&&f!==null&&ag(f,Ce.memoizedState.deps)?y.memoizedState=rl(o,A,u,f):(Zt.flags|=s,y.memoizedState=rl(1|o,A,u,f))}function pE(s,o){sd(8390656,8,s,o)}function gE(s,o){Lc(2048,8,s,o)}function mE(s,o){return Lc(4,2,s,o)}function yE(s,o){return Lc(4,4,s,o)}function vE(s,o){if(typeof o=="function"){s=s();var u=o(s);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function EE(s,o,u){u=u!=null?u.concat([s]):null,Lc(4,4,vE.bind(null,o,s),u)}function yg(){}function AE(s,o){var u=sn();o=o===void 0?null:o;var f=u.memoizedState;return o!==null&&ag(o,f[1])?f[0]:(u.memoizedState=[s,o],s)}function bE(s,o){var u=sn();o=o===void 0?null:o;var f=u.memoizedState;if(o!==null&&ag(o,f[1]))return f[0];if(f=s(),Ja){w(!0);try{s()}finally{w(!1)}}return u.memoizedState=[f,o],f}function vg(s,o,u){return u===void 0||(Vs&1073741824)!==0?s.memoizedState=o:(s.memoizedState=u,s=wA(),Zt.lanes|=s,Ws|=s,u)}function TE(s,o,u,f){return gi(u,o)?u:el.current!==null?(s=vg(s,u,f),gi(s,o)||(bn=!0),s):(Vs&42)===0?(bn=!0,s.memoizedState=u):(s=wA(),Zt.lanes|=s,Ws|=s,o)}function _E(s,o,u,f,y){var A=Z.p;Z.p=A!==0&&8>A?A:8;var x=X.T,B={};X.T=B,bg(s,!1,o,u);try{var K=y(),rt=X.S;if(rt!==null&&rt(B,K),K!==null&&typeof K=="object"&&typeof K.then=="function"){var gt=lC(K,f);kc(s,o,gt,Ai(s))}else kc(s,o,f,Ai(s))}catch(Et){kc(s,o,{then:function(){},status:"rejected",reason:Et},Ai())}finally{Z.p=A,X.T=x}}function fC(){}function Eg(s,o,u,f){if(s.tag!==5)throw Error(n(476));var y=wE(s).queue;_E(s,y,o,ht,u===null?fC:function(){return SE(s),u(f)})}function wE(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:ht,baseState:ht,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rs,lastRenderedState:ht},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rs,lastRenderedState:u},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function SE(s){var o=wE(s).next.queue;kc(s,o,{},Ai())}function Ag(){return Vn(tu)}function RE(){return sn().memoizedState}function CE(){return sn().memoizedState}function pC(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var u=Ai();s=Fs(u);var f=Us(o,s,u);f!==null&&(bi(f,o,u),Dc(f,o,u)),o={cache:qp()},s.payload=o;return}o=o.return}}function gC(s,o,u){var f=Ai();u={lane:f,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},ad(s)?xE(o,u):(u=Vp(s,o,u,f),u!==null&&(bi(u,s,f),DE(u,o,f)))}function IE(s,o,u){var f=Ai();kc(s,o,u,f)}function kc(s,o,u,f){var y={lane:f,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(ad(s))xE(o,y);else{var A=s.alternate;if(s.lanes===0&&(A===null||A.lanes===0)&&(A=o.lastRenderedReducer,A!==null))try{var x=o.lastRenderedState,B=A(x,u);if(y.hasEagerState=!0,y.eagerState=B,gi(B,x))return zh(s,o,y,0),Ne===null&&Hh(),!1}catch{}finally{}if(u=Vp(s,o,y,f),u!==null)return bi(u,s,f),DE(u,o,f),!0}return!1}function bg(s,o,u,f){if(f={lane:2,revertLane:Zg(),action:f,hasEagerState:!1,eagerState:null,next:null},ad(s)){if(o)throw Error(n(479))}else o=Vp(s,u,f,2),o!==null&&bi(o,s,2)}function ad(s){var o=s.alternate;return s===Zt||o!==null&&o===Zt}function xE(s,o){nl=td=!0;var u=s.pending;u===null?o.next=o:(o.next=u.next,u.next=o),s.pending=o}function DE(s,o,u){if((u&4194048)!==0){var f=o.lanes;f&=s.pendingLanes,u|=f,o.lanes=u,rc(s,u)}}var od={readContext:Vn,use:nd,useCallback:Xe,useContext:Xe,useEffect:Xe,useImperativeHandle:Xe,useLayoutEffect:Xe,useInsertionEffect:Xe,useMemo:Xe,useReducer:Xe,useRef:Xe,useState:Xe,useDebugValue:Xe,useDeferredValue:Xe,useTransition:Xe,useSyncExternalStore:Xe,useId:Xe,useHostTransitionStatus:Xe,useFormState:Xe,useActionState:Xe,useOptimistic:Xe,useMemoCache:Xe,useCacheRefresh:Xe},OE={readContext:Vn,use:nd,useCallback:function(s,o){return si().memoizedState=[s,o===void 0?null:o],s},useContext:Vn,useEffect:pE,useImperativeHandle:function(s,o,u){u=u!=null?u.concat([s]):null,sd(4194308,4,vE.bind(null,o,s),u)},useLayoutEffect:function(s,o){return sd(4194308,4,s,o)},useInsertionEffect:function(s,o){sd(4,2,s,o)},useMemo:function(s,o){var u=si();o=o===void 0?null:o;var f=s();if(Ja){w(!0);try{s()}finally{w(!1)}}return u.memoizedState=[f,o],f},useReducer:function(s,o,u){var f=si();if(u!==void 0){var y=u(o);if(Ja){w(!0);try{u(o)}finally{w(!1)}}}else y=o;return f.memoizedState=f.baseState=y,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:y},f.queue=s,s=s.dispatch=gC.bind(null,Zt,s),[f.memoizedState,s]},useRef:function(s){var o=si();return s={current:s},o.memoizedState=s},useState:function(s){s=gg(s);var o=s.queue,u=IE.bind(null,Zt,o);return o.dispatch=u,[s.memoizedState,u]},useDebugValue:yg,useDeferredValue:function(s,o){var u=si();return vg(u,s,o)},useTransition:function(){var s=gg(!1);return s=_E.bind(null,Zt,s.queue,!0,!1),si().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,u){var f=Zt,y=si();if(ve){if(u===void 0)throw Error(n(407));u=u()}else{if(u=o(),Ne===null)throw Error(n(349));(de&124)!==0||J0(f,o,u)}y.memoizedState=u;var A={value:u,getSnapshot:o};return y.queue=A,pE(tE.bind(null,f,A,s),[s]),f.flags|=2048,rl(9,rd(),Z0.bind(null,f,A,u,o),null),u},useId:function(){var s=si(),o=Ne.identifierPrefix;if(ve){var u=es,f=ts;u=(f&~(1<<32-R(f)-1)).toString(32)+u,o=""+o+"R"+u,u=ed++,0<u&&(o+="H"+u.toString(32)),o+=""}else u=cC++,o=""+o+"r"+u.toString(32)+"";return s.memoizedState=o},useHostTransitionStatus:Ag,useFormState:cE,useActionState:cE,useOptimistic:function(s){var o=si();o.memoizedState=o.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=bg.bind(null,Zt,!0,u),u.dispatch=o,[s,o]},useMemoCache:dg,useCacheRefresh:function(){return si().memoizedState=pC.bind(null,Zt)}},NE={readContext:Vn,use:nd,useCallback:AE,useContext:Vn,useEffect:gE,useImperativeHandle:EE,useInsertionEffect:mE,useLayoutEffect:yE,useMemo:bE,useReducer:id,useRef:fE,useState:function(){return id(rs)},useDebugValue:yg,useDeferredValue:function(s,o){var u=sn();return TE(u,Ce.memoizedState,s,o)},useTransition:function(){var s=id(rs)[0],o=sn().memoizedState;return[typeof s=="boolean"?s:Mc(s),o]},useSyncExternalStore:Q0,useId:RE,useHostTransitionStatus:Ag,useFormState:uE,useActionState:uE,useOptimistic:function(s,o){var u=sn();return iE(u,Ce,s,o)},useMemoCache:dg,useCacheRefresh:CE},mC={readContext:Vn,use:nd,useCallback:AE,useContext:Vn,useEffect:gE,useImperativeHandle:EE,useInsertionEffect:mE,useLayoutEffect:yE,useMemo:bE,useReducer:pg,useRef:fE,useState:function(){return pg(rs)},useDebugValue:yg,useDeferredValue:function(s,o){var u=sn();return Ce===null?vg(u,s,o):TE(u,Ce.memoizedState,s,o)},useTransition:function(){var s=pg(rs)[0],o=sn().memoizedState;return[typeof s=="boolean"?s:Mc(s),o]},useSyncExternalStore:Q0,useId:RE,useHostTransitionStatus:Ag,useFormState:dE,useActionState:dE,useOptimistic:function(s,o){var u=sn();return Ce!==null?iE(u,Ce,s,o):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:dg,useCacheRefresh:CE},sl=null,Bc=0;function ld(s){var o=Bc;return Bc+=1,sl===null&&(sl=[]),z0(sl,s,o)}function Fc(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function cd(s,o){throw o.$$typeof===m?Error(n(525)):(s=Object.prototype.toString.call(o),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function PE(s){var o=s._init;return o(s._payload)}function ME(s){function o(tt,Q){if(s){var nt=tt.deletions;nt===null?(tt.deletions=[Q],tt.flags|=16):nt.push(Q)}}function u(tt,Q){if(!s)return null;for(;Q!==null;)o(tt,Q),Q=Q.sibling;return null}function f(tt){for(var Q=new Map;tt!==null;)tt.key!==null?Q.set(tt.key,tt):Q.set(tt.index,tt),tt=tt.sibling;return Q}function y(tt,Q){return tt=Zr(tt,Q),tt.index=0,tt.sibling=null,tt}function A(tt,Q,nt){return tt.index=nt,s?(nt=tt.alternate,nt!==null?(nt=nt.index,nt<Q?(tt.flags|=67108866,Q):nt):(tt.flags|=67108866,Q)):(tt.flags|=1048576,Q)}function x(tt){return s&&tt.alternate===null&&(tt.flags|=67108866),tt}function B(tt,Q,nt,vt){return Q===null||Q.tag!==6?(Q=Hp(nt,tt.mode,vt),Q.return=tt,Q):(Q=y(Q,nt),Q.return=tt,Q)}function K(tt,Q,nt,vt){var Ot=nt.type;return Ot===b?gt(tt,Q,nt.props.children,vt,nt.key):Q!==null&&(Q.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===N&&PE(Ot)===Q.type)?(Q=y(Q,nt.props),Fc(Q,nt),Q.return=tt,Q):(Q=$h(nt.type,nt.key,nt.props,null,tt.mode,vt),Fc(Q,nt),Q.return=tt,Q)}function rt(tt,Q,nt,vt){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==nt.containerInfo||Q.stateNode.implementation!==nt.implementation?(Q=zp(nt,tt.mode,vt),Q.return=tt,Q):(Q=y(Q,nt.children||[]),Q.return=tt,Q)}function gt(tt,Q,nt,vt,Ot){return Q===null||Q.tag!==7?(Q=Ga(nt,tt.mode,vt,Ot),Q.return=tt,Q):(Q=y(Q,nt),Q.return=tt,Q)}function Et(tt,Q,nt){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=Hp(""+Q,tt.mode,nt),Q.return=tt,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case v:return nt=$h(Q.type,Q.key,Q.props,null,tt.mode,nt),Fc(nt,Q),nt.return=tt,nt;case E:return Q=zp(Q,tt.mode,nt),Q.return=tt,Q;case N:var vt=Q._init;return Q=vt(Q._payload),Et(tt,Q,nt)}if(St(Q)||$(Q))return Q=Ga(Q,tt.mode,nt,null),Q.return=tt,Q;if(typeof Q.then=="function")return Et(tt,ld(Q),nt);if(Q.$$typeof===O)return Et(tt,Xh(tt,Q),nt);cd(tt,Q)}return null}function st(tt,Q,nt,vt){var Ot=Q!==null?Q.key:null;if(typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint")return Ot!==null?null:B(tt,Q,""+nt,vt);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case v:return nt.key===Ot?K(tt,Q,nt,vt):null;case E:return nt.key===Ot?rt(tt,Q,nt,vt):null;case N:return Ot=nt._init,nt=Ot(nt._payload),st(tt,Q,nt,vt)}if(St(nt)||$(nt))return Ot!==null?null:gt(tt,Q,nt,vt,null);if(typeof nt.then=="function")return st(tt,Q,ld(nt),vt);if(nt.$$typeof===O)return st(tt,Q,Xh(tt,nt),vt);cd(tt,nt)}return null}function ct(tt,Q,nt,vt,Ot){if(typeof vt=="string"&&vt!==""||typeof vt=="number"||typeof vt=="bigint")return tt=tt.get(nt)||null,B(Q,tt,""+vt,Ot);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case v:return tt=tt.get(vt.key===null?nt:vt.key)||null,K(Q,tt,vt,Ot);case E:return tt=tt.get(vt.key===null?nt:vt.key)||null,rt(Q,tt,vt,Ot);case N:var te=vt._init;return vt=te(vt._payload),ct(tt,Q,nt,vt,Ot)}if(St(vt)||$(vt))return tt=tt.get(nt)||null,gt(Q,tt,vt,Ot,null);if(typeof vt.then=="function")return ct(tt,Q,nt,ld(vt),Ot);if(vt.$$typeof===O)return ct(tt,Q,nt,Xh(Q,vt),Ot);cd(Q,vt)}return null}function zt(tt,Q,nt,vt){for(var Ot=null,te=null,Pt=Q,Ft=Q=0,_n=null;Pt!==null&&Ft<nt.length;Ft++){Pt.index>Ft?(_n=Pt,Pt=null):_n=Pt.sibling;var ge=st(tt,Pt,nt[Ft],vt);if(ge===null){Pt===null&&(Pt=_n);break}s&&Pt&&ge.alternate===null&&o(tt,Pt),Q=A(ge,Q,Ft),te===null?Ot=ge:te.sibling=ge,te=ge,Pt=_n}if(Ft===nt.length)return u(tt,Pt),ve&&Ya(tt,Ft),Ot;if(Pt===null){for(;Ft<nt.length;Ft++)Pt=Et(tt,nt[Ft],vt),Pt!==null&&(Q=A(Pt,Q,Ft),te===null?Ot=Pt:te.sibling=Pt,te=Pt);return ve&&Ya(tt,Ft),Ot}for(Pt=f(Pt);Ft<nt.length;Ft++)_n=ct(Pt,tt,Ft,nt[Ft],vt),_n!==null&&(s&&_n.alternate!==null&&Pt.delete(_n.key===null?Ft:_n.key),Q=A(_n,Q,Ft),te===null?Ot=_n:te.sibling=_n,te=_n);return s&&Pt.forEach(function(na){return o(tt,na)}),ve&&Ya(tt,Ft),Ot}function Bt(tt,Q,nt,vt){if(nt==null)throw Error(n(151));for(var Ot=null,te=null,Pt=Q,Ft=Q=0,_n=null,ge=nt.next();Pt!==null&&!ge.done;Ft++,ge=nt.next()){Pt.index>Ft?(_n=Pt,Pt=null):_n=Pt.sibling;var na=st(tt,Pt,ge.value,vt);if(na===null){Pt===null&&(Pt=_n);break}s&&Pt&&na.alternate===null&&o(tt,Pt),Q=A(na,Q,Ft),te===null?Ot=na:te.sibling=na,te=na,Pt=_n}if(ge.done)return u(tt,Pt),ve&&Ya(tt,Ft),Ot;if(Pt===null){for(;!ge.done;Ft++,ge=nt.next())ge=Et(tt,ge.value,vt),ge!==null&&(Q=A(ge,Q,Ft),te===null?Ot=ge:te.sibling=ge,te=ge);return ve&&Ya(tt,Ft),Ot}for(Pt=f(Pt);!ge.done;Ft++,ge=nt.next())ge=ct(Pt,tt,Ft,ge.value,vt),ge!==null&&(s&&ge.alternate!==null&&Pt.delete(ge.key===null?Ft:ge.key),Q=A(ge,Q,Ft),te===null?Ot=ge:te.sibling=ge,te=ge);return s&&Pt.forEach(function(yI){return o(tt,yI)}),ve&&Ya(tt,Ft),Ot}function xe(tt,Q,nt,vt){if(typeof nt=="object"&&nt!==null&&nt.type===b&&nt.key===null&&(nt=nt.props.children),typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case v:t:{for(var Ot=nt.key;Q!==null;){if(Q.key===Ot){if(Ot=nt.type,Ot===b){if(Q.tag===7){u(tt,Q.sibling),vt=y(Q,nt.props.children),vt.return=tt,tt=vt;break t}}else if(Q.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===N&&PE(Ot)===Q.type){u(tt,Q.sibling),vt=y(Q,nt.props),Fc(vt,nt),vt.return=tt,tt=vt;break t}u(tt,Q);break}else o(tt,Q);Q=Q.sibling}nt.type===b?(vt=Ga(nt.props.children,tt.mode,vt,nt.key),vt.return=tt,tt=vt):(vt=$h(nt.type,nt.key,nt.props,null,tt.mode,vt),Fc(vt,nt),vt.return=tt,tt=vt)}return x(tt);case E:t:{for(Ot=nt.key;Q!==null;){if(Q.key===Ot)if(Q.tag===4&&Q.stateNode.containerInfo===nt.containerInfo&&Q.stateNode.implementation===nt.implementation){u(tt,Q.sibling),vt=y(Q,nt.children||[]),vt.return=tt,tt=vt;break t}else{u(tt,Q);break}else o(tt,Q);Q=Q.sibling}vt=zp(nt,tt.mode,vt),vt.return=tt,tt=vt}return x(tt);case N:return Ot=nt._init,nt=Ot(nt._payload),xe(tt,Q,nt,vt)}if(St(nt))return zt(tt,Q,nt,vt);if($(nt)){if(Ot=$(nt),typeof Ot!="function")throw Error(n(150));return nt=Ot.call(nt),Bt(tt,Q,nt,vt)}if(typeof nt.then=="function")return xe(tt,Q,ld(nt),vt);if(nt.$$typeof===O)return xe(tt,Q,Xh(tt,nt),vt);cd(tt,nt)}return typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint"?(nt=""+nt,Q!==null&&Q.tag===6?(u(tt,Q.sibling),vt=y(Q,nt),vt.return=tt,tt=vt):(u(tt,Q),vt=Hp(nt,tt.mode,vt),vt.return=tt,tt=vt),x(tt)):u(tt,Q)}return function(tt,Q,nt,vt){try{Bc=0;var Ot=xe(tt,Q,nt,vt);return sl=null,Ot}catch(Pt){if(Pt===Ic||Pt===Qh)throw Pt;var te=mi(29,Pt,null,tt.mode);return te.lanes=vt,te.return=tt,te}finally{}}}var al=ME(!0),LE=ME(!1),Li=lt(null),yr=null;function js(s){var o=s.alternate;it(mn,mn.current&1),it(Li,s),yr===null&&(o===null||el.current!==null||o.memoizedState!==null)&&(yr=s)}function kE(s){if(s.tag===22){if(it(mn,mn.current),it(Li,s),yr===null){var o=s.alternate;o!==null&&o.memoizedState!==null&&(yr=s)}}else Hs()}function Hs(){it(mn,mn.current),it(Li,Li.current)}function ss(s){q(Li),yr===s&&(yr=null),q(mn)}var mn=lt(0);function ud(s){for(var o=s;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||hm(u)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function Tg(s,o,u,f){o=s.memoizedState,u=u(f,o),u=u==null?o:p({},o,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var _g={enqueueSetState:function(s,o,u){s=s._reactInternals;var f=Ai(),y=Fs(f);y.payload=o,u!=null&&(y.callback=u),o=Us(s,y,f),o!==null&&(bi(o,s,f),Dc(o,s,f))},enqueueReplaceState:function(s,o,u){s=s._reactInternals;var f=Ai(),y=Fs(f);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=Us(s,y,f),o!==null&&(bi(o,s,f),Dc(o,s,f))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var u=Ai(),f=Fs(u);f.tag=2,o!=null&&(f.callback=o),o=Us(s,f,u),o!==null&&(bi(o,s,u),Dc(o,s,u))}};function BE(s,o,u,f,y,A,x){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,A,x):o.prototype&&o.prototype.isPureReactComponent?!Ac(u,f)||!Ac(y,A):!0}function FE(s,o,u,f){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,f),o.state!==s&&_g.enqueueReplaceState(o,o.state,null)}function Za(s,o){var u=o;if("ref"in o){u={};for(var f in o)f!=="ref"&&(u[f]=o[f])}if(s=s.defaultProps){u===o&&(u=p({},u));for(var y in s)u[y]===void 0&&(u[y]=s[y])}return u}var hd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function UE(s){hd(s)}function VE(s){console.error(s)}function jE(s){hd(s)}function dd(s,o){try{var u=s.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function HE(s,o,u){try{var f=s.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function wg(s,o,u){return u=Fs(u),u.tag=3,u.payload={element:null},u.callback=function(){dd(s,o)},u}function zE(s){return s=Fs(s),s.tag=3,s}function GE(s,o,u,f){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var A=f.value;s.payload=function(){return y(A)},s.callback=function(){HE(o,u,f)}}var x=u.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(s.callback=function(){HE(o,u,f),typeof y!="function"&&(Ks===null?Ks=new Set([this]):Ks.add(this));var B=f.stack;this.componentDidCatch(f.value,{componentStack:B!==null?B:""})})}function yC(s,o,u,f,y){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=u.alternate,o!==null&&Sc(o,u,y,!0),u=Li.current,u!==null){switch(u.tag){case 13:return yr===null?Kg():u.alternate===null&&$e===0&&($e=3),u.flags&=-257,u.flags|=65536,u.lanes=y,f===Zp?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([f]):o.add(f),qg(s,f,y)),!1;case 22:return u.flags|=65536,f===Zp?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([f]):u.add(f)),qg(s,f,y)),!1}throw Error(n(435,u.tag))}return qg(s,f,y),Kg(),!1}if(ve)return o=Li.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,f!==Yp&&(s=Error(n(422),{cause:f}),wc(Oi(s,u)))):(f!==Yp&&(o=Error(n(423),{cause:f}),wc(Oi(o,u))),s=s.current.alternate,s.flags|=65536,y&=-y,s.lanes|=y,f=Oi(f,u),y=wg(s.stateNode,f,y),ng(s,y),$e!==4&&($e=2)),!1;var A=Error(n(520),{cause:f});if(A=Oi(A,u),$c===null?$c=[A]:$c.push(A),$e!==4&&($e=2),o===null)return!0;f=Oi(f,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,s=y&-y,u.lanes|=s,s=wg(u.stateNode,f,s),ng(u,s),!1;case 1:if(o=u.type,A=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Ks===null||!Ks.has(A))))return u.flags|=65536,y&=-y,u.lanes|=y,y=zE(y),GE(y,s,u,f),ng(u,y),!1}u=u.return}while(u!==null);return!1}var $E=Error(n(461)),bn=!1;function xn(s,o,u,f){o.child=s===null?LE(o,null,u,f):al(o,s.child,u,f)}function YE(s,o,u,f,y){u=u.render;var A=o.ref;if("ref"in f){var x={};for(var B in f)B!=="ref"&&(x[B]=f[B])}else x=f;return qa(o),f=og(s,o,u,x,A,y),B=lg(),s!==null&&!bn?(cg(s,o,y),as(s,o,y)):(ve&&B&&Gp(o),o.flags|=1,xn(s,o,f,y),o.child)}function WE(s,o,u,f,y){if(s===null){var A=u.type;return typeof A=="function"&&!jp(A)&&A.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=A,KE(s,o,A,f,y)):(s=$h(u.type,null,f,o,o.mode,y),s.ref=o.ref,s.return=o,o.child=s)}if(A=s.child,!Ng(s,y)){var x=A.memoizedProps;if(u=u.compare,u=u!==null?u:Ac,u(x,f)&&s.ref===o.ref)return as(s,o,y)}return o.flags|=1,s=Zr(A,f),s.ref=o.ref,s.return=o,o.child=s}function KE(s,o,u,f,y){if(s!==null){var A=s.memoizedProps;if(Ac(A,f)&&s.ref===o.ref)if(bn=!1,o.pendingProps=f=A,Ng(s,y))(s.flags&131072)!==0&&(bn=!0);else return o.lanes=s.lanes,as(s,o,y)}return Sg(s,o,u,f,y)}function XE(s,o,u){var f=o.pendingProps,y=f.children,A=s!==null?s.memoizedState:null;if(f.mode==="hidden"){if((o.flags&128)!==0){if(f=A!==null?A.baseLanes|u:u,s!==null){for(y=o.child=s.child,A=0;y!==null;)A=A|y.lanes|y.childLanes,y=y.sibling;o.childLanes=A&~f}else o.childLanes=0,o.child=null;return qE(s,o,f,u)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&qh(o,A!==null?A.cachePool:null),A!==null?K0(o,A):rg(),kE(o);else return o.lanes=o.childLanes=536870912,qE(s,o,A!==null?A.baseLanes|u:u,u)}else A!==null?(qh(o,A.cachePool),K0(o,A),Hs(),o.memoizedState=null):(s!==null&&qh(o,null),rg(),Hs());return xn(s,o,y,u),o.child}function qE(s,o,u,f){var y=Jp();return y=y===null?null:{parent:gn._currentValue,pool:y},o.memoizedState={baseLanes:u,cachePool:y},s!==null&&qh(o,null),rg(),kE(o),s!==null&&Sc(s,o,f,!0),null}function fd(s,o){var u=o.ref;if(u===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(s===null||s.ref!==u)&&(o.flags|=4194816)}}function Sg(s,o,u,f,y){return qa(o),u=og(s,o,u,f,void 0,y),f=lg(),s!==null&&!bn?(cg(s,o,y),as(s,o,y)):(ve&&f&&Gp(o),o.flags|=1,xn(s,o,u,y),o.child)}function QE(s,o,u,f,y,A){return qa(o),o.updateQueue=null,u=q0(o,f,u,y),X0(s),f=lg(),s!==null&&!bn?(cg(s,o,A),as(s,o,A)):(ve&&f&&Gp(o),o.flags|=1,xn(s,o,u,A),o.child)}function JE(s,o,u,f,y){if(qa(o),o.stateNode===null){var A=qo,x=u.contextType;typeof x=="object"&&x!==null&&(A=Vn(x)),A=new u(f,A),o.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=_g,o.stateNode=A,A._reactInternals=o,A=o.stateNode,A.props=f,A.state=o.memoizedState,A.refs={},tg(o),x=u.contextType,A.context=typeof x=="object"&&x!==null?Vn(x):qo,A.state=o.memoizedState,x=u.getDerivedStateFromProps,typeof x=="function"&&(Tg(o,u,x,f),A.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(x=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),x!==A.state&&_g.enqueueReplaceState(A,A.state,null),Nc(o,f,A,y),Oc(),A.state=o.memoizedState),typeof A.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(s===null){A=o.stateNode;var B=o.memoizedProps,K=Za(u,B);A.props=K;var rt=A.context,gt=u.contextType;x=qo,typeof gt=="object"&&gt!==null&&(x=Vn(gt));var Et=u.getDerivedStateFromProps;gt=typeof Et=="function"||typeof A.getSnapshotBeforeUpdate=="function",B=o.pendingProps!==B,gt||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(B||rt!==x)&&FE(o,A,f,x),Bs=!1;var st=o.memoizedState;A.state=st,Nc(o,f,A,y),Oc(),rt=o.memoizedState,B||st!==rt||Bs?(typeof Et=="function"&&(Tg(o,u,Et,f),rt=o.memoizedState),(K=Bs||BE(o,u,K,f,st,rt,x))?(gt||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(o.flags|=4194308)):(typeof A.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=rt),A.props=f,A.state=rt,A.context=x,f=K):(typeof A.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{A=o.stateNode,eg(s,o),x=o.memoizedProps,gt=Za(u,x),A.props=gt,Et=o.pendingProps,st=A.context,rt=u.contextType,K=qo,typeof rt=="object"&&rt!==null&&(K=Vn(rt)),B=u.getDerivedStateFromProps,(rt=typeof B=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(x!==Et||st!==K)&&FE(o,A,f,K),Bs=!1,st=o.memoizedState,A.state=st,Nc(o,f,A,y),Oc();var ct=o.memoizedState;x!==Et||st!==ct||Bs||s!==null&&s.dependencies!==null&&Kh(s.dependencies)?(typeof B=="function"&&(Tg(o,u,B,f),ct=o.memoizedState),(gt=Bs||BE(o,u,gt,f,st,ct,K)||s!==null&&s.dependencies!==null&&Kh(s.dependencies))?(rt||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(f,ct,K),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(f,ct,K)),typeof A.componentDidUpdate=="function"&&(o.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof A.componentDidUpdate!="function"||x===s.memoizedProps&&st===s.memoizedState||(o.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&st===s.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=ct),A.props=f,A.state=ct,A.context=K,f=gt):(typeof A.componentDidUpdate!="function"||x===s.memoizedProps&&st===s.memoizedState||(o.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&st===s.memoizedState||(o.flags|=1024),f=!1)}return A=f,fd(s,o),f=(o.flags&128)!==0,A||f?(A=o.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:A.render(),o.flags|=1,s!==null&&f?(o.child=al(o,s.child,null,y),o.child=al(o,null,u,y)):xn(s,o,u,y),o.memoizedState=A.state,s=o.child):s=as(s,o,y),s}function ZE(s,o,u,f){return _c(),o.flags|=256,xn(s,o,u,f),o.child}var Rg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Cg(s){return{baseLanes:s,cachePool:V0()}}function Ig(s,o,u){return s=s!==null?s.childLanes&~u:0,o&&(s|=ki),s}function tA(s,o,u){var f=o.pendingProps,y=!1,A=(o.flags&128)!==0,x;if((x=A)||(x=s!==null&&s.memoizedState===null?!1:(mn.current&2)!==0),x&&(y=!0,o.flags&=-129),x=(o.flags&32)!==0,o.flags&=-33,s===null){if(ve){if(y?js(o):Hs(),ve){var B=Ge,K;if(K=B){t:{for(K=B,B=mr;K.nodeType!==8;){if(!B){B=null;break t}if(K=Ji(K.nextSibling),K===null){B=null;break t}}B=K}B!==null?(o.memoizedState={dehydrated:B,treeContext:$a!==null?{id:ts,overflow:es}:null,retryLane:536870912,hydrationErrors:null},K=mi(18,null,null,0),K.stateNode=B,K.return=o,o.child=K,qn=o,Ge=null,K=!0):K=!1}K||Ka(o)}if(B=o.memoizedState,B!==null&&(B=B.dehydrated,B!==null))return hm(B)?o.lanes=32:o.lanes=536870912,null;ss(o)}return B=f.children,f=f.fallback,y?(Hs(),y=o.mode,B=pd({mode:"hidden",children:B},y),f=Ga(f,y,u,null),B.return=o,f.return=o,B.sibling=f,o.child=B,y=o.child,y.memoizedState=Cg(u),y.childLanes=Ig(s,x,u),o.memoizedState=Rg,f):(js(o),xg(o,B))}if(K=s.memoizedState,K!==null&&(B=K.dehydrated,B!==null)){if(A)o.flags&256?(js(o),o.flags&=-257,o=Dg(s,o,u)):o.memoizedState!==null?(Hs(),o.child=s.child,o.flags|=128,o=null):(Hs(),y=f.fallback,B=o.mode,f=pd({mode:"visible",children:f.children},B),y=Ga(y,B,u,null),y.flags|=2,f.return=o,y.return=o,f.sibling=y,o.child=f,al(o,s.child,null,u),f=o.child,f.memoizedState=Cg(u),f.childLanes=Ig(s,x,u),o.memoizedState=Rg,o=y);else if(js(o),hm(B)){if(x=B.nextSibling&&B.nextSibling.dataset,x)var rt=x.dgst;x=rt,f=Error(n(419)),f.stack="",f.digest=x,wc({value:f,source:null,stack:null}),o=Dg(s,o,u)}else if(bn||Sc(s,o,u,!1),x=(u&s.childLanes)!==0,bn||x){if(x=Ne,x!==null&&(f=u&-u,f=(f&42)!==0?1:xs(f),f=(f&(x.suspendedLanes|u))!==0?0:f,f!==0&&f!==K.retryLane))throw K.retryLane=f,Xo(s,f),bi(x,s,f),$E;B.data==="$?"||Kg(),o=Dg(s,o,u)}else B.data==="$?"?(o.flags|=192,o.child=s.child,o=null):(s=K.treeContext,Ge=Ji(B.nextSibling),qn=o,ve=!0,Wa=null,mr=!1,s!==null&&(Pi[Mi++]=ts,Pi[Mi++]=es,Pi[Mi++]=$a,ts=s.id,es=s.overflow,$a=o),o=xg(o,f.children),o.flags|=4096);return o}return y?(Hs(),y=f.fallback,B=o.mode,K=s.child,rt=K.sibling,f=Zr(K,{mode:"hidden",children:f.children}),f.subtreeFlags=K.subtreeFlags&65011712,rt!==null?y=Zr(rt,y):(y=Ga(y,B,u,null),y.flags|=2),y.return=o,f.return=o,f.sibling=y,o.child=f,f=y,y=o.child,B=s.child.memoizedState,B===null?B=Cg(u):(K=B.cachePool,K!==null?(rt=gn._currentValue,K=K.parent!==rt?{parent:rt,pool:rt}:K):K=V0(),B={baseLanes:B.baseLanes|u,cachePool:K}),y.memoizedState=B,y.childLanes=Ig(s,x,u),o.memoizedState=Rg,f):(js(o),u=s.child,s=u.sibling,u=Zr(u,{mode:"visible",children:f.children}),u.return=o,u.sibling=null,s!==null&&(x=o.deletions,x===null?(o.deletions=[s],o.flags|=16):x.push(s)),o.child=u,o.memoizedState=null,u)}function xg(s,o){return o=pd({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function pd(s,o){return s=mi(22,s,null,o),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Dg(s,o,u){return al(o,s.child,null,u),s=xg(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function eA(s,o,u){s.lanes|=o;var f=s.alternate;f!==null&&(f.lanes|=o),Kp(s.return,o,u)}function Og(s,o,u,f,y){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:y}:(A.isBackwards=o,A.rendering=null,A.renderingStartTime=0,A.last=f,A.tail=u,A.tailMode=y)}function nA(s,o,u){var f=o.pendingProps,y=f.revealOrder,A=f.tail;if(xn(s,o,f.children,u),f=mn.current,(f&2)!==0)f=f&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)t:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&eA(s,u,o);else if(s.tag===19)eA(s,u,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break t;for(;s.sibling===null;){if(s.return===null||s.return===o)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}f&=1}switch(it(mn,f),y){case"forwards":for(u=o.child,y=null;u!==null;)s=u.alternate,s!==null&&ud(s)===null&&(y=u),u=u.sibling;u=y,u===null?(y=o.child,o.child=null):(y=u.sibling,u.sibling=null),Og(o,!1,y,u,A);break;case"backwards":for(u=null,y=o.child,o.child=null;y!==null;){if(s=y.alternate,s!==null&&ud(s)===null){o.child=y;break}s=y.sibling,y.sibling=u,u=y,y=s}Og(o,!0,u,null,A);break;case"together":Og(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function as(s,o,u){if(s!==null&&(o.dependencies=s.dependencies),Ws|=o.lanes,(u&o.childLanes)===0)if(s!==null){if(Sc(s,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(n(153));if(o.child!==null){for(s=o.child,u=Zr(s,s.pendingProps),o.child=u,u.return=o;s.sibling!==null;)s=s.sibling,u=u.sibling=Zr(s,s.pendingProps),u.return=o;u.sibling=null}return o.child}function Ng(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&Kh(s)))}function vC(s,o,u){switch(o.tag){case 3:pt(o,o.stateNode.containerInfo),ks(o,gn,s.memoizedState.cache),_c();break;case 27:case 5:Vt(o);break;case 4:pt(o,o.stateNode.containerInfo);break;case 10:ks(o,o.type,o.memoizedProps.value);break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(js(o),o.flags|=128,null):(u&o.child.childLanes)!==0?tA(s,o,u):(js(o),s=as(s,o,u),s!==null?s.sibling:null);js(o);break;case 19:var y=(s.flags&128)!==0;if(f=(u&o.childLanes)!==0,f||(Sc(s,o,u,!1),f=(u&o.childLanes)!==0),y){if(f)return nA(s,o,u);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),it(mn,mn.current),f)break;return null;case 22:case 23:return o.lanes=0,XE(s,o,u);case 24:ks(o,gn,s.memoizedState.cache)}return as(s,o,u)}function iA(s,o,u){if(s!==null)if(s.memoizedProps!==o.pendingProps)bn=!0;else{if(!Ng(s,u)&&(o.flags&128)===0)return bn=!1,vC(s,o,u);bn=(s.flags&131072)!==0}else bn=!1,ve&&(o.flags&1048576)!==0&&P0(o,Wh,o.index);switch(o.lanes=0,o.tag){case 16:t:{s=o.pendingProps;var f=o.elementType,y=f._init;if(f=y(f._payload),o.type=f,typeof f=="function")jp(f)?(s=Za(f,s),o.tag=1,o=JE(null,o,f,s,u)):(o.tag=0,o=Sg(null,o,f,s,u));else{if(f!=null){if(y=f.$$typeof,y===F){o.tag=11,o=YE(null,o,f,s,u);break t}else if(y===P){o.tag=14,o=WE(null,o,f,s,u);break t}}throw o=Tt(f)||f,Error(n(306,o,""))}}return o;case 0:return Sg(s,o,o.type,o.pendingProps,u);case 1:return f=o.type,y=Za(f,o.pendingProps),JE(s,o,f,y,u);case 3:t:{if(pt(o,o.stateNode.containerInfo),s===null)throw Error(n(387));f=o.pendingProps;var A=o.memoizedState;y=A.element,eg(s,o),Nc(o,f,null,u);var x=o.memoizedState;if(f=x.cache,ks(o,gn,f),f!==A.cache&&Xp(o,[gn],u,!0),Oc(),f=x.element,A.isDehydrated)if(A={element:f,isDehydrated:!1,cache:x.cache},o.updateQueue.baseState=A,o.memoizedState=A,o.flags&256){o=ZE(s,o,f,u);break t}else if(f!==y){y=Oi(Error(n(424)),o),wc(y),o=ZE(s,o,f,u);break t}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Ge=Ji(s.firstChild),qn=o,ve=!0,Wa=null,mr=!0,u=LE(o,null,f,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(_c(),f===y){o=as(s,o,u);break t}xn(s,o,f,u)}o=o.child}return o;case 26:return fd(s,o),s===null?(u=ob(o.type,null,o.pendingProps,null))?o.memoizedState=u:ve||(u=o.type,s=o.pendingProps,f=Id(ut.current).createElement(u),f[dn]=o,f[en]=s,On(f,u,s),Ke(f),o.stateNode=f):o.memoizedState=ob(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return Vt(o),s===null&&ve&&(f=o.stateNode=rb(o.type,o.pendingProps,ut.current),qn=o,mr=!0,y=Ge,Qs(o.type)?(dm=y,Ge=Ji(f.firstChild)):Ge=y),xn(s,o,o.pendingProps.children,u),fd(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&ve&&((y=f=Ge)&&(f=YC(f,o.type,o.pendingProps,mr),f!==null?(o.stateNode=f,qn=o,Ge=Ji(f.firstChild),mr=!1,y=!0):y=!1),y||Ka(o)),Vt(o),y=o.type,A=o.pendingProps,x=s!==null?s.memoizedProps:null,f=A.children,lm(y,A)?f=null:x!==null&&lm(y,x)&&(o.flags|=32),o.memoizedState!==null&&(y=og(s,o,uC,null,null,u),tu._currentValue=y),fd(s,o),xn(s,o,f,u),o.child;case 6:return s===null&&ve&&((s=u=Ge)&&(u=WC(u,o.pendingProps,mr),u!==null?(o.stateNode=u,qn=o,Ge=null,s=!0):s=!1),s||Ka(o)),null;case 13:return tA(s,o,u);case 4:return pt(o,o.stateNode.containerInfo),f=o.pendingProps,s===null?o.child=al(o,null,f,u):xn(s,o,f,u),o.child;case 11:return YE(s,o,o.type,o.pendingProps,u);case 7:return xn(s,o,o.pendingProps,u),o.child;case 8:return xn(s,o,o.pendingProps.children,u),o.child;case 12:return xn(s,o,o.pendingProps.children,u),o.child;case 10:return f=o.pendingProps,ks(o,o.type,f.value),xn(s,o,f.children,u),o.child;case 9:return y=o.type._context,f=o.pendingProps.children,qa(o),y=Vn(y),f=f(y),o.flags|=1,xn(s,o,f,u),o.child;case 14:return WE(s,o,o.type,o.pendingProps,u);case 15:return KE(s,o,o.type,o.pendingProps,u);case 19:return nA(s,o,u);case 31:return f=o.pendingProps,u=o.mode,f={mode:f.mode,children:f.children},s===null?(u=pd(f,u),u.ref=o.ref,o.child=u,u.return=o,o=u):(u=Zr(s.child,f),u.ref=o.ref,o.child=u,u.return=o,o=u),o;case 22:return XE(s,o,u);case 24:return qa(o),f=Vn(gn),s===null?(y=Jp(),y===null&&(y=Ne,A=qp(),y.pooledCache=A,A.refCount++,A!==null&&(y.pooledCacheLanes|=u),y=A),o.memoizedState={parent:f,cache:y},tg(o),ks(o,gn,y)):((s.lanes&u)!==0&&(eg(s,o),Nc(o,null,null,u),Oc()),y=s.memoizedState,A=o.memoizedState,y.parent!==f?(y={parent:f,cache:f},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),ks(o,gn,f)):(f=A.cache,ks(o,gn,f),f!==y.cache&&Xp(o,[gn],u,!0))),xn(s,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function os(s){s.flags|=4}function rA(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!db(o)){if(o=Li.current,o!==null&&((de&4194048)===de?yr!==null:(de&62914560)!==de&&(de&536870912)===0||o!==yr))throw xc=Zp,j0;s.flags|=8192}}function gd(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?nc():536870912,s.lanes|=o,ul|=o)}function Uc(s,o){if(!ve)switch(s.tailMode){case"hidden":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function Ve(s){var o=s.alternate!==null&&s.alternate.child===s.child,u=0,f=0;if(o)for(var y=s.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags&65011712,f|=y.flags&65011712,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=f,s.childLanes=u,o}function EC(s,o,u){var f=o.pendingProps;switch($p(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ve(o),null;case 1:return Ve(o),null;case 3:return u=o.stateNode,f=null,s!==null&&(f=s.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),is(gn),Ct(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(Tc(o)?os(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,k0())),Ve(o),null;case 26:return u=o.memoizedState,s===null?(os(o),u!==null?(Ve(o),rA(o,u)):(Ve(o),o.flags&=-16777217)):u?u!==s.memoizedState?(os(o),Ve(o),rA(o,u)):(Ve(o),o.flags&=-16777217):(s.memoizedProps!==f&&os(o),Ve(o),o.flags&=-16777217),null;case 27:It(o),u=ut.current;var y=o.type;if(s!==null&&o.stateNode!=null)s.memoizedProps!==f&&os(o);else{if(!f){if(o.stateNode===null)throw Error(n(166));return Ve(o),null}s=yt.current,Tc(o)?M0(o):(s=rb(y,f,u),o.stateNode=s,os(o))}return Ve(o),null;case 5:if(It(o),u=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==f&&os(o);else{if(!f){if(o.stateNode===null)throw Error(n(166));return Ve(o),null}if(s=yt.current,Tc(o))M0(o);else{switch(y=Id(ut.current),s){case 1:s=y.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:s=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":s=y.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":s=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":s=y.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof f.is=="string"?y.createElement("select",{is:f.is}):y.createElement("select"),f.multiple?s.multiple=!0:f.size&&(s.size=f.size);break;default:s=typeof f.is=="string"?y.createElement(u,{is:f.is}):y.createElement(u)}}s[dn]=o,s[en]=f;t:for(y=o.child;y!==null;){if(y.tag===5||y.tag===6)s.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===o)break t;for(;y.sibling===null;){if(y.return===null||y.return===o)break t;y=y.return}y.sibling.return=y.return,y=y.sibling}o.stateNode=s;t:switch(On(s,u,f),u){case"button":case"input":case"select":case"textarea":s=!!f.autoFocus;break t;case"img":s=!0;break t;default:s=!1}s&&os(o)}}return Ve(o),o.flags&=-16777217,null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==f&&os(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(n(166));if(s=ut.current,Tc(o)){if(s=o.stateNode,u=o.memoizedProps,f=null,y=qn,y!==null)switch(y.tag){case 27:case 5:f=y.memoizedProps}s[dn]=o,s=!!(s.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||QA(s.nodeValue,u)),s||Ka(o)}else s=Id(s).createTextNode(f),s[dn]=o,o.stateNode=s}return Ve(o),null;case 13:if(f=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(y=Tc(o),f!==null&&f.dehydrated!==null){if(s===null){if(!y)throw Error(n(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(n(317));y[dn]=o}else _c(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ve(o),y=!1}else y=k0(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=y),y=!0;if(!y)return o.flags&256?(ss(o),o):(ss(o),null)}if(ss(o),(o.flags&128)!==0)return o.lanes=u,o;if(u=f!==null,s=s!==null&&s.memoizedState!==null,u){f=o.child,y=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(y=f.alternate.memoizedState.cachePool.pool);var A=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(A=f.memoizedState.cachePool.pool),A!==y&&(f.flags|=2048)}return u!==s&&u&&(o.child.flags|=8192),gd(o,o.updateQueue),Ve(o),null;case 4:return Ct(),s===null&&im(o.stateNode.containerInfo),Ve(o),null;case 10:return is(o.type),Ve(o),null;case 19:if(q(mn),y=o.memoizedState,y===null)return Ve(o),null;if(f=(o.flags&128)!==0,A=y.rendering,A===null)if(f)Uc(y,!1);else{if($e!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(A=ud(s),A!==null){for(o.flags|=128,Uc(y,!1),s=A.updateQueue,o.updateQueue=s,gd(o,s),o.subtreeFlags=0,s=u,u=o.child;u!==null;)N0(u,s),u=u.sibling;return it(mn,mn.current&1|2),o.child}s=s.sibling}y.tail!==null&&_e()>vd&&(o.flags|=128,f=!0,Uc(y,!1),o.lanes=4194304)}else{if(!f)if(s=ud(A),s!==null){if(o.flags|=128,f=!0,s=s.updateQueue,o.updateQueue=s,gd(o,s),Uc(y,!0),y.tail===null&&y.tailMode==="hidden"&&!A.alternate&&!ve)return Ve(o),null}else 2*_e()-y.renderingStartTime>vd&&u!==536870912&&(o.flags|=128,f=!0,Uc(y,!1),o.lanes=4194304);y.isBackwards?(A.sibling=o.child,o.child=A):(s=y.last,s!==null?s.sibling=A:o.child=A,y.last=A)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=_e(),o.sibling=null,s=mn.current,it(mn,f?s&1|2:s&1),o):(Ve(o),null);case 22:case 23:return ss(o),sg(),f=o.memoizedState!==null,s!==null?s.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(u&536870912)!==0&&(o.flags&128)===0&&(Ve(o),o.subtreeFlags&6&&(o.flags|=8192)):Ve(o),u=o.updateQueue,u!==null&&gd(o,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==u&&(o.flags|=2048),s!==null&&q(Qa),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),is(gn),Ve(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function AC(s,o){switch($p(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return is(gn),Ct(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return It(o),null;case 13:if(ss(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(n(340));_c()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return q(mn),null;case 4:return Ct(),null;case 10:return is(o.type),null;case 22:case 23:return ss(o),sg(),s!==null&&q(Qa),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return is(gn),null;case 25:return null;default:return null}}function sA(s,o){switch($p(o),o.tag){case 3:is(gn),Ct();break;case 26:case 27:case 5:It(o);break;case 4:Ct();break;case 13:ss(o);break;case 19:q(mn);break;case 10:is(o.type);break;case 22:case 23:ss(o),sg(),s!==null&&q(Qa);break;case 24:is(gn)}}function Vc(s,o){try{var u=o.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var y=f.next;u=y;do{if((u.tag&s)===s){f=void 0;var A=u.create,x=u.inst;f=A(),x.destroy=f}u=u.next}while(u!==y)}}catch(B){Oe(o,o.return,B)}}function zs(s,o,u){try{var f=o.updateQueue,y=f!==null?f.lastEffect:null;if(y!==null){var A=y.next;f=A;do{if((f.tag&s)===s){var x=f.inst,B=x.destroy;if(B!==void 0){x.destroy=void 0,y=o;var K=u,rt=B;try{rt()}catch(gt){Oe(y,K,gt)}}}f=f.next}while(f!==A)}}catch(gt){Oe(o,o.return,gt)}}function aA(s){var o=s.updateQueue;if(o!==null){var u=s.stateNode;try{W0(o,u)}catch(f){Oe(s,s.return,f)}}}function oA(s,o,u){u.props=Za(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(f){Oe(s,o,f)}}function jc(s,o){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var f=s.stateNode;break;case 30:f=s.stateNode;break;default:f=s.stateNode}typeof u=="function"?s.refCleanup=u(f):u.current=f}}catch(y){Oe(s,o,y)}}function vr(s,o){var u=s.ref,f=s.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(y){Oe(s,o,y)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){Oe(s,o,y)}else u.current=null}function lA(s){var o=s.type,u=s.memoizedProps,f=s.stateNode;try{t:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break t;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(y){Oe(s,s.return,y)}}function Pg(s,o,u){try{var f=s.stateNode;jC(f,s.type,u,o),f[en]=o}catch(y){Oe(s,s.return,y)}}function cA(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Qs(s.type)||s.tag===4}function Mg(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||cA(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Qs(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Lg(s,o,u){var f=s.tag;if(f===5||f===6)s=s.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(s),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Cd));else if(f!==4&&(f===27&&Qs(s.type)&&(u=s.stateNode,o=null),s=s.child,s!==null))for(Lg(s,o,u),s=s.sibling;s!==null;)Lg(s,o,u),s=s.sibling}function md(s,o,u){var f=s.tag;if(f===5||f===6)s=s.stateNode,o?u.insertBefore(s,o):u.appendChild(s);else if(f!==4&&(f===27&&Qs(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(md(s,o,u),s=s.sibling;s!==null;)md(s,o,u),s=s.sibling}function uA(s){var o=s.stateNode,u=s.memoizedProps;try{for(var f=s.type,y=o.attributes;y.length;)o.removeAttributeNode(y[0]);On(o,f,u),o[dn]=s,o[en]=u}catch(A){Oe(s,s.return,A)}}var ls=!1,qe=!1,kg=!1,hA=typeof WeakSet=="function"?WeakSet:Set,Tn=null;function bC(s,o){if(s=s.containerInfo,am=Md,s=T0(s),Mp(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else t:{u=(u=s.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var y=f.anchorOffset,A=f.focusNode;f=f.focusOffset;try{u.nodeType,A.nodeType}catch{u=null;break t}var x=0,B=-1,K=-1,rt=0,gt=0,Et=s,st=null;e:for(;;){for(var ct;Et!==u||y!==0&&Et.nodeType!==3||(B=x+y),Et!==A||f!==0&&Et.nodeType!==3||(K=x+f),Et.nodeType===3&&(x+=Et.nodeValue.length),(ct=Et.firstChild)!==null;)st=Et,Et=ct;for(;;){if(Et===s)break e;if(st===u&&++rt===y&&(B=x),st===A&&++gt===f&&(K=x),(ct=Et.nextSibling)!==null)break;Et=st,st=Et.parentNode}Et=ct}u=B===-1||K===-1?null:{start:B,end:K}}else u=null}u=u||{start:0,end:0}}else u=null;for(om={focusedElem:s,selectionRange:u},Md=!1,Tn=o;Tn!==null;)if(o=Tn,s=o.child,(o.subtreeFlags&1024)!==0&&s!==null)s.return=o,Tn=s;else for(;Tn!==null;){switch(o=Tn,A=o.alternate,s=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&A!==null){s=void 0,u=o,y=A.memoizedProps,A=A.memoizedState,f=u.stateNode;try{var zt=Za(u.type,y,u.elementType===u.type);s=f.getSnapshotBeforeUpdate(zt,A),f.__reactInternalSnapshotBeforeUpdate=s}catch(Bt){Oe(u,u.return,Bt)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,u=s.nodeType,u===9)um(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":um(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=o.sibling,s!==null){s.return=o.return,Tn=s;break}Tn=o.return}}function dA(s,o,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:Gs(s,u),f&4&&Vc(5,u);break;case 1:if(Gs(s,u),f&4)if(s=u.stateNode,o===null)try{s.componentDidMount()}catch(x){Oe(u,u.return,x)}else{var y=Za(u.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(y,o,s.__reactInternalSnapshotBeforeUpdate)}catch(x){Oe(u,u.return,x)}}f&64&&aA(u),f&512&&jc(u,u.return);break;case 3:if(Gs(s,u),f&64&&(s=u.updateQueue,s!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{W0(s,o)}catch(x){Oe(u,u.return,x)}}break;case 27:o===null&&f&4&&uA(u);case 26:case 5:Gs(s,u),o===null&&f&4&&lA(u),f&512&&jc(u,u.return);break;case 12:Gs(s,u);break;case 13:Gs(s,u),f&4&&gA(s,u),f&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=DC.bind(null,u),KC(s,u))));break;case 22:if(f=u.memoizedState!==null||ls,!f){o=o!==null&&o.memoizedState!==null||qe,y=ls;var A=qe;ls=f,(qe=o)&&!A?$s(s,u,(u.subtreeFlags&8772)!==0):Gs(s,u),ls=y,qe=A}break;case 30:break;default:Gs(s,u)}}function fA(s){var o=s.alternate;o!==null&&(s.alternate=null,fA(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&Ns(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ke=null,ai=!1;function cs(s,o,u){for(u=u.child;u!==null;)pA(s,o,u),u=u.sibling}function pA(s,o,u){if(L&&typeof L.onCommitFiberUnmount=="function")try{L.onCommitFiberUnmount(Me,u)}catch{}switch(u.tag){case 26:qe||vr(u,o),cs(s,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:qe||vr(u,o);var f=ke,y=ai;Qs(u.type)&&(ke=u.stateNode,ai=!1),cs(s,o,u),qc(u.stateNode),ke=f,ai=y;break;case 5:qe||vr(u,o);case 6:if(f=ke,y=ai,ke=null,cs(s,o,u),ke=f,ai=y,ke!==null)if(ai)try{(ke.nodeType===9?ke.body:ke.nodeName==="HTML"?ke.ownerDocument.body:ke).removeChild(u.stateNode)}catch(A){Oe(u,o,A)}else try{ke.removeChild(u.stateNode)}catch(A){Oe(u,o,A)}break;case 18:ke!==null&&(ai?(s=ke,nb(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),ru(s)):nb(ke,u.stateNode));break;case 4:f=ke,y=ai,ke=u.stateNode.containerInfo,ai=!0,cs(s,o,u),ke=f,ai=y;break;case 0:case 11:case 14:case 15:qe||zs(2,u,o),qe||zs(4,u,o),cs(s,o,u);break;case 1:qe||(vr(u,o),f=u.stateNode,typeof f.componentWillUnmount=="function"&&oA(u,o,f)),cs(s,o,u);break;case 21:cs(s,o,u);break;case 22:qe=(f=qe)||u.memoizedState!==null,cs(s,o,u),qe=f;break;default:cs(s,o,u)}}function gA(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{ru(s)}catch(u){Oe(o,o.return,u)}}function TC(s){switch(s.tag){case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new hA),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new hA),o;default:throw Error(n(435,s.tag))}}function Bg(s,o){var u=TC(s);o.forEach(function(f){var y=OC.bind(null,s,f);u.has(f)||(u.add(f),f.then(y,y))})}function yi(s,o){var u=o.deletions;if(u!==null)for(var f=0;f<u.length;f++){var y=u[f],A=s,x=o,B=x;t:for(;B!==null;){switch(B.tag){case 27:if(Qs(B.type)){ke=B.stateNode,ai=!1;break t}break;case 5:ke=B.stateNode,ai=!1;break t;case 3:case 4:ke=B.stateNode.containerInfo,ai=!0;break t}B=B.return}if(ke===null)throw Error(n(160));pA(A,x,y),ke=null,ai=!1,A=y.alternate,A!==null&&(A.return=null),y.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)mA(o,s),o=o.sibling}var Qi=null;function mA(s,o){var u=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:yi(o,s),vi(s),f&4&&(zs(3,s,s.return),Vc(3,s),zs(5,s,s.return));break;case 1:yi(o,s),vi(s),f&512&&(qe||u===null||vr(u,u.return)),f&64&&ls&&(s=s.updateQueue,s!==null&&(f=s.callbacks,f!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var y=Qi;if(yi(o,s),vi(s),f&512&&(qe||u===null||vr(u,u.return)),f&4){var A=u!==null?u.memoizedState:null;if(f=s.memoizedState,u===null)if(f===null)if(s.stateNode===null){t:{f=s.type,u=s.memoizedProps,y=y.ownerDocument||y;e:switch(f){case"title":A=y.getElementsByTagName("title")[0],(!A||A[Ia]||A[dn]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=y.createElement(f),y.head.insertBefore(A,y.querySelector("head > title"))),On(A,f,u),A[dn]=s,Ke(A),f=A;break t;case"link":var x=ub("link","href",y).get(f+(u.href||""));if(x){for(var B=0;B<x.length;B++)if(A=x[B],A.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&A.getAttribute("rel")===(u.rel==null?null:u.rel)&&A.getAttribute("title")===(u.title==null?null:u.title)&&A.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){x.splice(B,1);break e}}A=y.createElement(f),On(A,f,u),y.head.appendChild(A);break;case"meta":if(x=ub("meta","content",y).get(f+(u.content||""))){for(B=0;B<x.length;B++)if(A=x[B],A.getAttribute("content")===(u.content==null?null:""+u.content)&&A.getAttribute("name")===(u.name==null?null:u.name)&&A.getAttribute("property")===(u.property==null?null:u.property)&&A.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&A.getAttribute("charset")===(u.charSet==null?null:u.charSet)){x.splice(B,1);break e}}A=y.createElement(f),On(A,f,u),y.head.appendChild(A);break;default:throw Error(n(468,f))}A[dn]=s,Ke(A),f=A}s.stateNode=f}else hb(y,s.type,s.stateNode);else s.stateNode=cb(y,f,s.memoizedProps);else A!==f?(A===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):A.count--,f===null?hb(y,s.type,s.stateNode):cb(y,f,s.memoizedProps)):f===null&&s.stateNode!==null&&Pg(s,s.memoizedProps,u.memoizedProps)}break;case 27:yi(o,s),vi(s),f&512&&(qe||u===null||vr(u,u.return)),u!==null&&f&4&&Pg(s,s.memoizedProps,u.memoizedProps);break;case 5:if(yi(o,s),vi(s),f&512&&(qe||u===null||vr(u,u.return)),s.flags&32){y=s.stateNode;try{Ci(y,"")}catch(ct){Oe(s,s.return,ct)}}f&4&&s.stateNode!=null&&(y=s.memoizedProps,Pg(s,y,u!==null?u.memoizedProps:y)),f&1024&&(kg=!0);break;case 6:if(yi(o,s),vi(s),f&4){if(s.stateNode===null)throw Error(n(162));f=s.memoizedProps,u=s.stateNode;try{u.nodeValue=f}catch(ct){Oe(s,s.return,ct)}}break;case 3:if(Od=null,y=Qi,Qi=xd(o.containerInfo),yi(o,s),Qi=y,vi(s),f&4&&u!==null&&u.memoizedState.isDehydrated)try{ru(o.containerInfo)}catch(ct){Oe(s,s.return,ct)}kg&&(kg=!1,yA(s));break;case 4:f=Qi,Qi=xd(s.stateNode.containerInfo),yi(o,s),vi(s),Qi=f;break;case 12:yi(o,s),vi(s);break;case 13:yi(o,s),vi(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(zg=_e()),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,Bg(s,f)));break;case 22:y=s.memoizedState!==null;var K=u!==null&&u.memoizedState!==null,rt=ls,gt=qe;if(ls=rt||y,qe=gt||K,yi(o,s),qe=gt,ls=rt,vi(s),f&8192)t:for(o=s.stateNode,o._visibility=y?o._visibility&-2:o._visibility|1,y&&(u===null||K||ls||qe||to(s)),u=null,o=s;;){if(o.tag===5||o.tag===26){if(u===null){K=u=o;try{if(A=K.stateNode,y)x=A.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{B=K.stateNode;var Et=K.memoizedProps.style,st=Et!=null&&Et.hasOwnProperty("display")?Et.display:null;B.style.display=st==null||typeof st=="boolean"?"":(""+st).trim()}}catch(ct){Oe(K,K.return,ct)}}}else if(o.tag===6){if(u===null){K=o;try{K.stateNode.nodeValue=y?"":K.memoizedProps}catch(ct){Oe(K,K.return,ct)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break t;for(;o.sibling===null;){if(o.return===null||o.return===s)break t;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=s.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,Bg(s,u))));break;case 19:yi(o,s),vi(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,Bg(s,f)));break;case 30:break;case 21:break;default:yi(o,s),vi(s)}}function vi(s){var o=s.flags;if(o&2){try{for(var u,f=s.return;f!==null;){if(cA(f)){u=f;break}f=f.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var y=u.stateNode,A=Mg(s);md(s,A,y);break;case 5:var x=u.stateNode;u.flags&32&&(Ci(x,""),u.flags&=-33);var B=Mg(s);md(s,B,x);break;case 3:case 4:var K=u.stateNode.containerInfo,rt=Mg(s);Lg(s,rt,K);break;default:throw Error(n(161))}}catch(gt){Oe(s,s.return,gt)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function yA(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;yA(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Gs(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)dA(s,o.alternate,o),o=o.sibling}function to(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:zs(4,o,o.return),to(o);break;case 1:vr(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&oA(o,o.return,u),to(o);break;case 27:qc(o.stateNode);case 26:case 5:vr(o,o.return),to(o);break;case 22:o.memoizedState===null&&to(o);break;case 30:to(o);break;default:to(o)}s=s.sibling}}function $s(s,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,y=s,A=o,x=A.flags;switch(A.tag){case 0:case 11:case 15:$s(y,A,u),Vc(4,A);break;case 1:if($s(y,A,u),f=A,y=f.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(rt){Oe(f,f.return,rt)}if(f=A,y=f.updateQueue,y!==null){var B=f.stateNode;try{var K=y.shared.hiddenCallbacks;if(K!==null)for(y.shared.hiddenCallbacks=null,y=0;y<K.length;y++)Y0(K[y],B)}catch(rt){Oe(f,f.return,rt)}}u&&x&64&&aA(A),jc(A,A.return);break;case 27:uA(A);case 26:case 5:$s(y,A,u),u&&f===null&&x&4&&lA(A),jc(A,A.return);break;case 12:$s(y,A,u);break;case 13:$s(y,A,u),u&&x&4&&gA(y,A);break;case 22:A.memoizedState===null&&$s(y,A,u),jc(A,A.return);break;case 30:break;default:$s(y,A,u)}o=o.sibling}}function Fg(s,o){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&Rc(u))}function Ug(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Rc(s))}function Er(s,o,u,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)vA(s,o,u,f),o=o.sibling}function vA(s,o,u,f){var y=o.flags;switch(o.tag){case 0:case 11:case 15:Er(s,o,u,f),y&2048&&Vc(9,o);break;case 1:Er(s,o,u,f);break;case 3:Er(s,o,u,f),y&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Rc(s)));break;case 12:if(y&2048){Er(s,o,u,f),s=o.stateNode;try{var A=o.memoizedProps,x=A.id,B=A.onPostCommit;typeof B=="function"&&B(x,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(K){Oe(o,o.return,K)}}else Er(s,o,u,f);break;case 13:Er(s,o,u,f);break;case 23:break;case 22:A=o.stateNode,x=o.alternate,o.memoizedState!==null?A._visibility&2?Er(s,o,u,f):Hc(s,o):A._visibility&2?Er(s,o,u,f):(A._visibility|=2,ol(s,o,u,f,(o.subtreeFlags&10256)!==0)),y&2048&&Fg(x,o);break;case 24:Er(s,o,u,f),y&2048&&Ug(o.alternate,o);break;default:Er(s,o,u,f)}}function ol(s,o,u,f,y){for(y=y&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var A=s,x=o,B=u,K=f,rt=x.flags;switch(x.tag){case 0:case 11:case 15:ol(A,x,B,K,y),Vc(8,x);break;case 23:break;case 22:var gt=x.stateNode;x.memoizedState!==null?gt._visibility&2?ol(A,x,B,K,y):Hc(A,x):(gt._visibility|=2,ol(A,x,B,K,y)),y&&rt&2048&&Fg(x.alternate,x);break;case 24:ol(A,x,B,K,y),y&&rt&2048&&Ug(x.alternate,x);break;default:ol(A,x,B,K,y)}o=o.sibling}}function Hc(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=s,f=o,y=f.flags;switch(f.tag){case 22:Hc(u,f),y&2048&&Fg(f.alternate,f);break;case 24:Hc(u,f),y&2048&&Ug(f.alternate,f);break;default:Hc(u,f)}o=o.sibling}}var zc=8192;function ll(s){if(s.subtreeFlags&zc)for(s=s.child;s!==null;)EA(s),s=s.sibling}function EA(s){switch(s.tag){case 26:ll(s),s.flags&zc&&s.memoizedState!==null&&oI(Qi,s.memoizedState,s.memoizedProps);break;case 5:ll(s);break;case 3:case 4:var o=Qi;Qi=xd(s.stateNode.containerInfo),ll(s),Qi=o;break;case 22:s.memoizedState===null&&(o=s.alternate,o!==null&&o.memoizedState!==null?(o=zc,zc=16777216,ll(s),zc=o):ll(s));break;default:ll(s)}}function AA(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function Gc(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];Tn=f,TA(f,s)}AA(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)bA(s),s=s.sibling}function bA(s){switch(s.tag){case 0:case 11:case 15:Gc(s),s.flags&2048&&zs(9,s,s.return);break;case 3:Gc(s);break;case 12:Gc(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,yd(s)):Gc(s);break;default:Gc(s)}}function yd(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];Tn=f,TA(f,s)}AA(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:zs(8,o,o.return),yd(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,yd(o));break;default:yd(o)}s=s.sibling}}function TA(s,o){for(;Tn!==null;){var u=Tn;switch(u.tag){case 0:case 11:case 15:zs(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Rc(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,Tn=f;else t:for(u=s;Tn!==null;){f=Tn;var y=f.sibling,A=f.return;if(fA(f),f===u){Tn=null;break t}if(y!==null){y.return=A,Tn=y;break t}Tn=A}}}var _C={getCacheForType:function(s){var o=Vn(gn),u=o.data.get(s);return u===void 0&&(u=s(),o.data.set(s,u)),u}},wC=typeof WeakMap=="function"?WeakMap:Map,we=0,Ne=null,ie=null,de=0,Se=0,Ei=null,Ys=!1,cl=!1,Vg=!1,us=0,$e=0,Ws=0,eo=0,jg=0,ki=0,ul=0,$c=null,oi=null,Hg=!1,zg=0,vd=1/0,Ed=null,Ks=null,Dn=0,Xs=null,hl=null,dl=0,Gg=0,$g=null,_A=null,Yc=0,Yg=null;function Ai(){if((we&2)!==0&&de!==0)return de&-de;if(X.T!==null){var s=Zo;return s!==0?s:Zg()}return Ds()}function wA(){ki===0&&(ki=(de&536870912)===0||ve?ec():536870912);var s=Li.current;return s!==null&&(s.flags|=32),ki}function bi(s,o,u){(s===Ne&&(Se===2||Se===9)||s.cancelPendingCommit!==null)&&(fl(s,0),qs(s,de,ki,!1)),Hr(s,u),((we&2)===0||s!==Ne)&&(s===Ne&&((we&2)===0&&(eo|=u),$e===4&&qs(s,de,ki,!1)),Ar(s))}function SA(s,o,u){if((we&6)!==0)throw Error(n(327));var f=!u&&(o&124)===0&&(o&s.expiredLanes)===0||Ee(s,o),y=f?CC(s,o):Xg(s,o,!0),A=f;do{if(y===0){cl&&!f&&qs(s,o,0,!1);break}else{if(u=s.current.alternate,A&&!SC(u)){y=Xg(s,o,!1),A=!1;continue}if(y===2){if(A=o,s.errorRecoveryDisabledLanes&A)var x=0;else x=s.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){o=x;t:{var B=s;y=$c;var K=B.current.memoizedState.isDehydrated;if(K&&(fl(B,x).flags|=256),x=Xg(B,x,!1),x!==2){if(Vg&&!K){B.errorRecoveryDisabledLanes|=A,eo|=A,y=4;break t}A=oi,oi=y,A!==null&&(oi===null?oi=A:oi.push.apply(oi,A))}y=x}if(A=!1,y!==2)continue}}if(y===1){fl(s,0),qs(s,o,0,!0);break}t:{switch(f=s,A=y,A){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:qs(f,o,ki,!Ys);break t;case 2:oi=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(y=zg+300-_e(),10<y)){if(qs(f,o,ki,!Ys),ye(f,0,!0)!==0)break t;f.timeoutHandle=tb(RA.bind(null,f,u,oi,Ed,Hg,o,ki,eo,ul,Ys,A,2,-0,0),y);break t}RA(f,u,oi,Ed,Hg,o,ki,eo,ul,Ys,A,0,-0,0)}}break}while(!0);Ar(s)}function RA(s,o,u,f,y,A,x,B,K,rt,gt,Et,st,ct){if(s.timeoutHandle=-1,Et=o.subtreeFlags,(Et&8192||(Et&16785408)===16785408)&&(Zc={stylesheets:null,count:0,unsuspend:aI},EA(o),Et=lI(),Et!==null)){s.cancelPendingCommit=Et(PA.bind(null,s,o,A,u,f,y,x,B,K,gt,1,st,ct)),qs(s,A,x,!rt);return}PA(s,o,A,u,f,y,x,B,K)}function SC(s){for(var o=s;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var y=u[f],A=y.getSnapshot;y=y.value;try{if(!gi(A(),y))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function qs(s,o,u,f){o&=~jg,o&=~eo,s.suspendedLanes|=o,s.pingedLanes&=~o,f&&(s.warmLanes|=o),f=s.expirationTimes;for(var y=o;0<y;){var A=31-R(y),x=1<<A;f[A]=-1,y&=~x}u!==0&&sr(s,u,o)}function Ad(){return(we&6)===0?(Wc(0),!1):!0}function Wg(){if(ie!==null){if(Se===0)var s=ie.return;else s=ie,ns=Xa=null,ug(s),sl=null,Bc=0,s=ie;for(;s!==null;)sA(s.alternate,s),s=s.return;ie=null}}function fl(s,o){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,zC(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),Wg(),Ne=s,ie=u=Zr(s.current,null),de=o,Se=0,Ei=null,Ys=!1,cl=Ee(s,o),Vg=!1,ul=ki=jg=eo=Ws=$e=0,oi=$c=null,Hg=!1,(o&8)!==0&&(o|=o&32);var f=s.entangledLanes;if(f!==0)for(s=s.entanglements,f&=o;0<f;){var y=31-R(f),A=1<<y;o|=s[y],f&=~A}return us=o,Hh(),u}function CA(s,o){Zt=null,X.H=od,o===Ic||o===Qh?(o=G0(),Se=3):o===j0?(o=G0(),Se=4):Se=o===$E?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Ei=o,ie===null&&($e=1,dd(s,Oi(o,s.current)))}function IA(){var s=X.H;return X.H=od,s===null?od:s}function xA(){var s=X.A;return X.A=_C,s}function Kg(){$e=4,Ys||(de&4194048)!==de&&Li.current!==null||(cl=!0),(Ws&134217727)===0&&(eo&134217727)===0||Ne===null||qs(Ne,de,ki,!1)}function Xg(s,o,u){var f=we;we|=2;var y=IA(),A=xA();(Ne!==s||de!==o)&&(Ed=null,fl(s,o)),o=!1;var x=$e;t:do try{if(Se!==0&&ie!==null){var B=ie,K=Ei;switch(Se){case 8:Wg(),x=6;break t;case 3:case 2:case 9:case 6:Li.current===null&&(o=!0);var rt=Se;if(Se=0,Ei=null,pl(s,B,K,rt),u&&cl){x=0;break t}break;default:rt=Se,Se=0,Ei=null,pl(s,B,K,rt)}}RC(),x=$e;break}catch(gt){CA(s,gt)}while(!0);return o&&s.shellSuspendCounter++,ns=Xa=null,we=f,X.H=y,X.A=A,ie===null&&(Ne=null,de=0,Hh()),x}function RC(){for(;ie!==null;)DA(ie)}function CC(s,o){var u=we;we|=2;var f=IA(),y=xA();Ne!==s||de!==o?(Ed=null,vd=_e()+500,fl(s,o)):cl=Ee(s,o);t:do try{if(Se!==0&&ie!==null){o=ie;var A=Ei;e:switch(Se){case 1:Se=0,Ei=null,pl(s,o,A,1);break;case 2:case 9:if(H0(A)){Se=0,Ei=null,OA(o);break}o=function(){Se!==2&&Se!==9||Ne!==s||(Se=7),Ar(s)},A.then(o,o);break t;case 3:Se=7;break t;case 4:Se=5;break t;case 7:H0(A)?(Se=0,Ei=null,OA(o)):(Se=0,Ei=null,pl(s,o,A,7));break;case 5:var x=null;switch(ie.tag){case 26:x=ie.memoizedState;case 5:case 27:var B=ie;if(!x||db(x)){Se=0,Ei=null;var K=B.sibling;if(K!==null)ie=K;else{var rt=B.return;rt!==null?(ie=rt,bd(rt)):ie=null}break e}}Se=0,Ei=null,pl(s,o,A,5);break;case 6:Se=0,Ei=null,pl(s,o,A,6);break;case 8:Wg(),$e=6;break t;default:throw Error(n(462))}}IC();break}catch(gt){CA(s,gt)}while(!0);return ns=Xa=null,X.H=f,X.A=y,we=u,ie!==null?0:(Ne=null,de=0,Hh(),$e)}function IC(){for(;ie!==null&&!Te();)DA(ie)}function DA(s){var o=iA(s.alternate,s,us);s.memoizedProps=s.pendingProps,o===null?bd(s):ie=o}function OA(s){var o=s,u=o.alternate;switch(o.tag){case 15:case 0:o=QE(u,o,o.pendingProps,o.type,void 0,de);break;case 11:o=QE(u,o,o.pendingProps,o.type.render,o.ref,de);break;case 5:ug(o);default:sA(u,o),o=ie=N0(o,us),o=iA(u,o,us)}s.memoizedProps=s.pendingProps,o===null?bd(s):ie=o}function pl(s,o,u,f){ns=Xa=null,ug(o),sl=null,Bc=0;var y=o.return;try{if(yC(s,y,o,u,de)){$e=1,dd(s,Oi(u,s.current)),ie=null;return}}catch(A){if(y!==null)throw ie=y,A;$e=1,dd(s,Oi(u,s.current)),ie=null;return}o.flags&32768?(ve||f===1?s=!0:cl||(de&536870912)!==0?s=!1:(Ys=s=!0,(f===2||f===9||f===3||f===6)&&(f=Li.current,f!==null&&f.tag===13&&(f.flags|=16384))),NA(o,s)):bd(o)}function bd(s){var o=s;do{if((o.flags&32768)!==0){NA(o,Ys);return}s=o.return;var u=EC(o.alternate,o,us);if(u!==null){ie=u;return}if(o=o.sibling,o!==null){ie=o;return}ie=o=s}while(o!==null);$e===0&&($e=5)}function NA(s,o){do{var u=AC(s.alternate,s);if(u!==null){u.flags&=32767,ie=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(s=s.sibling,s!==null)){ie=s;return}ie=s=u}while(s!==null);$e=6,ie=null}function PA(s,o,u,f,y,A,x,B,K){s.cancelPendingCommit=null;do Td();while(Dn!==0);if((we&6)!==0)throw Error(n(327));if(o!==null){if(o===s.current)throw Error(n(177));if(A=o.lanes|o.childLanes,A|=Up,ic(s,u,A,x,B,K),s===Ne&&(ie=Ne=null,de=0),hl=o,Xs=s,dl=u,Gg=A,$g=y,_A=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,NC(ri,function(){return FA(),null})):(s.callbackNode=null,s.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=X.T,X.T=null,y=Z.p,Z.p=2,x=we,we|=4;try{bC(s,o,u)}finally{we=x,Z.p=y,X.T=f}}Dn=1,MA(),LA(),kA()}}function MA(){if(Dn===1){Dn=0;var s=Xs,o=hl,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=X.T,X.T=null;var f=Z.p;Z.p=2;var y=we;we|=4;try{mA(o,s);var A=om,x=T0(s.containerInfo),B=A.focusedElem,K=A.selectionRange;if(x!==B&&B&&B.ownerDocument&&b0(B.ownerDocument.documentElement,B)){if(K!==null&&Mp(B)){var rt=K.start,gt=K.end;if(gt===void 0&&(gt=rt),"selectionStart"in B)B.selectionStart=rt,B.selectionEnd=Math.min(gt,B.value.length);else{var Et=B.ownerDocument||document,st=Et&&Et.defaultView||window;if(st.getSelection){var ct=st.getSelection(),zt=B.textContent.length,Bt=Math.min(K.start,zt),xe=K.end===void 0?Bt:Math.min(K.end,zt);!ct.extend&&Bt>xe&&(x=xe,xe=Bt,Bt=x);var tt=A0(B,Bt),Q=A0(B,xe);if(tt&&Q&&(ct.rangeCount!==1||ct.anchorNode!==tt.node||ct.anchorOffset!==tt.offset||ct.focusNode!==Q.node||ct.focusOffset!==Q.offset)){var nt=Et.createRange();nt.setStart(tt.node,tt.offset),ct.removeAllRanges(),Bt>xe?(ct.addRange(nt),ct.extend(Q.node,Q.offset)):(nt.setEnd(Q.node,Q.offset),ct.addRange(nt))}}}}for(Et=[],ct=B;ct=ct.parentNode;)ct.nodeType===1&&Et.push({element:ct,left:ct.scrollLeft,top:ct.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<Et.length;B++){var vt=Et[B];vt.element.scrollLeft=vt.left,vt.element.scrollTop=vt.top}}Md=!!am,om=am=null}finally{we=y,Z.p=f,X.T=u}}s.current=o,Dn=2}}function LA(){if(Dn===2){Dn=0;var s=Xs,o=hl,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=X.T,X.T=null;var f=Z.p;Z.p=2;var y=we;we|=4;try{dA(s,o.alternate,o)}finally{we=y,Z.p=f,X.T=u}}Dn=3}}function kA(){if(Dn===4||Dn===3){Dn=0,me();var s=Xs,o=hl,u=dl,f=_A;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Dn=5:(Dn=0,hl=Xs=null,BA(s,s.pendingLanes));var y=s.pendingLanes;if(y===0&&(Ks=null),Oo(u),o=o.stateNode,L&&typeof L.onCommitFiberRoot=="function")try{L.onCommitFiberRoot(Me,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=X.T,y=Z.p,Z.p=2,X.T=null;try{for(var A=s.onRecoverableError,x=0;x<f.length;x++){var B=f[x];A(B.value,{componentStack:B.stack})}}finally{X.T=o,Z.p=y}}(dl&3)!==0&&Td(),Ar(s),y=s.pendingLanes,(u&4194090)!==0&&(y&42)!==0?s===Yg?Yc++:(Yc=0,Yg=s):Yc=0,Wc(0)}}function BA(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,Rc(o)))}function Td(s){return MA(),LA(),kA(),FA()}function FA(){if(Dn!==5)return!1;var s=Xs,o=Gg;Gg=0;var u=Oo(dl),f=X.T,y=Z.p;try{Z.p=32>u?32:u,X.T=null,u=$g,$g=null;var A=Xs,x=dl;if(Dn=0,hl=Xs=null,dl=0,(we&6)!==0)throw Error(n(331));var B=we;if(we|=4,bA(A.current),vA(A,A.current,x,u),we=B,Wc(0,!1),L&&typeof L.onPostCommitFiberRoot=="function")try{L.onPostCommitFiberRoot(Me,A)}catch{}return!0}finally{Z.p=y,X.T=f,BA(s,o)}}function UA(s,o,u){o=Oi(u,o),o=wg(s.stateNode,o,2),s=Us(s,o,2),s!==null&&(Hr(s,2),Ar(s))}function Oe(s,o,u){if(s.tag===3)UA(s,s,u);else for(;o!==null;){if(o.tag===3){UA(o,s,u);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Ks===null||!Ks.has(f))){s=Oi(u,s),u=zE(2),f=Us(o,u,2),f!==null&&(GE(u,f,o,s),Hr(f,2),Ar(f));break}}o=o.return}}function qg(s,o,u){var f=s.pingCache;if(f===null){f=s.pingCache=new wC;var y=new Set;f.set(o,y)}else y=f.get(o),y===void 0&&(y=new Set,f.set(o,y));y.has(u)||(Vg=!0,y.add(u),s=xC.bind(null,s,o,u),o.then(s,s))}function xC(s,o,u){var f=s.pingCache;f!==null&&f.delete(o),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,Ne===s&&(de&u)===u&&($e===4||$e===3&&(de&62914560)===de&&300>_e()-zg?(we&2)===0&&fl(s,0):jg|=u,ul===de&&(ul=0)),Ar(s)}function VA(s,o){o===0&&(o=nc()),s=Xo(s,o),s!==null&&(Hr(s,o),Ar(s))}function DC(s){var o=s.memoizedState,u=0;o!==null&&(u=o.retryLane),VA(s,u)}function OC(s,o){var u=0;switch(s.tag){case 13:var f=s.stateNode,y=s.memoizedState;y!==null&&(u=y.retryLane);break;case 19:f=s.stateNode;break;case 22:f=s.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(o),VA(s,u)}function NC(s,o){return Xt(s,o)}var _d=null,gl=null,Qg=!1,wd=!1,Jg=!1,no=0;function Ar(s){s!==gl&&s.next===null&&(gl===null?_d=gl=s:gl=gl.next=s),wd=!0,Qg||(Qg=!0,MC())}function Wc(s,o){if(!Jg&&wd){Jg=!0;do for(var u=!1,f=_d;f!==null;){if(s!==0){var y=f.pendingLanes;if(y===0)var A=0;else{var x=f.suspendedLanes,B=f.pingedLanes;A=(1<<31-R(42|s)+1)-1,A&=y&~(x&~B),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(u=!0,GA(f,A))}else A=de,A=ye(f,f===Ne?A:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(A&3)===0||Ee(f,A)||(u=!0,GA(f,A));f=f.next}while(u);Jg=!1}}function PC(){jA()}function jA(){wd=Qg=!1;var s=0;no!==0&&(HC()&&(s=no),no=0);for(var o=_e(),u=null,f=_d;f!==null;){var y=f.next,A=HA(f,o);A===0?(f.next=null,u===null?_d=y:u.next=y,y===null&&(gl=u)):(u=f,(s!==0||(A&3)!==0)&&(wd=!0)),f=y}Wc(s)}function HA(s,o){for(var u=s.suspendedLanes,f=s.pingedLanes,y=s.expirationTimes,A=s.pendingLanes&-62914561;0<A;){var x=31-R(A),B=1<<x,K=y[x];K===-1?((B&u)===0||(B&f)!==0)&&(y[x]=pe(B,o)):K<=o&&(s.expiredLanes|=B),A&=~B}if(o=Ne,u=de,u=ye(s,s===o?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f=s.callbackNode,u===0||s===o&&(Se===2||Se===9)||s.cancelPendingCommit!==null)return f!==null&&f!==null&&ne(f),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||Ee(s,u)){if(o=u&-u,o===s.callbackPriority)return o;switch(f!==null&&ne(f),Oo(u)){case 2:case 8:u=Wi;break;case 32:u=ri;break;case 268435456:u=Si;break;default:u=ri}return f=zA.bind(null,s),u=Xt(u,f),s.callbackPriority=o,s.callbackNode=u,o}return f!==null&&f!==null&&ne(f),s.callbackPriority=2,s.callbackNode=null,2}function zA(s,o){if(Dn!==0&&Dn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(Td()&&s.callbackNode!==u)return null;var f=de;return f=ye(s,s===Ne?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f===0?null:(SA(s,f,o),HA(s,_e()),s.callbackNode!=null&&s.callbackNode===u?zA.bind(null,s):null)}function GA(s,o){if(Td())return null;SA(s,o,!0)}function MC(){GC(function(){(we&6)!==0?Xt(ii,PC):jA()})}function Zg(){return no===0&&(no=ec()),no}function $A(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Bo(""+s)}function YA(s,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,s.id&&u.setAttribute("form",s.id),o.parentNode.insertBefore(u,o),s=new FormData(s),u.parentNode.removeChild(u),s}function LC(s,o,u,f,y){if(o==="submit"&&u&&u.stateNode===y){var A=$A((y[en]||null).action),x=f.submitter;x&&(o=(o=x[en]||null)?$A(o.formAction):x.getAttribute("formAction"),o!==null&&(A=o,x=null));var B=new Fo("action","action",null,f,y);s.push({event:B,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(no!==0){var K=x?YA(y,x):new FormData(y);Eg(u,{pending:!0,data:K,method:y.method,action:A},null,K)}}else typeof A=="function"&&(B.preventDefault(),K=x?YA(y,x):new FormData(y),Eg(u,{pending:!0,data:K,method:y.method,action:A},A,K))},currentTarget:y}]})}}for(var tm=0;tm<Fp.length;tm++){var em=Fp[tm],kC=em.toLowerCase(),BC=em[0].toUpperCase()+em.slice(1);qi(kC,"on"+BC)}qi(S0,"onAnimationEnd"),qi(R0,"onAnimationIteration"),qi(C0,"onAnimationStart"),qi("dblclick","onDoubleClick"),qi("focusin","onFocus"),qi("focusout","onBlur"),qi(tC,"onTransitionRun"),qi(eC,"onTransitionStart"),qi(nC,"onTransitionCancel"),qi(I0,"onTransitionEnd"),Gr("onMouseEnter",["mouseout","mouseover"]),Gr("onMouseLeave",["mouseout","mouseover"]),Gr("onPointerEnter",["pointerout","pointerover"]),Gr("onPointerLeave",["pointerout","pointerover"]),Ki("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ki("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ki("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ki("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ki("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ki("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kc));function WA(s,o){o=(o&4)!==0;for(var u=0;u<s.length;u++){var f=s[u],y=f.event;f=f.listeners;t:{var A=void 0;if(o)for(var x=f.length-1;0<=x;x--){var B=f[x],K=B.instance,rt=B.currentTarget;if(B=B.listener,K!==A&&y.isPropagationStopped())break t;A=B,y.currentTarget=rt;try{A(y)}catch(gt){hd(gt)}y.currentTarget=null,A=K}else for(x=0;x<f.length;x++){if(B=f[x],K=B.instance,rt=B.currentTarget,B=B.listener,K!==A&&y.isPropagationStopped())break t;A=B,y.currentTarget=rt;try{A(y)}catch(gt){hd(gt)}y.currentTarget=null,A=K}}}}function re(s,o){var u=o[sc];u===void 0&&(u=o[sc]=new Set);var f=s+"__bubble";u.has(f)||(KA(o,s,2,!1),u.add(f))}function nm(s,o,u){var f=0;o&&(f|=4),KA(u,s,f,o)}var Sd="_reactListening"+Math.random().toString(36).slice(2);function im(s){if(!s[Sd]){s[Sd]=!0,ac.forEach(function(u){u!=="selectionchange"&&(FC.has(u)||nm(u,!1,s),nm(u,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[Sd]||(o[Sd]=!0,nm("selectionchange",!1,o))}}function KA(s,o,u,f){switch(vb(o)){case 2:var y=hI;break;case 8:y=dI;break;default:y=ym}u=y.bind(null,o,u,s),y=void 0,!xi||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),f?y!==void 0?s.addEventListener(o,u,{capture:!0,passive:y}):s.addEventListener(o,u,!0):y!==void 0?s.addEventListener(o,u,{passive:y}):s.addEventListener(o,u,!1)}function rm(s,o,u,f,y){var A=f;if((o&1)===0&&(o&2)===0&&f!==null)t:for(;;){if(f===null)return;var x=f.tag;if(x===3||x===4){var B=f.stateNode.containerInfo;if(B===y)break;if(x===4)for(x=f.return;x!==null;){var K=x.tag;if((K===3||K===4)&&x.stateNode.containerInfo===y)return;x=x.return}for(;B!==null;){if(x=zr(B),x===null)return;if(K=x.tag,K===5||K===6||K===26||K===27){f=A=x;continue t}B=B.parentNode}}f=f.return}Ch(function(){var rt=A,gt=Ii(u),Et=[];t:{var st=x0.get(s);if(st!==void 0){var ct=Fo,zt=s;switch(s){case"keypress":if(hr(u)===0)break t;case"keydown":case"keyup":ct=Go;break;case"focusin":zt="focus",ct=jo;break;case"focusout":zt="blur",ct=jo;break;case"beforeblur":case"afterblur":ct=jo;break;case"click":if(u.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ct=Di;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ct=Dp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ct=Lh;break;case S0:case R0:case C0:ct=Ho;break;case I0:ct=Bh;break;case"scroll":case"scrollend":ct=Ih;break;case"wheel":ct=$o;break;case"copy":case"cut":case"paste":ct=zo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ct=vc;break;case"toggle":case"beforetoggle":ct=Uh}var Bt=(o&4)!==0,xe=!Bt&&(s==="scroll"||s==="scrollend"),tt=Bt?st!==null?st+"Capture":null:st;Bt=[];for(var Q=rt,nt;Q!==null;){var vt=Q;if(nt=vt.stateNode,vt=vt.tag,vt!==5&&vt!==26&&vt!==27||nt===null||tt===null||(vt=La(Q,tt),vt!=null&&Bt.push(Xc(Q,vt,nt))),xe)break;Q=Q.return}0<Bt.length&&(st=new ct(st,zt,null,u,gt),Et.push({event:st,listeners:Bt}))}}if((o&7)===0){t:{if(st=s==="mouseover"||s==="pointerover",ct=s==="mouseout"||s==="pointerout",st&&u!==Wr&&(zt=u.relatedTarget||u.fromElement)&&(zr(zt)||zt[Ri]))break t;if((ct||st)&&(st=gt.window===gt?gt:(st=gt.ownerDocument)?st.defaultView||st.parentWindow:window,ct?(zt=u.relatedTarget||u.toElement,ct=rt,zt=zt?zr(zt):null,zt!==null&&(xe=a(zt),Bt=zt.tag,zt!==xe||Bt!==5&&Bt!==27&&Bt!==6)&&(zt=null)):(ct=null,zt=rt),ct!==zt)){if(Bt=Di,vt="onMouseLeave",tt="onMouseEnter",Q="mouse",(s==="pointerout"||s==="pointerover")&&(Bt=vc,vt="onPointerLeave",tt="onPointerEnter",Q="pointer"),xe=ct==null?st:or(ct),nt=zt==null?st:or(zt),st=new Bt(vt,Q+"leave",ct,u,gt),st.target=xe,st.relatedTarget=nt,vt=null,zr(gt)===rt&&(Bt=new Bt(tt,Q+"enter",zt,u,gt),Bt.target=nt,Bt.relatedTarget=xe,vt=Bt),xe=vt,ct&&zt)e:{for(Bt=ct,tt=zt,Q=0,nt=Bt;nt;nt=ml(nt))Q++;for(nt=0,vt=tt;vt;vt=ml(vt))nt++;for(;0<Q-nt;)Bt=ml(Bt),Q--;for(;0<nt-Q;)tt=ml(tt),nt--;for(;Q--;){if(Bt===tt||tt!==null&&Bt===tt.alternate)break e;Bt=ml(Bt),tt=ml(tt)}Bt=null}else Bt=null;ct!==null&&XA(Et,st,ct,Bt,!1),zt!==null&&xe!==null&&XA(Et,xe,zt,Bt,!0)}}t:{if(st=rt?or(rt):window,ct=st.nodeName&&st.nodeName.toLowerCase(),ct==="select"||ct==="input"&&st.type==="file")var Ot=p0;else if(pn(st))if(g0)Ot=QR;else{Ot=XR;var te=KR}else ct=st.nodeName,!ct||ct.toLowerCase()!=="input"||st.type!=="checkbox"&&st.type!=="radio"?rt&&hc(rt.elementType)&&(Ot=p0):Ot=qR;if(Ot&&(Ot=Ot(s,rt))){Jr(Et,Ot,u,gt);break t}te&&te(s,st,rt),s==="focusout"&&rt&&st.type==="number"&&rt.memoizedProps.value!=null&&Ms(st,"number",st.value)}switch(te=rt?or(rt):window,s){case"focusin":(pn(te)||te.contentEditable==="true")&&(Yo=te,Lp=rt,bc=null);break;case"focusout":bc=Lp=Yo=null;break;case"mousedown":kp=!0;break;case"contextmenu":case"mouseup":case"dragend":kp=!1,_0(Et,u,gt);break;case"selectionchange":if(ZR)break;case"keydown":case"keyup":_0(Et,u,gt)}var Pt;if(pr)t:{switch(s){case"compositionstart":var Ft="onCompositionStart";break t;case"compositionend":Ft="onCompositionEnd";break t;case"compositionupdate":Ft="onCompositionUpdate";break t}Ft=void 0}else ue?dt(s,u)&&(Ft="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(Ft="onCompositionStart");Ft&&(I&&u.locale!=="ko"&&(ue||Ft!=="onCompositionStart"?Ft==="onCompositionEnd"&&ue&&(Pt=fc()):(ur=gt,Ls="value"in ur?ur.value:ur.textContent,ue=!0)),te=Rd(rt,Ft),0<te.length&&(Ft=new mc(Ft,s,null,u,gt),Et.push({event:Ft,listeners:te}),Pt?Ft.data=Pt:(Pt=wt(u),Pt!==null&&(Ft.data=Pt)))),(Pt=_?fn(s,u):he(s,u))&&(Ft=Rd(rt,"onBeforeInput"),0<Ft.length&&(te=new mc("onBeforeInput","beforeinput",null,u,gt),Et.push({event:te,listeners:Ft}),te.data=Pt)),LC(Et,s,rt,u,gt)}WA(Et,o)})}function Xc(s,o,u){return{instance:s,listener:o,currentTarget:u}}function Rd(s,o){for(var u=o+"Capture",f=[];s!==null;){var y=s,A=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||A===null||(y=La(s,u),y!=null&&f.unshift(Xc(s,y,A)),y=La(s,o),y!=null&&f.push(Xc(s,y,A))),s.tag===3)return f;s=s.return}return[]}function ml(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function XA(s,o,u,f,y){for(var A=o._reactName,x=[];u!==null&&u!==f;){var B=u,K=B.alternate,rt=B.stateNode;if(B=B.tag,K!==null&&K===f)break;B!==5&&B!==26&&B!==27||rt===null||(K=rt,y?(rt=La(u,A),rt!=null&&x.unshift(Xc(u,rt,K))):y||(rt=La(u,A),rt!=null&&x.push(Xc(u,rt,K)))),u=u.return}x.length!==0&&s.push({event:o,listeners:x})}var UC=/\r\n?/g,VC=/\u0000|\uFFFD/g;function qA(s){return(typeof s=="string"?s:""+s).replace(UC,`
`).replace(VC,"")}function QA(s,o){return o=qA(o),qA(s)===o}function Cd(){}function Ie(s,o,u,f,y,A){switch(u){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||Ci(s,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&Ci(s,""+f);break;case"className":lr(s,"class",f);break;case"tabIndex":lr(s,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":lr(s,u,f);break;case"style":uc(s,f,A);break;case"data":if(o!=="object"){lr(s,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||u!=="href")){s.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(u);break}f=Bo(""+f),s.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(u==="formAction"?(o!=="input"&&Ie(s,o,"name",y.name,y,null),Ie(s,o,"formEncType",y.formEncType,y,null),Ie(s,o,"formMethod",y.formMethod,y,null),Ie(s,o,"formTarget",y.formTarget,y,null)):(Ie(s,o,"encType",y.encType,y,null),Ie(s,o,"method",y.method,y,null),Ie(s,o,"target",y.target,y,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(u);break}f=Bo(""+f),s.setAttribute(u,f);break;case"onClick":f!=null&&(s.onclick=Cd);break;case"onScroll":f!=null&&re("scroll",s);break;case"onScrollEnd":f!=null&&re("scrollend",s);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(u=f.__html,u!=null){if(y.children!=null)throw Error(n(60));s.innerHTML=u}}break;case"multiple":s.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":s.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){s.removeAttribute("xlink:href");break}u=Bo(""+f),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(u,""+f):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":f===!0?s.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(u,f):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?s.setAttribute(u,f):s.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?s.removeAttribute(u):s.setAttribute(u,f);break;case"popover":re("beforetoggle",s),re("toggle",s),Ps(s,"popover",f);break;case"xlinkActuate":Cn(s,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Cn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Cn(s,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Cn(s,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Cn(s,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Cn(s,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Cn(s,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Cn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Cn(s,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Ps(s,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Ip.get(u)||u,Ps(s,u,f))}}function sm(s,o,u,f,y,A){switch(u){case"style":uc(s,f,A);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(u=f.__html,u!=null){if(y.children!=null)throw Error(n(60));s.innerHTML=u}}break;case"children":typeof f=="string"?Ci(s,f):(typeof f=="number"||typeof f=="bigint")&&Ci(s,""+f);break;case"onScroll":f!=null&&re("scroll",s);break;case"onScrollEnd":f!=null&&re("scrollend",s);break;case"onClick":f!=null&&(s.onclick=Cd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!No.hasOwnProperty(u))t:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),o=u.slice(2,y?u.length-7:void 0),A=s[en]||null,A=A!=null?A[u]:null,typeof A=="function"&&s.removeEventListener(o,A,y),typeof f=="function")){typeof A!="function"&&A!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(o,f,y);break t}u in s?s[u]=f:f===!0?s.setAttribute(u,""):Ps(s,u,f)}}}function On(s,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":re("error",s),re("load",s);var f=!1,y=!1,A;for(A in u)if(u.hasOwnProperty(A)){var x=u[A];if(x!=null)switch(A){case"src":f=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:Ie(s,o,A,x,u,null)}}y&&Ie(s,o,"srcSet",u.srcSet,u,null),f&&Ie(s,o,"src",u.src,u,null);return;case"input":re("invalid",s);var B=A=x=y=null,K=null,rt=null;for(f in u)if(u.hasOwnProperty(f)){var gt=u[f];if(gt!=null)switch(f){case"name":y=gt;break;case"type":x=gt;break;case"checked":K=gt;break;case"defaultChecked":rt=gt;break;case"value":A=gt;break;case"defaultValue":B=gt;break;case"children":case"dangerouslySetInnerHTML":if(gt!=null)throw Error(n(137,o));break;default:Ie(s,o,f,gt,u,null)}}Na(s,A,B,K,rt,x,y,!1),ko(s);return;case"select":re("invalid",s),f=x=A=null;for(y in u)if(u.hasOwnProperty(y)&&(B=u[y],B!=null))switch(y){case"value":A=B;break;case"defaultValue":x=B;break;case"multiple":f=B;default:Ie(s,o,y,B,u,null)}o=A,u=x,s.multiple=!!f,o!=null?Yr(s,!!f,o,!1):u!=null&&Yr(s,!!f,u,!0);return;case"textarea":re("invalid",s),A=y=f=null;for(x in u)if(u.hasOwnProperty(x)&&(B=u[x],B!=null))switch(x){case"value":f=B;break;case"defaultValue":y=B;break;case"children":A=B;break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(n(91));break;default:Ie(s,o,x,B,u,null)}Pa(s,f,y,A),ko(s);return;case"option":for(K in u)if(u.hasOwnProperty(K)&&(f=u[K],f!=null))switch(K){case"selected":s.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Ie(s,o,K,f,u,null)}return;case"dialog":re("beforetoggle",s),re("toggle",s),re("cancel",s),re("close",s);break;case"iframe":case"object":re("load",s);break;case"video":case"audio":for(f=0;f<Kc.length;f++)re(Kc[f],s);break;case"image":re("error",s),re("load",s);break;case"details":re("toggle",s);break;case"embed":case"source":case"link":re("error",s),re("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(rt in u)if(u.hasOwnProperty(rt)&&(f=u[rt],f!=null))switch(rt){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:Ie(s,o,rt,f,u,null)}return;default:if(hc(o)){for(gt in u)u.hasOwnProperty(gt)&&(f=u[gt],f!==void 0&&sm(s,o,gt,f,u,void 0));return}}for(B in u)u.hasOwnProperty(B)&&(f=u[B],f!=null&&Ie(s,o,B,f,u,null))}function jC(s,o,u,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,A=null,x=null,B=null,K=null,rt=null,gt=null;for(ct in u){var Et=u[ct];if(u.hasOwnProperty(ct)&&Et!=null)switch(ct){case"checked":break;case"value":break;case"defaultValue":K=Et;default:f.hasOwnProperty(ct)||Ie(s,o,ct,null,f,Et)}}for(var st in f){var ct=f[st];if(Et=u[st],f.hasOwnProperty(st)&&(ct!=null||Et!=null))switch(st){case"type":A=ct;break;case"name":y=ct;break;case"checked":rt=ct;break;case"defaultChecked":gt=ct;break;case"value":x=ct;break;case"defaultValue":B=ct;break;case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(n(137,o));break;default:ct!==Et&&Ie(s,o,st,ct,f,Et)}}pi(s,x,B,K,rt,gt,A,y);return;case"select":ct=x=B=st=null;for(A in u)if(K=u[A],u.hasOwnProperty(A)&&K!=null)switch(A){case"value":break;case"multiple":ct=K;default:f.hasOwnProperty(A)||Ie(s,o,A,null,f,K)}for(y in f)if(A=f[y],K=u[y],f.hasOwnProperty(y)&&(A!=null||K!=null))switch(y){case"value":st=A;break;case"defaultValue":B=A;break;case"multiple":x=A;default:A!==K&&Ie(s,o,y,A,f,K)}o=B,u=x,f=ct,st!=null?Yr(s,!!u,st,!1):!!f!=!!u&&(o!=null?Yr(s,!!u,o,!0):Yr(s,!!u,u?[]:"",!1));return;case"textarea":ct=st=null;for(B in u)if(y=u[B],u.hasOwnProperty(B)&&y!=null&&!f.hasOwnProperty(B))switch(B){case"value":break;case"children":break;default:Ie(s,o,B,null,f,y)}for(x in f)if(y=f[x],A=u[x],f.hasOwnProperty(x)&&(y!=null||A!=null))switch(x){case"value":st=y;break;case"defaultValue":ct=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(n(91));break;default:y!==A&&Ie(s,o,x,y,f,A)}Re(s,st,ct);return;case"option":for(var zt in u)if(st=u[zt],u.hasOwnProperty(zt)&&st!=null&&!f.hasOwnProperty(zt))switch(zt){case"selected":s.selected=!1;break;default:Ie(s,o,zt,null,f,st)}for(K in f)if(st=f[K],ct=u[K],f.hasOwnProperty(K)&&st!==ct&&(st!=null||ct!=null))switch(K){case"selected":s.selected=st&&typeof st!="function"&&typeof st!="symbol";break;default:Ie(s,o,K,st,f,ct)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Bt in u)st=u[Bt],u.hasOwnProperty(Bt)&&st!=null&&!f.hasOwnProperty(Bt)&&Ie(s,o,Bt,null,f,st);for(rt in f)if(st=f[rt],ct=u[rt],f.hasOwnProperty(rt)&&st!==ct&&(st!=null||ct!=null))switch(rt){case"children":case"dangerouslySetInnerHTML":if(st!=null)throw Error(n(137,o));break;default:Ie(s,o,rt,st,f,ct)}return;default:if(hc(o)){for(var xe in u)st=u[xe],u.hasOwnProperty(xe)&&st!==void 0&&!f.hasOwnProperty(xe)&&sm(s,o,xe,void 0,f,st);for(gt in f)st=f[gt],ct=u[gt],!f.hasOwnProperty(gt)||st===ct||st===void 0&&ct===void 0||sm(s,o,gt,st,f,ct);return}}for(var tt in u)st=u[tt],u.hasOwnProperty(tt)&&st!=null&&!f.hasOwnProperty(tt)&&Ie(s,o,tt,null,f,st);for(Et in f)st=f[Et],ct=u[Et],!f.hasOwnProperty(Et)||st===ct||st==null&&ct==null||Ie(s,o,Et,st,f,ct)}var am=null,om=null;function Id(s){return s.nodeType===9?s:s.ownerDocument}function JA(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ZA(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function lm(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var cm=null;function HC(){var s=window.event;return s&&s.type==="popstate"?s===cm?!1:(cm=s,!0):(cm=null,!1)}var tb=typeof setTimeout=="function"?setTimeout:void 0,zC=typeof clearTimeout=="function"?clearTimeout:void 0,eb=typeof Promise=="function"?Promise:void 0,GC=typeof queueMicrotask=="function"?queueMicrotask:typeof eb<"u"?function(s){return eb.resolve(null).then(s).catch($C)}:tb;function $C(s){setTimeout(function(){throw s})}function Qs(s){return s==="head"}function nb(s,o){var u=o,f=0,y=0;do{var A=u.nextSibling;if(s.removeChild(u),A&&A.nodeType===8)if(u=A.data,u==="/$"){if(0<f&&8>f){u=f;var x=s.ownerDocument;if(u&1&&qc(x.documentElement),u&2&&qc(x.body),u&4)for(u=x.head,qc(u),x=u.firstChild;x;){var B=x.nextSibling,K=x.nodeName;x[Ia]||K==="SCRIPT"||K==="STYLE"||K==="LINK"&&x.rel.toLowerCase()==="stylesheet"||u.removeChild(x),x=B}}if(y===0){s.removeChild(A),ru(o);return}y--}else u==="$"||u==="$?"||u==="$!"?y++:f=u.charCodeAt(0)-48;else f=0;u=A}while(u);ru(o)}function um(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":um(u),Ns(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function YC(s,o,u,f){for(;s.nodeType===1;){var y=u;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(f){if(!s[Ia])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(A=s.getAttribute("rel"),A==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(A!==y.rel||s.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||s.getAttribute("title")!==(y.title==null?null:y.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(A=s.getAttribute("src"),(A!==(y.src==null?null:y.src)||s.getAttribute("type")!==(y.type==null?null:y.type)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&A&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var A=y.name==null?null:""+y.name;if(y.type==="hidden"&&s.getAttribute("name")===A)return s}else return s;if(s=Ji(s.nextSibling),s===null)break}return null}function WC(s,o,u){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=Ji(s.nextSibling),s===null))return null;return s}function hm(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function KC(s,o){var u=s.ownerDocument;if(s.data!=="$?"||u.readyState==="complete")o();else{var f=function(){o(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),s._reactRetry=f}}function Ji(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return s}var dm=null;function ib(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return s;o--}else u==="/$"&&o++}s=s.previousSibling}return null}function rb(s,o,u){switch(o=Id(u),s){case"html":if(s=o.documentElement,!s)throw Error(n(452));return s;case"head":if(s=o.head,!s)throw Error(n(453));return s;case"body":if(s=o.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function qc(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);Ns(s)}var Bi=new Map,sb=new Set;function xd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var hs=Z.d;Z.d={f:XC,r:qC,D:QC,C:JC,L:ZC,m:tI,X:nI,S:eI,M:iI};function XC(){var s=hs.f(),o=Ad();return s||o}function qC(s){var o=ar(s);o!==null&&o.tag===5&&o.type==="form"?SE(o):hs.r(s)}var yl=typeof document>"u"?null:document;function ab(s,o,u){var f=yl;if(f&&typeof o=="string"&&o){var y=nn(o);y='link[rel="'+s+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),sb.has(y)||(sb.add(y),s={rel:s,crossOrigin:u,href:o},f.querySelector(y)===null&&(o=f.createElement("link"),On(o,"link",s),Ke(o),f.head.appendChild(o)))}}function QC(s){hs.D(s),ab("dns-prefetch",s,null)}function JC(s,o){hs.C(s,o),ab("preconnect",s,o)}function ZC(s,o,u){hs.L(s,o,u);var f=yl;if(f&&s&&o){var y='link[rel="preload"][as="'+nn(o)+'"]';o==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+nn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+nn(u.imageSizes)+'"]')):y+='[href="'+nn(s)+'"]';var A=y;switch(o){case"style":A=vl(s);break;case"script":A=El(s)}Bi.has(A)||(s=p({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:s,as:o},u),Bi.set(A,s),f.querySelector(y)!==null||o==="style"&&f.querySelector(Qc(A))||o==="script"&&f.querySelector(Jc(A))||(o=f.createElement("link"),On(o,"link",s),Ke(o),f.head.appendChild(o)))}}function tI(s,o){hs.m(s,o);var u=yl;if(u&&s){var f=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+nn(f)+'"][href="'+nn(s)+'"]',A=y;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=El(s)}if(!Bi.has(A)&&(s=p({rel:"modulepreload",href:s},o),Bi.set(A,s),u.querySelector(y)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Jc(A)))return}f=u.createElement("link"),On(f,"link",s),Ke(f),u.head.appendChild(f)}}}function eI(s,o,u){hs.S(s,o,u);var f=yl;if(f&&s){var y=Wn(f).hoistableStyles,A=vl(s);o=o||"default";var x=y.get(A);if(!x){var B={loading:0,preload:null};if(x=f.querySelector(Qc(A)))B.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":o},u),(u=Bi.get(A))&&fm(s,u);var K=x=f.createElement("link");Ke(K),On(K,"link",s),K._p=new Promise(function(rt,gt){K.onload=rt,K.onerror=gt}),K.addEventListener("load",function(){B.loading|=1}),K.addEventListener("error",function(){B.loading|=2}),B.loading|=4,Dd(x,o,f)}x={type:"stylesheet",instance:x,count:1,state:B},y.set(A,x)}}}function nI(s,o){hs.X(s,o);var u=yl;if(u&&s){var f=Wn(u).hoistableScripts,y=El(s),A=f.get(y);A||(A=u.querySelector(Jc(y)),A||(s=p({src:s,async:!0},o),(o=Bi.get(y))&&pm(s,o),A=u.createElement("script"),Ke(A),On(A,"link",s),u.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},f.set(y,A))}}function iI(s,o){hs.M(s,o);var u=yl;if(u&&s){var f=Wn(u).hoistableScripts,y=El(s),A=f.get(y);A||(A=u.querySelector(Jc(y)),A||(s=p({src:s,async:!0,type:"module"},o),(o=Bi.get(y))&&pm(s,o),A=u.createElement("script"),Ke(A),On(A,"link",s),u.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},f.set(y,A))}}function ob(s,o,u,f){var y=(y=ut.current)?xd(y):null;if(!y)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=vl(u.href),u=Wn(y).hoistableStyles,f=u.get(o),f||(f={type:"style",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=vl(u.href);var A=Wn(y).hoistableStyles,x=A.get(s);if(x||(y=y.ownerDocument||y,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(s,x),(A=y.querySelector(Qc(s)))&&!A._p&&(x.instance=A,x.state.loading=5),Bi.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Bi.set(s,u),A||rI(y,s,u,x.state))),o&&f===null)throw Error(n(528,""));return x}if(o&&f!==null)throw Error(n(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=El(u),u=Wn(y).hoistableScripts,f=u.get(o),f||(f={type:"script",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function vl(s){return'href="'+nn(s)+'"'}function Qc(s){return'link[rel="stylesheet"]['+s+"]"}function lb(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function rI(s,o,u,f){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=s.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),On(o,"link",u),Ke(o),s.head.appendChild(o))}function El(s){return'[src="'+nn(s)+'"]'}function Jc(s){return"script[async]"+s}function cb(s,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var f=s.querySelector('style[data-href~="'+nn(u.href)+'"]');if(f)return o.instance=f,Ke(f),f;var y=p({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(s.ownerDocument||s).createElement("style"),Ke(f),On(f,"style",y),Dd(f,u.precedence,s),o.instance=f;case"stylesheet":y=vl(u.href);var A=s.querySelector(Qc(y));if(A)return o.state.loading|=4,o.instance=A,Ke(A),A;f=lb(u),(y=Bi.get(y))&&fm(f,y),A=(s.ownerDocument||s).createElement("link"),Ke(A);var x=A;return x._p=new Promise(function(B,K){x.onload=B,x.onerror=K}),On(A,"link",f),o.state.loading|=4,Dd(A,u.precedence,s),o.instance=A;case"script":return A=El(u.src),(y=s.querySelector(Jc(A)))?(o.instance=y,Ke(y),y):(f=u,(y=Bi.get(A))&&(f=p({},u),pm(f,y)),s=s.ownerDocument||s,y=s.createElement("script"),Ke(y),On(y,"link",f),s.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,Dd(f,u.precedence,s));return o.instance}function Dd(s,o,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=f.length?f[f.length-1]:null,A=y,x=0;x<f.length;x++){var B=f[x];if(B.dataset.precedence===o)A=B;else if(A!==y)break}A?A.parentNode.insertBefore(s,A.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(s,o.firstChild))}function fm(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function pm(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var Od=null;function ub(s,o,u){if(Od===null){var f=new Map,y=Od=new Map;y.set(u,f)}else y=Od,f=y.get(u),f||(f=new Map,y.set(u,f));if(f.has(s))return f;for(f.set(s,null),u=u.getElementsByTagName(s),y=0;y<u.length;y++){var A=u[y];if(!(A[Ia]||A[dn]||s==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var x=A.getAttribute(o)||"";x=s+x;var B=f.get(x);B?B.push(A):f.set(x,[A])}}return f}function hb(s,o,u){s=s.ownerDocument||s,s.head.insertBefore(u,o==="title"?s.querySelector("head > title"):null)}function sI(s,o,u){if(u===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function db(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Zc=null;function aI(){}function oI(s,o,u){if(Zc===null)throw Error(n(475));var f=Zc;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var y=vl(u.href),A=s.querySelector(Qc(y));if(A){s=A._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(f.count++,f=Nd.bind(f),s.then(f,f)),o.state.loading|=4,o.instance=A,Ke(A);return}A=s.ownerDocument||s,u=lb(u),(y=Bi.get(y))&&fm(u,y),A=A.createElement("link"),Ke(A);var x=A;x._p=new Promise(function(B,K){x.onload=B,x.onerror=K}),On(A,"link",u),o.instance=A}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(f.count++,o=Nd.bind(f),s.addEventListener("load",o),s.addEventListener("error",o))}}function lI(){if(Zc===null)throw Error(n(475));var s=Zc;return s.stylesheets&&s.count===0&&gm(s,s.stylesheets),0<s.count?function(o){var u=setTimeout(function(){if(s.stylesheets&&gm(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(u)}}:null}function Nd(){if(this.count--,this.count===0){if(this.stylesheets)gm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Pd=null;function gm(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Pd=new Map,o.forEach(cI,s),Pd=null,Nd.call(s))}function cI(s,o){if(!(o.state.loading&4)){var u=Pd.get(s);if(u)var f=u.get(null);else{u=new Map,Pd.set(s,u);for(var y=s.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<y.length;A++){var x=y[A];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(u.set(x.dataset.precedence,x),f=x)}f&&u.set(null,f)}y=o.instance,x=y.getAttribute("data-precedence"),A=u.get(x)||f,A===f&&u.set(null,y),u.set(x,y),this.count++,f=Nd.bind(this),y.addEventListener("load",f),y.addEventListener("error",f),A?A.parentNode.insertBefore(y,A.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(y,s.firstChild)),o.state.loading|=4}}var tu={$$typeof:O,Provider:null,Consumer:null,_currentValue:ht,_currentValue2:ht,_threadCount:0};function uI(s,o,u,f,y,A,x,B){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=jr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jr(0),this.hiddenUpdates=jr(null),this.identifierPrefix=f,this.onUncaughtError=y,this.onCaughtError=A,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function fb(s,o,u,f,y,A,x,B,K,rt,gt,Et){return s=new uI(s,o,u,x,B,K,rt,Et),o=1,A===!0&&(o|=24),A=mi(3,null,null,o),s.current=A,A.stateNode=s,o=qp(),o.refCount++,s.pooledCache=o,o.refCount++,A.memoizedState={element:f,isDehydrated:u,cache:o},tg(A),s}function pb(s){return s?(s=qo,s):qo}function gb(s,o,u,f,y,A){y=pb(y),f.context===null?f.context=y:f.pendingContext=y,f=Fs(o),f.payload={element:u},A=A===void 0?null:A,A!==null&&(f.callback=A),u=Us(s,f,o),u!==null&&(bi(u,s,o),Dc(u,s,o))}function mb(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<o?u:o}}function mm(s,o){mb(s,o),(s=s.alternate)&&mb(s,o)}function yb(s){if(s.tag===13){var o=Xo(s,67108864);o!==null&&bi(o,s,67108864),mm(s,67108864)}}var Md=!0;function hI(s,o,u,f){var y=X.T;X.T=null;var A=Z.p;try{Z.p=2,ym(s,o,u,f)}finally{Z.p=A,X.T=y}}function dI(s,o,u,f){var y=X.T;X.T=null;var A=Z.p;try{Z.p=8,ym(s,o,u,f)}finally{Z.p=A,X.T=y}}function ym(s,o,u,f){if(Md){var y=vm(f);if(y===null)rm(s,o,f,Ld,u),Eb(s,f);else if(pI(y,s,o,u,f))f.stopPropagation();else if(Eb(s,f),o&4&&-1<fI.indexOf(s)){for(;y!==null;){var A=ar(y);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var x=ce(A.pendingLanes);if(x!==0){var B=A;for(B.pendingLanes|=2,B.entangledLanes|=2;x;){var K=1<<31-R(x);B.entanglements[1]|=K,x&=~K}Ar(A),(we&6)===0&&(vd=_e()+500,Wc(0))}}break;case 13:B=Xo(A,2),B!==null&&bi(B,A,2),Ad(),mm(A,2)}if(A=vm(f),A===null&&rm(s,o,f,Ld,u),A===y)break;y=A}y!==null&&f.stopPropagation()}else rm(s,o,f,null,u)}}function vm(s){return s=Ii(s),Em(s)}var Ld=null;function Em(s){if(Ld=null,s=zr(s),s!==null){var o=a(s);if(o===null)s=null;else{var u=o.tag;if(u===13){if(s=l(o),s!==null)return s;s=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Ld=s,null}function vb(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Yi()){case ii:return 2;case Wi:return 8;case ri:case Un:return 32;case Si:return 268435456;default:return 32}default:return 32}}var Am=!1,Js=null,Zs=null,ta=null,eu=new Map,nu=new Map,ea=[],fI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Eb(s,o){switch(s){case"focusin":case"focusout":Js=null;break;case"dragenter":case"dragleave":Zs=null;break;case"mouseover":case"mouseout":ta=null;break;case"pointerover":case"pointerout":eu.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":nu.delete(o.pointerId)}}function iu(s,o,u,f,y,A){return s===null||s.nativeEvent!==A?(s={blockedOn:o,domEventName:u,eventSystemFlags:f,nativeEvent:A,targetContainers:[y]},o!==null&&(o=ar(o),o!==null&&yb(o)),s):(s.eventSystemFlags|=f,o=s.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),s)}function pI(s,o,u,f,y){switch(o){case"focusin":return Js=iu(Js,s,o,u,f,y),!0;case"dragenter":return Zs=iu(Zs,s,o,u,f,y),!0;case"mouseover":return ta=iu(ta,s,o,u,f,y),!0;case"pointerover":var A=y.pointerId;return eu.set(A,iu(eu.get(A)||null,s,o,u,f,y)),!0;case"gotpointercapture":return A=y.pointerId,nu.set(A,iu(nu.get(A)||null,s,o,u,f,y)),!0}return!1}function Ab(s){var o=zr(s.target);if(o!==null){var u=a(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){s.blockedOn=o,Ah(s.priority,function(){if(u.tag===13){var f=Ai();f=xs(f);var y=Xo(u,f);y!==null&&bi(y,u,f),mm(u,f)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function kd(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var u=vm(s.nativeEvent);if(u===null){u=s.nativeEvent;var f=new u.constructor(u.type,u);Wr=f,u.target.dispatchEvent(f),Wr=null}else return o=ar(u),o!==null&&yb(o),s.blockedOn=u,!1;o.shift()}return!0}function bb(s,o,u){kd(s)&&u.delete(o)}function gI(){Am=!1,Js!==null&&kd(Js)&&(Js=null),Zs!==null&&kd(Zs)&&(Zs=null),ta!==null&&kd(ta)&&(ta=null),eu.forEach(bb),nu.forEach(bb)}function Bd(s,o){s.blockedOn===o&&(s.blockedOn=null,Am||(Am=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,gI)))}var Fd=null;function Tb(s){Fd!==s&&(Fd=s,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Fd===s&&(Fd=null);for(var o=0;o<s.length;o+=3){var u=s[o],f=s[o+1],y=s[o+2];if(typeof f!="function"){if(Em(f||u)===null)continue;break}var A=ar(u);A!==null&&(s.splice(o,3),o-=3,Eg(A,{pending:!0,data:y,method:u.method,action:f},f,y))}}))}function ru(s){function o(K){return Bd(K,s)}Js!==null&&Bd(Js,s),Zs!==null&&Bd(Zs,s),ta!==null&&Bd(ta,s),eu.forEach(o),nu.forEach(o);for(var u=0;u<ea.length;u++){var f=ea[u];f.blockedOn===s&&(f.blockedOn=null)}for(;0<ea.length&&(u=ea[0],u.blockedOn===null);)Ab(u),u.blockedOn===null&&ea.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var y=u[f],A=u[f+1],x=y[en]||null;if(typeof A=="function")x||Tb(u);else if(x){var B=null;if(A&&A.hasAttribute("formAction")){if(y=A,x=A[en]||null)B=x.formAction;else if(Em(y)!==null)continue}else B=x.action;typeof B=="function"?u[f+1]=B:(u.splice(f,3),f-=3),Tb(u)}}}function bm(s){this._internalRoot=s}Ud.prototype.render=bm.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(n(409));var u=o.current,f=Ai();gb(u,f,s,o,null,null)},Ud.prototype.unmount=bm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;gb(s.current,2,null,s,null,null),Ad(),o[Ri]=null}};function Ud(s){this._internalRoot=s}Ud.prototype.unstable_scheduleHydration=function(s){if(s){var o=Ds();s={blockedOn:null,target:s,priority:o};for(var u=0;u<ea.length&&o!==0&&o<ea[u].priority;u++);ea.splice(u,0,s),u===0&&Ab(s)}};var _b=t.version;if(_b!=="19.1.1")throw Error(n(527,_b,"19.1.1"));Z.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=h(o),s=s!==null?d(s):null,s=s===null?null:s.stateNode,s};var mI={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vd.isDisabled&&Vd.supportsFiber)try{Me=Vd.inject(mI),L=Vd}catch{}}return au.createRoot=function(s,o){if(!i(s))throw Error(n(299));var u=!1,f="",y=UE,A=VE,x=jE,B=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(A=o.onCaughtError),o.onRecoverableError!==void 0&&(x=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(B=o.unstable_transitionCallbacks)),o=fb(s,1,!1,null,null,u,f,y,A,x,B,null),s[Ri]=o.current,im(s),new bm(o)},au.hydrateRoot=function(s,o,u){if(!i(s))throw Error(n(299));var f=!1,y="",A=UE,x=VE,B=jE,K=null,rt=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(A=u.onUncaughtError),u.onCaughtError!==void 0&&(x=u.onCaughtError),u.onRecoverableError!==void 0&&(B=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(K=u.unstable_transitionCallbacks),u.formState!==void 0&&(rt=u.formState)),o=fb(s,1,!0,o,u??null,f,y,A,x,B,K,rt),o.context=pb(null),u=o.current,f=Ai(),f=xs(f),y=Fs(f),y.callback=null,Us(u,y,f),u=f,o.current.lanes=u,Hr(o,u),Ar(o),s[Ri]=o.current,im(s),new Ud(o)},au.version="19.1.1",au}var Lb;function RI(){if(Lb)return Sm.exports;Lb=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),Sm.exports=SI(),Sm.exports}var CI=RI();/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var kb="popstate";function II(r={}){function t(n,i){let{pathname:a,search:l,hash:c}=n.location;return ty("",{pathname:a,search:l,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function e(n,i){return typeof i=="string"?i:Lu(i)}return DI(t,e,null,r)}function Ue(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function ir(r,t){if(!r){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function xI(){return Math.random().toString(36).substring(2,10)}function Bb(r,t){return{usr:r.state,key:r.key,idx:t}}function ty(r,t,e=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof t=="string"?Yl(t):t,state:e,key:t&&t.key||n||xI()}}function Lu({pathname:r="/",search:t="",hash:e=""}){return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(r+=e.charAt(0)==="#"?e:"#"+e),r}function Yl(r){let t={};if(r){let e=r.indexOf("#");e>=0&&(t.hash=r.substring(e),r=r.substring(0,e));let n=r.indexOf("?");n>=0&&(t.search=r.substring(n),r=r.substring(0,n)),r&&(t.pathname=r)}return t}function DI(r,t,e,n={}){let{window:i=document.defaultView,v5Compat:a=!1}=n,l=i.history,c="POP",h=null,d=p();d==null&&(d=0,l.replaceState({...l.state,idx:d},""));function p(){return(l.state||{idx:null}).idx}function m(){c="POP";let S=p(),C=S==null?null:S-d;d=S,h&&h({action:c,location:T.location,delta:C})}function v(S,C){c="PUSH";let D=ty(T.location,S,C);d=p()+1;let O=Bb(D,d),F=T.createHref(D);try{l.pushState(O,"",F)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;i.location.assign(F)}a&&h&&h({action:c,location:T.location,delta:1})}function E(S,C){c="REPLACE";let D=ty(T.location,S,C);d=p();let O=Bb(D,d),F=T.createHref(D);l.replaceState(O,"",F),a&&h&&h({action:c,location:T.location,delta:0})}function b(S){return OI(S)}let T={get action(){return c},get location(){return r(i,l)},listen(S){if(h)throw new Error("A history only accepts one active listener");return i.addEventListener(kb,m),h=S,()=>{i.removeEventListener(kb,m),h=null}},createHref(S){return t(i,S)},createURL:b,encodeLocation(S){let C=b(S);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:v,replace:E,go(S){return l.go(S)}};return T}function OI(r,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),Ue(e,"No window.location.(origin|href) available to create URL");let n=typeof r=="string"?r:Lu(r);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=e+n),new URL(n,e)}function hw(r,t,e="/"){return NI(r,t,e,!1)}function NI(r,t,e,n){let i=typeof t=="string"?Yl(t):t,a=bs(i.pathname||"/",e);if(a==null)return null;let l=dw(r);PI(l);let c=null;for(let h=0;c==null&&h<l.length;++h){let d=GI(a);c=HI(l[h],d,n)}return c}function dw(r,t=[],e=[],n="",i=!1){let a=(l,c,h=i,d)=>{let p={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(n)&&h)return;Ue(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length)}let m=vs([n,p.relativePath]),v=e.concat(p);l.children&&l.children.length>0&&(Ue(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),dw(l.children,t,v,m,h)),!(l.path==null&&!l.index)&&t.push({path:m,score:VI(m,l.index),routesMeta:v})};return r.forEach((l,c)=>{if(l.path===""||!l.path?.includes("?"))a(l,c);else for(let h of fw(l.path))a(l,c,!0,h)}),t}function fw(r){let t=r.split("/");if(t.length===0)return[];let[e,...n]=t,i=e.endsWith("?"),a=e.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let l=fw(n.join("/")),c=[];return c.push(...l.map(h=>h===""?a:[a,h].join("/"))),i&&c.push(...l),c.map(h=>r.startsWith("/")&&h===""?"/":h)}function PI(r){r.sort((t,e)=>t.score!==e.score?e.score-t.score:jI(t.routesMeta.map(n=>n.childrenIndex),e.routesMeta.map(n=>n.childrenIndex)))}var MI=/^:[\w-]+$/,LI=3,kI=2,BI=1,FI=10,UI=-2,Fb=r=>r==="*";function VI(r,t){let e=r.split("/"),n=e.length;return e.some(Fb)&&(n+=UI),t&&(n+=kI),e.filter(i=>!Fb(i)).reduce((i,a)=>i+(MI.test(a)?LI:a===""?BI:FI),n)}function jI(r,t){return r.length===t.length&&r.slice(0,-1).every((n,i)=>n===t[i])?r[r.length-1]-t[t.length-1]:0}function HI(r,t,e=!1){let{routesMeta:n}=r,i={},a="/",l=[];for(let c=0;c<n.length;++c){let h=n[c],d=c===n.length-1,p=a==="/"?t:t.slice(a.length)||"/",m=wf({path:h.relativePath,caseSensitive:h.caseSensitive,end:d},p),v=h.route;if(!m&&d&&e&&!n[n.length-1].route.index&&(m=wf({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!m)return null;Object.assign(i,m.params),l.push({params:i,pathname:vs([a,m.pathname]),pathnameBase:KI(vs([a,m.pathnameBase])),route:v}),m.pathnameBase!=="/"&&(a=vs([a,m.pathnameBase]))}return l}function wf(r,t){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[e,n]=zI(r.path,r.caseSensitive,r.end),i=t.match(e);if(!i)return null;let a=i[0],l=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:n.reduce((d,{paramName:p,isOptional:m},v)=>{if(p==="*"){let b=c[v]||"";l=a.slice(0,a.length-b.length).replace(/(.)\/+$/,"$1")}const E=c[v];return m&&!E?d[p]=void 0:d[p]=(E||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:l,pattern:r}}function zI(r,t=!1,e=!0){ir(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],i="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,h)=>(n.push({paramName:c,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(n.push({paramName:"*"}),i+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?i+="\\/*$":r!==""&&r!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function GI(r){try{return r.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ir(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),r}}function bs(r,t){if(t==="/")return r;if(!r.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,n=r.charAt(e);return n&&n!=="/"?null:r.slice(e)||"/"}function $I(r,t="/"){let{pathname:e,search:n="",hash:i=""}=typeof r=="string"?Yl(r):r;return{pathname:e?e.startsWith("/")?e:YI(e,t):t,search:XI(n),hash:qI(i)}}function YI(r,t){let e=t.replace(/\/+$/,"").split("/");return r.split("/").forEach(i=>{i===".."?e.length>1&&e.pop():i!=="."&&e.push(i)}),e.length>1?e.join("/"):"/"}function xm(r,t,e,n){return`Cannot include a '${r}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function WI(r){return r.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function zy(r){let t=WI(r);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function Gy(r,t,e,n=!1){let i;typeof r=="string"?i=Yl(r):(i={...r},Ue(!i.pathname||!i.pathname.includes("?"),xm("?","pathname","search",i)),Ue(!i.pathname||!i.pathname.includes("#"),xm("#","pathname","hash",i)),Ue(!i.search||!i.search.includes("#"),xm("#","search","hash",i)));let a=r===""||i.pathname==="",l=a?"/":i.pathname,c;if(l==null)c=e;else{let m=t.length-1;if(!n&&l.startsWith("..")){let v=l.split("/");for(;v[0]==="..";)v.shift(),m-=1;i.pathname=v.join("/")}c=m>=0?t[m]:"/"}let h=$I(i,c),d=l&&l!=="/"&&l.endsWith("/"),p=(a||l===".")&&e.endsWith("/");return!h.pathname.endsWith("/")&&(d||p)&&(h.pathname+="/"),h}var vs=r=>r.join("/").replace(/\/\/+/g,"/"),KI=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),XI=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,qI=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function QI(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var pw=["POST","PUT","PATCH","DELETE"];new Set(pw);var JI=["GET",...pw];new Set(JI);var Wl=at.createContext(null);Wl.displayName="DataRouter";var qf=at.createContext(null);qf.displayName="DataRouterState";at.createContext(!1);var gw=at.createContext({isTransitioning:!1});gw.displayName="ViewTransition";var ZI=at.createContext(new Map);ZI.displayName="Fetchers";var tx=at.createContext(null);tx.displayName="Await";var rr=at.createContext(null);rr.displayName="Navigation";var Zu=at.createContext(null);Zu.displayName="Location";var Fr=at.createContext({outlet:null,matches:[],isDataRoute:!1});Fr.displayName="Route";var $y=at.createContext(null);$y.displayName="RouteError";function ex(r,{relative:t}={}){Ue(Kl(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:n}=at.useContext(rr),{hash:i,pathname:a,search:l}=th(r,{relative:t}),c=a;return e!=="/"&&(c=a==="/"?e:vs([e,a])),n.createHref({pathname:c,search:l,hash:i})}function Kl(){return at.useContext(Zu)!=null}function Rs(){return Ue(Kl(),"useLocation() may be used only in the context of a <Router> component."),at.useContext(Zu).location}var mw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function yw(r){at.useContext(rr).static||at.useLayoutEffect(r)}function Xl(){let{isDataRoute:r}=at.useContext(Fr);return r?px():nx()}function nx(){Ue(Kl(),"useNavigate() may be used only in the context of a <Router> component.");let r=at.useContext(Wl),{basename:t,navigator:e}=at.useContext(rr),{matches:n}=at.useContext(Fr),{pathname:i}=Rs(),a=JSON.stringify(zy(n)),l=at.useRef(!1);return yw(()=>{l.current=!0}),at.useCallback((h,d={})=>{if(ir(l.current,mw),!l.current)return;if(typeof h=="number"){e.go(h);return}let p=Gy(h,JSON.parse(a),i,d.relative==="path");r==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:vs([t,p.pathname])),(d.replace?e.replace:e.push)(p,d.state,d)},[t,e,a,i,r])}at.createContext(null);function th(r,{relative:t}={}){let{matches:e}=at.useContext(Fr),{pathname:n}=Rs(),i=JSON.stringify(zy(e));return at.useMemo(()=>Gy(r,JSON.parse(i),n,t==="path"),[r,i,n,t])}function ix(r,t){return vw(r,t)}function vw(r,t,e,n,i){Ue(Kl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=at.useContext(rr),{matches:l}=at.useContext(Fr),c=l[l.length-1],h=c?c.params:{},d=c?c.pathname:"/",p=c?c.pathnameBase:"/",m=c&&c.route;{let D=m&&m.path||"";Ew(d,!m||D.endsWith("*")||D.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${D}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${D}"> to <Route path="${D==="/"?"*":`${D}/*`}">.`)}let v=Rs(),E;if(t){let D=typeof t=="string"?Yl(t):t;Ue(p==="/"||D.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${D.pathname}" was given in the \`location\` prop.`),E=D}else E=v;let b=E.pathname||"/",T=b;if(p!=="/"){let D=p.replace(/^\//,"").split("/");T="/"+b.replace(/^\//,"").split("/").slice(D.length).join("/")}let S=hw(r,{pathname:T});ir(m||S!=null,`No routes matched location "${E.pathname}${E.search}${E.hash}" `),ir(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${E.pathname}${E.search}${E.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let C=lx(S&&S.map(D=>Object.assign({},D,{params:Object.assign({},h,D.params),pathname:vs([p,a.encodeLocation?a.encodeLocation(D.pathname).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?p:vs([p,a.encodeLocation?a.encodeLocation(D.pathnameBase).pathname:D.pathnameBase])})),l,e,n,i);return t&&C?at.createElement(Zu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...E},navigationType:"POP"}},C):C}function rx(){let r=fx(),t=QI(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),e=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",r),l=at.createElement(at.Fragment,null,at.createElement("p",null," Hey developer "),at.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",at.createElement("code",{style:a},"ErrorBoundary")," or"," ",at.createElement("code",{style:a},"errorElement")," prop on your route.")),at.createElement(at.Fragment,null,at.createElement("h2",null,"Unexpected Application Error!"),at.createElement("h3",{style:{fontStyle:"italic"}},t),e?at.createElement("pre",{style:i},e):null,l)}var sx=at.createElement(rx,null),ax=class extends at.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,t){return t.location!==r.location||t.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:t.error,location:t.location,revalidation:r.revalidation||t.revalidation}}componentDidCatch(r,t){this.props.unstable_onError?this.props.unstable_onError(r,t):console.error("React Router caught the following error during render",r)}render(){return this.state.error!==void 0?at.createElement(Fr.Provider,{value:this.props.routeContext},at.createElement($y.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ox({routeContext:r,match:t,children:e}){let n=at.useContext(Wl);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),at.createElement(Fr.Provider,{value:r},e)}function lx(r,t=[],e=null,n=null,i=null){if(r==null){if(!e)return null;if(e.errors)r=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)r=e.matches;else return null}let a=r,l=e?.errors;if(l!=null){let d=a.findIndex(p=>p.route.id&&l?.[p.route.id]!==void 0);Ue(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,d+1))}let c=!1,h=-1;if(e)for(let d=0;d<a.length;d++){let p=a[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=d),p.route.id){let{loaderData:m,errors:v}=e,E=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!v||v[p.route.id]===void 0);if(p.route.lazy||E){c=!0,h>=0?a=a.slice(0,h+1):a=[a[0]];break}}}return a.reduceRight((d,p,m)=>{let v,E=!1,b=null,T=null;e&&(v=l&&p.route.id?l[p.route.id]:void 0,b=p.route.errorElement||sx,c&&(h<0&&m===0?(Ew("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),E=!0,T=null):h===m&&(E=!0,T=p.route.hydrateFallbackElement||null)));let S=t.concat(a.slice(0,m+1)),C=()=>{let D;return v?D=b:E?D=T:p.route.Component?D=at.createElement(p.route.Component,null):p.route.element?D=p.route.element:D=d,at.createElement(ox,{match:p,routeContext:{outlet:d,matches:S,isDataRoute:e!=null},children:D})};return e&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?at.createElement(ax,{location:e.location,revalidation:e.revalidation,component:b,error:v,children:C(),routeContext:{outlet:null,matches:S,isDataRoute:!0},unstable_onError:n}):C()},null)}function Yy(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function cx(r){let t=at.useContext(Wl);return Ue(t,Yy(r)),t}function ux(r){let t=at.useContext(qf);return Ue(t,Yy(r)),t}function hx(r){let t=at.useContext(Fr);return Ue(t,Yy(r)),t}function Wy(r){let t=hx(r),e=t.matches[t.matches.length-1];return Ue(e.route.id,`${r} can only be used on routes that contain a unique "id"`),e.route.id}function dx(){return Wy("useRouteId")}function fx(){let r=at.useContext($y),t=ux("useRouteError"),e=Wy("useRouteError");return r!==void 0?r:t.errors?.[e]}function px(){let{router:r}=cx("useNavigate"),t=Wy("useNavigate"),e=at.useRef(!1);return yw(()=>{e.current=!0}),at.useCallback(async(i,a={})=>{ir(e.current,mw),e.current&&(typeof i=="number"?r.navigate(i):await r.navigate(i,{fromRouteId:t,...a}))},[r,t])}var Ub={};function Ew(r,t,e){!t&&!Ub[r]&&(Ub[r]=!0,ir(!1,e))}at.memo(gx);function gx({routes:r,future:t,state:e,unstable_onError:n}){return vw(r,void 0,e,n,t)}function mx({to:r,replace:t,state:e,relative:n}){Ue(Kl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=at.useContext(rr);ir(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=at.useContext(Fr),{pathname:l}=Rs(),c=Xl(),h=Gy(r,zy(a),l,n==="path"),d=JSON.stringify(h);return at.useEffect(()=>{c(JSON.parse(d),{replace:t,state:e,relative:n})},[c,d,n,t,e]),null}function Tl(r){Ue(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function yx({basename:r="/",children:t=null,location:e,navigationType:n="POP",navigator:i,static:a=!1}){Ue(!Kl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=r.replace(/^\/*/,"/"),c=at.useMemo(()=>({basename:l,navigator:i,static:a,future:{}}),[l,i,a]);typeof e=="string"&&(e=Yl(e));let{pathname:h="/",search:d="",hash:p="",state:m=null,key:v="default"}=e,E=at.useMemo(()=>{let b=bs(h,l);return b==null?null:{location:{pathname:b,search:d,hash:p,state:m,key:v},navigationType:n}},[l,h,d,p,m,v,n]);return ir(E!=null,`<Router basename="${l}"> is not able to match the URL "${h}${d}${p}" because it does not start with the basename, so the <Router> won't render anything.`),E==null?null:at.createElement(rr.Provider,{value:c},at.createElement(Zu.Provider,{children:t,value:E}))}function vx({children:r,location:t}){return ix(ey(r),t)}function ey(r,t=[]){let e=[];return at.Children.forEach(r,(n,i)=>{if(!at.isValidElement(n))return;let a=[...t,i];if(n.type===at.Fragment){e.push.apply(e,ey(n.props.children,a));return}Ue(n.type===Tl,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ue(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=ey(n.props.children,a)),e.push(l)}),e}var lf="get",cf="application/x-www-form-urlencoded";function Qf(r){return r!=null&&typeof r.tagName=="string"}function Ex(r){return Qf(r)&&r.tagName.toLowerCase()==="button"}function Ax(r){return Qf(r)&&r.tagName.toLowerCase()==="form"}function bx(r){return Qf(r)&&r.tagName.toLowerCase()==="input"}function Tx(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function _x(r,t){return r.button===0&&(!t||t==="_self")&&!Tx(r)}var jd=null;function wx(){if(jd===null)try{new FormData(document.createElement("form"),0),jd=!1}catch{jd=!0}return jd}var Sx=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Dm(r){return r!=null&&!Sx.has(r)?(ir(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${cf}"`),null):r}function Rx(r,t){let e,n,i,a,l;if(Ax(r)){let c=r.getAttribute("action");n=c?bs(c,t):null,e=r.getAttribute("method")||lf,i=Dm(r.getAttribute("enctype"))||cf,a=new FormData(r)}else if(Ex(r)||bx(r)&&(r.type==="submit"||r.type==="image")){let c=r.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=r.getAttribute("formaction")||c.getAttribute("action");if(n=h?bs(h,t):null,e=r.getAttribute("formmethod")||c.getAttribute("method")||lf,i=Dm(r.getAttribute("formenctype"))||Dm(c.getAttribute("enctype"))||cf,a=new FormData(c,r),!wx()){let{name:d,type:p,value:m}=r;if(p==="image"){let v=d?`${d}.`:"";a.append(`${v}x`,"0"),a.append(`${v}y`,"0")}else d&&a.append(d,m)}}else{if(Qf(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=lf,n=null,i=cf,l=r}return a&&i==="text/plain"&&(l=a,a=void 0),{action:n,method:e.toLowerCase(),encType:i,formData:a,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ky(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function Cx(r,t,e){let n=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return n.pathname==="/"?n.pathname=`_root.${e}`:t&&bs(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${e}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${e}`,n}async function Ix(r,t){if(r.id in t)return t[r.id];try{let e=await import(r.module);return t[r.id]=e,e}catch(e){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function xx(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function Dx(r,t,e){let n=await Promise.all(r.map(async i=>{let a=t.routes[i.route.id];if(a){let l=await Ix(a,e);return l.links?l.links():[]}return[]}));return Mx(n.flat(1).filter(xx).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function Vb(r,t,e,n,i,a){let l=(h,d)=>e[d]?h.route.id!==e[d].route.id:!0,c=(h,d)=>e[d].pathname!==h.pathname||e[d].route.path?.endsWith("*")&&e[d].params["*"]!==h.params["*"];return a==="assets"?t.filter((h,d)=>l(h,d)||c(h,d)):a==="data"?t.filter((h,d)=>{let p=n.routes[h.route.id];if(!p||!p.hasLoader)return!1;if(l(h,d)||c(h,d))return!0;if(h.route.shouldRevalidate){let m=h.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function Ox(r,t,{includeHydrateFallback:e}={}){return Nx(r.map(n=>{let i=t.routes[n.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),e&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function Nx(r){return[...new Set(r)]}function Px(r){let t={},e=Object.keys(r).sort();for(let n of e)t[n]=r[n];return t}function Mx(r,t){let e=new Set;return new Set(t),r.reduce((n,i)=>{let a=JSON.stringify(Px(i));return e.has(a)||(e.add(a),n.push({key:a,link:i})),n},[])}function Aw(){let r=at.useContext(Wl);return Ky(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function Lx(){let r=at.useContext(qf);return Ky(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var Xy=at.createContext(void 0);Xy.displayName="FrameworkContext";function bw(){let r=at.useContext(Xy);return Ky(r,"You must render this element inside a <HydratedRouter> element"),r}function kx(r,t){let e=at.useContext(Xy),[n,i]=at.useState(!1),[a,l]=at.useState(!1),{onFocus:c,onBlur:h,onMouseEnter:d,onMouseLeave:p,onTouchStart:m}=t,v=at.useRef(null);at.useEffect(()=>{if(r==="render"&&l(!0),r==="viewport"){let T=C=>{C.forEach(D=>{l(D.isIntersecting)})},S=new IntersectionObserver(T,{threshold:.5});return v.current&&S.observe(v.current),()=>{S.disconnect()}}},[r]),at.useEffect(()=>{if(n){let T=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(T)}}},[n]);let E=()=>{i(!0)},b=()=>{i(!1),l(!1)};return e?r!=="intent"?[a,v,{}]:[a,v,{onFocus:ou(c,E),onBlur:ou(h,b),onMouseEnter:ou(d,E),onMouseLeave:ou(p,b),onTouchStart:ou(m,E)}]:[!1,v,{}]}function ou(r,t){return e=>{r&&r(e),e.defaultPrevented||t(e)}}function Bx({page:r,...t}){let{router:e}=Aw(),n=at.useMemo(()=>hw(e.routes,r,e.basename),[e.routes,r,e.basename]);return n?at.createElement(Ux,{page:r,matches:n,...t}):null}function Fx(r){let{manifest:t,routeModules:e}=bw(),[n,i]=at.useState([]);return at.useEffect(()=>{let a=!1;return Dx(r,t,e).then(l=>{a||i(l)}),()=>{a=!0}},[r,t,e]),n}function Ux({page:r,matches:t,...e}){let n=Rs(),{manifest:i,routeModules:a}=bw(),{basename:l}=Aw(),{loaderData:c,matches:h}=Lx(),d=at.useMemo(()=>Vb(r,t,h,i,n,"data"),[r,t,h,i,n]),p=at.useMemo(()=>Vb(r,t,h,i,n,"assets"),[r,t,h,i,n]),m=at.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let b=new Set,T=!1;if(t.forEach(C=>{let D=i.routes[C.route.id];!D||!D.hasLoader||(!d.some(O=>O.route.id===C.route.id)&&C.route.id in c&&a[C.route.id]?.shouldRevalidate||D.hasClientLoader?T=!0:b.add(C.route.id))}),b.size===0)return[];let S=Cx(r,l,"data");return T&&b.size>0&&S.searchParams.set("_routes",t.filter(C=>b.has(C.route.id)).map(C=>C.route.id).join(",")),[S.pathname+S.search]},[l,c,n,i,d,t,r,a]),v=at.useMemo(()=>Ox(p,i),[p,i]),E=Fx(p);return at.createElement(at.Fragment,null,m.map(b=>at.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...e})),v.map(b=>at.createElement("link",{key:b,rel:"modulepreload",href:b,...e})),E.map(({key:b,link:T})=>at.createElement("link",{key:b,nonce:e.nonce,...T})))}function Vx(...r){return t=>{r.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var Tw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Tw&&(window.__reactRouterVersion="7.8.2")}catch{}function _w({basename:r,children:t,window:e}){let n=at.useRef();n.current==null&&(n.current=II({window:e,v5Compat:!0}));let i=n.current,[a,l]=at.useState({action:i.action,location:i.location}),c=at.useCallback(h=>{at.startTransition(()=>l(h))},[l]);return at.useLayoutEffect(()=>i.listen(c),[i,c]),at.createElement(yx,{basename:r,children:t,location:a.location,navigationType:a.action,navigator:i})}var ww=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wu=at.forwardRef(function({onClick:t,discover:e="render",prefetch:n="none",relative:i,reloadDocument:a,replace:l,state:c,target:h,to:d,preventScrollReset:p,viewTransition:m,...v},E){let{basename:b}=at.useContext(rr),T=typeof d=="string"&&ww.test(d),S,C=!1;if(typeof d=="string"&&T&&(S=d,Tw))try{let M=new URL(window.location.href),V=d.startsWith("//")?new URL(M.protocol+d):new URL(d),H=bs(V.pathname,b);V.origin===M.origin&&H!=null?d=H+V.search+V.hash:C=!0}catch{ir(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let D=ex(d,{relative:i}),[O,F,k]=kx(n,v),z=Gx(d,{replace:l,state:c,target:h,preventScrollReset:p,relative:i,viewTransition:m});function P(M){t&&t(M),M.defaultPrevented||z(M)}let N=at.createElement("a",{...v,...k,href:S||D,onClick:C||a?t:P,ref:Vx(E,F),target:h,"data-discover":!T&&e==="render"?"true":void 0});return O&&!T?at.createElement(at.Fragment,null,N,at.createElement(Bx,{page:D})):N});wu.displayName="Link";var jx=at.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:n="",end:i=!1,style:a,to:l,viewTransition:c,children:h,...d},p){let m=th(l,{relative:d.relative}),v=Rs(),E=at.useContext(qf),{navigator:b,basename:T}=at.useContext(rr),S=E!=null&&Xx(m)&&c===!0,C=b.encodeLocation?b.encodeLocation(m).pathname:m.pathname,D=v.pathname,O=E&&E.navigation&&E.navigation.location?E.navigation.location.pathname:null;e||(D=D.toLowerCase(),O=O?O.toLowerCase():null,C=C.toLowerCase()),O&&T&&(O=bs(O,T)||O);const F=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let k=D===C||!i&&D.startsWith(C)&&D.charAt(F)==="/",z=O!=null&&(O===C||!i&&O.startsWith(C)&&O.charAt(C.length)==="/"),P={isActive:k,isPending:z,isTransitioning:S},N=k?t:void 0,M;typeof n=="function"?M=n(P):M=[n,k?"active":null,z?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let V=typeof a=="function"?a(P):a;return at.createElement(wu,{...d,"aria-current":N,className:M,ref:p,style:V,to:l,viewTransition:c},typeof h=="function"?h(P):h)});jx.displayName="NavLink";var Hx=at.forwardRef(({discover:r="render",fetcherKey:t,navigate:e,reloadDocument:n,replace:i,state:a,method:l=lf,action:c,onSubmit:h,relative:d,preventScrollReset:p,viewTransition:m,...v},E)=>{let b=Wx(),T=Kx(c,{relative:d}),S=l.toLowerCase()==="get"?"get":"post",C=typeof c=="string"&&ww.test(c),D=O=>{if(h&&h(O),O.defaultPrevented)return;O.preventDefault();let F=O.nativeEvent.submitter,k=F?.getAttribute("formmethod")||l;b(F||O.currentTarget,{fetcherKey:t,method:k,navigate:e,replace:i,state:a,relative:d,preventScrollReset:p,viewTransition:m})};return at.createElement("form",{ref:E,method:S,action:T,onSubmit:n?h:D,...v,"data-discover":!C&&r==="render"?"true":void 0})});Hx.displayName="Form";function zx(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Sw(r){let t=at.useContext(Wl);return Ue(t,zx(r)),t}function Gx(r,{target:t,replace:e,state:n,preventScrollReset:i,relative:a,viewTransition:l}={}){let c=Xl(),h=Rs(),d=th(r,{relative:a});return at.useCallback(p=>{if(_x(p,t)){p.preventDefault();let m=e!==void 0?e:Lu(h)===Lu(d);c(r,{replace:m,state:n,preventScrollReset:i,relative:a,viewTransition:l})}},[h,c,d,e,n,t,r,i,a,l])}var $x=0,Yx=()=>`__${String(++$x)}__`;function Wx(){let{router:r}=Sw("useSubmit"),{basename:t}=at.useContext(rr),e=dx();return at.useCallback(async(n,i={})=>{let{action:a,method:l,encType:c,formData:h,body:d}=Rx(n,t);if(i.navigate===!1){let p=i.fetcherKey||Yx();await r.fetch(p,e,i.action||a,{preventScrollReset:i.preventScrollReset,formData:h,body:d,formMethod:i.method||l,formEncType:i.encType||c,flushSync:i.flushSync})}else await r.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:h,body:d,formMethod:i.method||l,formEncType:i.encType||c,replace:i.replace,state:i.state,fromRouteId:e,flushSync:i.flushSync,viewTransition:i.viewTransition})},[r,t,e])}function Kx(r,{relative:t}={}){let{basename:e}=at.useContext(rr),n=at.useContext(Fr);Ue(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),a={...th(r||".",{relative:t})},l=Rs();if(r==null){a.search=l.search;let c=new URLSearchParams(a.search),h=c.getAll("index");if(h.some(p=>p==="")){c.delete("index"),h.filter(m=>m).forEach(m=>c.append("index",m));let p=c.toString();a.search=p?`?${p}`:""}}return(!r||r===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(a.pathname=a.pathname==="/"?e:vs([e,a.pathname])),Lu(a)}function Xx(r,{relative:t}={}){let e=at.useContext(gw);Ue(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Sw("useViewTransitionState"),i=th(r,{relative:t});if(!e.isTransitioning)return!1;let a=bs(e.currentLocation.pathname,n)||e.currentLocation.pathname,l=bs(e.nextLocation.pathname,n)||e.nextLocation.pathname;return wf(i.pathname,l)!=null||wf(i.pathname,a)!=null}const qx="/AuthentiDoc/assets/logo-BO3XLrPh.png",Qx=()=>{};var jb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw=function(r){const t=[];let e=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=i&63|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=i&63|128)}return t},Jx=function(r){const t=[];let e=0,n=0;for(;e<r.length;){const i=r[e++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=r[e++];t[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=r[e++],l=r[e++],c=r[e++],h=((i&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536;t[n++]=String.fromCharCode(55296+(h>>10)),t[n++]=String.fromCharCode(56320+(h&1023))}else{const a=r[e++],l=r[e++];t[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|l&63)}}return t.join("")},Cw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,t){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const a=r[i],l=i+1<r.length,c=l?r[i+1]:0,h=i+2<r.length,d=h?r[i+2]:0,p=a>>2,m=(a&3)<<4|c>>4;let v=(c&15)<<2|d>>6,E=d&63;h||(E=64,l||(v=64)),n.push(e[p],e[m],e[v],e[E])}return n.join("")},encodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(r):this.encodeByteArray(Rw(r),t)},decodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(r):Jx(this.decodeStringToByteArray(r,t))},decodeStringToByteArray(r,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const a=e[r.charAt(i++)],c=i<r.length?e[r.charAt(i)]:0;++i;const d=i<r.length?e[r.charAt(i)]:64;++i;const m=i<r.length?e[r.charAt(i)]:64;if(++i,a==null||c==null||d==null||m==null)throw new Zx;const v=a<<2|c>>4;if(n.push(v),d!==64){const E=c<<4&240|d>>2;if(n.push(E),m!==64){const b=d<<6&192|m;n.push(b)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class Zx extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const tD=function(r){const t=Rw(r);return Cw.encodeByteArray(t,!0)},Sf=function(r){return tD(r).replace(/\./g,"")},Iw=function(r){try{return Cw.decodeString(r,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nD=()=>eD().__FIREBASE_DEFAULTS__,iD=()=>{if(typeof process>"u"||typeof jb>"u")return;const r=jb.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},rD=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=r&&Iw(r[1]);return t&&JSON.parse(t)},Jf=()=>{try{return Qx()||nD()||iD()||rD()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},xw=r=>Jf()?.emulatorHosts?.[r],Dw=r=>{const t=xw(r);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),n]:[t.substring(0,e),n]},Ow=()=>Jf()?.config,Nw=r=>Jf()?.[`_${r}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ra(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function qy(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(r,t){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},n=t||"demo-project",i=r.iat||0,a=r.sub||r.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...r};return[Sf(JSON.stringify(e)),Sf(JSON.stringify(l)),""].join(".")}const Su={};function aD(){const r={prod:[],emulator:[]};for(const t of Object.keys(Su))Su[t]?r.emulator.push(t):r.prod.push(t);return r}function oD(r){let t=document.getElementById(r),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",r),e=!0),{created:e,element:t}}let Hb=!1;function Qy(r,t){if(typeof window>"u"||typeof document>"u"||!Ra(window.location.host)||Su[r]===t||Su[r]||Hb)return;Su[r]=t;function e(v){return`__firebase__banner__${v}`}const n="__firebase__banner",a=aD().prod.length>0;function l(){const v=document.getElementById(n);v&&v.remove()}function c(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function h(v,E){v.setAttribute("width","24"),v.setAttribute("id",E),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function d(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{Hb=!0,l()},v}function p(v,E){v.setAttribute("id",E),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function m(){const v=oD(n),E=e("text"),b=document.getElementById(E)||document.createElement("span"),T=e("learnmore"),S=document.getElementById(T)||document.createElement("a"),C=e("preprendIcon"),D=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const O=v.element;c(O),p(S,T);const F=d();h(D,C),O.append(D,b,S,F),document.body.appendChild(O)}a?(b.innerText="Preview backend disconnected.",D.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(D.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function lD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Yn())}function cD(){const r=Jf()?.forceEnvironment;if(r==="node")return!0;if(r==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function uD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function hD(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function dD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function fD(){const r=Yn();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function pD(){return!cD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function gD(){try{return typeof indexedDB=="object"}catch{return!1}}function mD(){return new Promise((r,t)=>{try{let e=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD="FirebaseError";class Ur extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name=yD,Object.setPrototypeOf(this,Ur.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,eh.prototype.create)}}class eh{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,a=this.errors[t],l=a?vD(a,n):"Error",c=`${this.serviceName}: ${l} (${i}).`;return new Ur(i,c,n)}}function vD(r,t){return r.replace(ED,(e,n)=>{const i=t[n];return i!=null?String(i):`<${n}?>`})}const ED=/\{\$([^}]+)}/g;function AD(r){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t))return!1;return!0}function po(r,t){if(r===t)return!0;const e=Object.keys(r),n=Object.keys(t);for(const i of e){if(!n.includes(i))return!1;const a=r[i],l=t[i];if(zb(a)&&zb(l)){if(!po(a,l))return!1}else if(a!==l)return!1}for(const i of n)if(!e.includes(i))return!1;return!0}function zb(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nh(r){const t=[];for(const[e,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function pu(r){const t={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");t[decodeURIComponent(i)]=decodeURIComponent(a)}}),t}function gu(r){const t=r.indexOf("?");if(!t)return"";const e=r.indexOf("#",t);return r.substring(t,e>0?e:void 0)}function bD(r,t){const e=new TD(r,t);return e.subscribe.bind(e)}class TD{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,n){let i;if(t===void 0&&e===void 0&&n===void 0)throw new Error("Missing Observer.");_D(t,["next","error","complete"])?i=t:i={next:t,error:e,complete:n},i.next===void 0&&(i.next=Om),i.error===void 0&&(i.error=Om),i.complete===void 0&&(i.complete=Om);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function _D(r,t){if(typeof r!="object"||r===null)return!1;for(const e of t)if(e in r&&typeof r[e]=="function")return!0;return!1}function Om(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(r){return r&&r._delegate?r._delegate:r}class ya{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const n=new sD;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),n=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(RD(t))try{this.getOrInitializeService({instanceIdentifier:io})}catch{}for(const[e,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(t=io){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=io){return this.instances.has(t)}getOptions(t=io){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[a,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);n===c&&l.resolve(i)}return i}onInit(t,e){const n=this.normalizeInstanceIdentifier(e),i=this.onInitCallbacks.get(n)??new Set;i.add(t),this.onInitCallbacks.set(n,i);const a=this.instances.get(n);return a&&t(a,n),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:SD(t),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=io){return this.component?this.component.multipleInstances?t:io:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function SD(r){return r===io?void 0:r}function RD(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new wD(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var se;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(se||(se={}));const ID={debug:se.DEBUG,verbose:se.VERBOSE,info:se.INFO,warn:se.WARN,error:se.ERROR,silent:se.SILENT},xD=se.INFO,DD={[se.DEBUG]:"log",[se.VERBOSE]:"log",[se.INFO]:"info",[se.WARN]:"warn",[se.ERROR]:"error"},OD=(r,t,...e)=>{if(t<r.logLevel)return;const n=new Date().toISOString(),i=DD[t];if(i)console[i](`[${n}]  ${r.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Jy{constructor(t){this.name=t,this._logLevel=xD,this._logHandler=OD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in se))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?ID[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,se.DEBUG,...t),this._logHandler(this,se.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,se.VERBOSE,...t),this._logHandler(this,se.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,se.INFO,...t),this._logHandler(this,se.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,se.WARN,...t),this._logHandler(this,se.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,se.ERROR,...t),this._logHandler(this,se.ERROR,...t)}}const ND=(r,t)=>t.some(e=>r instanceof e);let Gb,$b;function PD(){return Gb||(Gb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function MD(){return $b||($b=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Mw=new WeakMap,ny=new WeakMap,Lw=new WeakMap,Nm=new WeakMap,Zy=new WeakMap;function LD(r){const t=new Promise((e,n)=>{const i=()=>{r.removeEventListener("success",a),r.removeEventListener("error",l)},a=()=>{e(da(r.result)),i()},l=()=>{n(r.error),i()};r.addEventListener("success",a),r.addEventListener("error",l)});return t.then(e=>{e instanceof IDBCursor&&Mw.set(e,r)}).catch(()=>{}),Zy.set(t,r),t}function kD(r){if(ny.has(r))return;const t=new Promise((e,n)=>{const i=()=>{r.removeEventListener("complete",a),r.removeEventListener("error",l),r.removeEventListener("abort",l)},a=()=>{e(),i()},l=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",a),r.addEventListener("error",l),r.addEventListener("abort",l)});ny.set(r,t)}let iy={get(r,t,e){if(r instanceof IDBTransaction){if(t==="done")return ny.get(r);if(t==="objectStoreNames")return r.objectStoreNames||Lw.get(r);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return da(r[t])},set(r,t,e){return r[t]=e,!0},has(r,t){return r instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in r}};function BD(r){iy=r(iy)}function FD(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const n=r.call(Pm(this),t,...e);return Lw.set(n,t.sort?t.sort():[t]),da(n)}:MD().includes(r)?function(...t){return r.apply(Pm(this),t),da(Mw.get(this))}:function(...t){return da(r.apply(Pm(this),t))}}function UD(r){return typeof r=="function"?FD(r):(r instanceof IDBTransaction&&kD(r),ND(r,PD())?new Proxy(r,iy):r)}function da(r){if(r instanceof IDBRequest)return LD(r);if(Nm.has(r))return Nm.get(r);const t=UD(r);return t!==r&&(Nm.set(r,t),Zy.set(t,r)),t}const Pm=r=>Zy.get(r);function VD(r,t,{blocked:e,upgrade:n,blocking:i,terminated:a}={}){const l=indexedDB.open(r,t),c=da(l);return n&&l.addEventListener("upgradeneeded",h=>{n(da(l.result),h.oldVersion,h.newVersion,da(l.transaction),h)}),e&&l.addEventListener("blocked",h=>e(h.oldVersion,h.newVersion,h)),c.then(h=>{a&&h.addEventListener("close",()=>a()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const jD=["get","getKey","getAll","getAllKeys","count"],HD=["put","add","delete","clear"],Mm=new Map;function Yb(r,t){if(!(r instanceof IDBDatabase&&!(t in r)&&typeof t=="string"))return;if(Mm.get(t))return Mm.get(t);const e=t.replace(/FromIndex$/,""),n=t!==e,i=HD.includes(e);if(!(e in(n?IDBIndex:IDBObjectStore).prototype)||!(i||jD.includes(e)))return;const a=async function(l,...c){const h=this.transaction(l,i?"readwrite":"readonly");let d=h.store;return n&&(d=d.index(c.shift())),(await Promise.all([d[e](...c),i&&h.done]))[0]};return Mm.set(t,a),a}BD(r=>({...r,get:(t,e,n)=>Yb(t,e)||r.get(t,e,n),has:(t,e)=>!!Yb(t,e)||r.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(GD(e)){const n=e.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(e=>e).join(" ")}}function GD(r){return r.getComponent()?.type==="VERSION"}const ry="@firebase/app",Wb="0.14.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts=new Jy("@firebase/app"),$D="@firebase/app-compat",YD="@firebase/analytics-compat",WD="@firebase/analytics",KD="@firebase/app-check-compat",XD="@firebase/app-check",qD="@firebase/auth",QD="@firebase/auth-compat",JD="@firebase/database",ZD="@firebase/data-connect",tO="@firebase/database-compat",eO="@firebase/functions",nO="@firebase/functions-compat",iO="@firebase/installations",rO="@firebase/installations-compat",sO="@firebase/messaging",aO="@firebase/messaging-compat",oO="@firebase/performance",lO="@firebase/performance-compat",cO="@firebase/remote-config",uO="@firebase/remote-config-compat",hO="@firebase/storage",dO="@firebase/storage-compat",fO="@firebase/firestore",pO="@firebase/ai",gO="@firebase/firestore-compat",mO="firebase",yO="12.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sy="[DEFAULT]",vO={[ry]:"fire-core",[$D]:"fire-core-compat",[WD]:"fire-analytics",[YD]:"fire-analytics-compat",[XD]:"fire-app-check",[KD]:"fire-app-check-compat",[qD]:"fire-auth",[QD]:"fire-auth-compat",[JD]:"fire-rtdb",[ZD]:"fire-data-connect",[tO]:"fire-rtdb-compat",[eO]:"fire-fn",[nO]:"fire-fn-compat",[iO]:"fire-iid",[rO]:"fire-iid-compat",[sO]:"fire-fcm",[aO]:"fire-fcm-compat",[oO]:"fire-perf",[lO]:"fire-perf-compat",[cO]:"fire-rc",[uO]:"fire-rc-compat",[hO]:"fire-gcs",[dO]:"fire-gcs-compat",[fO]:"fire-fst",[gO]:"fire-fst-compat",[pO]:"fire-vertex","fire-js":"fire-js",[mO]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf=new Map,EO=new Map,ay=new Map;function Kb(r,t){try{r.container.addComponent(t)}catch(e){Ts.debug(`Component ${t.name} failed to register with FirebaseApp ${r.name}`,e)}}function go(r){const t=r.name;if(ay.has(t))return Ts.debug(`There were multiple attempts to register component ${t}.`),!1;ay.set(t,r);for(const e of Rf.values())Kb(e,r);for(const e of EO.values())Kb(e,r);return!0}function Zf(r,t){const e=r.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),r.container.getProvider(t)}function di(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AO={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fa=new eh("app","Firebase",AO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(t,e,n){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ya("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw fa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo=yO;function kw(r,t={}){let e=r;typeof t!="object"&&(t={name:t});const n={name:sy,automaticDataCollectionEnabled:!0,...t},i=n.name;if(typeof i!="string"||!i)throw fa.create("bad-app-name",{appName:String(i)});if(e||(e=Ow()),!e)throw fa.create("no-options");const a=Rf.get(i);if(a){if(po(e,a.options)&&po(n,a.config))return a;throw fa.create("duplicate-app",{appName:i})}const l=new CD(i);for(const h of ay.values())l.addComponent(h);const c=new bO(e,n,l);return Rf.set(i,c),c}function tv(r=sy){const t=Rf.get(r);if(!t&&r===sy&&Ow())return kw();if(!t)throw fa.create("no-app",{appName:r});return t}function xr(r,t,e){let n=vO[r]??r;e&&(n+=`-${e}`);const i=n.match(/\s|\//),a=t.match(/\s|\//);if(i||a){const l=[`Unable to register library "${n}" with version "${t}":`];i&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Ts.warn(l.join(" "));return}go(new ya(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TO="firebase-heartbeat-database",_O=1,ku="firebase-heartbeat-store";let Lm=null;function Bw(){return Lm||(Lm=VD(TO,_O,{upgrade:(r,t)=>{switch(t){case 0:try{r.createObjectStore(ku)}catch(e){console.warn(e)}}}}).catch(r=>{throw fa.create("idb-open",{originalErrorMessage:r.message})})),Lm}async function wO(r){try{const e=(await Bw()).transaction(ku),n=await e.objectStore(ku).get(Fw(r));return await e.done,n}catch(t){if(t instanceof Ur)Ts.warn(t.message);else{const e=fa.create("idb-get",{originalErrorMessage:t?.message});Ts.warn(e.message)}}}async function Xb(r,t){try{const n=(await Bw()).transaction(ku,"readwrite");await n.objectStore(ku).put(t,Fw(r)),await n.done}catch(e){if(e instanceof Ur)Ts.warn(e.message);else{const n=fa.create("idb-set",{originalErrorMessage:e?.message});Ts.warn(n.message)}}}function Fw(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SO=1024,RO=30;class CO{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new xO(e),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=qb();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:e}),this._heartbeatsCache.heartbeats.length>RO){const i=DO(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){Ts.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=qb(),{heartbeatsToSend:e,unsentEntries:n}=IO(this._heartbeatsCache.heartbeats),i=Sf(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Ts.warn(t),""}}}function qb(){return new Date().toISOString().substring(0,10)}function IO(r,t=SO){const e=[];let n=r.slice();for(const i of r){const a=e.find(l=>l.agent===i.agent);if(a){if(a.dates.push(i.date),Qb(e)>t){a.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),Qb(e)>t){e.pop();break}n=n.slice(1)}return{heartbeatsToSend:e,unsentEntries:n}}class xO{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gD()?mD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await wO(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return Xb(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return Xb(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}else return}}function Qb(r){return Sf(JSON.stringify({version:2,heartbeats:r})).length}function DO(r){if(r.length===0)return-1;let t=0,e=r[0].date;for(let n=1;n<r.length;n++)r[n].date<e&&(e=r[n].date,t=n);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OO(r){go(new ya("platform-logger",t=>new zD(t),"PRIVATE")),go(new ya("heartbeat",t=>new CO(t),"PRIVATE")),xr(ry,Wb,r),xr(ry,Wb,"esm2020"),xr("fire-js","")}OO("");var NO="firebase",PO="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xr(NO,PO,"app");function Uw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const MO=Uw,Vw=new eh("auth","Firebase",Uw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf=new Jy("@firebase/auth");function LO(r,...t){Cf.logLevel<=se.WARN&&Cf.warn(`Auth (${wo}): ${r}`,...t)}function uf(r,...t){Cf.logLevel<=se.ERROR&&Cf.error(`Auth (${wo}): ${r}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gi(r,...t){throw nv(r,...t)}function nr(r,...t){return nv(r,...t)}function ev(r,t,e){const n={...MO(),[t]:e};return new eh("auth","Firebase",n).create(t,{appName:r.name})}function Es(r){return ev(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function kO(r,t,e){const n=e;if(!(t instanceof n))throw n.name!==t.constructor.name&&Gi(r,"argument-error"),ev(r,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function nv(r,...t){if(typeof r!="string"){const e=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(e,...n)}return Vw.create(r,...t)}function jt(r,t,...e){if(!r)throw nv(t,...e)}function ms(r){const t="INTERNAL ASSERTION FAILED: "+r;throw uf(t),new Error(t)}function _s(r,t){r||ms(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oy(){return typeof self<"u"&&self.location?.href||""}function BO(){return Jb()==="http:"||Jb()==="https:"}function Jb(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(BO()||hD()||"connection"in navigator)?navigator.onLine:!0}function UO(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(t,e){this.shortDelay=t,this.longDelay=e,_s(e>t,"Short delay should be less than long delay!"),this.isMobile=lD()||dD()}get(){return FO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iv(r,t){_s(r.emulator,"Emulator should always be set here");const{url:e}=r.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ms("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ms("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ms("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jO=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],HO=new ih(3e4,6e4);function Cs(r,t){return r.tenantId&&!t.tenantId?{...t,tenantId:r.tenantId}:t}async function Is(r,t,e,n,i={}){return Hw(r,i,async()=>{let a={},l={};n&&(t==="GET"?l=n:a={body:JSON.stringify(n)});const c=nh({key:r.config.apiKey,...l}).slice(1),h=await r._getAdditionalHeaders();h["Content-Type"]="application/json",r.languageCode&&(h["X-Firebase-Locale"]=r.languageCode);const d={method:t,headers:h,...a};return uD()||(d.referrerPolicy="no-referrer"),r.emulatorConfig&&Ra(r.emulatorConfig.host)&&(d.credentials="include"),jw.fetch()(await zw(r,r.config.apiHost,e,c),d)})}async function Hw(r,t,e){r._canInitEmulator=!1;const n={...VO,...t};try{const i=new GO(r),a=await Promise.race([e(),i.promise]);i.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw Hd(r,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const c=a.ok?l.errorMessage:l.error.message,[h,d]=c.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hd(r,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw Hd(r,"email-already-in-use",l);if(h==="USER_DISABLED")throw Hd(r,"user-disabled",l);const p=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw ev(r,p,d);Gi(r,p)}}catch(i){if(i instanceof Ur)throw i;Gi(r,"network-request-failed",{message:String(i)})}}async function rh(r,t,e,n,i={}){const a=await Is(r,t,e,n,i);return"mfaPendingCredential"in a&&Gi(r,"multi-factor-auth-required",{_serverResponse:a}),a}async function zw(r,t,e,n){const i=`${t}${e}?${n}`,a=r,l=a.config.emulator?iv(r.config,i):`${r.config.apiScheme}://${i}`;return jO.includes(e)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function zO(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class GO{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,n)=>{this.timer=setTimeout(()=>n(nr(this.auth,"network-request-failed")),HO.get())})}}function Hd(r,t,e){const n={appName:r.name};e.email&&(n.email=e.email),e.phoneNumber&&(n.phoneNumber=e.phoneNumber);const i=nr(r,t,n);return i.customData._tokenResponse=e,i}function Zb(r){return r!==void 0&&r.enterprise!==void 0}class $O{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return zO(e.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function YO(r,t){return Is(r,"GET","/v2/recaptchaConfig",Cs(r,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WO(r,t){return Is(r,"POST","/v1/accounts:delete",t)}async function If(r,t){return Is(r,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ru(r){if(r)try{const t=new Date(Number(r));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function KO(r,t=!1){const e=Ze(r),n=await e.getIdToken(t),i=rv(n);jt(i&&i.exp&&i.auth_time&&i.iat,e.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,l=a?.sign_in_provider;return{claims:i,token:n,authTime:Ru(km(i.auth_time)),issuedAtTime:Ru(km(i.iat)),expirationTime:Ru(km(i.exp)),signInProvider:l||null,signInSecondFactor:a?.sign_in_second_factor||null}}function km(r){return Number(r)*1e3}function rv(r){const[t,e,n]=r.split(".");if(t===void 0||e===void 0||n===void 0)return uf("JWT malformed, contained fewer than 3 sections"),null;try{const i=Iw(e);return i?JSON.parse(i):(uf("Failed to decode base64 JWT payload"),null)}catch(i){return uf("Caught error parsing JWT payload as JSON",i?.toString()),null}}function tT(r){const t=rv(r);return jt(t,"internal-error"),jt(typeof t.exp<"u","internal-error"),jt(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bu(r,t,e=!1){if(e)return t;try{return await t}catch(n){throw n instanceof Ur&&XO(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function XO({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ru(this.lastLoginAt),this.creationTime=Ru(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xf(r){const t=r.auth,e=await r.getIdToken(),n=await Bu(r,If(t,{idToken:e}));jt(n?.users.length,t,"internal-error");const i=n.users[0];r._notifyReloadListener(i);const a=i.providerUserInfo?.length?Gw(i.providerUserInfo):[],l=JO(r.providerData,a),c=r.isAnonymous,h=!(r.email&&i.passwordHash)&&!l?.length,d=c?h:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new ly(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(r,p)}async function QO(r){const t=Ze(r);await xf(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function JO(r,t){return[...r.filter(n=>!t.some(i=>i.providerId===n.providerId)),...t]}function Gw(r){return r.map(({providerId:t,...e})=>({providerId:t,uid:e.rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZO(r,t){const e=await Hw(r,{},async()=>{const n=nh({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:a}=r.config,l=await zw(r,i,"/v1/token",`key=${a}`),c=await r._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:c,body:n};return r.emulatorConfig&&Ra(r.emulatorConfig.host)&&(h.credentials="include"),jw.fetch()(l,h)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function t2(r,t){return Is(r,"POST","/v2/accounts:revokeToken",Cs(r,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){jt(t.idToken,"internal-error"),jt(typeof t.idToken<"u","internal-error"),jt(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):tT(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){jt(t.length!==0,"internal-error");const e=tT(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(jt(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:a}=await ZO(t,e);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:a}=e,l=new Pl;return n&&(jt(typeof n=="string","internal-error",{appName:t}),l.refreshToken=n),i&&(jt(typeof i=="string","internal-error",{appName:t}),l.accessToken=i),a&&(jt(typeof a=="number","internal-error",{appName:t}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Pl,this.toJSON())}_performRefresh(){return ms("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ia(r,t){jt(typeof r=="string"||typeof r>"u","internal-error",{appName:t})}class tr{constructor({uid:t,auth:e,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new qO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=e,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ly(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(t){const e=await Bu(this,this.stsTokenManager.getToken(this.auth,t));return jt(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return KO(this,t)}reload(){return QO(this)}_assign(t){this!==t&&(jt(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>({...e})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new tr({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return e.metadata._copy(this.metadata),e}_onReload(t){jt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await xf(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(di(this.auth.app))return Promise.reject(Es(this.auth));const t=await this.getIdToken();return await Bu(this,WO(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){const n=e.displayName??void 0,i=e.email??void 0,a=e.phoneNumber??void 0,l=e.photoURL??void 0,c=e.tenantId??void 0,h=e._redirectEventId??void 0,d=e.createdAt??void 0,p=e.lastLoginAt??void 0,{uid:m,emailVerified:v,isAnonymous:E,providerData:b,stsTokenManager:T}=e;jt(m&&T,t,"internal-error");const S=Pl.fromJSON(this.name,T);jt(typeof m=="string",t,"internal-error"),ia(n,t.name),ia(i,t.name),jt(typeof v=="boolean",t,"internal-error"),jt(typeof E=="boolean",t,"internal-error"),ia(a,t.name),ia(l,t.name),ia(c,t.name),ia(h,t.name),ia(d,t.name),ia(p,t.name);const C=new tr({uid:m,auth:t,email:i,emailVerified:v,displayName:n,isAnonymous:E,photoURL:l,phoneNumber:a,tenantId:c,stsTokenManager:S,createdAt:d,lastLoginAt:p});return b&&Array.isArray(b)&&(C.providerData=b.map(D=>({...D}))),h&&(C._redirectEventId=h),C}static async _fromIdTokenResponse(t,e,n=!1){const i=new Pl;i.updateFromServerResponse(e);const a=new tr({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await xf(a),a}static async _fromGetAccountInfoResponse(t,e,n){const i=e.users[0];jt(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?Gw(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!a?.length,c=new Pl;c.updateFromIdToken(n);const h=new tr({uid:i.localId,auth:t,stsTokenManager:c,isAnonymous:l}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new ly(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(h,d),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eT=new Map;function ys(r){_s(r instanceof Function,"Expected a class definition");let t=eT.get(r);return t?(_s(t instanceof r,"Instance stored in cache mismatched with class"),t):(t=new r,eT.set(r,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}$w.type="NONE";const nT=$w;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hf(r,t,e){return`firebase:${r}:${t}:${e}`}class Ml{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=hf(this.userKey,i.apiKey,a),this.fullPersistenceKey=hf("persistence",i.apiKey,a),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await If(this.auth,{idToken:t}).catch(()=>{});return e?tr._fromGetAccountInfoResponse(this.auth,e,t):null}return tr._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new Ml(ys(nT),t,n);const i=(await Promise.all(e.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=i[0]||ys(nT);const l=hf(n,t.config.apiKey,t.name);let c=null;for(const d of e)try{const p=await d._get(l);if(p){let m;if(typeof p=="string"){const v=await If(t,{idToken:p}).catch(()=>{});if(!v)break;m=await tr._fromGetAccountInfoResponse(t,v,p)}else m=tr._fromJSON(t,p);d!==a&&(c=m),a=d;break}}catch{}const h=i.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!h.length?new Ml(a,t,n):(a=h[0],c&&await a._set(l,c.toJSON()),await Promise.all(e.map(async d=>{if(d!==a)try{await d._remove(l)}catch{}})),new Ml(a,t,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iT(r){const t=r.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Xw(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Yw(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Qw(t))return"Blackberry";if(Jw(t))return"Webos";if(Ww(t))return"Safari";if((t.includes("chrome/")||Kw(t))&&!t.includes("edge/"))return"Chrome";if(qw(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(e);if(n?.length===2)return n[1]}return"Other"}function Yw(r=Yn()){return/firefox\//i.test(r)}function Ww(r=Yn()){const t=r.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Kw(r=Yn()){return/crios\//i.test(r)}function Xw(r=Yn()){return/iemobile/i.test(r)}function qw(r=Yn()){return/android/i.test(r)}function Qw(r=Yn()){return/blackberry/i.test(r)}function Jw(r=Yn()){return/webos/i.test(r)}function sv(r=Yn()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function e2(r=Yn()){return sv(r)&&!!window.navigator?.standalone}function n2(){return fD()&&document.documentMode===10}function Zw(r=Yn()){return sv(r)||qw(r)||Jw(r)||Qw(r)||/windows phone/i.test(r)||Xw(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tS(r,t=[]){let e;switch(r){case"Browser":e=iT(Yn());break;case"Worker":e=`${iT(Yn())}-${r}`;break;default:e=r}const n=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${wo}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=a=>new Promise((l,c)=>{try{const h=t(a);l(h)}catch(h){c(h)}});n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(n){e.reverse();for(const i of e)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r2(r,t={}){return Is(r,"GET","/v2/passwordPolicy",Cs(r,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2=6;class a2{constructor(t){const e=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=e.minPasswordLength??s2,e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=e.maxPasswordLength),e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=e.containsLowercaseCharacter),e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=e.containsUppercaseCharacter),e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=e.containsNumericCharacter),e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=e.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=t.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const e={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,e),this.validatePasswordCharacterOptions(t,e),e.isValid&&(e.isValid=e.meetsMinPasswordLength??!0),e.isValid&&(e.isValid=e.meetsMaxPasswordLength??!0),e.isValid&&(e.isValid=e.containsLowercaseLetter??!0),e.isValid&&(e.isValid=e.containsUppercaseLetter??!0),e.isValid&&(e.isValid=e.containsNumericCharacter??!0),e.isValid&&(e.isValid=e.containsNonAlphanumericCharacter??!0),e}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let n;for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2{constructor(t,e,n,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rT(this),this.idTokenSubscription=new rT(this),this.beforeStateQueue=new i2(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Vw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=ys(e)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ml.create(this,t),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await If(this,{idToken:t}),n=await tr._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if(di(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let n=e,i=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,l=n?._redirectEventId,c=await this.tryRedirectSignIn(t);(!a||a===l)&&c?.user&&(n=c.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return jt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await xf(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=UO()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(di(this.app))return Promise.reject(Es(this));const e=t?Ze(t):null;return e&&jt(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&jt(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return di(this.app)?Promise.reject(Es(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return di(this.app)?Promise.reject(Es(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ys(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await r2(this),e=new a2(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new eh("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(n.tenantId=this.tenantId),await t2(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return t===null?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&ys(t)||this._popupRedirectResolver;jt(e,this,"argument-error"),this.redirectPersistenceManager=await Ml.create(this,[ys(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===t?this._currentUser:this.redirectUser?._redirectEventId===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=this.currentUser?.uid??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const a=typeof e=="function"?e:e.next.bind(e);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(jt(c,this,"internal-error"),c.then(()=>{l||a(this.currentUser)}),typeof e=="function"){const h=t.addObserver(e,n,i);return()=>{l=!0,h()}}else{const h=t.addObserver(e);return()=>{l=!0,h()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return jt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=tS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const e=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();e&&(t["X-Firebase-Client"]=e);const n=await this._getAppCheckToken();return n&&(t["X-Firebase-AppCheck"]=n),t}async _getAppCheckToken(){if(di(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&LO(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Ca(r){return Ze(r)}class rT{constructor(t){this.auth=t,this.observer=null,this.addObserver=bD(e=>this.observer=e)}get next(){return jt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function l2(r){tp=r}function eS(r){return tp.loadJS(r)}function c2(){return tp.recaptchaEnterpriseScript}function u2(){return tp.gapiScript}function h2(r){return`__${r}${Math.floor(Math.random()*1e6)}`}class d2{constructor(){this.enterprise=new f2}ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}class f2{ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}const p2="recaptcha-enterprise",nS="NO_RECAPTCHA";class g2{constructor(t){this.type=p2,this.auth=Ca(t)}async verify(t="verify",e=!1){async function n(a){if(!e){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,c)=>{YO(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new $O(h);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,l(d.siteKey)}}).catch(h=>{c(h)})})}function i(a,l,c){const h=window.grecaptcha;Zb(h)?h.enterprise.ready(()=>{h.enterprise.execute(a,{action:t}).then(d=>{l(d)}).catch(()=>{l(nS)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new d2().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{n(this.auth).then(c=>{if(!e&&Zb(window.grecaptcha))i(c,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let h=c2();h.length!==0&&(h+=c),eS(h).then(()=>{i(c,a,l)}).catch(d=>{l(d)})}}).catch(c=>{l(c)})})}}async function sT(r,t,e,n=!1,i=!1){const a=new g2(r);let l;if(i)l=nS;else try{l=await a.verify(e)}catch{l=await a.verify(e,!0)}const c={...t};if(e==="mfaSmsEnrollment"||e==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const h=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:d,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const h=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:l}):Object.assign(c,{captchaResponse:l}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function cy(r,t,e,n,i){if(r._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await sT(r,t,e,e==="getOobCode");return n(r,a)}else return n(r,t).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${e} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await sT(r,t,e,e==="getOobCode");return n(r,l)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m2(r,t){const e=Zf(r,"auth");if(e.isInitialized()){const i=e.getImmediate(),a=e.getOptions();if(po(a,t??{}))return i;Gi(i,"already-initialized")}return e.initialize({options:t})}function y2(r,t){const e=t?.persistence||[],n=(Array.isArray(e)?e:[e]).map(ys);t?.errorMap&&r._updateErrorMap(t.errorMap),r._initializeWithPersistence(n,t?.popupRedirectResolver)}function v2(r,t,e){const n=Ca(r);jt(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const i=!1,a=iS(t),{host:l,port:c}=E2(t),h=c===null?"":`:${c}`,d={url:`${a}//${l}${h}/`},p=Object.freeze({host:l,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){jt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),jt(po(d,n.config.emulator)&&po(p,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=p,n.settings.appVerificationDisabledForTesting=!0,Ra(l)?(qy(`${a}//${l}${h}`),Qy("Auth",!0)):A2()}function iS(r){const t=r.indexOf(":");return t<0?"":r.substr(0,t+1)}function E2(r){const t=iS(r),e=/(\/\/)?([^?#/]+)/.exec(r.substr(t.length));if(!e)return{host:"",port:null};const n=e[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:aT(n.substr(a.length+1))}}else{const[a,l]=n.split(":");return{host:a,port:aT(l)}}}function aT(r){if(!r)return null;const t=Number(r);return isNaN(t)?null:t}function A2(){function r(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return ms("not implemented")}_getIdTokenResponse(t){return ms("not implemented")}_linkToIdToken(t,e){return ms("not implemented")}_getReauthenticationResolver(t){return ms("not implemented")}}async function b2(r,t){return Is(r,"POST","/v1/accounts:signUp",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T2(r,t){return rh(r,"POST","/v1/accounts:signInWithPassword",Cs(r,t))}async function _2(r,t){return Is(r,"POST","/v1/accounts:sendOobCode",Cs(r,t))}async function w2(r,t){return _2(r,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S2(r,t){return rh(r,"POST","/v1/accounts:signInWithEmailLink",Cs(r,t))}async function R2(r,t){return rh(r,"POST","/v1/accounts:signInWithEmailLink",Cs(r,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu extends av{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new Fu(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new Fu(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t;if(e?.email&&e?.password){if(e.signInMethod==="password")return this._fromEmailAndPassword(e.email,e.password);if(e.signInMethod==="emailLink")return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const e={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return cy(t,e,"signInWithPassword",T2);case"emailLink":return S2(t,{email:this._email,oobCode:this._password});default:Gi(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":const n={idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return cy(t,n,"signUpPassword",b2);case"emailLink":return R2(t,{idToken:e,email:this._email,oobCode:this._password});default:Gi(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ll(r,t){return rh(r,"POST","/v1/accounts:signInWithIdp",Cs(r,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2="http://localhost";class mo extends av{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new mo(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Gi("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:n,signInMethod:i,...a}=e;if(!n||!i)return null;const l=new mo(n,i);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(t){const e=this.buildRequest();return Ll(t,e)}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,Ll(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Ll(t,e)}buildRequest(){const t={requestUri:C2,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=nh(e)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I2(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function x2(r){const t=pu(gu(r)).link,e=t?pu(gu(t)).deep_link_id:null,n=pu(gu(r)).deep_link_id;return(n?pu(gu(n)).link:null)||n||e||t||r}class ov{constructor(t){const e=pu(gu(t)),n=e.apiKey??null,i=e.oobCode??null,a=I2(e.mode??null);jt(n&&i&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=i,this.continueUrl=e.continueUrl??null,this.languageCode=e.lang??null,this.tenantId=e.tenantId??null}static parseLink(t){const e=x2(t);try{return new ov(e)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(){this.providerId=ql.PROVIDER_ID}static credential(t,e){return Fu._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=ov.parseLink(e);return jt(n,"argument-error"),Fu._fromEmailAndCode(t,n.code,n.tenantId)}}ql.PROVIDER_ID="password";ql.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ql.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh extends lv{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa extends sh{constructor(){super("facebook.com")}static credential(t){return mo._fromParams({providerId:sa.PROVIDER_ID,signInMethod:sa.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return sa.credentialFromTaggedObject(t)}static credentialFromError(t){return sa.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return sa.credential(t.oauthAccessToken)}catch{return null}}}sa.FACEBOOK_SIGN_IN_METHOD="facebook.com";sa.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs extends sh{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return mo._fromParams({providerId:gs.PROVIDER_ID,signInMethod:gs.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return gs.credentialFromTaggedObject(t)}static credentialFromError(t){return gs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return gs.credential(e,n)}catch{return null}}}gs.GOOGLE_SIGN_IN_METHOD="google.com";gs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa extends sh{constructor(){super("github.com")}static credential(t){return mo._fromParams({providerId:aa.PROVIDER_ID,signInMethod:aa.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return aa.credentialFromTaggedObject(t)}static credentialFromError(t){return aa.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return aa.credential(t.oauthAccessToken)}catch{return null}}}aa.GITHUB_SIGN_IN_METHOD="github.com";aa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa extends sh{constructor(){super("twitter.com")}static credential(t,e){return mo._fromParams({providerId:oa.PROVIDER_ID,signInMethod:oa.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return oa.credentialFromTaggedObject(t)}static credentialFromError(t){return oa.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return oa.credential(e,n)}catch{return null}}}oa.TWITTER_SIGN_IN_METHOD="twitter.com";oa.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D2(r,t){return rh(r,"POST","/v1/accounts:signUp",Cs(r,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const a=await tr._fromIdTokenResponse(t,n,i),l=oT(n);return new yo({user:a,providerId:l,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=oT(n);return new yo({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function oT(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df extends Ur{constructor(t,e,n,i){super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Df.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new Df(t,e,n,i)}}function rS(r,t,e,n){return(t==="reauthenticate"?e._getReauthenticationResolver(r):e._getIdTokenResponse(r)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Df._fromErrorAndOperation(r,a,t,n):a})}async function O2(r,t,e=!1){const n=await Bu(r,t._linkToIdToken(r.auth,await r.getIdToken()),e);return yo._forOperation(r,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N2(r,t,e=!1){const{auth:n}=r;if(di(n.app))return Promise.reject(Es(n));const i="reauthenticate";try{const a=await Bu(r,rS(n,i,t,r),e);jt(a.idToken,n,"internal-error");const l=rv(a.idToken);jt(l,n,"internal-error");const{sub:c}=l;return jt(r.uid===c,n,"user-mismatch"),yo._forOperation(r,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&Gi(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sS(r,t,e=!1){if(di(r.app))return Promise.reject(Es(r));const n="signIn",i=await rS(r,n,t),a=await yo._fromIdTokenResponse(r,n,i);return e||await r._updateCurrentUser(a.user),a}async function P2(r,t){return sS(Ca(r),t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aS(r){const t=Ca(r);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function M2(r,t,e){if(di(r.app))return Promise.reject(Es(r));const n=Ca(r),l=await cy(n,{returnSecureToken:!0,email:t,password:e,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",D2).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&aS(r),h}),c=await yo._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(c.user),c}function L2(r,t,e){return di(r.app)?Promise.reject(Es(r)):P2(Ze(r),ql.credential(t,e)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&aS(r),n})}async function k2(r,t){const e=Ze(r),i={requestType:"VERIFY_EMAIL",idToken:await r.getIdToken()},{email:a}=await w2(e.auth,i);a!==r.email&&await r.reload()}function B2(r,t,e,n){return Ze(r).onIdTokenChanged(t,e,n)}function F2(r,t,e){return Ze(r).beforeAuthStateChanged(t,e)}function oS(r,t,e,n){return Ze(r).onAuthStateChanged(t,e,n)}function uy(r){return Ze(r).signOut()}async function U2(r){return Ze(r).delete()}const Of="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(Of,"1"),this.storage.removeItem(Of),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V2=1e3,j2=10;class cS extends lS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Zw(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((l,c,h)=>{this.notifyListeners(l,h)});return}const n=t.key;e?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(n);!e&&this.localCache[n]===l||this.notifyListeners(n,l)},a=this.storage.getItem(n);n2()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,j2):i()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)})},V2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}cS.type="LOCAL";const H2=cS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS extends lS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}uS.type="SESSION";const hS=uS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z2(r){return Promise.all(r.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(i=>i.isListeningto(t));if(e)return e;const n=new ep(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:a}=e.data,l=this.handlersMap[i];if(!l?.size)return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const c=Array.from(l).map(async d=>d(e.origin,a)),h=await z2(c);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:h})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ep.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv(r="",t=10){let e="";for(let n=0;n<t;n++)e+=Math.floor(Math.random()*10);return r+e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,l;return new Promise((c,h)=>{const d=cv("",20);i.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},n);l={messageChannel:i,onMessage(m){const v=m;if(v.data.eventId===d)switch(v.data.status){case"ack":clearTimeout(p),a=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(v.data.response);break;default:clearTimeout(p),clearTimeout(a),h(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:t,eventId:d,data:e},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dr(){return window}function $2(r){Dr().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(){return typeof Dr().WorkerGlobalScope<"u"&&typeof Dr().importScripts=="function"}async function Y2(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function W2(){return navigator?.serviceWorker?.controller||null}function K2(){return dS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fS="firebaseLocalStorageDb",X2=1,Nf="firebaseLocalStorage",pS="fbase_key";class ah{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function np(r,t){return r.transaction([Nf],t?"readwrite":"readonly").objectStore(Nf)}function q2(){const r=indexedDB.deleteDatabase(fS);return new ah(r).toPromise()}function hy(){const r=indexedDB.open(fS,X2);return new Promise((t,e)=>{r.addEventListener("error",()=>{e(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(Nf,{keyPath:pS})}catch(i){e(i)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(Nf)?t(n):(n.close(),await q2(),t(await hy()))})})}async function lT(r,t,e){const n=np(r,!0).put({[pS]:t,value:e});return new ah(n).toPromise()}async function Q2(r,t){const e=np(r,!1).get(t),n=await new ah(e).toPromise();return n===void 0?null:n.value}function cT(r,t){const e=np(r,!0).delete(t);return new ah(e).toPromise()}const J2=800,Z2=3;class gS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await hy(),this.db)}async _withRetries(t){let e=0;for(;;)try{const n=await this._openDb();return await t(n)}catch(n){if(e++>Z2)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return dS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ep._getInstance(K2()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Y2(),!this.activeServiceWorker)return;this.sender=new G2(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||W2()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await hy();return await lT(t,Of,"1"),await cT(t,Of),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(n=>lT(n,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(n=>Q2(n,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>cT(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(i=>{const a=np(i,!1).getAll();return new ah(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],n=new Set;if(t.length!==0)for(const{fbase_key:i,value:a}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),e.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),e.push(i));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),J2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}gS.type="LOCAL";const tN=gS;new ih(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mS(r,t){return t?ys(t):(jt(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv extends av{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Ll(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Ll(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Ll(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function eN(r){return sS(r.auth,new uv(r),r.bypassAuthState)}function nN(r){const{auth:t,user:e}=r;return jt(e,t,"internal-error"),N2(e,new uv(r),r.bypassAuthState)}async function iN(r){const{auth:t,user:e}=r;return jt(e,t,"internal-error"),O2(e,new uv(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(t,e,n,i,a=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:a,error:l,type:c}=t;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:e,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(h))}catch(d){this.reject(d)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return eN;case"linkViaPopup":case"linkViaRedirect":return iN;case"reauthViaPopup":case"reauthViaRedirect":return nN;default:Gi(this.auth,"internal-error")}}resolve(t){_s(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){_s(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN=new ih(2e3,1e4);async function uT(r,t,e){if(di(r.app))return Promise.reject(nr(r,"operation-not-supported-in-this-environment"));const n=Ca(r);kO(r,t,lv);const i=mS(n,e);return new ro(n,"signInViaPopup",t,i).executeNotNull()}class ro extends yS{constructor(t,e,n,i,a){super(t,e,i,a),this.provider=n,this.authWindow=null,this.pollId=null,ro.currentPopupAction&&ro.currentPopupAction.cancel(),ro.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return jt(t,this.auth,"internal-error"),t}async onExecution(){_s(this.filter.length===1,"Popup operations only handle one event");const t=cv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(nr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(nr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ro.currentPopupAction=null}pollUserCancellation(){const t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(nr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,rN.get())};t()}}ro.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sN="pendingRedirect",df=new Map;class aN extends yS{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=df.get(this.auth._key());if(!t){try{const n=await oN(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}df.set(this.auth._key(),t)}return this.bypassAuthState||df.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function oN(r,t){const e=uN(t),n=cN(r);if(!await n._isAvailable())return!1;const i=await n._get(e)==="true";return await n._remove(e),i}function lN(r,t){df.set(r._key(),t)}function cN(r){return ys(r._redirectPersistence)}function uN(r){return hf(sN,r.config.apiKey,r.name)}async function hN(r,t,e=!1){if(di(r.app))return Promise.reject(Es(r));const n=Ca(r),i=mS(n,t),l=await new aN(n,i,e).execute();return l&&!e&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,t)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dN=600*1e3;class fN{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!pN(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!vS(t)){const n=t.error.code?.split("auth/")[1]||"internal-error";e.onError(nr(this.auth,n))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=dN&&this.cachedEventUids.clear(),this.cachedEventUids.has(hT(t))}saveEventToCache(t){this.cachedEventUids.add(hT(t)),this.lastProcessedEventTime=Date.now()}}function hT(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(t=>t).join("-")}function vS({type:r,error:t}){return r==="unknown"&&t?.code==="auth/no-auth-event"}function pN(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vS(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gN(r,t={}){return Is(r,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yN=/^https?/;async function vN(r){if(r.config.emulator)return;const{authorizedDomains:t}=await gN(r);for(const e of t)try{if(EN(e))return}catch{}Gi(r,"unauthorized-domain")}function EN(r){const t=oy(),{protocol:e,hostname:n}=new URL(t);if(r.startsWith("chrome-extension://")){const l=new URL(r);return l.hostname===""&&n===""?e==="chrome-extension:"&&r.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&l.hostname===n}if(!yN.test(e))return!1;if(mN.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN=new ih(3e4,6e4);function dT(){const r=Dr().___jsl;if(r?.H){for(const t of Object.keys(r.H))if(r.H[t].r=r.H[t].r||[],r.H[t].L=r.H[t].L||[],r.H[t].r=[...r.H[t].L],r.CP)for(let e=0;e<r.CP.length;e++)r.CP[e]=null}}function bN(r){return new Promise((t,e)=>{function n(){dT(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{dT(),e(nr(r,"network-request-failed"))},timeout:AN.get()})}if(Dr().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(Dr().gapi?.load)n();else{const i=h2("iframefcb");return Dr()[i]=()=>{gapi.load?n():e(nr(r,"network-request-failed"))},eS(`${u2()}?onload=${i}`).catch(a=>e(a))}}).catch(t=>{throw ff=null,t})}let ff=null;function TN(r){return ff=ff||bN(r),ff}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N=new ih(5e3,15e3),wN="__/auth/iframe",SN="emulator/auth/iframe",RN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},CN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function IN(r){const t=r.config;jt(t.authDomain,r,"auth-domain-config-required");const e=t.emulator?iv(t,SN):`https://${r.config.authDomain}/${wN}`,n={apiKey:t.apiKey,appName:r.name,v:wo},i=CN.get(r.config.apiHost);i&&(n.eid=i);const a=r._getFrameworks();return a.length&&(n.fw=a.join(",")),`${e}?${nh(n).slice(1)}`}async function xN(r){const t=await TN(r),e=Dr().gapi;return jt(e,r,"internal-error"),t.open({where:document.body,url:IN(r),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:RN,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const l=nr(r,"network-request-failed"),c=Dr().setTimeout(()=>{a(l)},_N.get());function h(){Dr().clearTimeout(c),i(n)}n.ping(h).then(h,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ON=500,NN=600,PN="_blank",MN="http://localhost";class fT{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function LN(r,t,e,n=ON,i=NN){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const h={...DN,width:n.toString(),height:i.toString(),top:a,left:l},d=Yn().toLowerCase();e&&(c=Kw(d)?PN:e),Yw(d)&&(t=t||MN,h.scrollbars="yes");const p=Object.entries(h).reduce((v,[E,b])=>`${v}${E}=${b},`,"");if(e2(d)&&c!=="_self")return kN(t||"",c),new fT(null);const m=window.open(t||"",c,p);jt(m,r,"popup-blocked");try{m.focus()}catch{}return new fT(m)}function kN(r,t){const e=document.createElement("a");e.href=r,e.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BN="__/auth/handler",FN="emulator/auth/handler",UN=encodeURIComponent("fac");async function pT(r,t,e,n,i,a){jt(r.config.authDomain,r,"auth-domain-config-required"),jt(r.config.apiKey,r,"invalid-api-key");const l={apiKey:r.config.apiKey,appName:r.name,authType:e,redirectUrl:n,v:wo,eventId:i};if(t instanceof lv){t.setDefaultLanguage(r.languageCode),l.providerId=t.providerId||"",AD(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[p,m]of Object.entries({}))l[p]=m}if(t instanceof sh){const p=t.getScopes().filter(m=>m!=="");p.length>0&&(l.scopes=p.join(","))}r.tenantId&&(l.tid=r.tenantId);const c=l;for(const p of Object.keys(c))c[p]===void 0&&delete c[p];const h=await r._getAppCheckToken(),d=h?`#${UN}=${encodeURIComponent(h)}`:"";return`${VN(r)}?${nh(c).slice(1)}${d}`}function VN({config:r}){return r.emulator?iv(r,FN):`https://${r.authDomain}/${BN}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bm="webStorageSupport";class jN{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=hS,this._completeRedirectFn=hN,this._overrideRedirectResult=lN}async _openPopup(t,e,n,i){_s(this.eventManagers[t._key()]?.manager,"_initialize() not called before _openPopup()");const a=await pT(t,e,n,oy(),i);return LN(t,a,cv())}async _openRedirect(t,e,n,i){await this._originValidation(t);const a=await pT(t,e,n,oy(),i);return $2(a),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:i,promise:a}=this.eventManagers[e];return i?Promise.resolve(i):(_s(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch(()=>{delete this.eventManagers[e]}),n}async initAndGetManager(t){const e=await xN(t),n=new fN(t);return e.register("authEvent",i=>(jt(i?.authEvent,t,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Bm,{type:Bm},i=>{const a=i?.[0]?.[Bm];a!==void 0&&e(!!a),Gi(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=vN(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Zw()||Ww()||sv()}}const HN=jN;var gT="@firebase/auth",mT="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zN{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(n=>{t(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){jt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GN(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function $N(r){go(new ya("auth",(t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),a=t.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=n.options;jt(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:l,authDomain:c,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tS(r)},d=new o2(n,i,a,h);return y2(d,e),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider("auth-internal").initialize()})),go(new ya("auth-internal",t=>{const e=Ca(t.getProvider("auth").getImmediate());return(n=>new zN(n))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),xr(gT,mT,GN(r)),xr(gT,mT,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YN=300,WN=Nw("authIdTokenMaxAge")||YN;let yT=null;const KN=r=>async t=>{const e=t&&await t.getIdTokenResult(),n=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>WN)return;const i=e?.token;yT!==i&&(yT=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function XN(r=tv()){const t=Zf(r,"auth");if(t.isInitialized())return t.getImmediate();const e=m2(r,{popupRedirectResolver:HN,persistence:[tN,H2,hS]}),n=Nw("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const l=KN(a.toString());F2(e,l,()=>l(e.currentUser)),B2(e,c=>l(c))}}const i=xw("auth");return i&&v2(e,`http://${i}`),e}function qN(){return document.getElementsByTagName("head")?.[0]??document}l2({loadJS(r){return new Promise((t,e)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=t,n.onerror=i=>{const a=nr("internal-error");a.customData=i,e(a)},n.type="text/javascript",n.charset="UTF-8",qN().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});$N("Browser");var vT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var pa,ES;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(P,N){function M(){}M.prototype=N.prototype,P.D=N.prototype,P.prototype=new M,P.prototype.constructor=P,P.C=function(V,H,$){for(var j=Array(arguments.length-2),Tt=2;Tt<arguments.length;Tt++)j[Tt-2]=arguments[Tt];return N.prototype[H].apply(V,j)}}function e(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(n,e),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(P,N,M){M||(M=0);var V=Array(16);if(typeof N=="string")for(var H=0;16>H;++H)V[H]=N.charCodeAt(M++)|N.charCodeAt(M++)<<8|N.charCodeAt(M++)<<16|N.charCodeAt(M++)<<24;else for(H=0;16>H;++H)V[H]=N[M++]|N[M++]<<8|N[M++]<<16|N[M++]<<24;N=P.g[0],M=P.g[1],H=P.g[2];var $=P.g[3],j=N+($^M&(H^$))+V[0]+3614090360&4294967295;N=M+(j<<7&4294967295|j>>>25),j=$+(H^N&(M^H))+V[1]+3905402710&4294967295,$=N+(j<<12&4294967295|j>>>20),j=H+(M^$&(N^M))+V[2]+606105819&4294967295,H=$+(j<<17&4294967295|j>>>15),j=M+(N^H&($^N))+V[3]+3250441966&4294967295,M=H+(j<<22&4294967295|j>>>10),j=N+($^M&(H^$))+V[4]+4118548399&4294967295,N=M+(j<<7&4294967295|j>>>25),j=$+(H^N&(M^H))+V[5]+1200080426&4294967295,$=N+(j<<12&4294967295|j>>>20),j=H+(M^$&(N^M))+V[6]+2821735955&4294967295,H=$+(j<<17&4294967295|j>>>15),j=M+(N^H&($^N))+V[7]+4249261313&4294967295,M=H+(j<<22&4294967295|j>>>10),j=N+($^M&(H^$))+V[8]+1770035416&4294967295,N=M+(j<<7&4294967295|j>>>25),j=$+(H^N&(M^H))+V[9]+2336552879&4294967295,$=N+(j<<12&4294967295|j>>>20),j=H+(M^$&(N^M))+V[10]+4294925233&4294967295,H=$+(j<<17&4294967295|j>>>15),j=M+(N^H&($^N))+V[11]+2304563134&4294967295,M=H+(j<<22&4294967295|j>>>10),j=N+($^M&(H^$))+V[12]+1804603682&4294967295,N=M+(j<<7&4294967295|j>>>25),j=$+(H^N&(M^H))+V[13]+4254626195&4294967295,$=N+(j<<12&4294967295|j>>>20),j=H+(M^$&(N^M))+V[14]+2792965006&4294967295,H=$+(j<<17&4294967295|j>>>15),j=M+(N^H&($^N))+V[15]+1236535329&4294967295,M=H+(j<<22&4294967295|j>>>10),j=N+(H^$&(M^H))+V[1]+4129170786&4294967295,N=M+(j<<5&4294967295|j>>>27),j=$+(M^H&(N^M))+V[6]+3225465664&4294967295,$=N+(j<<9&4294967295|j>>>23),j=H+(N^M&($^N))+V[11]+643717713&4294967295,H=$+(j<<14&4294967295|j>>>18),j=M+($^N&(H^$))+V[0]+3921069994&4294967295,M=H+(j<<20&4294967295|j>>>12),j=N+(H^$&(M^H))+V[5]+3593408605&4294967295,N=M+(j<<5&4294967295|j>>>27),j=$+(M^H&(N^M))+V[10]+38016083&4294967295,$=N+(j<<9&4294967295|j>>>23),j=H+(N^M&($^N))+V[15]+3634488961&4294967295,H=$+(j<<14&4294967295|j>>>18),j=M+($^N&(H^$))+V[4]+3889429448&4294967295,M=H+(j<<20&4294967295|j>>>12),j=N+(H^$&(M^H))+V[9]+568446438&4294967295,N=M+(j<<5&4294967295|j>>>27),j=$+(M^H&(N^M))+V[14]+3275163606&4294967295,$=N+(j<<9&4294967295|j>>>23),j=H+(N^M&($^N))+V[3]+4107603335&4294967295,H=$+(j<<14&4294967295|j>>>18),j=M+($^N&(H^$))+V[8]+1163531501&4294967295,M=H+(j<<20&4294967295|j>>>12),j=N+(H^$&(M^H))+V[13]+2850285829&4294967295,N=M+(j<<5&4294967295|j>>>27),j=$+(M^H&(N^M))+V[2]+4243563512&4294967295,$=N+(j<<9&4294967295|j>>>23),j=H+(N^M&($^N))+V[7]+1735328473&4294967295,H=$+(j<<14&4294967295|j>>>18),j=M+($^N&(H^$))+V[12]+2368359562&4294967295,M=H+(j<<20&4294967295|j>>>12),j=N+(M^H^$)+V[5]+4294588738&4294967295,N=M+(j<<4&4294967295|j>>>28),j=$+(N^M^H)+V[8]+2272392833&4294967295,$=N+(j<<11&4294967295|j>>>21),j=H+($^N^M)+V[11]+1839030562&4294967295,H=$+(j<<16&4294967295|j>>>16),j=M+(H^$^N)+V[14]+4259657740&4294967295,M=H+(j<<23&4294967295|j>>>9),j=N+(M^H^$)+V[1]+2763975236&4294967295,N=M+(j<<4&4294967295|j>>>28),j=$+(N^M^H)+V[4]+1272893353&4294967295,$=N+(j<<11&4294967295|j>>>21),j=H+($^N^M)+V[7]+4139469664&4294967295,H=$+(j<<16&4294967295|j>>>16),j=M+(H^$^N)+V[10]+3200236656&4294967295,M=H+(j<<23&4294967295|j>>>9),j=N+(M^H^$)+V[13]+681279174&4294967295,N=M+(j<<4&4294967295|j>>>28),j=$+(N^M^H)+V[0]+3936430074&4294967295,$=N+(j<<11&4294967295|j>>>21),j=H+($^N^M)+V[3]+3572445317&4294967295,H=$+(j<<16&4294967295|j>>>16),j=M+(H^$^N)+V[6]+76029189&4294967295,M=H+(j<<23&4294967295|j>>>9),j=N+(M^H^$)+V[9]+3654602809&4294967295,N=M+(j<<4&4294967295|j>>>28),j=$+(N^M^H)+V[12]+3873151461&4294967295,$=N+(j<<11&4294967295|j>>>21),j=H+($^N^M)+V[15]+530742520&4294967295,H=$+(j<<16&4294967295|j>>>16),j=M+(H^$^N)+V[2]+3299628645&4294967295,M=H+(j<<23&4294967295|j>>>9),j=N+(H^(M|~$))+V[0]+4096336452&4294967295,N=M+(j<<6&4294967295|j>>>26),j=$+(M^(N|~H))+V[7]+1126891415&4294967295,$=N+(j<<10&4294967295|j>>>22),j=H+(N^($|~M))+V[14]+2878612391&4294967295,H=$+(j<<15&4294967295|j>>>17),j=M+($^(H|~N))+V[5]+4237533241&4294967295,M=H+(j<<21&4294967295|j>>>11),j=N+(H^(M|~$))+V[12]+1700485571&4294967295,N=M+(j<<6&4294967295|j>>>26),j=$+(M^(N|~H))+V[3]+2399980690&4294967295,$=N+(j<<10&4294967295|j>>>22),j=H+(N^($|~M))+V[10]+4293915773&4294967295,H=$+(j<<15&4294967295|j>>>17),j=M+($^(H|~N))+V[1]+2240044497&4294967295,M=H+(j<<21&4294967295|j>>>11),j=N+(H^(M|~$))+V[8]+1873313359&4294967295,N=M+(j<<6&4294967295|j>>>26),j=$+(M^(N|~H))+V[15]+4264355552&4294967295,$=N+(j<<10&4294967295|j>>>22),j=H+(N^($|~M))+V[6]+2734768916&4294967295,H=$+(j<<15&4294967295|j>>>17),j=M+($^(H|~N))+V[13]+1309151649&4294967295,M=H+(j<<21&4294967295|j>>>11),j=N+(H^(M|~$))+V[4]+4149444226&4294967295,N=M+(j<<6&4294967295|j>>>26),j=$+(M^(N|~H))+V[11]+3174756917&4294967295,$=N+(j<<10&4294967295|j>>>22),j=H+(N^($|~M))+V[2]+718787259&4294967295,H=$+(j<<15&4294967295|j>>>17),j=M+($^(H|~N))+V[9]+3951481745&4294967295,P.g[0]=P.g[0]+N&4294967295,P.g[1]=P.g[1]+(H+(j<<21&4294967295|j>>>11))&4294967295,P.g[2]=P.g[2]+H&4294967295,P.g[3]=P.g[3]+$&4294967295}n.prototype.u=function(P,N){N===void 0&&(N=P.length);for(var M=N-this.blockSize,V=this.B,H=this.h,$=0;$<N;){if(H==0)for(;$<=M;)i(this,P,$),$+=this.blockSize;if(typeof P=="string"){for(;$<N;)if(V[H++]=P.charCodeAt($++),H==this.blockSize){i(this,V),H=0;break}}else for(;$<N;)if(V[H++]=P[$++],H==this.blockSize){i(this,V),H=0;break}}this.h=H,this.o+=N},n.prototype.v=function(){var P=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);P[0]=128;for(var N=1;N<P.length-8;++N)P[N]=0;var M=8*this.o;for(N=P.length-8;N<P.length;++N)P[N]=M&255,M/=256;for(this.u(P),P=Array(16),N=M=0;4>N;++N)for(var V=0;32>V;V+=8)P[M++]=this.g[N]>>>V&255;return P};function a(P,N){var M=c;return Object.prototype.hasOwnProperty.call(M,P)?M[P]:M[P]=N(P)}function l(P,N){this.h=N;for(var M=[],V=!0,H=P.length-1;0<=H;H--){var $=P[H]|0;V&&$==N||(M[H]=$,V=!1)}this.g=M}var c={};function h(P){return-128<=P&&128>P?a(P,function(N){return new l([N|0],0>N?-1:0)}):new l([P|0],0>P?-1:0)}function d(P){if(isNaN(P)||!isFinite(P))return m;if(0>P)return S(d(-P));for(var N=[],M=1,V=0;P>=M;V++)N[V]=P/M|0,M*=4294967296;return new l(N,0)}function p(P,N){if(P.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(P.charAt(0)=="-")return S(p(P.substring(1),N));if(0<=P.indexOf("-"))throw Error('number format error: interior "-" character');for(var M=d(Math.pow(N,8)),V=m,H=0;H<P.length;H+=8){var $=Math.min(8,P.length-H),j=parseInt(P.substring(H,H+$),N);8>$?($=d(Math.pow(N,$)),V=V.j($).add(d(j))):(V=V.j(M),V=V.add(d(j)))}return V}var m=h(0),v=h(1),E=h(16777216);r=l.prototype,r.m=function(){if(T(this))return-S(this).m();for(var P=0,N=1,M=0;M<this.g.length;M++){var V=this.i(M);P+=(0<=V?V:4294967296+V)*N,N*=4294967296}return P},r.toString=function(P){if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(b(this))return"0";if(T(this))return"-"+S(this).toString(P);for(var N=d(Math.pow(P,6)),M=this,V="";;){var H=F(M,N).g;M=C(M,H.j(N));var $=((0<M.g.length?M.g[0]:M.h)>>>0).toString(P);if(M=H,b(M))return $+V;for(;6>$.length;)$="0"+$;V=$+V}},r.i=function(P){return 0>P?0:P<this.g.length?this.g[P]:this.h};function b(P){if(P.h!=0)return!1;for(var N=0;N<P.g.length;N++)if(P.g[N]!=0)return!1;return!0}function T(P){return P.h==-1}r.l=function(P){return P=C(this,P),T(P)?-1:b(P)?0:1};function S(P){for(var N=P.g.length,M=[],V=0;V<N;V++)M[V]=~P.g[V];return new l(M,~P.h).add(v)}r.abs=function(){return T(this)?S(this):this},r.add=function(P){for(var N=Math.max(this.g.length,P.g.length),M=[],V=0,H=0;H<=N;H++){var $=V+(this.i(H)&65535)+(P.i(H)&65535),j=($>>>16)+(this.i(H)>>>16)+(P.i(H)>>>16);V=j>>>16,$&=65535,j&=65535,M[H]=j<<16|$}return new l(M,M[M.length-1]&-2147483648?-1:0)};function C(P,N){return P.add(S(N))}r.j=function(P){if(b(this)||b(P))return m;if(T(this))return T(P)?S(this).j(S(P)):S(S(this).j(P));if(T(P))return S(this.j(S(P)));if(0>this.l(E)&&0>P.l(E))return d(this.m()*P.m());for(var N=this.g.length+P.g.length,M=[],V=0;V<2*N;V++)M[V]=0;for(V=0;V<this.g.length;V++)for(var H=0;H<P.g.length;H++){var $=this.i(V)>>>16,j=this.i(V)&65535,Tt=P.i(H)>>>16,St=P.i(H)&65535;M[2*V+2*H]+=j*St,D(M,2*V+2*H),M[2*V+2*H+1]+=$*St,D(M,2*V+2*H+1),M[2*V+2*H+1]+=j*Tt,D(M,2*V+2*H+1),M[2*V+2*H+2]+=$*Tt,D(M,2*V+2*H+2)}for(V=0;V<N;V++)M[V]=M[2*V+1]<<16|M[2*V];for(V=N;V<2*N;V++)M[V]=0;return new l(M,0)};function D(P,N){for(;(P[N]&65535)!=P[N];)P[N+1]+=P[N]>>>16,P[N]&=65535,N++}function O(P,N){this.g=P,this.h=N}function F(P,N){if(b(N))throw Error("division by zero");if(b(P))return new O(m,m);if(T(P))return N=F(S(P),N),new O(S(N.g),S(N.h));if(T(N))return N=F(P,S(N)),new O(S(N.g),N.h);if(30<P.g.length){if(T(P)||T(N))throw Error("slowDivide_ only works with positive integers.");for(var M=v,V=N;0>=V.l(P);)M=k(M),V=k(V);var H=z(M,1),$=z(V,1);for(V=z(V,2),M=z(M,2);!b(V);){var j=$.add(V);0>=j.l(P)&&(H=H.add(M),$=j),V=z(V,1),M=z(M,1)}return N=C(P,H.j(N)),new O(H,N)}for(H=m;0<=P.l(N);){for(M=Math.max(1,Math.floor(P.m()/N.m())),V=Math.ceil(Math.log(M)/Math.LN2),V=48>=V?1:Math.pow(2,V-48),$=d(M),j=$.j(N);T(j)||0<j.l(P);)M-=V,$=d(M),j=$.j(N);b($)&&($=v),H=H.add($),P=C(P,j)}return new O(H,P)}r.A=function(P){return F(this,P).h},r.and=function(P){for(var N=Math.max(this.g.length,P.g.length),M=[],V=0;V<N;V++)M[V]=this.i(V)&P.i(V);return new l(M,this.h&P.h)},r.or=function(P){for(var N=Math.max(this.g.length,P.g.length),M=[],V=0;V<N;V++)M[V]=this.i(V)|P.i(V);return new l(M,this.h|P.h)},r.xor=function(P){for(var N=Math.max(this.g.length,P.g.length),M=[],V=0;V<N;V++)M[V]=this.i(V)^P.i(V);return new l(M,this.h^P.h)};function k(P){for(var N=P.g.length+1,M=[],V=0;V<N;V++)M[V]=P.i(V)<<1|P.i(V-1)>>>31;return new l(M,P.h)}function z(P,N){var M=N>>5;N%=32;for(var V=P.g.length-M,H=[],$=0;$<V;$++)H[$]=0<N?P.i($+M)>>>N|P.i($+M+1)<<32-N:P.i($+M);return new l(H,P.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,ES=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=d,l.fromString=p,pa=l}).apply(typeof vT<"u"?vT:typeof self<"u"?self:typeof window<"u"?window:{});var zd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var AS,mu,bS,pf,dy,TS,_S,wS;(function(){var r,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(g,_,I){return g==Array.prototype||g==Object.prototype||(g[_]=I.value),g};function e(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof zd=="object"&&zd];for(var _=0;_<g.length;++_){var I=g[_];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var n=e(this);function i(g,_){if(_)t:{var I=n;g=g.split(".");for(var U=0;U<g.length-1;U++){var et=g[U];if(!(et in I))break t;I=I[et]}g=g[g.length-1],U=I[g],_=_(U),_!=U&&_!=null&&t(I,g,{configurable:!0,writable:!0,value:_})}}function a(g,_){g instanceof String&&(g+="");var I=0,U=!1,et={next:function(){if(!U&&I<g.length){var dt=I++;return{value:_(dt,g[dt]),done:!1}}return U=!0,{done:!0,value:void 0}}};return et[Symbol.iterator]=function(){return et},et}i("Array.prototype.values",function(g){return g||function(){return a(this,function(_,I){return I})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function h(g){var _=typeof g;return _=_!="object"?_:g?Array.isArray(g)?"array":_:"null",_=="array"||_=="object"&&typeof g.length=="number"}function d(g){var _=typeof g;return _=="object"&&g!=null||_=="function"}function p(g,_,I){return g.call.apply(g.bind,arguments)}function m(g,_,I){if(!g)throw Error();if(2<arguments.length){var U=Array.prototype.slice.call(arguments,2);return function(){var et=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(et,U),g.apply(_,et)}}return function(){return g.apply(_,arguments)}}function v(g,_,I){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,v.apply(null,arguments)}function E(g,_){var I=Array.prototype.slice.call(arguments,1);return function(){var U=I.slice();return U.push.apply(U,arguments),g.apply(this,U)}}function b(g,_){function I(){}I.prototype=_.prototype,g.aa=_.prototype,g.prototype=new I,g.prototype.constructor=g,g.Qb=function(U,et,dt){for(var wt=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)wt[ue-2]=arguments[ue];return _.prototype[et].apply(U,wt)}}function T(g){const _=g.length;if(0<_){const I=Array(_);for(let U=0;U<_;U++)I[U]=g[U];return I}return[]}function S(g,_){for(let I=1;I<arguments.length;I++){const U=arguments[I];if(h(U)){const et=g.length||0,dt=U.length||0;g.length=et+dt;for(let wt=0;wt<dt;wt++)g[et+wt]=U[wt]}else g.push(U)}}class C{constructor(_,I){this.i=_,this.j=I,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function D(g){return/^[\s\xa0]*$/.test(g)}function O(){var g=c.navigator;return g&&(g=g.userAgent)?g:""}function F(g){return F[" "](g),g}F[" "]=function(){};var k=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function z(g,_,I){for(const U in g)_.call(I,g[U],U,g)}function P(g,_){for(const I in g)_.call(void 0,g[I],I,g)}function N(g){const _={};for(const I in g)_[I]=g[I];return _}const M="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(g,_){let I,U;for(let et=1;et<arguments.length;et++){U=arguments[et];for(I in U)g[I]=U[I];for(let dt=0;dt<M.length;dt++)I=M[dt],Object.prototype.hasOwnProperty.call(U,I)&&(g[I]=U[I])}}function H(g){var _=1;g=g.split(":");const I=[];for(;0<_&&g.length;)I.push(g.shift()),_--;return g.length&&I.push(g.join(":")),I}function $(g){c.setTimeout(()=>{throw g},0)}function j(){var g=Rt;let _=null;return g.g&&(_=g.g,g.g=g.g.next,g.g||(g.h=null),_.next=null),_}class Tt{constructor(){this.h=this.g=null}add(_,I){const U=St.get();U.set(_,I),this.h?this.h.next=U:this.g=U,this.h=U}}var St=new C(()=>new X,g=>g.reset());class X{constructor(){this.next=this.g=this.h=null}set(_,I){this.h=_,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let Z,ht=!1,Rt=new Tt,W=()=>{const g=c.Promise.resolve(void 0);Z=()=>{g.then(lt)}};var lt=()=>{for(var g;g=j();){try{g.h.call(g.g)}catch(I){$(I)}var _=St;_.j(g),100>_.h&&(_.h++,g.next=_.g,_.g=g)}ht=!1};function q(){this.s=this.s,this.C=this.C}q.prototype.s=!1,q.prototype.ma=function(){this.s||(this.s=!0,this.N())},q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function it(g,_){this.type=g,this.g=this.target=_,this.defaultPrevented=!1}it.prototype.h=function(){this.defaultPrevented=!0};var yt=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var g=!1,_=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const I=()=>{};c.addEventListener("test",I,_),c.removeEventListener("test",I,_)}catch{}return g})();function _t(g,_){if(it.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g){var I=this.type=g.type,U=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;if(this.target=g.target||g.srcElement,this.g=_,_=g.relatedTarget){if(k){t:{try{F(_.nodeName);var et=!0;break t}catch{}et=!1}et||(_=null)}}else I=="mouseover"?_=g.fromElement:I=="mouseout"&&(_=g.toElement);this.relatedTarget=_,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=typeof g.pointerType=="string"?g.pointerType:ut[g.pointerType]||"",this.state=g.state,this.i=g,g.defaultPrevented&&_t.aa.h.call(this)}}b(_t,it);var ut={2:"touch",3:"pen",4:"mouse"};_t.prototype.h=function(){_t.aa.h.call(this);var g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var ft="closure_listenable_"+(1e6*Math.random()|0),pt=0;function Ct(g,_,I,U,et){this.listener=g,this.proxy=null,this.src=_,this.type=I,this.capture=!!U,this.ha=et,this.key=++pt,this.da=this.fa=!1}function Vt(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function It(g){this.src=g,this.g={},this.h=0}It.prototype.add=function(g,_,I,U,et){var dt=g.toString();g=this.g[dt],g||(g=this.g[dt]=[],this.h++);var wt=Xt(g,_,U,et);return-1<wt?(_=g[wt],I||(_.fa=!1)):(_=new Ct(_,this.src,dt,!!U,et),_.fa=I,g.push(_)),_};function qt(g,_){var I=_.type;if(I in g.g){var U=g.g[I],et=Array.prototype.indexOf.call(U,_,void 0),dt;(dt=0<=et)&&Array.prototype.splice.call(U,et,1),dt&&(Vt(_),g.g[I].length==0&&(delete g.g[I],g.h--))}}function Xt(g,_,I,U){for(var et=0;et<g.length;++et){var dt=g[et];if(!dt.da&&dt.listener==_&&dt.capture==!!I&&dt.ha==U)return et}return-1}var ne="closure_lm_"+(1e6*Math.random()|0),Te={};function me(g,_,I,U,et){if(Array.isArray(_)){for(var dt=0;dt<_.length;dt++)me(g,_[dt],I,U,et);return null}return I=fi(I),g&&g[ft]?g.K(_,I,d(U)?!!U.capture:!1,et):_e(g,_,I,!1,U,et)}function _e(g,_,I,U,et,dt){if(!_)throw Error("Invalid event type");var wt=d(et)?!!et.capture:!!et,ue=Si(g);if(ue||(g[ne]=ue=new It(g)),I=ue.add(_,I,U,wt,dt),I.proxy)return I;if(U=Yi(),I.proxy=U,U.src=g,U.listener=I,g.addEventListener)yt||(et=wt),et===void 0&&(et=!1),g.addEventListener(_.toString(),U,et);else if(g.attachEvent)g.attachEvent(ri(_.toString()),U);else if(g.addListener&&g.removeListener)g.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return I}function Yi(){function g(I){return _.call(g.src,g.listener,I)}const _=Un;return g}function ii(g,_,I,U,et){if(Array.isArray(_))for(var dt=0;dt<_.length;dt++)ii(g,_[dt],I,U,et);else U=d(U)?!!U.capture:!!U,I=fi(I),g&&g[ft]?(g=g.i,_=String(_).toString(),_ in g.g&&(dt=g.g[_],I=Xt(dt,I,U,et),-1<I&&(Vt(dt[I]),Array.prototype.splice.call(dt,I,1),dt.length==0&&(delete g.g[_],g.h--)))):g&&(g=Si(g))&&(_=g.g[_.toString()],g=-1,_&&(g=Xt(_,I,U,et)),(I=-1<g?_[g]:null)&&Wi(I))}function Wi(g){if(typeof g!="number"&&g&&!g.da){var _=g.src;if(_&&_[ft])qt(_.i,g);else{var I=g.type,U=g.proxy;_.removeEventListener?_.removeEventListener(I,U,g.capture):_.detachEvent?_.detachEvent(ri(I),U):_.addListener&&_.removeListener&&_.removeListener(U),(I=Si(_))?(qt(I,g),I.h==0&&(I.src=null,_[ne]=null)):Vt(g)}}}function ri(g){return g in Te?Te[g]:Te[g]="on"+g}function Un(g,_){if(g.da)g=!0;else{_=new _t(_,this);var I=g.listener,U=g.ha||g.src;g.fa&&Wi(g),g=I.call(U,_)}return g}function Si(g){return g=g[ne],g instanceof It?g:null}var Vr="__closure_events_fn_"+(1e9*Math.random()>>>0);function fi(g){return typeof g=="function"?g:(g[Vr]||(g[Vr]=function(_){return g.handleEvent(_)}),g[Vr])}function Me(){q.call(this),this.i=new It(this),this.M=this,this.F=null}b(Me,q),Me.prototype[ft]=!0,Me.prototype.removeEventListener=function(g,_,I,U){ii(this,g,_,I,U)};function L(g,_){var I,U=g.F;if(U)for(I=[];U;U=U.F)I.push(U);if(g=g.M,U=_.type||_,typeof _=="string")_=new it(_,g);else if(_ instanceof it)_.target=_.target||g;else{var et=_;_=new it(U,g),V(_,et)}if(et=!0,I)for(var dt=I.length-1;0<=dt;dt--){var wt=_.g=I[dt];et=w(wt,U,!0,_)&&et}if(wt=_.g=g,et=w(wt,U,!0,_)&&et,et=w(wt,U,!1,_)&&et,I)for(dt=0;dt<I.length;dt++)wt=_.g=I[dt],et=w(wt,U,!1,_)&&et}Me.prototype.N=function(){if(Me.aa.N.call(this),this.i){var g=this.i,_;for(_ in g.g){for(var I=g.g[_],U=0;U<I.length;U++)Vt(I[U]);delete g.g[_],g.h--}}this.F=null},Me.prototype.K=function(g,_,I,U){return this.i.add(String(g),_,!1,I,U)},Me.prototype.L=function(g,_,I,U){return this.i.add(String(g),_,!0,I,U)};function w(g,_,I,U){if(_=g.i.g[String(_)],!_)return!0;_=_.concat();for(var et=!0,dt=0;dt<_.length;++dt){var wt=_[dt];if(wt&&!wt.da&&wt.capture==I){var ue=wt.listener,fn=wt.ha||wt.src;wt.fa&&qt(g.i,wt),et=ue.call(fn,U)!==!1&&et}}return et&&!U.defaultPrevented}function R(g,_,I){if(typeof g=="function")I&&(g=v(g,I));else if(g&&typeof g.handleEvent=="function")g=v(g.handleEvent,g);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:c.setTimeout(g,_||0)}function G(g){g.g=R(()=>{g.g=null,g.i&&(g.i=!1,G(g))},g.l);const _=g.h;g.h=null,g.m.apply(null,_)}class J extends q{constructor(_,I){super(),this.m=_,this.l=I,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:G(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ot(g){q.call(this),this.h=g,this.g={}}b(ot,q);var mt=[];function Yt(g){z(g.g,function(_,I){this.g.hasOwnProperty(I)&&Wi(_)},g),g.g={}}ot.prototype.N=function(){ot.aa.N.call(this),Yt(this)},ot.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=c.JSON.stringify,ye=c.JSON.parse,Ee=class{stringify(g){return c.JSON.stringify(g,void 0)}parse(g){return c.JSON.parse(g,void 0)}};function pe(){}pe.prototype.h=null;function ec(g){return g.h||(g.h=g.i())}function nc(){}var jr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Hr(){it.call(this,"d")}b(Hr,it);function ic(){it.call(this,"c")}b(ic,it);var sr={},rc=null;function xs(){return rc=rc||new Me}sr.La="serverreachability";function Oo(g){it.call(this,sr.La,g)}b(Oo,it);function Ds(g){const _=xs();L(_,new Oo(_))}sr.STAT_EVENT="statevent";function Ah(g,_){it.call(this,sr.STAT_EVENT,g),this.stat=_}b(Ah,it);function Le(g){const _=xs();L(_,new Ah(_,g))}sr.Ma="timingevent";function dn(g,_){it.call(this,sr.Ma,g),this.size=_}b(dn,it);function en(g,_){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){g()},_)}function Ri(){this.g=!0}Ri.prototype.xa=function(){this.g=!1};function sc(g,_,I,U,et,dt){g.info(function(){if(g.g)if(dt)for(var wt="",ue=dt.split("&"),fn=0;fn<ue.length;fn++){var he=ue[fn].split("=");if(1<he.length){var An=he[0];he=he[1];var pn=An.split("_");wt=2<=pn.length&&pn[1]=="type"?wt+(An+"="+he+"&"):wt+(An+"=redacted&")}}else wt=null;else wt=dt;return"XMLHTTP REQ ("+U+") [attempt "+et+"]: "+_+`
`+I+`
`+wt})}function Sp(g,_,I,U,et,dt,wt){g.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+et+"]: "+_+`
`+I+`
`+dt+" "+wt})}function Os(g,_,I,U){g.info(function(){return"XMLHTTP TEXT ("+_+"): "+Ia(g,I)+(U?" "+U:"")})}function bh(g,_){g.info(function(){return"TIMEOUT: "+_})}Ri.prototype.info=function(){};function Ia(g,_){if(!g.g)return _;if(!_)return null;try{var I=JSON.parse(_);if(I){for(g=0;g<I.length;g++)if(Array.isArray(I[g])){var U=I[g];if(!(2>U.length)){var et=U[1];if(Array.isArray(et)&&!(1>et.length)){var dt=et[0];if(dt!="noop"&&dt!="stop"&&dt!="close")for(var wt=1;wt<et.length;wt++)et[wt]=""}}}}return ce(I)}catch{return _}}var Ns={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},zr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ar;function or(){}b(or,pe),or.prototype.g=function(){return new XMLHttpRequest},or.prototype.i=function(){return{}},ar=new or;function Wn(g,_,I,U){this.j=g,this.i=_,this.l=I,this.R=U||1,this.U=new ot(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ke}function Ke(){this.i=null,this.g="",this.h=!1}var ac={},No={};function Ki(g,_,I){g.L=1,g.v=Pa(pi(_)),g.m=I,g.P=!0,Gr(g,null)}function Gr(g,_){g.F=Date.now(),xa(g),g.A=pi(g.v);var I=g.A,U=g.R;Array.isArray(U)||(U=[String(U)]),dc(I.i,"t",U),g.C=0,I=g.j.J,g.h=new Ke,g.g=Bh(g.j,I?_:null,!g.m),0<g.O&&(g.M=new J(v(g.Y,g,g.g),g.O)),_=g.U,I=g.g,U=g.ca;var et="readystatechange";Array.isArray(et)||(et&&(mt[0]=et.toString()),et=mt);for(var dt=0;dt<et.length;dt++){var wt=me(I,et[dt],U||_.handleEvent,!1,_.h||_);if(!wt)break;_.g[wt.key]=wt}_=g.H?N(g.H):{},g.m?(g.u||(g.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.A,g.u,g.m,_)):(g.u="GET",g.g.ea(g.A,g.u,null,_)),Ds(),sc(g.i,g.u,g.A,g.l,g.R,g.m)}Wn.prototype.ca=function(g){g=g.target;const _=this.M;_&&Di(g)==3?_.j():this.Y(g)},Wn.prototype.Y=function(g){try{if(g==this.g)t:{const pn=Di(this.g);var _=this.g.Ba();const Jr=this.g.Z();if(!(3>pn)&&(pn!=3||this.g&&(this.h.h||this.g.oa()||xh(this.g)))){this.J||pn!=4||_==7||(_==8||0>=Jr?Ds(3):Ds(2)),Ps(this);var I=this.g.Z();this.X=I;e:if(Th(this)){var U=xh(this.g);g="";var et=U.length,dt=Di(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Cn(this),lr(this);var wt="";break e}this.h.i=new c.TextDecoder}for(_=0;_<et;_++)this.h.h=!0,g+=this.h.i.decode(U[_],{stream:!(dt&&_==et-1)});U.length=0,this.h.g+=g,this.C=0,wt=this.h.g}else wt=this.g.oa();if(this.o=I==200,Sp(this.i,this.u,this.A,this.l,this.R,pn,I),this.o){if(this.T&&!this.K){e:{if(this.g){var ue,fn=this.g;if((ue=fn.g?fn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(ue)){var he=ue;break e}}he=null}if(I=he)Os(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Da(this,I);else{this.o=!1,this.s=3,Le(12),Cn(this),lr(this);break t}}if(this.P){I=!0;let In;for(;!this.J&&this.C<wt.length;)if(In=_h(this,wt),In==No){pn==4&&(this.s=4,Le(14),I=!1),Os(this.i,this.l,null,"[Incomplete Response]");break}else if(In==ac){this.s=4,Le(15),Os(this.i,this.l,wt,"[Invalid Chunk]"),I=!1;break}else Os(this.i,this.l,In,null),Da(this,In);if(Th(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pn!=4||wt.length!=0||this.h.h||(this.s=1,Le(16),I=!1),this.o=this.o&&I,!I)Os(this.i,this.l,wt,"[Invalid Chunked Response]"),Cn(this),lr(this);else if(0<wt.length&&!this.W){this.W=!0;var An=this.j;An.g==this&&An.ba&&!An.M&&(An.j.info("Great, no buffering proxy detected. Bytes received: "+wt.length),ja(An),An.M=!0,Le(11))}}else Os(this.i,this.l,wt,null),Da(this,wt);pn==4&&Cn(this),this.o&&!this.J&&(pn==4?Mh(this.j,this):(this.o=!1,xa(this)))}else Dp(this.g),I==400&&0<wt.indexOf("Unknown SID")?(this.s=3,Le(12)):(this.s=0,Le(13)),Cn(this),lr(this)}}}catch{}finally{}};function Th(g){return g.g?g.u=="GET"&&g.L!=2&&g.j.Ca:!1}function _h(g,_){var I=g.C,U=_.indexOf(`
`,I);return U==-1?No:(I=Number(_.substring(I,U)),isNaN(I)?ac:(U+=1,U+I>_.length?No:(_=_.slice(U,U+I),g.C=U+I,_)))}Wn.prototype.cancel=function(){this.J=!0,Cn(this)};function xa(g){g.S=Date.now()+g.I,wh(g,g.I)}function wh(g,_){if(g.B!=null)throw Error("WatchDog timer not null");g.B=en(v(g.ba,g),_)}function Ps(g){g.B&&(c.clearTimeout(g.B),g.B=null)}Wn.prototype.ba=function(){this.B=null;const g=Date.now();0<=g-this.S?(bh(this.i,this.A),this.L!=2&&(Ds(),Le(17)),Cn(this),this.s=2,lr(this)):wh(this,this.S-g)};function lr(g){g.j.G==0||g.J||Mh(g.j,g)}function Cn(g){Ps(g);var _=g.M;_&&typeof _.ma=="function"&&_.ma(),g.M=null,Yt(g.U),g.g&&(_=g.g,g.g=null,_.abort(),_.ma())}function Da(g,_){try{var I=g.j;if(I.G!=0&&(I.g==g||oc(I.h,g))){if(!g.K&&oc(I.h,g)&&I.G==3){try{var U=I.Da.g.parse(_)}catch{U=null}if(Array.isArray(U)&&U.length==3){var et=U;if(et[0]==0){t:if(!I.u){if(I.g)if(I.g.F+3e3<g.F)Go(I),Ho(I);else break t;yc(I),Le(18)}}else I.za=et[1],0<I.za-I.T&&37500>et[2]&&I.F&&I.v==0&&!I.C&&(I.C=en(v(I.Za,I),6e3));if(1>=Mo(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else Qr(I,11)}else if((g.K||I.g==g)&&Go(I),!D(_))for(et=I.Da.g.parse(_),_=0;_<et.length;_++){let he=et[_];if(I.T=he[0],he=he[1],I.G==2)if(he[0]=="c"){I.K=he[1],I.ia=he[2];const An=he[3];An!=null&&(I.la=An,I.j.info("VER="+I.la));const pn=he[4];pn!=null&&(I.Aa=pn,I.j.info("SVER="+I.Aa));const Jr=he[5];Jr!=null&&typeof Jr=="number"&&0<Jr&&(U=1.5*Jr,I.L=U,I.j.info("backChannelRequestTimeoutMs_="+U)),U=I;const In=g.g;if(In){const gr=In.g?In.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(gr){var dt=U.h;dt.g||gr.indexOf("spdy")==-1&&gr.indexOf("quic")==-1&&gr.indexOf("h2")==-1||(dt.j=dt.l,dt.g=new Set,dt.h&&(Lo(dt,dt.h),dt.h=null))}if(U.D){const Ec=In.g?In.g.getResponseHeader("X-HTTP-Session-Id"):null;Ec&&(U.ya=Ec,Re(U.I,U.D,Ec))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-g.F,I.j.info("Handshake RTT: "+I.R+"ms")),U=I;var wt=g;if(U.qa=kh(U,U.J?U.ia:null,U.W),wt.K){Kn(U.h,wt);var ue=wt,fn=U.L;fn&&(ue.I=fn),ue.B&&(Ps(ue),xa(ue)),U.g=wt}else Nh(U);0<I.i.length&&zo(I)}else he[0]!="stop"&&he[0]!="close"||Qr(I,7);else I.G==3&&(he[0]=="stop"||he[0]=="close"?he[0]=="stop"?Qr(I,7):gc(I):he[0]!="noop"&&I.l&&I.l.ta(he),I.v=0)}}Ds(4)}catch{}}var Sh=class{constructor(g,_){this.g=g,this.map=_}};function $r(g){this.l=g||10,c.PerformanceNavigationTiming?(g=c.performance.getEntriesByType("navigation"),g=0<g.length&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Po(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function Mo(g){return g.h?1:g.g?g.g.size:0}function oc(g,_){return g.h?g.h==_:g.g?g.g.has(_):!1}function Lo(g,_){g.g?g.g.add(_):g.h=_}function Kn(g,_){g.h&&g.h==_?g.h=null:g.g&&g.g.has(_)&&g.g.delete(_)}$r.prototype.cancel=function(){if(this.i=lc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function lc(g){if(g.h!=null)return g.i.concat(g.h.D);if(g.g!=null&&g.g.size!==0){let _=g.i;for(const I of g.g.values())_=_.concat(I.D);return _}return T(g.i)}function Rp(g){if(g.V&&typeof g.V=="function")return g.V();if(typeof Map<"u"&&g instanceof Map||typeof Set<"u"&&g instanceof Set)return Array.from(g.values());if(typeof g=="string")return g.split("");if(h(g)){for(var _=[],I=g.length,U=0;U<I;U++)_.push(g[U]);return _}_=[],I=0;for(U in g)_[I++]=g[U];return _}function ko(g){if(g.na&&typeof g.na=="function")return g.na();if(!g.V||typeof g.V!="function"){if(typeof Map<"u"&&g instanceof Map)return Array.from(g.keys());if(!(typeof Set<"u"&&g instanceof Set)){if(h(g)||typeof g=="string"){var _=[];g=g.length;for(var I=0;I<g;I++)_.push(I);return _}_=[],I=0;for(const U in g)_[I++]=U;return _}}}function cc(g,_){if(g.forEach&&typeof g.forEach=="function")g.forEach(_,void 0);else if(h(g)||typeof g=="string")Array.prototype.forEach.call(g,_,void 0);else for(var I=ko(g),U=Rp(g),et=U.length,dt=0;dt<et;dt++)_.call(void 0,U[dt],I&&I[dt],g)}var Oa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Cp(g,_){if(g){g=g.split("&");for(var I=0;I<g.length;I++){var U=g[I].indexOf("="),et=null;if(0<=U){var dt=g[I].substring(0,U);et=g[I].substring(U+1)}else dt=g[I];_(dt,et?decodeURIComponent(et.replace(/\+/g," ")):"")}}}function nn(g){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,g instanceof nn){this.h=g.h,Na(this,g.j),this.o=g.o,this.g=g.g,Ms(this,g.s),this.l=g.l;var _=g.i,I=new Wr;I.i=_.i,_.g&&(I.g=new Map(_.g),I.h=_.h),Yr(this,I),this.m=g.m}else g&&(_=String(g).match(Oa))?(this.h=!1,Na(this,_[1]||"",!0),this.o=Ci(_[2]||""),this.g=Ci(_[3]||"",!0),Ms(this,_[4]),this.l=Ci(_[5]||"",!0),Yr(this,_[6]||"",!0),this.m=Ci(_[7]||"")):(this.h=!1,this.i=new Wr(null,this.h))}nn.prototype.toString=function(){var g=[],_=this.j;_&&g.push(Ma(_,uc,!0),":");var I=this.g;return(I||_=="file")&&(g.push("//"),(_=this.o)&&g.push(Ma(_,uc,!0),"@"),g.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.s,I!=null&&g.push(":",String(I))),(I=this.l)&&(this.g&&I.charAt(0)!="/"&&g.push("/"),g.push(Ma(I,I.charAt(0)=="/"?Ip:hc,!0))),(I=this.i.toString())&&g.push("?",I),(I=this.m)&&g.push("#",Ma(I,Bo)),g.join("")};function pi(g){return new nn(g)}function Na(g,_,I){g.j=I?Ci(_,!0):_,g.j&&(g.j=g.j.replace(/:$/,""))}function Ms(g,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);g.s=_}else g.s=null}function Yr(g,_,I){_ instanceof Wr?(g.i=_,Ch(g.i,g.h)):(I||(_=Ma(_,xp)),g.i=new Wr(_,g.h))}function Re(g,_,I){g.i.set(_,I)}function Pa(g){return Re(g,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),g}function Ci(g,_){return g?_?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Ma(g,_,I){return typeof g=="string"?(g=encodeURI(g).replace(_,Rh),I&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Rh(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var uc=/[#\/\?@]/g,hc=/[#\?:]/g,Ip=/[#\?]/g,xp=/[#\?@]/g,Bo=/#/g;function Wr(g,_){this.h=this.g=null,this.i=g||null,this.j=!!_}function Ii(g){g.g||(g.g=new Map,g.h=0,g.i&&Cp(g.i,function(_,I){g.add(decodeURIComponent(_.replace(/\+/g," ")),I)}))}r=Wr.prototype,r.add=function(g,_){Ii(this),this.i=null,g=cr(this,g);var I=this.g.get(g);return I||this.g.set(g,I=[]),I.push(_),this.h+=1,this};function Kr(g,_){Ii(g),_=cr(g,_),g.g.has(_)&&(g.i=null,g.h-=g.g.get(_).length,g.g.delete(_))}function Xr(g,_){return Ii(g),_=cr(g,_),g.g.has(_)}r.forEach=function(g,_){Ii(this),this.g.forEach(function(I,U){I.forEach(function(et){g.call(_,et,U,this)},this)},this)},r.na=function(){Ii(this);const g=Array.from(this.g.values()),_=Array.from(this.g.keys()),I=[];for(let U=0;U<_.length;U++){const et=g[U];for(let dt=0;dt<et.length;dt++)I.push(_[U])}return I},r.V=function(g){Ii(this);let _=[];if(typeof g=="string")Xr(this,g)&&(_=_.concat(this.g.get(cr(this,g))));else{g=Array.from(this.g.values());for(let I=0;I<g.length;I++)_=_.concat(g[I])}return _},r.set=function(g,_){return Ii(this),this.i=null,g=cr(this,g),Xr(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[_]),this.h+=1,this},r.get=function(g,_){return g?(g=this.V(g),0<g.length?String(g[0]):_):_};function dc(g,_,I){Kr(g,_),0<I.length&&(g.i=null,g.g.set(cr(g,_),T(I)),g.h+=I.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],_=Array.from(this.g.keys());for(var I=0;I<_.length;I++){var U=_[I];const dt=encodeURIComponent(String(U)),wt=this.V(U);for(U=0;U<wt.length;U++){var et=dt;wt[U]!==""&&(et+="="+encodeURIComponent(String(wt[U]))),g.push(et)}}return this.i=g.join("&")};function cr(g,_){return _=String(_),g.j&&(_=_.toLowerCase()),_}function Ch(g,_){_&&!g.j&&(Ii(g),g.i=null,g.g.forEach(function(I,U){var et=U.toLowerCase();U!=et&&(Kr(this,U),dc(this,et,I))},g)),g.j=_}function La(g,_){const I=new Ri;if(c.Image){const U=new Image;U.onload=E(xi,I,"TestLoadImage: loaded",!0,_,U),U.onerror=E(xi,I,"TestLoadImage: error",!1,_,U),U.onabort=E(xi,I,"TestLoadImage: abort",!1,_,U),U.ontimeout=E(xi,I,"TestLoadImage: timeout",!1,_,U),c.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=g}else _(!1)}function Xi(g,_){const I=new Ri,U=new AbortController,et=setTimeout(()=>{U.abort(),xi(I,"TestPingServer: timeout",!1,_)},1e4);fetch(g,{signal:U.signal}).then(dt=>{clearTimeout(et),dt.ok?xi(I,"TestPingServer: ok",!0,_):xi(I,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(et),xi(I,"TestPingServer: error",!1,_)})}function xi(g,_,I,U,et){try{et&&(et.onload=null,et.onerror=null,et.onabort=null,et.ontimeout=null),U(I)}catch{}}function ka(){this.g=new Ee}function ur(g,_,I){const U=I||"";try{cc(g,function(et,dt){let wt=et;d(et)&&(wt=ce(et)),_.push(U+dt+"="+encodeURIComponent(wt))})}catch(et){throw _.push(U+"type="+encodeURIComponent("_badmap")),et}}function Ls(g){this.l=g.Ub||null,this.j=g.eb||!1}b(Ls,pe),Ls.prototype.g=function(){return new qr(this.l,this.j)},Ls.prototype.i=(function(g){return function(){return g}})({});function qr(g,_){Me.call(this),this.D=g,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(qr,Me),r=qr.prototype,r.open=function(g,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=g,this.A=_,this.readyState=1,dr(this)},r.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};g&&(_.body=g),(this.D||c).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,hr(this)),this.readyState=0},r.Sa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,dr(this)),this.g&&(this.readyState=3,dr(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;fc(this)}else g.text().then(this.Ra.bind(this),this.ga.bind(this))};function fc(g){g.j.read().then(g.Pa.bind(g)).catch(g.ga.bind(g))}r.Pa=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var _=g.value?g.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!g.done}))&&(this.response=this.responseText+=_)}g.done?hr(this):dr(this),this.readyState==3&&fc(this)}},r.Ra=function(g){this.g&&(this.response=this.responseText=g,hr(this))},r.Qa=function(g){this.g&&(this.response=g,hr(this))},r.ga=function(){this.g&&hr(this)};function hr(g){g.readyState=4,g.l=null,g.j=null,g.v=null,dr(g)}r.setRequestHeader=function(g,_){this.u.append(g,_)},r.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],_=this.h.entries();for(var I=_.next();!I.done;)I=I.value,g.push(I[0]+": "+I[1]),I=_.next();return g.join(`\r
`)};function dr(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(qr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function pc(g){let _="";return z(g,function(I,U){_+=U,_+=":",_+=I,_+=`\r
`}),_}function En(g,_,I){t:{for(U in I){var U=!1;break t}U=!0}U||(I=pc(I),typeof g=="string"?I!=null&&encodeURIComponent(String(I)):Re(g,_,I))}function Ae(g){Me.call(this),this.headers=new Map,this.o=g||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(Ae,Me);var Fo=/^https?$/i,Ba=["POST","PUT"];r=Ae.prototype,r.Ha=function(g){this.J=g},r.ea=function(g,_,I,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);_=_?_.toUpperCase():"GET",this.D=g,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ar.g(),this.v=this.o?ec(this.o):ec(ar),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(_,String(g),!0),this.B=!1}catch(dt){Ih(this,dt);return}if(g=I||"",I=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var et in U)I.set(et,U[et]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const dt of U.keys())I.set(dt,U.get(dt));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(I.keys()).find(dt=>dt.toLowerCase()=="content-type"),et=c.FormData&&g instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Ba,_,void 0))||U||et||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[dt,wt]of I)this.g.setRequestHeader(dt,wt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Fa(this),this.u=!0,this.g.send(g),this.u=!1}catch(dt){Ih(this,dt)}};function Ih(g,_){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=_,g.m=5,Uo(g),fr(g)}function Uo(g){g.A||(g.A=!0,L(g,"complete"),L(g,"error"))}r.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=g||7,L(this,"complete"),L(this,"abort"),fr(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fr(this,!0)),Ae.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Vo(this):this.bb())},r.bb=function(){Vo(this)};function Vo(g){if(g.h&&typeof l<"u"&&(!g.v[1]||Di(g)!=4||g.Z()!=2)){if(g.u&&Di(g)==4)R(g.Ea,0,g);else if(L(g,"readystatechange"),Di(g)==4){g.h=!1;try{const wt=g.Z();t:switch(wt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break t;default:_=!1}var I;if(!(I=_)){var U;if(U=wt===0){var et=String(g.D).match(Oa)[1]||null;!et&&c.self&&c.self.location&&(et=c.self.location.protocol.slice(0,-1)),U=!Fo.test(et?et.toLowerCase():"")}I=U}if(I)L(g,"complete"),L(g,"success");else{g.m=6;try{var dt=2<Di(g)?g.g.statusText:""}catch{dt=""}g.l=dt+" ["+g.Z()+"]",Uo(g)}}finally{fr(g)}}}}function fr(g,_){if(g.g){Fa(g);const I=g.g,U=g.v[0]?()=>{}:null;g.g=null,g.v=null,_||L(g,"ready");try{I.onreadystatechange=U}catch{}}}function Fa(g){g.I&&(c.clearTimeout(g.I),g.I=null)}r.isActive=function(){return!!this.g};function Di(g){return g.g?g.g.readyState:0}r.Z=function(){try{return 2<Di(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(g){if(this.g){var _=this.g.responseText;return g&&_.indexOf(g)==0&&(_=_.substring(g.length)),ye(_)}};function xh(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.H){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Dp(g){const _={};g=(g.g&&2<=Di(g)&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<g.length;U++){if(D(g[U]))continue;var I=H(g[U]);const et=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const dt=_[et]||[];_[et]=dt,dt.push(I)}P(_,function(U){return U.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ua(g,_,I){return I&&I.internalChannelParams&&I.internalChannelParams[g]||_}function jo(g){this.Aa=0,this.i=[],this.j=new Ri,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ua("failFast",!1,g),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ua("baseRetryDelayMs",5e3,g),this.cb=Ua("retryDelaySeedMs",1e4,g),this.Wa=Ua("forwardChannelMaxRetries",2,g),this.wa=Ua("forwardChannelRequestTimeoutMs",2e4,g),this.pa=g&&g.xmlHttpFactory||void 0,this.Xa=g&&g.Tb||void 0,this.Ca=g&&g.useFetchStreams||!1,this.L=void 0,this.J=g&&g.supportsCrossDomainXhr||!1,this.K="",this.h=new $r(g&&g.concurrentRequestLimit),this.Da=new ka,this.P=g&&g.fastHandshake||!1,this.O=g&&g.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=g&&g.Rb||!1,g&&g.xa&&this.j.xa(),g&&g.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&g&&g.detectBufferingProxy||!1,this.ja=void 0,g&&g.longPollingTimeout&&0<g.longPollingTimeout&&(this.ja=g.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=jo.prototype,r.la=8,r.G=1,r.connect=function(g,_,I,U){Le(0),this.W=g,this.H=_||{},I&&U!==void 0&&(this.H.OSID=I,this.H.OAID=U),this.F=this.X,this.I=kh(this,null,this.W),zo(this)};function gc(g){if(Dh(g),g.G==3){var _=g.U++,I=pi(g.I);if(Re(I,"SID",g.K),Re(I,"RID",_),Re(I,"TYPE","terminate"),Va(g,I),_=new Wn(g,g.j,_),_.L=2,_.v=Pa(pi(I)),I=!1,c.navigator&&c.navigator.sendBeacon)try{I=c.navigator.sendBeacon(_.v.toString(),"")}catch{}!I&&c.Image&&(new Image().src=_.v,I=!0),I||(_.g=Bh(_.j,null),_.g.ea(_.v)),_.F=Date.now(),xa(_)}Lh(g)}function Ho(g){g.g&&(ja(g),g.g.cancel(),g.g=null)}function Dh(g){Ho(g),g.u&&(c.clearTimeout(g.u),g.u=null),Go(g),g.h.cancel(),g.s&&(typeof g.s=="number"&&c.clearTimeout(g.s),g.s=null)}function zo(g){if(!Po(g.h)&&!g.s){g.s=!0;var _=g.Ga;Z||W(),ht||(Z(),ht=!0),Rt.add(_,g),g.B=0}}function Op(g,_){return Mo(g.h)>=g.h.j-(g.s?1:0)?!1:g.s?(g.i=_.D.concat(g.i),!0):g.G==1||g.G==2||g.B>=(g.Va?0:g.Wa)?!1:(g.s=en(v(g.Ga,g,_),vc(g,g.B)),g.B++,!0)}r.Ga=function(g){if(this.s)if(this.s=null,this.G==1){if(!g){this.U=Math.floor(1e5*Math.random()),g=this.U++;const et=new Wn(this,this.j,g);let dt=this.o;if(this.S&&(dt?(dt=N(dt),V(dt,this.S)):dt=this.S),this.m!==null||this.O||(et.H=dt,dt=null),this.P)t:{for(var _=0,I=0;I<this.i.length;I++){e:{var U=this.i[I];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break e}U=void 0}if(U===void 0)break;if(_+=U,4096<_){_=I;break t}if(_===4096||I===this.i.length-1){_=I+1;break t}}_=1e3}else _=1e3;_=Oh(this,et,_),I=pi(this.I),Re(I,"RID",g),Re(I,"CVER",22),this.D&&Re(I,"X-HTTP-Session-Id",this.D),Va(this,I),dt&&(this.O?_="headers="+encodeURIComponent(String(pc(dt)))+"&"+_:this.m&&En(I,this.m,dt)),Lo(this.h,et),this.Ua&&Re(I,"TYPE","init"),this.P?(Re(I,"$req",_),Re(I,"SID","null"),et.T=!0,Ki(et,I,null)):Ki(et,I,_),this.G=2}}else this.G==3&&(g?mc(this,g):this.i.length==0||Po(this.h)||mc(this))};function mc(g,_){var I;_?I=_.l:I=g.U++;const U=pi(g.I);Re(U,"SID",g.K),Re(U,"RID",I),Re(U,"AID",g.T),Va(g,U),g.m&&g.o&&En(U,g.m,g.o),I=new Wn(g,g.j,I,g.B+1),g.m===null&&(I.H=g.o),_&&(g.i=_.D.concat(g.i)),_=Oh(g,I,1e3),I.I=Math.round(.5*g.wa)+Math.round(.5*g.wa*Math.random()),Lo(g.h,I),Ki(I,U,_)}function Va(g,_){g.H&&z(g.H,function(I,U){Re(_,U,I)}),g.l&&cc({},function(I,U){Re(_,U,I)})}function Oh(g,_,I){I=Math.min(g.i.length,I);var U=g.l?v(g.l.Na,g.l,g):null;t:{var et=g.i;let dt=-1;for(;;){const wt=["count="+I];dt==-1?0<I?(dt=et[0].g,wt.push("ofs="+dt)):dt=0:wt.push("ofs="+dt);let ue=!0;for(let fn=0;fn<I;fn++){let he=et[fn].g;const An=et[fn].map;if(he-=dt,0>he)dt=Math.max(0,et[fn].g-100),ue=!1;else try{ur(An,wt,"req"+he+"_")}catch{U&&U(An)}}if(ue){U=wt.join("&");break t}}}return g=g.i.splice(0,I),_.D=g,U}function Nh(g){if(!g.g&&!g.u){g.Y=1;var _=g.Fa;Z||W(),ht||(Z(),ht=!0),Rt.add(_,g),g.v=0}}function yc(g){return g.g||g.u||3<=g.v?!1:(g.Y++,g.u=en(v(g.Fa,g),vc(g,g.v)),g.v++,!0)}r.Fa=function(){if(this.u=null,Ph(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var g=2*this.R;this.j.info("BP detection timer enabled: "+g),this.A=en(v(this.ab,this),g)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Le(10),Ho(this),Ph(this))};function ja(g){g.A!=null&&(c.clearTimeout(g.A),g.A=null)}function Ph(g){g.g=new Wn(g,g.j,"rpc",g.Y),g.m===null&&(g.g.H=g.o),g.g.O=0;var _=pi(g.qa);Re(_,"RID","rpc"),Re(_,"SID",g.K),Re(_,"AID",g.T),Re(_,"CI",g.F?"0":"1"),!g.F&&g.ja&&Re(_,"TO",g.ja),Re(_,"TYPE","xmlhttp"),Va(g,_),g.m&&g.o&&En(_,g.m,g.o),g.L&&(g.g.I=g.L);var I=g.g;g=g.ia,I.L=1,I.v=Pa(pi(_)),I.m=null,I.P=!0,Gr(I,g)}r.Za=function(){this.C!=null&&(this.C=null,Ho(this),yc(this),Le(19))};function Go(g){g.C!=null&&(c.clearTimeout(g.C),g.C=null)}function Mh(g,_){var I=null;if(g.g==_){Go(g),ja(g),g.g=null;var U=2}else if(oc(g.h,_))I=_.D,Kn(g.h,_),U=1;else return;if(g.G!=0){if(_.o)if(U==1){I=_.m?_.m.length:0,_=Date.now()-_.F;var et=g.B;U=xs(),L(U,new dn(U,I)),zo(g)}else Nh(g);else if(et=_.s,et==3||et==0&&0<_.X||!(U==1&&Op(g,_)||U==2&&yc(g)))switch(I&&0<I.length&&(_=g.h,_.i=_.i.concat(I)),et){case 1:Qr(g,5);break;case 4:Qr(g,10);break;case 3:Qr(g,6);break;default:Qr(g,2)}}}function vc(g,_){let I=g.Ta+Math.floor(Math.random()*g.cb);return g.isActive()||(I*=2),I*_}function Qr(g,_){if(g.j.info("Error code "+_),_==2){var I=v(g.fb,g),U=g.Xa;const et=!U;U=new nn(U||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Na(U,"https"),Pa(U),et?La(U.toString(),I):Xi(U.toString(),I)}else Le(2);g.G=0,g.l&&g.l.sa(_),Lh(g),Dh(g)}r.fb=function(g){g?(this.j.info("Successfully pinged google.com"),Le(2)):(this.j.info("Failed to ping google.com"),Le(1))};function Lh(g){if(g.G=0,g.ka=[],g.l){const _=lc(g.h);(_.length!=0||g.i.length!=0)&&(S(g.ka,_),S(g.ka,g.i),g.h.i.length=0,T(g.i),g.i.length=0),g.l.ra()}}function kh(g,_,I){var U=I instanceof nn?pi(I):new nn(I);if(U.g!="")_&&(U.g=_+"."+U.g),Ms(U,U.s);else{var et=c.location;U=et.protocol,_=_?_+"."+et.hostname:et.hostname,et=+et.port;var dt=new nn(null);U&&Na(dt,U),_&&(dt.g=_),et&&Ms(dt,et),I&&(dt.l=I),U=dt}return I=g.D,_=g.ya,I&&_&&Re(U,I,_),Re(U,"VER",g.la),Va(g,U),U}function Bh(g,_,I){if(_&&!g.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=g.Ca&&!g.pa?new Ae(new Ls({eb:I})):new Ae(g.pa),_.Ha(g.J),_}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Fh(){}r=Fh.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function $o(){}$o.prototype.g=function(g,_){return new Xn(g,_)};function Xn(g,_){Me.call(this),this.g=new jo(_),this.l=g,this.h=_&&_.messageUrlParams||null,g=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(g?g["X-WebChannel-Content-Type"]=_.messageContentType:g={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(g?g["X-WebChannel-Client-Profile"]=_.va:g={"X-WebChannel-Client-Profile":_.va}),this.g.S=g,(g=_&&_.Sb)&&!D(g)&&(this.g.m=g),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!D(_)&&(this.g.D=_,g=this.h,g!==null&&_ in g&&(g=this.h,_ in g&&delete g[_])),this.j=new pr(this)}b(Xn,Me),Xn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Xn.prototype.close=function(){gc(this.g)},Xn.prototype.o=function(g){var _=this.g;if(typeof g=="string"){var I={};I.__data__=g,g=I}else this.u&&(I={},I.__data__=ce(g),g=I);_.i.push(new Sh(_.Ya++,g)),_.G==3&&zo(_)},Xn.prototype.N=function(){this.g.l=null,delete this.j,gc(this.g),delete this.g,Xn.aa.N.call(this)};function Uh(g){Hr.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var _=g.__sm__;if(_){t:{for(const I in _){g=I;break t}g=void 0}(this.i=g)&&(g=this.i,_=_!==null&&g in _?_[g]:void 0),this.data=_}else this.data=g}b(Uh,Hr);function Vh(){ic.call(this),this.status=1}b(Vh,ic);function pr(g){this.g=g}b(pr,Fh),pr.prototype.ua=function(){L(this.g,"a")},pr.prototype.ta=function(g){L(this.g,new Uh(g))},pr.prototype.sa=function(g){L(this.g,new Vh)},pr.prototype.ra=function(){L(this.g,"b")},$o.prototype.createWebChannel=$o.prototype.g,Xn.prototype.send=Xn.prototype.o,Xn.prototype.open=Xn.prototype.m,Xn.prototype.close=Xn.prototype.close,wS=function(){return new $o},_S=function(){return xs()},TS=sr,dy={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ns.NO_ERROR=0,Ns.TIMEOUT=8,Ns.HTTP_ERROR=6,pf=Ns,zr.COMPLETE="complete",bS=zr,nc.EventType=jr,jr.OPEN="a",jr.CLOSE="b",jr.ERROR="c",jr.MESSAGE="d",Me.prototype.listen=Me.prototype.K,mu=nc,Ae.prototype.listenOnce=Ae.prototype.L,Ae.prototype.getLastError=Ae.prototype.Ka,Ae.prototype.getLastErrorCode=Ae.prototype.Ba,Ae.prototype.getStatus=Ae.prototype.Z,Ae.prototype.getResponseJson=Ae.prototype.Oa,Ae.prototype.getResponseText=Ae.prototype.oa,Ae.prototype.send=Ae.prototype.ea,Ae.prototype.setWithCredentials=Ae.prototype.Ha,AS=Ae}).apply(typeof zd<"u"?zd:typeof self<"u"?self:typeof window<"u"?window:{});const ET="@firebase/firestore",AT="4.9.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}zn.UNAUTHENTICATED=new zn(null),zn.GOOGLE_CREDENTIALS=new zn("google-credentials-uid"),zn.FIRST_PARTY=new zn("first-party-uid"),zn.MOCK_USER=new zn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ql="12.2.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo=new Jy("@firebase/firestore");function _l(){return vo.logLevel}function xt(r,...t){if(vo.logLevel<=se.DEBUG){const e=t.map(hv);vo.debug(`Firestore (${Ql}): ${r}`,...e)}}function ws(r,...t){if(vo.logLevel<=se.ERROR){const e=t.map(hv);vo.error(`Firestore (${Ql}): ${r}`,...e)}}function Ul(r,...t){if(vo.logLevel<=se.WARN){const e=t.map(hv);vo.warn(`Firestore (${Ql}): ${r}`,...e)}}function hv(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(e){return JSON.stringify(e)})(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(r,t,e){let n="Unexpected state";typeof t=="string"?n=t:e=t,SS(r,n,e)}function SS(r,t,e){let n=`FIRESTORE (${Ql}) INTERNAL ASSERTION FAILED: ${t} (ID: ${r.toString(16)})`;if(e!==void 0)try{n+=" CONTEXT: "+JSON.stringify(e)}catch{n+=" CONTEXT: "+e}throw ws(n),new Error(n)}function be(r,t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,r||SS(t,i,n)}function Kt(r,t){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Mt extends Ur{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class QN{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(zn.UNAUTHENTICATED)))}shutdown(){}}class JN{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class ZN{constructor(t){this.t=t,this.currentUser=zn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){be(this.o===void 0,42304);let n=this.i;const i=h=>this.i!==n?(n=this.i,e(h)):Promise.resolve();let a=new ga;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new ga,t.enqueueRetryable((()=>i(this.currentUser)))};const l=()=>{const h=a;t.enqueueRetryable((async()=>{await h.promise,await i(this.currentUser)}))},c=h=>{xt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((h=>c(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?c(h):(xt("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new ga)}}),0),l()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((n=>this.i!==t?(xt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(be(typeof n.accessToken=="string",31837,{l:n}),new RS(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return be(t===null||typeof t=="string",2055,{h:t}),new zn(t)}}class tP{constructor(t,e,n){this.P=t,this.T=e,this.I=n,this.type="FirstParty",this.user=zn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class eP{constructor(t,e,n){this.P=t,this.T=e,this.I=n}getToken(){return Promise.resolve(new tP(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(zn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class bT{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class nP{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,di(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){be(this.o===void 0,3512);const n=a=>{a.error!=null&&xt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,xt("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?e(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable((()=>n(a)))};const i=a=>{xt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):xt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new bT(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(be(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new bT(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iP(r){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(r);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let n=0;n<r;n++)e[n]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=iP(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<e&&(n+=t.charAt(i[a]%62))}return n}}function ae(r,t){return r<t?-1:r>t?1:0}function fy(r,t){const e=Math.min(r.length,t.length);for(let n=0;n<e;n++){const i=r.charAt(n),a=t.charAt(n);if(i!==a)return Fm(i)===Fm(a)?ae(i,a):Fm(i)?1:-1}return ae(r.length,t.length)}const rP=55296,sP=57343;function Fm(r){const t=r.charCodeAt(0);return t>=rP&&t<=sP}function Vl(r,t,e){return r.length===t.length&&r.every(((n,i)=>e(n,t[i])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TT="__name__";class Rr{constructor(t,e,n){e===void 0?e=0:e>t.length&&Ht(637,{offset:e,range:t.length}),n===void 0?n=t.length-e:n>t.length-e&&Ht(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return Rr.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Rr?t.forEach((n=>{e.push(n)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const a=Rr.compareSegments(t.get(i),e.get(i));if(a!==0)return a}return ae(t.length,e.length)}static compareSegments(t,e){const n=Rr.isNumericId(t),i=Rr.isNumericId(e);return n&&!i?-1:!n&&i?1:n&&i?Rr.extractNumericId(t).compare(Rr.extractNumericId(e)):fy(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return pa.fromString(t.substring(4,t.length-2))}}class He extends Rr{construct(t,e,n){return new He(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Mt(bt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((i=>i.length>0)))}return new He(e)}static emptyPath(){return new He([])}}const aP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kn extends Rr{construct(t,e,n){return new kn(t,e,n)}static isValidIdentifier(t){return aP.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kn.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===TT}static keyField(){return new kn([TT])}static fromServerFormat(t){const e=[];let n="",i=0;const a=()=>{if(n.length===0)throw new Mt(bt.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let l=!1;for(;i<t.length;){const c=t[i];if(c==="\\"){if(i+1===t.length)throw new Mt(bt.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const h=t[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new Mt(bt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=h,i+=2}else c==="`"?(l=!l,i++):c!=="."||l?(n+=c,i++):(a(),i++)}if(a(),l)throw new Mt(bt.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new kn(e)}static emptyPath(){return new kn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(t){this.path=t}static fromPath(t){return new kt(He.fromString(t))}static fromName(t){return new kt(He.fromString(t).popFirst(5))}static empty(){return new kt(He.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&He.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return He.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new kt(new He(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oP(r,t,e){if(!e)throw new Mt(bt.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${t}.`)}function lP(r,t,e,n){if(t===!0&&n===!0)throw new Mt(bt.INVALID_ARGUMENT,`${r} and ${e} cannot be used together.`)}function _T(r){if(!kt.isDocumentKey(r))throw new Mt(bt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function CS(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function fv(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const t=(function(n){return n.constructor?n.constructor.name:null})(r);return t?`a custom ${t} object`:"an object"}}return typeof r=="function"?"a function":Ht(12329,{type:typeof r})}function Uu(r,t){if("_delegate"in r&&(r=r._delegate),!(r instanceof t)){if(t.name===r.constructor.name)throw new Mt(bt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=fv(r);throw new Mt(bt.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return r}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hn(r,t){const e={typeString:r};return t&&(e.value=t),e}function oh(r,t){if(!CS(r))throw new Mt(bt.INVALID_ARGUMENT,"JSON must be an object");let e;for(const n in t)if(t[n]){const i=t[n].typeString,a="value"in t[n]?{value:t[n].value}:void 0;if(!(n in r)){e=`JSON missing required field: '${n}'`;break}const l=r[n];if(i&&typeof l!==i){e=`JSON field '${n}' must be a ${i}.`;break}if(a!==void 0&&l!==a.value){e=`Expected '${n}' field to equal '${a.value}'`;break}}if(e)throw new Mt(bt.INVALID_ARGUMENT,e);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wT=-62135596800,ST=1e6;class Pe{static now(){return Pe.fromMillis(Date.now())}static fromDate(t){return Pe.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*ST);return new Pe(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Mt(bt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Mt(bt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<wT)throw new Mt(bt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Mt(bt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ST}_compareTo(t){return this.seconds===t.seconds?ae(this.nanoseconds,t.nanoseconds):ae(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Pe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(oh(t,Pe._jsonSchema))return new Pe(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-wT;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Pe._jsonSchemaVersion="firestore/timestamp/1.0",Pe._jsonSchema={type:hn("string",Pe._jsonSchemaVersion),seconds:hn("number"),nanoseconds:hn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{static fromTimestamp(t){return new Wt(t)}static min(){return new Wt(new Pe(0,0))}static max(){return new Wt(new Pe(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vu=-1;function cP(r,t){const e=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=Wt.fromTimestamp(n===1e9?new Pe(e+1,0):new Pe(e,n));return new va(i,kt.empty(),t)}function uP(r){return new va(r.readTime,r.key,Vu)}class va{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new va(Wt.min(),kt.empty(),Vu)}static max(){return new va(Wt.max(),kt.empty(),Vu)}}function hP(r,t){let e=r.readTime.compareTo(t.readTime);return e!==0?e:(e=kt.comparator(r.documentKey,t.documentKey),e!==0?e:ae(r.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class fP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jl(r){if(r.code!==bt.FAILED_PRECONDITION||r.message!==dP)throw r;xt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Ht(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new At(((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(e,a).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof At?e:At.resolve(e)}catch(e){return At.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):At.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):At.reject(e)}static resolve(t){return new At(((e,n)=>{e(t)}))}static reject(t){return new At(((e,n)=>{n(t)}))}static waitFor(t){return new At(((e,n)=>{let i=0,a=0,l=!1;t.forEach((c=>{++i,c.next((()=>{++a,l&&a===i&&e()}),(h=>n(h)))})),l=!0,a===i&&e()}))}static or(t){let e=At.resolve(!1);for(const n of t)e=e.next((i=>i?At.resolve(i):n()));return e}static forEach(t,e){const n=[];return t.forEach(((i,a)=>{n.push(e.call(this,i,a))})),this.waitFor(n)}static mapArray(t,e){return new At(((n,i)=>{const a=t.length,l=new Array(a);let c=0;for(let h=0;h<a;h++){const d=h;e(t[d]).next((p=>{l[d]=p,++c,c===a&&n(l)}),(p=>i(p)))}}))}static doWhile(t,e){return new At(((n,i)=>{const a=()=>{t()===!0?e().next((()=>{a()}),i):n()};a()}))}}function pP(r){const t=r.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function Zl(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>e.writeSequenceNumber(n))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}ip.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pv=-1;function rp(r){return r==null}function Pf(r){return r===0&&1/r==-1/0}function gP(r){return typeof r=="number"&&Number.isInteger(r)&&!Pf(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IS="";function mP(r){let t="";for(let e=0;e<r.length;e++)t.length>0&&(t=RT(t)),t=yP(r.get(e),t);return RT(t)}function yP(r,t){let e=t;const n=r.length;for(let i=0;i<n;i++){const a=r.charAt(i);switch(a){case"\0":e+="";break;case IS:e+="";break;default:e+=a}}return e}function RT(r){return r+IS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CT(r){let t=0;for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&t++;return t}function So(r,t){for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&t(e,r[e])}function xS(r){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(t,e){this.comparator=t,this.root=e||Mn.EMPTY}insert(t,e){return new ze(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Mn.BLACK,null,null))}remove(t){return new ze(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Mn.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(n===0)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Gd(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Gd(this.root,t,this.comparator,!1)}getReverseIterator(){return new Gd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Gd(this.root,t,this.comparator,!0)}}class Gd{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=e?n(t.key,e):1,e&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(a===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Mn{constructor(t,e,n,i,a){this.key=t,this.value=e,this.color=n??Mn.RED,this.left=i??Mn.EMPTY,this.right=a??Mn.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,a){return new Mn(t??this.key,e??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const a=n(t,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(t,e,n),null):a===0?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Mn.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),e(t,i.key)===0){if(i.right.isEmpty())return Mn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Mn.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Mn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ht(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ht(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw Ht(27949);return t+(this.isRed()?0:1)}}Mn.EMPTY=null,Mn.RED=!0,Mn.BLACK=!1;Mn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ht(57766)}get value(){throw Ht(16141)}get color(){throw Ht(16727)}get left(){throw Ht(29726)}get right(){throw Ht(36894)}copy(t,e,n,i,a){return this}insert(t,e,n){return new Mn(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(t){this.comparator=t,this.data=new ze(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new IT(this.data.getIterator())}getIteratorFrom(t){return new IT(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((n=>{e=e.add(n)})),e}isEqual(t){if(!(t instanceof vn)||this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const i=e.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new vn(this.comparator);return e.data=t,e}}class IT{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(t){this.fields=t,t.sort(kn.comparator)}static empty(){return new er([])}unionWith(t){let e=new vn(kn.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new er(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Vl(this.fields,t.fields,((e,n)=>e.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new DS("Invalid base64 string: "+a):a}})(t);return new Fn(e)}static fromUint8Array(t){const e=(function(i){let a="";for(let l=0;l<i.length;++l)a+=String.fromCharCode(i[l]);return a})(t);return new Fn(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ae(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Fn.EMPTY_BYTE_STRING=new Fn("");const vP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ea(r){if(be(!!r,39018),typeof r=="string"){let t=0;const e=vP.exec(r);if(be(!!e,46558,{timestamp:r}),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:Je(r.seconds),nanos:Je(r.nanos)}}function Je(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Aa(r){return typeof r=="string"?Fn.fromBase64String(r):Fn.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS="server_timestamp",NS="__type__",PS="__previous_value__",MS="__local_write_time__";function gv(r){return(r?.mapValue?.fields||{})[NS]?.stringValue===OS}function sp(r){const t=r.mapValue.fields[PS];return gv(t)?sp(t):t}function ju(r){const t=Ea(r.mapValue.fields[MS].timestampValue);return new Pe(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(t,e,n,i,a,l,c,h,d,p){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=c,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=p}}const Mf="(default)";class Hu{constructor(t,e){this.projectId=t,this.database=e||Mf}static empty(){return new Hu("","")}get isDefaultDatabase(){return this.database===Mf}isEqual(t){return t instanceof Hu&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS="__type__",AP="__max__",$d={mapValue:{}},kS="__vector__",Lf="value";function ba(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?gv(r)?4:TP(r)?9007199254740991:bP(r)?10:11:Ht(28295,{value:r})}function Lr(r,t){if(r===t)return!0;const e=ba(r);if(e!==ba(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===t.booleanValue;case 4:return ju(r).isEqual(ju(t));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const l=Ea(i.timestampValue),c=Ea(a.timestampValue);return l.seconds===c.seconds&&l.nanos===c.nanos})(r,t);case 5:return r.stringValue===t.stringValue;case 6:return(function(i,a){return Aa(i.bytesValue).isEqual(Aa(a.bytesValue))})(r,t);case 7:return r.referenceValue===t.referenceValue;case 8:return(function(i,a){return Je(i.geoPointValue.latitude)===Je(a.geoPointValue.latitude)&&Je(i.geoPointValue.longitude)===Je(a.geoPointValue.longitude)})(r,t);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return Je(i.integerValue)===Je(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const l=Je(i.doubleValue),c=Je(a.doubleValue);return l===c?Pf(l)===Pf(c):isNaN(l)&&isNaN(c)}return!1})(r,t);case 9:return Vl(r.arrayValue.values||[],t.arrayValue.values||[],Lr);case 10:case 11:return(function(i,a){const l=i.mapValue.fields||{},c=a.mapValue.fields||{};if(CT(l)!==CT(c))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(c[h]===void 0||!Lr(l[h],c[h])))return!1;return!0})(r,t);default:return Ht(52216,{left:r})}}function zu(r,t){return(r.values||[]).find((e=>Lr(e,t)))!==void 0}function jl(r,t){if(r===t)return 0;const e=ba(r),n=ba(t);if(e!==n)return ae(e,n);switch(e){case 0:case 9007199254740991:return 0;case 1:return ae(r.booleanValue,t.booleanValue);case 2:return(function(a,l){const c=Je(a.integerValue||a.doubleValue),h=Je(l.integerValue||l.doubleValue);return c<h?-1:c>h?1:c===h?0:isNaN(c)?isNaN(h)?0:-1:1})(r,t);case 3:return xT(r.timestampValue,t.timestampValue);case 4:return xT(ju(r),ju(t));case 5:return fy(r.stringValue,t.stringValue);case 6:return(function(a,l){const c=Aa(a),h=Aa(l);return c.compareTo(h)})(r.bytesValue,t.bytesValue);case 7:return(function(a,l){const c=a.split("/"),h=l.split("/");for(let d=0;d<c.length&&d<h.length;d++){const p=ae(c[d],h[d]);if(p!==0)return p}return ae(c.length,h.length)})(r.referenceValue,t.referenceValue);case 8:return(function(a,l){const c=ae(Je(a.latitude),Je(l.latitude));return c!==0?c:ae(Je(a.longitude),Je(l.longitude))})(r.geoPointValue,t.geoPointValue);case 9:return DT(r.arrayValue,t.arrayValue);case 10:return(function(a,l){const c=a.fields||{},h=l.fields||{},d=c[Lf]?.arrayValue,p=h[Lf]?.arrayValue,m=ae(d?.values?.length||0,p?.values?.length||0);return m!==0?m:DT(d,p)})(r.mapValue,t.mapValue);case 11:return(function(a,l){if(a===$d.mapValue&&l===$d.mapValue)return 0;if(a===$d.mapValue)return 1;if(l===$d.mapValue)return-1;const c=a.fields||{},h=Object.keys(c),d=l.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let m=0;m<h.length&&m<p.length;++m){const v=fy(h[m],p[m]);if(v!==0)return v;const E=jl(c[h[m]],d[p[m]]);if(E!==0)return E}return ae(h.length,p.length)})(r.mapValue,t.mapValue);default:throw Ht(23264,{he:e})}}function xT(r,t){if(typeof r=="string"&&typeof t=="string"&&r.length===t.length)return ae(r,t);const e=Ea(r),n=Ea(t),i=ae(e.seconds,n.seconds);return i!==0?i:ae(e.nanos,n.nanos)}function DT(r,t){const e=r.values||[],n=t.values||[];for(let i=0;i<e.length&&i<n.length;++i){const a=jl(e[i],n[i]);if(a)return a}return ae(e.length,n.length)}function Hl(r){return py(r)}function py(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?(function(e){const n=Ea(e);return`time(${n.seconds},${n.nanos})`})(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?(function(e){return Aa(e).toBase64()})(r.bytesValue):"referenceValue"in r?(function(e){return kt.fromName(e).toString()})(r.referenceValue):"geoPointValue"in r?(function(e){return`geo(${e.latitude},${e.longitude})`})(r.geoPointValue):"arrayValue"in r?(function(e){let n="[",i=!0;for(const a of e.values||[])i?i=!1:n+=",",n+=py(a);return n+"]"})(r.arrayValue):"mapValue"in r?(function(e){const n=Object.keys(e.fields||{}).sort();let i="{",a=!0;for(const l of n)a?a=!1:i+=",",i+=`${l}:${py(e.fields[l])}`;return i+"}"})(r.mapValue):Ht(61005,{value:r})}function gf(r){switch(ba(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=sp(r);return t?16+gf(t):16;case 5:return 2*r.stringValue.length;case 6:return Aa(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((i,a)=>i+gf(a)),0)})(r.arrayValue);case 10:case 11:return(function(n){let i=0;return So(n.fields,((a,l)=>{i+=a.length+gf(l)})),i})(r.mapValue);default:throw Ht(13486,{value:r})}}function gy(r){return!!r&&"integerValue"in r}function mv(r){return!!r&&"arrayValue"in r}function OT(r){return!!r&&"nullValue"in r}function NT(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function mf(r){return!!r&&"mapValue"in r}function bP(r){return(r?.mapValue?.fields||{})[LS]?.stringValue===kS}function Cu(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:{...r.timestampValue}};if(r.mapValue){const t={mapValue:{fields:{}}};return So(r.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Cu(n))),t}if(r.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(r.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Cu(r.arrayValue.values[e]);return t}return{...r}}function TP(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===AP}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(t){this.value=t}static empty(){return new Hi({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!mf(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Cu(e)}setAll(t){let e=kn.emptyPath(),n={},i=[];t.forEach(((l,c)=>{if(!e.isImmediateParentOf(c)){const h=this.getFieldsMap(e);this.applyChanges(h,n,i),n={},i=[],e=c.popLast()}l?n[c.lastSegment()]=Cu(l):i.push(c.lastSegment())}));const a=this.getFieldsMap(e);this.applyChanges(a,n,i)}delete(t){const e=this.field(t.popLast());mf(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Lr(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];mf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){So(e,((i,a)=>t[i]=a));for(const i of n)delete t[i]}clone(){return new Hi(Cu(this.value))}}function BS(r){const t=[];return So(r.fields,((e,n)=>{const i=new kn([e]);if(mf(n)){const a=BS(n.mapValue).fields;if(a.length===0)t.push(i);else for(const l of a)t.push(i.child(l))}else t.push(i)})),new er(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(t,e,n,i,a,l,c){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=a,this.data=l,this.documentState=c}static newInvalidDocument(t){return new Gn(t,0,Wt.min(),Wt.min(),Wt.min(),Hi.empty(),0)}static newFoundDocument(t,e,n,i){return new Gn(t,1,e,Wt.min(),n,i,0)}static newNoDocument(t,e){return new Gn(t,2,e,Wt.min(),Wt.min(),Hi.empty(),0)}static newUnknownDocument(t,e){return new Gn(t,3,e,Wt.min(),Wt.min(),Hi.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Wt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Hi.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Hi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Wt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Gn&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Gn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(t,e){this.position=t,this.inclusive=e}}function PT(r,t,e){let n=0;for(let i=0;i<r.position.length;i++){const a=t[i],l=r.position[i];if(a.field.isKeyField()?n=kt.comparator(kt.fromName(l.referenceValue),e.key):n=jl(l,e.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function MT(r,t){if(r===null)return t===null;if(t===null||r.inclusive!==t.inclusive||r.position.length!==t.position.length)return!1;for(let e=0;e<r.position.length;e++)if(!Lr(r.position[e],t.position[e]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(t,e="asc"){this.field=t,this.dir=e}}function _P(r,t){return r.dir===t.dir&&r.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{}class yn extends FS{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,n):new SP(t,e,n):e==="array-contains"?new IP(t,n):e==="in"?new xP(t,n):e==="not-in"?new DP(t,n):e==="array-contains-any"?new OP(t,n):new yn(t,e,n)}static createKeyFieldInFilter(t,e,n){return e==="in"?new RP(t,n):new CP(t,n)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(jl(e,this.value)):e!==null&&ba(this.value)===ba(e)&&this.matchesComparison(jl(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Ht(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class kr extends FS{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new kr(t,e)}matches(t){return US(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function US(r){return r.op==="and"}function VS(r){return wP(r)&&US(r)}function wP(r){for(const t of r.filters)if(t instanceof kr)return!1;return!0}function my(r){if(r instanceof yn)return r.field.canonicalString()+r.op.toString()+Hl(r.value);if(VS(r))return r.filters.map((t=>my(t))).join(",");{const t=r.filters.map((e=>my(e))).join(",");return`${r.op}(${t})`}}function jS(r,t){return r instanceof yn?(function(n,i){return i instanceof yn&&n.op===i.op&&n.field.isEqual(i.field)&&Lr(n.value,i.value)})(r,t):r instanceof kr?(function(n,i){return i instanceof kr&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce(((a,l,c)=>a&&jS(l,i.filters[c])),!0):!1})(r,t):void Ht(19439)}function HS(r){return r instanceof yn?(function(e){return`${e.field.canonicalString()} ${e.op} ${Hl(e.value)}`})(r):r instanceof kr?(function(e){return e.op.toString()+" {"+e.getFilters().map(HS).join(" ,")+"}"})(r):"Filter"}class SP extends yn{constructor(t,e,n){super(t,e,n),this.key=kt.fromName(n.referenceValue)}matches(t){const e=kt.comparator(t.key,this.key);return this.matchesComparison(e)}}class RP extends yn{constructor(t,e){super(t,"in",e),this.keys=zS("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class CP extends yn{constructor(t,e){super(t,"not-in",e),this.keys=zS("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function zS(r,t){return(t.arrayValue?.values||[]).map((e=>kt.fromName(e.referenceValue)))}class IP extends yn{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return mv(e)&&zu(e.arrayValue,this.value)}}class xP extends yn{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&zu(this.value.arrayValue,e)}}class DP extends yn{constructor(t,e){super(t,"not-in",e)}matches(t){if(zu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!zu(this.value.arrayValue,e)}}class OP extends yn{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!mv(e)||!e.arrayValue.values)&&e.arrayValue.values.some((n=>zu(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(t,e=null,n=[],i=[],a=null,l=null,c=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=l,this.endAt=c,this.Te=null}}function LT(r,t=null,e=[],n=[],i=null,a=null,l=null){return new NP(r,t,e,n,i,a,l)}function yv(r){const t=Kt(r);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((n=>my(n))).join(","),e+="|ob:",e+=t.orderBy.map((n=>(function(a){return a.field.canonicalString()+a.dir})(n))).join(","),rp(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((n=>Hl(n))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((n=>Hl(n))).join(",")),t.Te=e}return t.Te}function vv(r,t){if(r.limit!==t.limit||r.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<r.orderBy.length;e++)if(!_P(r.orderBy[e],t.orderBy[e]))return!1;if(r.filters.length!==t.filters.length)return!1;for(let e=0;e<r.filters.length;e++)if(!jS(r.filters[e],t.filters[e]))return!1;return r.collectionGroup===t.collectionGroup&&!!r.path.isEqual(t.path)&&!!MT(r.startAt,t.startAt)&&MT(r.endAt,t.endAt)}function yy(r){return kt.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(t,e=null,n=[],i=[],a=null,l="F",c=null,h=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=l,this.startAt=c,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function PP(r,t,e,n,i,a,l,c){return new ap(r,t,e,n,i,a,l,c)}function Ev(r){return new ap(r)}function kT(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function MP(r){return r.collectionGroup!==null}function Iu(r){const t=Kt(r);if(t.Ie===null){t.Ie=[];const e=new Set;for(const a of t.explicitOrderBy)t.Ie.push(a),e.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(l){let c=new vn(kn.comparator);return l.filters.forEach((h=>{h.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(t).forEach((a=>{e.has(a.canonicalString())||a.isKeyField()||t.Ie.push(new Bf(a,n))})),e.has(kn.keyField().canonicalString())||t.Ie.push(new Bf(kn.keyField(),n))}return t.Ie}function Or(r){const t=Kt(r);return t.Ee||(t.Ee=LP(t,Iu(r))),t.Ee}function LP(r,t){if(r.limitType==="F")return LT(r.path,r.collectionGroup,t,r.filters,r.limit,r.startAt,r.endAt);{t=t.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new Bf(i.field,a)}));const e=r.endAt?new kf(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new kf(r.startAt.position,r.startAt.inclusive):null;return LT(r.path,r.collectionGroup,t,r.filters,r.limit,e,n)}}function vy(r,t,e){return new ap(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),t,e,r.startAt,r.endAt)}function op(r,t){return vv(Or(r),Or(t))&&r.limitType===t.limitType}function GS(r){return`${yv(Or(r))}|lt:${r.limitType}`}function wl(r){return`Query(target=${(function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map((i=>HS(i))).join(", ")}]`),rp(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map((i=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(i))).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>Hl(i))).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>Hl(i))).join(",")),`Target(${n})`})(Or(r))}; limitType=${r.limitType})`}function lp(r,t){return t.isFoundDocument()&&(function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):kt.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)})(r,t)&&(function(n,i){for(const a of Iu(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(r,t)&&(function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0})(r,t)&&(function(n,i){return!(n.startAt&&!(function(l,c,h){const d=PT(l,c,h);return l.inclusive?d<=0:d<0})(n.startAt,Iu(n),i)||n.endAt&&!(function(l,c,h){const d=PT(l,c,h);return l.inclusive?d>=0:d>0})(n.endAt,Iu(n),i))})(r,t)}function kP(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function $S(r){return(t,e)=>{let n=!1;for(const i of Iu(r)){const a=BP(i,t,e);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function BP(r,t,e){const n=r.field.isKeyField()?kt.comparator(t.key,e.key):(function(a,l,c){const h=l.data.field(a),d=c.data.field(a);return h!==null&&d!==null?jl(h,d):Ht(42886)})(r.field,t,e);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Ht(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,t))return a}}has(t){return this.get(t)!==void 0}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return this.inner[n]=[[t,e]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],t))return void(i[a]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return n.length===1?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){So(this.inner,((e,n)=>{for(const[i,a]of n)t(i,a)}))}isEmpty(){return xS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FP=new ze(kt.comparator);function Ss(){return FP}const YS=new ze(kt.comparator);function yu(...r){let t=YS;for(const e of r)t=t.insert(e.key,e);return t}function WS(r){let t=YS;return r.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function so(){return xu()}function KS(){return xu()}function xu(){return new Ro((r=>r.toString()),((r,t)=>r.isEqual(t)))}const UP=new ze(kt.comparator),VP=new vn(kt.comparator);function oe(...r){let t=VP;for(const e of r)t=t.add(e);return t}const jP=new vn(ae);function HP(){return jP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Av(r,t){if(r.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pf(t)?"-0":t}}function XS(r){return{integerValue:""+r}}function zP(r,t){return gP(t)?XS(t):Av(r,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp{constructor(){this._=void 0}}function GP(r,t,e){return r instanceof Ff?(function(i,a){const l={fields:{[NS]:{stringValue:OS},[MS]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&gv(a)&&(a=sp(a)),a&&(l.fields[PS]=a),{mapValue:l}})(e,t):r instanceof Gu?QS(r,t):r instanceof $u?JS(r,t):(function(i,a){const l=qS(i,a),c=BT(l)+BT(i.Ae);return gy(l)&&gy(i.Ae)?XS(c):Av(i.serializer,c)})(r,t)}function $P(r,t,e){return r instanceof Gu?QS(r,t):r instanceof $u?JS(r,t):e}function qS(r,t){return r instanceof Uf?(function(n){return gy(n)||(function(a){return!!a&&"doubleValue"in a})(n)})(t)?t:{integerValue:0}:null}class Ff extends cp{}class Gu extends cp{constructor(t){super(),this.elements=t}}function QS(r,t){const e=ZS(t);for(const n of r.elements)e.some((i=>Lr(i,n)))||e.push(n);return{arrayValue:{values:e}}}class $u extends cp{constructor(t){super(),this.elements=t}}function JS(r,t){let e=ZS(t);for(const n of r.elements)e=e.filter((i=>!Lr(i,n)));return{arrayValue:{values:e}}}class Uf extends cp{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function BT(r){return Je(r.integerValue||r.doubleValue)}function ZS(r){return mv(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function YP(r,t){return r.field.isEqual(t.field)&&(function(n,i){return n instanceof Gu&&i instanceof Gu||n instanceof $u&&i instanceof $u?Vl(n.elements,i.elements,Lr):n instanceof Uf&&i instanceof Uf?Lr(n.Ae,i.Ae):n instanceof Ff&&i instanceof Ff})(r.transform,t.transform)}class WP{constructor(t,e){this.version=t,this.transformResults=e}}class As{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new As}static exists(t){return new As(void 0,t)}static updateTime(t){return new As(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function yf(r,t){return r.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(r.updateTime):r.exists===void 0||r.exists===t.isFoundDocument()}class up{}function t1(r,t){if(!r.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return r.isNoDocument()?new n1(r.key,As.none()):new lh(r.key,r.data,As.none());{const e=r.data,n=Hi.empty();let i=new vn(kn.comparator);for(let a of t.fields)if(!i.has(a)){let l=e.field(a);l===null&&a.length>1&&(a=a.popLast(),l=e.field(a)),l===null?n.delete(a):n.set(a,l),i=i.add(a)}return new Co(r.key,n,new er(i.toArray()),As.none())}}function KP(r,t,e){r instanceof lh?(function(i,a,l){const c=i.value.clone(),h=UT(i.fieldTransforms,a,l.transformResults);c.setAll(h),a.convertToFoundDocument(l.version,c).setHasCommittedMutations()})(r,t,e):r instanceof Co?(function(i,a,l){if(!yf(i.precondition,a))return void a.convertToUnknownDocument(l.version);const c=UT(i.fieldTransforms,a,l.transformResults),h=a.data;h.setAll(e1(i)),h.setAll(c),a.convertToFoundDocument(l.version,h).setHasCommittedMutations()})(r,t,e):(function(i,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,t,e)}function Du(r,t,e,n){return r instanceof lh?(function(a,l,c,h){if(!yf(a.precondition,l))return c;const d=a.value.clone(),p=VT(a.fieldTransforms,h,l);return d.setAll(p),l.convertToFoundDocument(l.version,d).setHasLocalMutations(),null})(r,t,e,n):r instanceof Co?(function(a,l,c,h){if(!yf(a.precondition,l))return c;const d=VT(a.fieldTransforms,h,l),p=l.data;return p.setAll(e1(a)),p.setAll(d),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((m=>m.field)))})(r,t,e,n):(function(a,l,c){return yf(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):c})(r,t,e)}function XP(r,t){let e=null;for(const n of r.fieldTransforms){const i=t.data.field(n.field),a=qS(n.transform,i||null);a!=null&&(e===null&&(e=Hi.empty()),e.set(n.field,a))}return e||null}function FT(r,t){return r.type===t.type&&!!r.key.isEqual(t.key)&&!!r.precondition.isEqual(t.precondition)&&!!(function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Vl(n,i,((a,l)=>YP(a,l)))})(r.fieldTransforms,t.fieldTransforms)&&(r.type===0?r.value.isEqual(t.value):r.type!==1||r.data.isEqual(t.data)&&r.fieldMask.isEqual(t.fieldMask))}class lh extends up{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Co extends up{constructor(t,e,n,i,a=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function e1(r){const t=new Map;return r.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const n=r.data.field(e);t.set(e,n)}})),t}function UT(r,t,e){const n=new Map;be(r.length===e.length,32656,{Re:e.length,Ve:r.length});for(let i=0;i<e.length;i++){const a=r[i],l=a.transform,c=t.data.field(a.field);n.set(a.field,$P(l,c,e[i]))}return n}function VT(r,t,e){const n=new Map;for(const i of r){const a=i.transform,l=e.data.field(i.field);n.set(i.field,GP(a,l,t))}return n}class n1 extends up{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class qP extends up{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(t.key)&&KP(a,t,n[i])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=Du(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=Du(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=KS();return this.mutations.forEach((i=>{const a=t.get(i.key),l=a.overlayedDocument;let c=this.applyToLocalView(l,a.mutatedFields);c=e.has(i.key)?null:c;const h=t1(l,c);h!==null&&n.set(i.key,h),l.isValidDocument()||l.convertToNoDocument(Wt.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),oe())}isEqual(t){return this.batchId===t.batchId&&Vl(this.mutations,t.mutations,((e,n)=>FT(e,n)))&&Vl(this.baseMutations,t.baseMutations,((e,n)=>FT(e,n)))}}class bv{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){be(t.mutations.length===n.length,58842,{me:t.mutations.length,fe:n.length});let i=(function(){return UP})();const a=t.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,n[l].version);return new bv(t,e,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(t,e){this.count=t,this.unchangedNames=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ln,fe;function tM(r){switch(r){case bt.OK:return Ht(64938);case bt.CANCELLED:case bt.UNKNOWN:case bt.DEADLINE_EXCEEDED:case bt.RESOURCE_EXHAUSTED:case bt.INTERNAL:case bt.UNAVAILABLE:case bt.UNAUTHENTICATED:return!1;case bt.INVALID_ARGUMENT:case bt.NOT_FOUND:case bt.ALREADY_EXISTS:case bt.PERMISSION_DENIED:case bt.FAILED_PRECONDITION:case bt.ABORTED:case bt.OUT_OF_RANGE:case bt.UNIMPLEMENTED:case bt.DATA_LOSS:return!0;default:return Ht(15467,{code:r})}}function i1(r){if(r===void 0)return ws("GRPC error has no .code"),bt.UNKNOWN;switch(r){case ln.OK:return bt.OK;case ln.CANCELLED:return bt.CANCELLED;case ln.UNKNOWN:return bt.UNKNOWN;case ln.DEADLINE_EXCEEDED:return bt.DEADLINE_EXCEEDED;case ln.RESOURCE_EXHAUSTED:return bt.RESOURCE_EXHAUSTED;case ln.INTERNAL:return bt.INTERNAL;case ln.UNAVAILABLE:return bt.UNAVAILABLE;case ln.UNAUTHENTICATED:return bt.UNAUTHENTICATED;case ln.INVALID_ARGUMENT:return bt.INVALID_ARGUMENT;case ln.NOT_FOUND:return bt.NOT_FOUND;case ln.ALREADY_EXISTS:return bt.ALREADY_EXISTS;case ln.PERMISSION_DENIED:return bt.PERMISSION_DENIED;case ln.FAILED_PRECONDITION:return bt.FAILED_PRECONDITION;case ln.ABORTED:return bt.ABORTED;case ln.OUT_OF_RANGE:return bt.OUT_OF_RANGE;case ln.UNIMPLEMENTED:return bt.UNIMPLEMENTED;case ln.DATA_LOSS:return bt.DATA_LOSS;default:return Ht(39323,{code:r})}}(fe=ln||(ln={}))[fe.OK=0]="OK",fe[fe.CANCELLED=1]="CANCELLED",fe[fe.UNKNOWN=2]="UNKNOWN",fe[fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fe[fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fe[fe.NOT_FOUND=5]="NOT_FOUND",fe[fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",fe[fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",fe[fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",fe[fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fe[fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fe[fe.ABORTED=10]="ABORTED",fe[fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",fe[fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",fe[fe.INTERNAL=13]="INTERNAL",fe[fe.UNAVAILABLE=14]="UNAVAILABLE",fe[fe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nM=new pa([4294967295,4294967295],0);function jT(r){const t=eM().encode(r),e=new ES;return e.update(t),new Uint8Array(e.digest())}function HT(r){const t=new DataView(r.buffer),e=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new pa([e,n],0),new pa([i,a],0)]}class Tv{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new vu(`Invalid padding: ${e}`);if(n<0)throw new vu(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new vu(`Invalid hash count: ${n}`);if(t.length===0&&e!==0)throw new vu(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=pa.fromNumber(this.ge)}ye(t,e,n){let i=t.add(e.multiply(pa.fromNumber(n)));return i.compare(nM)===1&&(i=new pa([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=jT(t),[n,i]=HT(e);for(let a=0;a<this.hashCount;a++){const l=this.ye(n,i,a);if(!this.we(l))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,a=new Uint8Array(Math.ceil(t/8)),l=new Tv(a,i,e);return n.forEach((c=>l.insert(c))),l}insert(t){if(this.ge===0)return;const e=jT(t),[n,i]=HT(e);for(let a=0;a<this.hashCount;a++){const l=this.ye(n,i,a);this.Se(l)}}Se(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class vu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(t,e,n,i,a){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,ch.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new hp(Wt.min(),i,new ze(ae),Ss(),oe())}}class ch{constructor(t,e,n,i,a){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new ch(n,e,oe(),oe(),oe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(t,e,n,i){this.be=t,this.removedTargetIds=e,this.key=n,this.De=i}}class r1{constructor(t,e){this.targetId=t,this.Ce=e}}class s1{constructor(t,e,n=Fn.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class zT{constructor(){this.ve=0,this.Fe=GT(),this.Me=Fn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=oe(),e=oe(),n=oe();return this.Fe.forEach(((i,a)=>{switch(a){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:Ht(38017,{changeType:a})}})),new ch(this.Me,this.xe,t,e,n)}qe(){this.Oe=!1,this.Fe=GT()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,be(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class iM{constructor(t){this.Ge=t,this.ze=new Map,this.je=Ss(),this.Je=Yd(),this.He=Yd(),this.Ye=new ze(ae)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const n=this.nt(e);switch(t.state){case 0:this.rt(e)&&n.Le(t.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(t.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(n.We(),n.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),n.Le(t.resumeToken));break;default:Ht(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((n,i)=>{this.rt(i)&&e(i)}))}st(t){const e=t.targetId,n=t.Ce.count,i=this.ot(e);if(i){const a=i.target;if(yy(a))if(n===0){const l=new kt(a.path);this.et(e,l,Gn.newNoDocument(l,Wt.min()))}else be(n===1,20013,{expectedCount:n});else{const l=this._t(e);if(l!==n){const c=this.ut(t),h=c?this.ct(c,t,l):1;if(h!==0){this.it(e);const d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,d)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=e;let l,c;try{l=Aa(n).toUint8Array()}catch(h){if(h instanceof DS)return Ul("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{c=new Tv(l,i,a)}catch(h){return Ul(h instanceof vu?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return c.ge===0?null:c}ct(t,e,n){return e.Ce.count===n-this.Pt(t,e.targetId)?0:2}Pt(t,e){const n=this.Ge.getRemoteKeysForTarget(e);let i=0;return n.forEach((a=>{const l=this.Ge.ht(),c=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;t.mightContain(c)||(this.et(e,a,null),i++)})),i}Tt(t){const e=new Map;this.ze.forEach(((a,l)=>{const c=this.ot(l);if(c){if(a.current&&yy(c.target)){const h=new kt(c.target.path);this.It(h).has(l)||this.Et(l,h)||this.et(l,h,Gn.newNoDocument(h,t))}a.Be&&(e.set(l,a.ke()),a.qe())}}));let n=oe();this.He.forEach(((a,l)=>{let c=!0;l.forEachWhile((h=>{const d=this.ot(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(n=n.add(a))})),this.je.forEach(((a,l)=>l.setReadTime(t)));const i=new hp(t,e,this.Ye,this.je,n);return this.je=Ss(),this.Je=Yd(),this.He=Yd(),this.Ye=new ze(ae),i}Xe(t,e){if(!this.rt(t))return;const n=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,n),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,n){if(!this.rt(t))return;const i=this.nt(t);this.Et(t,e)?i.Qe(e,1):i.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),n&&(this.je=this.je.insert(e,n))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new zT,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new vn(ae),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new vn(ae),this.Je=this.Je.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||xt("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new zT),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function Yd(){return new ze(kt.comparator)}function GT(){return new ze(kt.comparator)}const rM={asc:"ASCENDING",desc:"DESCENDING"},sM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},aM={and:"AND",or:"OR"};class oM{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Ey(r,t){return r.useProto3Json||rp(t)?t:{value:t}}function Vf(r,t){return r.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function a1(r,t){return r.useProto3Json?t.toBase64():t.toUint8Array()}function lM(r,t){return Vf(r,t.toTimestamp())}function Nr(r){return be(!!r,49232),Wt.fromTimestamp((function(e){const n=Ea(e);return new Pe(n.seconds,n.nanos)})(r))}function _v(r,t){return Ay(r,t).canonicalString()}function Ay(r,t){const e=(function(i){return new He(["projects",i.projectId,"databases",i.database])})(r).child("documents");return t===void 0?e:e.child(t)}function o1(r){const t=He.fromString(r);return be(d1(t),10190,{key:t.toString()}),t}function by(r,t){return _v(r.databaseId,t.path)}function Um(r,t){const e=o1(t);if(e.get(1)!==r.databaseId.projectId)throw new Mt(bt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+r.databaseId.projectId);if(e.get(3)!==r.databaseId.database)throw new Mt(bt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+r.databaseId.database);return new kt(c1(e))}function l1(r,t){return _v(r.databaseId,t)}function cM(r){const t=o1(r);return t.length===4?He.emptyPath():c1(t)}function Ty(r){return new He(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function c1(r){return be(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function $T(r,t,e){return{name:by(r,t),fields:e.value.mapValue.fields}}function uM(r,t){let e;if("targetChange"in t){t.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ht(39313,{state:d})})(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=(function(d,p){return d.useProto3Json?(be(p===void 0||typeof p=="string",58123),Fn.fromBase64String(p||"")):(be(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Fn.fromUint8Array(p||new Uint8Array))})(r,t.targetChange.resumeToken),l=t.targetChange.cause,c=l&&(function(d){const p=d.code===void 0?bt.UNKNOWN:i1(d.code);return new Mt(p,d.message||"")})(l);e=new s1(n,i,a,c||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const i=Um(r,n.document.name),a=Nr(n.document.updateTime),l=n.document.createTime?Nr(n.document.createTime):Wt.min(),c=new Hi({mapValue:{fields:n.document.fields}}),h=Gn.newFoundDocument(i,a,l,c),d=n.targetIds||[],p=n.removedTargetIds||[];e=new vf(d,p,h.key,h)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const i=Um(r,n.document),a=n.readTime?Nr(n.readTime):Wt.min(),l=Gn.newNoDocument(i,a),c=n.removedTargetIds||[];e=new vf([],c,l.key,l)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const i=Um(r,n.document),a=n.removedTargetIds||[];e=new vf([],a,i,null)}else{if(!("filter"in t))return Ht(11601,{Rt:t});{t.filter;const n=t.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,l=new ZP(i,a),c=n.targetId;e=new r1(c,l)}}return e}function hM(r,t){let e;if(t instanceof lh)e={update:$T(r,t.key,t.value)};else if(t instanceof n1)e={delete:by(r,t.key)};else if(t instanceof Co)e={update:$T(r,t.key,t.data),updateMask:AM(t.fieldMask)};else{if(!(t instanceof qP))return Ht(16599,{Vt:t.type});e={verify:by(r,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((n=>(function(a,l){const c=l.transform;if(c instanceof Ff)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Gu)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof $u)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Uf)return{fieldPath:l.field.canonicalString(),increment:c.Ae};throw Ht(20930,{transform:l.transform})})(0,n)))),t.precondition.isNone||(e.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:lM(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ht(27497)})(r,t.precondition)),e}function dM(r,t){return r&&r.length>0?(be(t!==void 0,14353),r.map((e=>(function(i,a){let l=i.updateTime?Nr(i.updateTime):Nr(a);return l.isEqual(Wt.min())&&(l=Nr(a)),new WP(l,i.transformResults||[])})(e,t)))):[]}function fM(r,t){return{documents:[l1(r,t.path)]}}function pM(r,t){const e={structuredQuery:{}},n=t.path;let i;t.collectionGroup!==null?(i=n,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=n.popLast(),e.structuredQuery.from=[{collectionId:n.lastSegment()}]),e.parent=l1(r,i);const a=(function(d){if(d.length!==0)return h1(kr.create(d,"and"))})(t.filters);a&&(e.structuredQuery.where=a);const l=(function(d){if(d.length!==0)return d.map((p=>(function(v){return{field:Sl(v.field),direction:yM(v.dir)}})(p)))})(t.orderBy);l&&(e.structuredQuery.orderBy=l);const c=Ey(r,t.limit);return c!==null&&(e.structuredQuery.limit=c),t.startAt&&(e.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(t.endAt)),{ft:e,parent:i}}function gM(r){let t=cM(r.parent);const e=r.structuredQuery,n=e.from?e.from.length:0;let i=null;if(n>0){be(n===1,65062);const p=e.from[0];p.allDescendants?i=p.collectionId:t=t.child(p.collectionId)}let a=[];e.where&&(a=(function(m){const v=u1(m);return v instanceof kr&&VS(v)?v.getFilters():[v]})(e.where));let l=[];e.orderBy&&(l=(function(m){return m.map((v=>(function(b){return new Bf(Rl(b.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(b.direction))})(v)))})(e.orderBy));let c=null;e.limit&&(c=(function(m){let v;return v=typeof m=="object"?m.value:m,rp(v)?null:v})(e.limit));let h=null;e.startAt&&(h=(function(m){const v=!!m.before,E=m.values||[];return new kf(E,v)})(e.startAt));let d=null;return e.endAt&&(d=(function(m){const v=!m.before,E=m.values||[];return new kf(E,v)})(e.endAt)),PP(t,i,l,a,c,"F",h,d)}function mM(r,t){const e=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ht(28987,{purpose:i})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function u1(r){return r.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=Rl(e.unaryFilter.field);return yn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Rl(e.unaryFilter.field);return yn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Rl(e.unaryFilter.field);return yn.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Rl(e.unaryFilter.field);return yn.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ht(61313);default:return Ht(60726)}})(r):r.fieldFilter!==void 0?(function(e){return yn.create(Rl(e.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ht(58110);default:return Ht(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(r):r.compositeFilter!==void 0?(function(e){return kr.create(e.compositeFilter.filters.map((n=>u1(n))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ht(1026)}})(e.compositeFilter.op))})(r):Ht(30097,{filter:r})}function yM(r){return rM[r]}function vM(r){return sM[r]}function EM(r){return aM[r]}function Sl(r){return{fieldPath:r.canonicalString()}}function Rl(r){return kn.fromServerFormat(r.fieldPath)}function h1(r){return r instanceof yn?(function(e){if(e.op==="=="){if(NT(e.value))return{unaryFilter:{field:Sl(e.field),op:"IS_NAN"}};if(OT(e.value))return{unaryFilter:{field:Sl(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(NT(e.value))return{unaryFilter:{field:Sl(e.field),op:"IS_NOT_NAN"}};if(OT(e.value))return{unaryFilter:{field:Sl(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Sl(e.field),op:vM(e.op),value:e.value}}})(r):r instanceof kr?(function(e){const n=e.getFilters().map((i=>h1(i)));return n.length===1?n[0]:{compositeFilter:{op:EM(e.op),filters:n}}})(r):Ht(54877,{filter:r})}function AM(r){const t=[];return r.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function d1(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(t,e,n,i,a=Wt.min(),l=Wt.min(),c=Fn.EMPTY_BYTE_STRING,h=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=c,this.expectedCount=h}withSequenceNumber(t){return new ha(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new ha(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ha(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ha(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bM{constructor(t){this.yt=t}}function TM(r){const t=gM({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?vy(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _M{constructor(){this.Cn=new wM}addToCollectionParentIndex(t,e){return this.Cn.add(e),At.resolve()}getCollectionParents(t,e){return At.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return At.resolve()}deleteFieldIndex(t,e){return At.resolve()}deleteAllFieldIndexes(t){return At.resolve()}createTargetIndexes(t,e){return At.resolve()}getDocumentsMatchingTarget(t,e){return At.resolve(null)}getIndexType(t,e){return At.resolve(0)}getFieldIndexes(t,e){return At.resolve([])}getNextCollectionGroupToUpdate(t){return At.resolve(null)}getMinOffset(t,e){return At.resolve(va.min())}getMinOffsetFromCollectionGroup(t,e){return At.resolve(va.min())}updateCollectionGroup(t,e,n){return At.resolve()}updateIndexEntries(t,e){return At.resolve()}}class wM{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new vn(He.comparator),a=!i.has(n);return this.index[e]=i.add(n),a}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new vn(He.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},f1=41943040;class hi{static withCacheSize(t){return new hi(t,hi.DEFAULT_COLLECTION_PERCENTILE,hi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hi.DEFAULT_COLLECTION_PERCENTILE=10,hi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hi.DEFAULT=new hi(f1,hi.DEFAULT_COLLECTION_PERCENTILE,hi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hi.DISABLED=new hi(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new zl(0)}static cr(){return new zl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT="LruGarbageCollector",SM=1048576;function KT([r,t],[e,n]){const i=ae(r,e);return i===0?ae(t,n):i}class RM{constructor(t){this.Ir=t,this.buffer=new vn(KT),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const n=this.buffer.last();KT(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}}get maxValue(){return this.buffer.last()[0]}}class CM{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){xt(WT,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Zl(e)?xt(WT,"Ignoring IndexedDB error during garbage collection: ",e):await Jl(e)}await this.Vr(3e5)}))}}class IM{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next((n=>Math.floor(e/100*n)))}nthSequenceNumber(t,e){if(e===0)return At.resolve(ip.ce);const n=new RM(e);return this.mr.forEachTarget(t,(i=>n.Ar(i.sequenceNumber))).next((()=>this.mr.pr(t,(i=>n.Ar(i))))).next((()=>n.maxValue))}removeTargets(t,e,n){return this.mr.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(xt("LruGarbageCollector","Garbage collection skipped; disabled"),At.resolve(YT)):this.getCacheSize(t).next((n=>n<this.params.cacheSizeCollectionThreshold?(xt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),YT):this.yr(t,e)))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let n,i,a,l,c,h,d;const p=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(xt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,l=Date.now(),this.nthSequenceNumber(t,i)))).next((m=>(n=m,c=Date.now(),this.removeTargets(t,n,e)))).next((m=>(a=m,h=Date.now(),this.removeOrphanedDocuments(t,n)))).next((m=>(d=Date.now(),_l()<=se.DEBUG&&xt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-p}ms
	Determined least recently used ${i} in `+(c-l)+`ms
	Removed ${a} targets in `+(h-c)+`ms
	Removed ${m} documents in `+(d-h)+`ms
Total Duration: ${d-p}ms`),At.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:m}))))}}function xM(r,t){return new IM(r,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(){this.changes=new Ro((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Gn.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return n!==void 0?At.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NM{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((i=>(n!==null&&Du(n.mutation,i,er.empty(),Pe.now()),i)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((n=>this.getLocalViewOfDocuments(t,n,oe()).next((()=>n))))}getLocalViewOfDocuments(t,e,n=oe()){const i=so();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((a=>{let l=yu();return a.forEach(((c,h)=>{l=l.insert(c,h.overlayedDocument)})),l}))))}getOverlayedDocuments(t,e){const n=so();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,oe())))}populateOverlays(t,e,n){const i=[];return n.forEach((a=>{e.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(t,i).next((a=>{a.forEach(((l,c)=>{e.set(l,c)}))}))}computeViews(t,e,n,i){let a=Ss();const l=xu(),c=(function(){return xu()})();return e.forEach(((h,d)=>{const p=n.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof Co)?a=a.insert(d.key,d):p!==void 0?(l.set(d.key,p.mutation.getFieldMask()),Du(p.mutation,d,p.mutation.getFieldMask(),Pe.now())):l.set(d.key,er.empty())})),this.recalculateAndSaveOverlays(t,a).next((h=>(h.forEach(((d,p)=>l.set(d,p))),e.forEach(((d,p)=>c.set(d,new OM(p,l.get(d)??null)))),c)))}recalculateAndSaveOverlays(t,e){const n=xu();let i=new ze(((l,c)=>l-c)),a=oe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((l=>{for(const c of l)c.keys().forEach((h=>{const d=e.get(h);if(d===null)return;let p=n.get(h)||er.empty();p=c.applyToLocalView(d,p),n.set(h,p);const m=(i.get(c.batchId)||oe()).add(h);i=i.insert(c.batchId,m)}))})).next((()=>{const l=[],c=i.getReverseIterator();for(;c.hasNext();){const h=c.getNext(),d=h.key,p=h.value,m=KS();p.forEach((v=>{if(!a.has(v)){const E=t1(e.get(v),n.get(v));E!==null&&m.set(v,E),a=a.add(v)}})),l.push(this.documentOverlayCache.saveOverlays(t,d,m))}return At.waitFor(l)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((n=>this.recalculateAndSaveOverlays(t,n)))}getDocumentsMatchingQuery(t,e,n,i){return(function(l){return kt.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):MP(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-a.size):At.resolve(so());let c=Vu,h=a;return l.next((d=>At.forEach(d,((p,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),a.get(p)?At.resolve():this.remoteDocumentCache.getEntry(t,p).next((v=>{h=h.insert(p,v)}))))).next((()=>this.populateOverlays(t,d,a))).next((()=>this.computeViews(t,h,d,oe()))).next((p=>({batchId:c,changes:WS(p)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new kt(e)).next((n=>{let i=yu();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const a=e.collectionGroup;let l=yu();return this.indexManager.getCollectionParents(t,a).next((c=>At.forEach(c,(h=>{const d=(function(m,v){return new ap(v,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(e,h.child(a));return this.getDocumentsMatchingCollectionQuery(t,d,n,i).next((p=>{p.forEach(((m,v)=>{l=l.insert(m,v)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(t,e,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,a,i)))).next((l=>{a.forEach(((h,d)=>{const p=d.getKey();l.get(p)===null&&(l=l.insert(p,Gn.newInvalidDocument(p)))}));let c=yu();return l.forEach(((h,d)=>{const p=a.get(h);p!==void 0&&Du(p.mutation,d,er.empty(),Pe.now()),lp(e,d)&&(c=c.insert(h,d))})),c}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PM{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return At.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,(function(i){return{id:i.id,version:i.version,createTime:Nr(i.createTime)}})(e)),At.resolve()}getNamedQuery(t,e){return At.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,(function(i){return{name:i.name,query:TM(i.bundledQuery),readTime:Nr(i.readTime)}})(e)),At.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(){this.overlays=new ze(kt.comparator),this.qr=new Map}getOverlay(t,e){return At.resolve(this.overlays.get(e))}getOverlays(t,e){const n=so();return At.forEach(e,(i=>this.getOverlay(t,i).next((a=>{a!==null&&n.set(i,a)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((i,a)=>{this.St(t,e,a)})),At.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(n)),At.resolve()}getOverlaysForCollection(t,e,n){const i=so(),a=e.length+1,l=new kt(e.child("")),c=this.overlays.getIteratorFrom(l);for(;c.hasNext();){const h=c.getNext().value,d=h.getKey();if(!e.isPrefixOf(d.path))break;d.path.length===a&&h.largestBatchId>n&&i.set(h.getKey(),h)}return At.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let a=new ze(((d,p)=>d-p));const l=this.overlays.getIterator();for(;l.hasNext();){const d=l.getNext().value;if(d.getKey().getCollectionGroup()===e&&d.largestBatchId>n){let p=a.get(d.largestBatchId);p===null&&(p=so(),a=a.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const c=so(),h=a.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((d,p)=>c.set(d,p))),!(c.size()>=i)););return At.resolve(c)}St(t,e,n){const i=this.overlays.get(n.key);if(i!==null){const l=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new JP(e,n));let a=this.qr.get(e);a===void 0&&(a=oe(),this.qr.set(e,a)),this.qr.set(e,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LM{constructor(){this.sessionToken=Fn.EMPTY_BYTE_STRING}getSessionToken(t){return At.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,At.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(){this.Qr=new vn(Sn.$r),this.Ur=new vn(Sn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const n=new Sn(t,e);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(t,e){t.forEach((n=>this.addReference(n,e)))}removeReference(t,e){this.Gr(new Sn(t,e))}zr(t,e){t.forEach((n=>this.removeReference(n,e)))}jr(t){const e=new kt(new He([])),n=new Sn(e,t),i=new Sn(e,t+1),a=[];return this.Ur.forEachInRange([n,i],(l=>{this.Gr(l),a.push(l.key)})),a}Jr(){this.Qr.forEach((t=>this.Gr(t)))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new kt(new He([])),n=new Sn(e,t),i=new Sn(e,t+1);let a=oe();return this.Ur.forEachInRange([n,i],(l=>{a=a.add(l.key)})),a}containsKey(t){const e=new Sn(t,0),n=this.Qr.firstAfterOrEqual(e);return n!==null&&t.isEqual(n.key)}}class Sn{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return kt.comparator(t.key,e.key)||ae(t.Yr,e.Yr)}static Kr(t,e){return ae(t.Yr,e.Yr)||kt.comparator(t.key,e.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new vn(Sn.$r)}checkEmpty(t){return At.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,n,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new QP(a,e,n,i);this.mutationQueue.push(l);for(const c of i)this.Zr=this.Zr.add(new Sn(c.key,a)),this.indexManager.addToCollectionParentIndex(t,c.key.path.popLast());return At.resolve(l)}lookupMutationBatch(t,e){return At.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.ei(n),a=i<0?0:i;return At.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return At.resolve(this.mutationQueue.length===0?pv:this.tr-1)}getAllMutationBatches(t){return At.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Sn(e,0),i=new Sn(e,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,i],(l=>{const c=this.Xr(l.Yr);a.push(c)})),At.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new vn(ae);return e.forEach((i=>{const a=new Sn(i,0),l=new Sn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,l],(c=>{n=n.add(c.Yr)}))})),At.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let a=n;kt.isDocumentKey(a)||(a=a.child(""));const l=new Sn(new kt(a),0);let c=new vn(ae);return this.Zr.forEachWhile((h=>{const d=h.key.path;return!!n.isPrefixOf(d)&&(d.length===i&&(c=c.add(h.Yr)),!0)}),l),At.resolve(this.ti(c))}ti(t){const e=[];return t.forEach((n=>{const i=this.Xr(n);i!==null&&e.push(i)})),e}removeMutationBatch(t,e){be(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return At.forEach(e.mutations,(i=>{const a=new Sn(i.key,e.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.Zr=n}))}ir(t){}containsKey(t,e){const n=new Sn(e,0),i=this.Zr.firstAfterOrEqual(n);return At.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,At.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BM{constructor(t){this.ri=t,this.docs=(function(){return new ze(kt.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),a=i?i.size:0,l=this.ri(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return At.resolve(n?n.document.mutableCopy():Gn.newInvalidDocument(e))}getEntries(t,e){let n=Ss();return e.forEach((i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():Gn.newInvalidDocument(i))})),At.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let a=Ss();const l=e.path,c=new kt(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(c);for(;h.hasNext();){const{key:d,value:{document:p}}=h.getNext();if(!l.isPrefixOf(d.path))break;d.path.length>l.length+1||hP(uP(p),n)<=0||(i.has(p.key)||lp(e,p))&&(a=a.insert(p.key,p.mutableCopy()))}return At.resolve(a)}getAllFromCollectionGroup(t,e,n,i){Ht(9500)}ii(t,e){return At.forEach(this.docs,(n=>e(n)))}newChangeBuffer(t){return new FM(this)}getSize(t){return At.resolve(this.size)}}class FM extends DM{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.Nr.addEntry(t,i)):this.Nr.removeEntry(n)})),At.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(t){this.persistence=t,this.si=new Ro((e=>yv(e)),vv),this.lastRemoteSnapshotVersion=Wt.min(),this.highestTargetId=0,this.oi=0,this._i=new wv,this.targetCount=0,this.ai=zl.ur()}forEachTarget(t,e){return this.si.forEach(((n,i)=>e(i))),At.resolve()}getLastRemoteSnapshotVersion(t){return At.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return At.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),At.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.oi&&(this.oi=e),At.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new zl(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,At.resolve()}updateTargetData(t,e){return this.Pr(e),At.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,At.resolve()}removeTargets(t,e,n){let i=0;const a=[];return this.si.forEach(((l,c)=>{c.sequenceNumber<=e&&n.get(c.targetId)===null&&(this.si.delete(l),a.push(this.removeMatchingKeysForTargetId(t,c.targetId)),i++)})),At.waitFor(a).next((()=>i))}getTargetCount(t){return At.resolve(this.targetCount)}getTargetData(t,e){const n=this.si.get(e)||null;return At.resolve(n)}addMatchingKeys(t,e,n){return this._i.Wr(e,n),At.resolve()}removeMatchingKeys(t,e,n){this._i.zr(e,n);const i=this.persistence.referenceDelegate,a=[];return i&&e.forEach((l=>{a.push(i.markPotentiallyOrphaned(t,l))})),At.waitFor(a)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),At.resolve()}getMatchingKeysForTargetId(t,e){const n=this._i.Hr(e);return At.resolve(n)}containsKey(t,e){return At.resolve(this._i.containsKey(e))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(t,e){this.ui={},this.overlays={},this.ci=new ip(0),this.li=!1,this.li=!0,this.hi=new LM,this.referenceDelegate=t(this),this.Pi=new UM(this),this.indexManager=new _M,this.remoteDocumentCache=(function(i){return new BM(i)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new bM(e),this.Ii=new PM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new MM,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.ui[t.toKey()];return n||(n=new kM(e,this.referenceDelegate),this.ui[t.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,n){xt("MemoryPersistence","Starting transaction:",t);const i=new VM(this.ci.next());return this.referenceDelegate.Ei(),n(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(t,e){return At.or(Object.values(this.ui).map((n=>()=>n.containsKey(t,e))))}}class VM extends fP{constructor(t){super(),this.currentSequenceNumber=t}}class Sv{constructor(t){this.persistence=t,this.Ri=new wv,this.Vi=null}static mi(t){return new Sv(t)}get fi(){if(this.Vi)return this.Vi;throw Ht(60996)}addReference(t,e,n){return this.Ri.addReference(n,e),this.fi.delete(n.toString()),At.resolve()}removeReference(t,e,n){return this.Ri.removeReference(n,e),this.fi.add(n.toString()),At.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),At.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach((i=>this.fi.add(i.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>n.removeTargetData(t,e)))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return At.forEach(this.fi,(n=>{const i=kt.fromPath(n);return this.gi(t,i).next((a=>{a||e.removeEntry(i,Wt.min())}))})).next((()=>(this.Vi=null,e.apply(t))))}updateLimboDocument(t,e){return this.gi(t,e).next((n=>{n?this.fi.delete(e.toString()):this.fi.add(e.toString())}))}Ti(t){return 0}gi(t,e){return At.or([()=>At.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class jf{constructor(t,e){this.persistence=t,this.pi=new Ro((n=>mP(n.path)),((n,i)=>n.isEqual(i))),this.garbageCollector=xM(this,e)}static mi(t,e){return new jf(t,e)}Ei(){}di(t){return At.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next((n=>e.next((i=>n+i))))}wr(t){let e=0;return this.pr(t,(n=>{e++})).next((()=>e))}pr(t,e){return At.forEach(this.pi,((n,i)=>this.br(t,n,i).next((a=>a?At.resolve():e(i)))))}removeTargets(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)}removeOrphanedDocuments(t,e){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(t,(l=>this.br(t,l,e).next((c=>{c||(n++,a.removeEntry(l,Wt.min()))})))).next((()=>a.apply(t))).next((()=>n))}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),At.resolve()}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,e,n){return this.pi.set(n,t.currentSequenceNumber),At.resolve()}removeReference(t,e,n){return this.pi.set(n,t.currentSequenceNumber),At.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),At.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=gf(t.data.value)),e}br(t,e,n){return At.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const i=this.pi.get(e);return At.resolve(i!==void 0&&i>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Es=n,this.ds=i}static As(t,e){let n=oe(),i=oe();for(const a of e.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Rv(t,e.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return pD()?8:pP(Yn())>0?6:4})()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,n,i){const a={result:null};return this.ys(t,e).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ws(t,e,i,n).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new jM;return this.Ss(t,e,l).next((c=>{if(a.result=c,this.Vs)return this.bs(t,e,l,c.size)}))})).next((()=>a.result))}bs(t,e,n,i){return n.documentReadCount<this.fs?(_l()<=se.DEBUG&&xt("QueryEngine","SDK will not create cache indexes for query:",wl(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),At.resolve()):(_l()<=se.DEBUG&&xt("QueryEngine","Query:",wl(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(_l()<=se.DEBUG&&xt("QueryEngine","The SDK decides to create cache indexes for query:",wl(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Or(e))):At.resolve())}ys(t,e){if(kT(e))return At.resolve(null);let n=Or(e);return this.indexManager.getIndexType(t,n).next((i=>i===0?null:(e.limit!==null&&i===1&&(e=vy(e,null,"F"),n=Or(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((a=>{const l=oe(...a);return this.ps.getDocuments(t,l).next((c=>this.indexManager.getMinOffset(t,n).next((h=>{const d=this.Ds(e,c);return this.Cs(e,d,l,h.readTime)?this.ys(t,vy(e,null,"F")):this.vs(t,d,e,h)}))))})))))}ws(t,e,n,i){return kT(e)||i.isEqual(Wt.min())?At.resolve(null):this.ps.getDocuments(t,n).next((a=>{const l=this.Ds(e,a);return this.Cs(e,l,n,i)?At.resolve(null):(_l()<=se.DEBUG&&xt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),wl(e)),this.vs(t,l,e,cP(i,Vu)).next((c=>c)))}))}Ds(t,e){let n=new vn($S(t));return e.forEach(((i,a)=>{lp(t,a)&&(n=n.add(a))})),n}Cs(t,e,n,i){if(t.limit===null)return!1;if(n.size!==e.size)return!0;const a=t.limitType==="F"?e.last():e.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(t,e,n){return _l()<=se.DEBUG&&xt("QueryEngine","Using full collection scan to execute query:",wl(e)),this.ps.getDocumentsMatchingQuery(t,e,va.min(),n)}vs(t,e,n,i){return this.ps.getDocumentsMatchingQuery(t,n,i).next((a=>(e.forEach((l=>{a=a.insert(l.key,l)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cv="LocalStore",zM=3e8;class GM{constructor(t,e,n,i){this.persistence=t,this.Fs=e,this.serializer=i,this.Ms=new ze(ae),this.xs=new Ro((a=>yv(a)),vv),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(n)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new NM(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ms)))}}function $M(r,t,e,n){return new GM(r,t,e,n)}async function g1(r,t){const e=Kt(r);return await e.persistence.runTransaction("Handle user change","readonly",(n=>{let i;return e.mutationQueue.getAllMutationBatches(n).next((a=>(i=a,e.Bs(t),e.mutationQueue.getAllMutationBatches(n)))).next((a=>{const l=[],c=[];let h=oe();for(const d of i){l.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}for(const d of a){c.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}return e.localDocuments.getDocuments(n,h).next((d=>({Ls:d,removedBatchIds:l,addedBatchIds:c})))}))}))}function YM(r,t){const e=Kt(r);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const i=t.batch.keys(),a=e.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,h,d,p){const m=d.batch,v=m.keys();let E=At.resolve();return v.forEach((b=>{E=E.next((()=>p.getEntry(h,b))).next((T=>{const S=d.docVersions.get(b);be(S!==null,48541),T.version.compareTo(S)<0&&(m.applyToRemoteDocument(T,d),T.isValidDocument()&&(T.setReadTime(d.commitVersion),p.addEntry(T)))}))})),E.next((()=>c.mutationQueue.removeMutationBatch(h,m)))})(e,n,t,a).next((()=>a.apply(n))).next((()=>e.mutationQueue.performConsistencyCheck(n))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(n,i,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(c){let h=oe();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(h=h.add(c.batch.mutations[d].key));return h})(t)))).next((()=>e.localDocuments.getDocuments(n,i)))}))}function m1(r){const t=Kt(r);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function WM(r,t){const e=Kt(r),n=t.snapshotVersion;let i=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=e.Ns.newChangeBuffer({trackRemovals:!0});i=e.Ms;const c=[];t.targetChanges.forEach(((p,m)=>{const v=i.get(m);if(!v)return;c.push(e.Pi.removeMatchingKeys(a,p.removedDocuments,m).next((()=>e.Pi.addMatchingKeys(a,p.addedDocuments,m))));let E=v.withSequenceNumber(a.currentSequenceNumber);t.targetMismatches.get(m)!==null?E=E.withResumeToken(Fn.EMPTY_BYTE_STRING,Wt.min()).withLastLimboFreeSnapshotVersion(Wt.min()):p.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(p.resumeToken,n)),i=i.insert(m,E),(function(T,S,C){return T.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=zM?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0})(v,E,p)&&c.push(e.Pi.updateTargetData(a,E))}));let h=Ss(),d=oe();if(t.documentUpdates.forEach((p=>{t.resolvedLimboDocuments.has(p)&&c.push(e.persistence.referenceDelegate.updateLimboDocument(a,p))})),c.push(KM(a,l,t.documentUpdates).next((p=>{h=p.ks,d=p.qs}))),!n.isEqual(Wt.min())){const p=e.Pi.getLastRemoteSnapshotVersion(a).next((m=>e.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n)));c.push(p)}return At.waitFor(c).next((()=>l.apply(a))).next((()=>e.localDocuments.getLocalViewOfDocuments(a,h,d))).next((()=>h))})).then((a=>(e.Ms=i,a)))}function KM(r,t,e){let n=oe(),i=oe();return e.forEach((a=>n=n.add(a))),t.getEntries(r,n).next((a=>{let l=Ss();return e.forEach(((c,h)=>{const d=a.get(c);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),h.isNoDocument()&&h.version.isEqual(Wt.min())?(t.removeEntry(c,h.readTime),l=l.insert(c,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(t.addEntry(h),l=l.insert(c,h)):xt(Cv,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",h.version)})),{ks:l,qs:i}}))}function XM(r,t){const e=Kt(r);return e.persistence.runTransaction("Get next mutation batch","readonly",(n=>(t===void 0&&(t=pv),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t))))}function qM(r,t){const e=Kt(r);return e.persistence.runTransaction("Allocate target","readwrite",(n=>{let i;return e.Pi.getTargetData(n,t).next((a=>a?(i=a,At.resolve(i)):e.Pi.allocateTargetId(n).next((l=>(i=new ha(t,l,"TargetPurposeListen",n.currentSequenceNumber),e.Pi.addTargetData(n,i).next((()=>i)))))))})).then((n=>{const i=e.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(n.targetId,n),e.xs.set(t,n.targetId)),n}))}async function _y(r,t,e){const n=Kt(r),i=n.Ms.get(t),a=e?"readwrite":"readwrite-primary";try{e||await n.persistence.runTransaction("Release target",a,(l=>n.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!Zl(l))throw l;xt(Cv,`Failed to update sequence numbers for target ${t}: ${l}`)}n.Ms=n.Ms.remove(t),n.xs.delete(i.target)}function XT(r,t,e){const n=Kt(r);let i=Wt.min(),a=oe();return n.persistence.runTransaction("Execute query","readwrite",(l=>(function(h,d,p){const m=Kt(h),v=m.xs.get(p);return v!==void 0?At.resolve(m.Ms.get(v)):m.Pi.getTargetData(d,p)})(n,l,Or(t)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(l,c.targetId).next((h=>{a=h}))})).next((()=>n.Fs.getDocumentsMatchingQuery(l,t,e?i:Wt.min(),e?a:oe()))).next((c=>(QM(n,kP(t),c),{documents:c,Qs:a})))))}function QM(r,t,e){let n=r.Os.get(t)||Wt.min();e.forEach(((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)})),r.Os.set(t,n)}class qT{constructor(){this.activeTargetIds=HP()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class JM{constructor(){this.Mo=new qT,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,n){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new qT,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{Oo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QT="ConnectivityMonitor";class JT{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){xt(QT,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){xt(QT,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wd=null;function wy(){return Wd===null?Wd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Wd++,"0x"+Wd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm="RestConnection",tL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class eL{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===Mf?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(t,e,n,i,a){const l=wy(),c=this.zo(t,e.toUriEncodedString());xt(Vm,`Sending RPC '${t}' ${l}:`,c,n);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,i,a);const{host:d}=new URL(c),p=Ra(d);return this.Jo(t,c,h,n,p).then((m=>(xt(Vm,`Received RPC '${t}' ${l}: `,m),m)),(m=>{throw Ul(Vm,`RPC '${t}' ${l} failed with error: `,m,"url: ",c,"request:",n),m}))}Ho(t,e,n,i,a,l){return this.Go(t,e,n,i,a)}jo(t,e,n){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ql})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((i,a)=>t[a]=i)),n&&n.headers.forEach(((i,a)=>t[a]=i))}zo(t,e){const n=tL[t];return`${this.Uo}/v1/${e}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hn="WebChannelConnection";class iL extends eL{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,n,i,a){const l=wy();return new Promise(((c,h)=>{const d=new AS;d.setWithCredentials(!0),d.listenOnce(bS.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case pf.NO_ERROR:const m=d.getResponseJson();xt(Hn,`XHR for RPC '${t}' ${l} received:`,JSON.stringify(m)),c(m);break;case pf.TIMEOUT:xt(Hn,`RPC '${t}' ${l} timed out`),h(new Mt(bt.DEADLINE_EXCEEDED,"Request time out"));break;case pf.HTTP_ERROR:const v=d.getStatus();if(xt(Hn,`RPC '${t}' ${l} failed with status:`,v,"response text:",d.getResponseText()),v>0){let E=d.getResponseJson();Array.isArray(E)&&(E=E[0]);const b=E?.error;if(b&&b.status&&b.message){const T=(function(C){const D=C.toLowerCase().replace(/_/g,"-");return Object.values(bt).indexOf(D)>=0?D:bt.UNKNOWN})(b.status);h(new Mt(T,b.message))}else h(new Mt(bt.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new Mt(bt.UNAVAILABLE,"Connection failed."));break;default:Ht(9055,{l_:t,streamId:l,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{xt(Hn,`RPC '${t}' ${l} completed.`)}}));const p=JSON.stringify(i);xt(Hn,`RPC '${t}' ${l} sending request:`,i),d.send(e,"POST",p,n,15)}))}T_(t,e,n){const i=wy(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],l=wS(),c=_S(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,e,n),h.encodeInitMessageHeaders=!0;const p=a.join("");xt(Hn,`Creating RPC '${t}' stream ${i}: ${p}`,h);const m=l.createWebChannel(p,h);this.I_(m);let v=!1,E=!1;const b=new nL({Yo:S=>{E?xt(Hn,`Not sending because RPC '${t}' stream ${i} is closed:`,S):(v||(xt(Hn,`Opening RPC '${t}' stream ${i} transport.`),m.open(),v=!0),xt(Hn,`RPC '${t}' stream ${i} sending:`,S),m.send(S))},Zo:()=>m.close()}),T=(S,C,D)=>{S.listen(C,(O=>{try{D(O)}catch(F){setTimeout((()=>{throw F}),0)}}))};return T(m,mu.EventType.OPEN,(()=>{E||(xt(Hn,`RPC '${t}' stream ${i} transport opened.`),b.o_())})),T(m,mu.EventType.CLOSE,(()=>{E||(E=!0,xt(Hn,`RPC '${t}' stream ${i} transport closed`),b.a_(),this.E_(m))})),T(m,mu.EventType.ERROR,(S=>{E||(E=!0,Ul(Hn,`RPC '${t}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),b.a_(new Mt(bt.UNAVAILABLE,"The operation could not be completed")))})),T(m,mu.EventType.MESSAGE,(S=>{if(!E){const C=S.data[0];be(!!C,16349);const D=C,O=D?.error||D[0]?.error;if(O){xt(Hn,`RPC '${t}' stream ${i} received error:`,O);const F=O.status;let k=(function(N){const M=ln[N];if(M!==void 0)return i1(M)})(F),z=O.message;k===void 0&&(k=bt.INTERNAL,z="Unknown error status: "+F+" with message "+O.message),E=!0,b.a_(new Mt(k,z)),m.close()}else xt(Hn,`RPC '${t}' stream ${i} received:`,C),b.u_(C)}})),T(c,TS.STAT_EVENT,(S=>{S.stat===dy.PROXY?xt(Hn,`RPC '${t}' stream ${i} detected buffering proxy`):S.stat===dy.NOPROXY&&xt(Hn,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{b.__()}),0),b}terminate(){this.c_.forEach((t=>t.close())),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter((e=>e===t))}}function jm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dp(r){return new oM(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(t,e,n=1e3,i=1.5,a=6e4){this.Mi=t,this.timerId=e,this.d_=n,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,e-n);i>0&&xt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),t()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT="PersistentStream";class v1{constructor(t,e,n,i,a,l,c,h){this.Mi=t,this.S_=n,this.b_=i,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=c,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new y1(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===bt.RESOURCE_EXHAUSTED?(ws(e.toString()),ws("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===bt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,i])=>{this.D_===e&&this.G_(n,i)}),(n=>{t((()=>{const i=new Mt(bt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)}))}))}G_(t,e){const n=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{n((()=>this.z_(i)))})),this.stream.onMessage((i=>{n((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return xt(ZT,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget((()=>this.D_===t?e():(xt(ZT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class rL extends v1{constructor(t,e,n,i,a,l){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,l),this.serializer=a}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=uM(this.serializer,t),n=(function(a){if(!("targetChange"in a))return Wt.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?Wt.min():l.readTime?Nr(l.readTime):Wt.min()})(t);return this.listener.H_(e,n)}Y_(t){const e={};e.database=Ty(this.serializer),e.addTarget=(function(a,l){let c;const h=l.target;if(c=yy(h)?{documents:fM(a,h)}:{query:pM(a,h).ft},c.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){c.resumeToken=a1(a,l.resumeToken);const d=Ey(a,l.expectedCount);d!==null&&(c.expectedCount=d)}else if(l.snapshotVersion.compareTo(Wt.min())>0){c.readTime=Vf(a,l.snapshotVersion.toTimestamp());const d=Ey(a,l.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,t);const n=mM(this.serializer,t);n&&(e.labels=n),this.q_(e)}Z_(t){const e={};e.database=Ty(this.serializer),e.removeTarget=t,this.q_(e)}}class sL extends v1{constructor(t,e,n,i,a,l){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,l),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}J_(t){return be(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,be(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){be(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=dM(t.writeResults,t.commitTime),n=Nr(t.commitTime);return this.listener.na(n,e)}ra(){const t={};t.database=Ty(this.serializer),this.q_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map((n=>hM(this.serializer,n)))};this.q_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{}class oL extends aL{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Mt(bt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Go(t,Ay(e,n),i,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===bt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Mt(bt.UNKNOWN,a.toString())}))}Ho(t,e,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Ho(t,Ay(e,n),i,l,c,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===bt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Mt(bt.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class lL{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ws(e),this.aa=!1):xt("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eo="RemoteStore";class cL{constructor(t,e,n,i,a){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((l=>{n.enqueueAndForget((async()=>{Io(this)&&(xt(Eo,"Restarting streams for network reachability change."),await(async function(h){const d=Kt(h);d.Ea.add(4),await uh(d),d.Ra.set("Unknown"),d.Ea.delete(4),await fp(d)})(this))}))})),this.Ra=new lL(n,i)}}async function fp(r){if(Io(r))for(const t of r.da)await t(!0)}async function uh(r){for(const t of r.da)await t(!1)}function E1(r,t){const e=Kt(r);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),Ov(e)?Dv(e):tc(e).O_()&&xv(e,t))}function Iv(r,t){const e=Kt(r),n=tc(e);e.Ia.delete(t),n.O_()&&A1(e,t),e.Ia.size===0&&(n.O_()?n.L_():Io(e)&&e.Ra.set("Unknown"))}function xv(r,t){if(r.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Wt.min())>0){const e=r.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}tc(r).Y_(t)}function A1(r,t){r.Va.Ue(t),tc(r).Z_(t)}function Dv(r){r.Va=new iM({getRemoteKeysForTarget:t=>r.remoteSyncer.getRemoteKeysForTarget(t),At:t=>r.Ia.get(t)||null,ht:()=>r.datastore.serializer.databaseId}),tc(r).start(),r.Ra.ua()}function Ov(r){return Io(r)&&!tc(r).x_()&&r.Ia.size>0}function Io(r){return Kt(r).Ea.size===0}function b1(r){r.Va=void 0}async function uL(r){r.Ra.set("Online")}async function hL(r){r.Ia.forEach(((t,e)=>{xv(r,t)}))}async function dL(r,t){b1(r),Ov(r)?(r.Ra.ha(t),Dv(r)):r.Ra.set("Unknown")}async function fL(r,t,e){if(r.Ra.set("Online"),t instanceof s1&&t.state===2&&t.cause)try{await(async function(i,a){const l=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,l),i.Ia.delete(c),i.Va.removeTarget(c))})(r,t)}catch(n){xt(Eo,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Hf(r,n)}else if(t instanceof vf?r.Va.Ze(t):t instanceof r1?r.Va.st(t):r.Va.tt(t),!e.isEqual(Wt.min()))try{const n=await m1(r.localStore);e.compareTo(n)>=0&&await(function(a,l){const c=a.Va.Tt(l);return c.targetChanges.forEach(((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const p=a.Ia.get(d);p&&a.Ia.set(d,p.withResumeToken(h.resumeToken,l))}})),c.targetMismatches.forEach(((h,d)=>{const p=a.Ia.get(h);if(!p)return;a.Ia.set(h,p.withResumeToken(Fn.EMPTY_BYTE_STRING,p.snapshotVersion)),A1(a,h);const m=new ha(p.target,h,d,p.sequenceNumber);xv(a,m)})),a.remoteSyncer.applyRemoteEvent(c)})(r,e)}catch(n){xt(Eo,"Failed to raise snapshot:",n),await Hf(r,n)}}async function Hf(r,t,e){if(!Zl(t))throw t;r.Ea.add(1),await uh(r),r.Ra.set("Offline"),e||(e=()=>m1(r.localStore)),r.asyncQueue.enqueueRetryable((async()=>{xt(Eo,"Retrying IndexedDB access"),await e(),r.Ea.delete(1),await fp(r)}))}function T1(r,t){return t().catch((e=>Hf(r,e,t)))}async function pp(r){const t=Kt(r),e=Ta(t);let n=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:pv;for(;pL(t);)try{const i=await XM(t.localStore,n);if(i===null){t.Ta.length===0&&e.L_();break}n=i.batchId,gL(t,i)}catch(i){await Hf(t,i)}_1(t)&&w1(t)}function pL(r){return Io(r)&&r.Ta.length<10}function gL(r,t){r.Ta.push(t);const e=Ta(r);e.O_()&&e.X_&&e.ea(t.mutations)}function _1(r){return Io(r)&&!Ta(r).x_()&&r.Ta.length>0}function w1(r){Ta(r).start()}async function mL(r){Ta(r).ra()}async function yL(r){const t=Ta(r);for(const e of r.Ta)t.ea(e.mutations)}async function vL(r,t,e){const n=r.Ta.shift(),i=bv.from(n,t,e);await T1(r,(()=>r.remoteSyncer.applySuccessfulWrite(i))),await pp(r)}async function EL(r,t){t&&Ta(r).X_&&await(async function(n,i){if((function(l){return tM(l)&&l!==bt.ABORTED})(i.code)){const a=n.Ta.shift();Ta(n).B_(),await T1(n,(()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i))),await pp(n)}})(r,t),_1(r)&&w1(r)}async function t_(r,t){const e=Kt(r);e.asyncQueue.verifyOperationInProgress(),xt(Eo,"RemoteStore received new credentials");const n=Io(e);e.Ea.add(3),await uh(e),n&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await fp(e)}async function AL(r,t){const e=Kt(r);t?(e.Ea.delete(2),await fp(e)):t||(e.Ea.add(2),await uh(e),e.Ra.set("Unknown"))}function tc(r){return r.ma||(r.ma=(function(e,n,i){const a=Kt(e);return a.sa(),new rL(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(r.datastore,r.asyncQueue,{Xo:uL.bind(null,r),t_:hL.bind(null,r),r_:dL.bind(null,r),H_:fL.bind(null,r)}),r.da.push((async t=>{t?(r.ma.B_(),Ov(r)?Dv(r):r.Ra.set("Unknown")):(await r.ma.stop(),b1(r))}))),r.ma}function Ta(r){return r.fa||(r.fa=(function(e,n,i){const a=Kt(e);return a.sa(),new sL(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(r.datastore,r.asyncQueue,{Xo:()=>Promise.resolve(),t_:mL.bind(null,r),r_:EL.bind(null,r),ta:yL.bind(null,r),na:vL.bind(null,r)}),r.da.push((async t=>{t?(r.fa.B_(),await pp(r)):(await r.fa.stop(),r.Ta.length>0&&(xt(Eo,`Stopping write stream with ${r.Ta.length} pending writes`),r.Ta=[]))}))),r.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(t,e,n,i,a){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new ga,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,a){const l=Date.now()+n,c=new Nv(t,e,l,i,a);return c.start(n),c}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Mt(bt.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pv(r,t){if(ws("AsyncQueue",`${t}: ${r}`),Zl(r))return new Mt(bt.UNAVAILABLE,`${t}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{static emptySet(t){return new kl(t.comparator)}constructor(t){this.comparator=t?(e,n)=>t(e,n)||kt.comparator(e.key,n.key):(e,n)=>kt.comparator(e.key,n.key),this.keyedMap=yu(),this.sortedSet=new ze(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof kl)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const i=e.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const n=new kl;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(){this.ga=new ze(kt.comparator)}track(t){const e=t.doc.key,n=this.ga.get(e);n?t.type!==0&&n.type===3?this.ga=this.ga.insert(e,t):t.type===3&&n.type!==1?this.ga=this.ga.insert(e,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.ga=this.ga.remove(e):t.type===1&&n.type===2?this.ga=this.ga.insert(e,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):Ht(63341,{Rt:t,pa:n}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Gl{constructor(t,e,n,i,a,l,c,h,d){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=c,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(t,e,n,i,a){const l=[];return e.forEach((c=>{l.push({type:0,doc:c})})),new Gl(t,e,kl.emptySet(e),l,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&op(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((t=>t.Da()))}}class TL{constructor(){this.queries=n_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,n){const i=Kt(e),a=i.queries;i.queries=n_(),a.forEach(((l,c)=>{for(const h of c.Sa)h.onError(n)}))})(this,new Mt(bt.ABORTED,"Firestore shutting down"))}}function n_(){return new Ro((r=>GS(r)),op)}async function _L(r,t){const e=Kt(r);let n=3;const i=t.query;let a=e.queries.get(i);a?!a.ba()&&t.Da()&&(n=2):(a=new bL,n=t.Da()?0:1);try{switch(n){case 0:a.wa=await e.onListen(i,!0);break;case 1:a.wa=await e.onListen(i,!1);break;case 2:await e.onFirstRemoteStoreListen(i)}}catch(l){const c=Pv(l,`Initialization of query '${wl(t.query)}' failed`);return void t.onError(c)}e.queries.set(i,a),a.Sa.push(t),t.va(e.onlineState),a.wa&&t.Fa(a.wa)&&Mv(e)}async function wL(r,t){const e=Kt(r),n=t.query;let i=3;const a=e.queries.get(n);if(a){const l=a.Sa.indexOf(t);l>=0&&(a.Sa.splice(l,1),a.Sa.length===0?i=t.Da()?0:1:!a.ba()&&t.Da()&&(i=2))}switch(i){case 0:return e.queries.delete(n),e.onUnlisten(n,!0);case 1:return e.queries.delete(n),e.onUnlisten(n,!1);case 2:return e.onLastRemoteStoreUnlisten(n);default:return}}function SL(r,t){const e=Kt(r);let n=!1;for(const i of t){const a=i.query,l=e.queries.get(a);if(l){for(const c of l.Sa)c.Fa(i)&&(n=!0);l.wa=i}}n&&Mv(e)}function RL(r,t,e){const n=Kt(r),i=n.queries.get(t);if(i)for(const a of i.Sa)a.onError(e);n.queries.delete(t)}function Mv(r){r.Ca.forEach((t=>{t.next()}))}var Sy,i_;(i_=Sy||(Sy={})).Ma="default",i_.Cache="cache";class CL{constructor(t,e,n){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(t){if(!this.options.includeMetadataChanges){const n=[];for(const i of t.docChanges)i.type!==3&&n.push(i);t=new Gl(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const n=e!=="Offline";return(!this.options.qa||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Gl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==Sy.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(t){this.key=t}}class R1{constructor(t){this.key=t}}class IL{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=oe(),this.mutatedKeys=oe(),this.eu=$S(t),this.tu=new kl(this.eu)}get nu(){return this.Ya}ru(t,e){const n=e?e.iu:new e_,i=e?e.tu:this.tu;let a=e?e.mutatedKeys:this.mutatedKeys,l=i,c=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((p,m)=>{const v=i.get(p),E=lp(this.query,m)?m:null,b=!!v&&this.mutatedKeys.has(v.key),T=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let S=!1;v&&E?v.data.isEqual(E.data)?b!==T&&(n.track({type:3,doc:E}),S=!0):this.su(v,E)||(n.track({type:2,doc:E}),S=!0,(h&&this.eu(E,h)>0||d&&this.eu(E,d)<0)&&(c=!0)):!v&&E?(n.track({type:0,doc:E}),S=!0):v&&!E&&(n.track({type:1,doc:v}),S=!0,(h||d)&&(c=!0)),S&&(E?(l=l.add(E),a=T?a.add(p):a.delete(p)):(l=l.delete(p),a=a.delete(p)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const p=this.query.limitType==="F"?l.last():l.first();l=l.delete(p.key),a=a.delete(p.key),n.track({type:1,doc:p})}return{tu:l,iu:n,Cs:c,mutatedKeys:a}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const a=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const l=t.iu.ya();l.sort(((p,m)=>(function(E,b){const T=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ht(20277,{Rt:S})}};return T(E)-T(b)})(p.type,m.type)||this.eu(p.doc,m.doc))),this.ou(n),i=i??!1;const c=e&&!i?this._u():[],h=this.Xa.size===0&&this.current&&!i?1:0,d=h!==this.Za;return this.Za=h,l.length!==0||d?{snapshot:new Gl(this.query,t.tu,a,l,t.mutatedKeys,h===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new e_,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=oe(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const e=[];return t.forEach((n=>{this.Xa.has(n)||e.push(new R1(n))})),this.Xa.forEach((n=>{t.has(n)||e.push(new S1(n))})),e}cu(t){this.Ya=t.Qs,this.Xa=oe();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Gl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Lv="SyncEngine";class xL{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class DL{constructor(t){this.key=t,this.hu=!1}}class OL{constructor(t,e,n,i,a,l){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Ro((c=>GS(c)),op),this.Iu=new Map,this.Eu=new Set,this.du=new ze(kt.comparator),this.Au=new Map,this.Ru=new wv,this.Vu={},this.mu=new Map,this.fu=zl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function NL(r,t,e=!0){const n=N1(r);let i;const a=n.Tu.get(t);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await C1(n,t,e,!0),i}async function PL(r,t){const e=N1(r);await C1(e,t,!0,!1)}async function C1(r,t,e,n){const i=await qM(r.localStore,Or(t)),a=i.targetId,l=r.sharedClientState.addLocalQueryTarget(a,e);let c;return n&&(c=await ML(r,t,a,l==="current",i.resumeToken)),r.isPrimaryClient&&e&&E1(r.remoteStore,i),c}async function ML(r,t,e,n,i){r.pu=(m,v,E)=>(async function(T,S,C,D){let O=S.view.ru(C);O.Cs&&(O=await XT(T.localStore,S.query,!1).then((({documents:P})=>S.view.ru(P,O))));const F=D&&D.targetChanges.get(S.targetId),k=D&&D.targetMismatches.get(S.targetId)!=null,z=S.view.applyChanges(O,T.isPrimaryClient,F,k);return s_(T,S.targetId,z.au),z.snapshot})(r,m,v,E);const a=await XT(r.localStore,t,!0),l=new IL(t,a.Qs),c=l.ru(a.documents),h=ch.createSynthesizedTargetChangeForCurrentChange(e,n&&r.onlineState!=="Offline",i),d=l.applyChanges(c,r.isPrimaryClient,h);s_(r,e,d.au);const p=new xL(t,e,l);return r.Tu.set(t,p),r.Iu.has(e)?r.Iu.get(e).push(t):r.Iu.set(e,[t]),d.snapshot}async function LL(r,t,e){const n=Kt(r),i=n.Tu.get(t),a=n.Iu.get(i.targetId);if(a.length>1)return n.Iu.set(i.targetId,a.filter((l=>!op(l,t)))),void n.Tu.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await _y(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),e&&Iv(n.remoteStore,i.targetId),Ry(n,i.targetId)})).catch(Jl)):(Ry(n,i.targetId),await _y(n.localStore,i.targetId,!0))}async function kL(r,t){const e=Kt(r),n=e.Tu.get(t),i=e.Iu.get(n.targetId);e.isPrimaryClient&&i.length===1&&(e.sharedClientState.removeLocalQueryTarget(n.targetId),Iv(e.remoteStore,n.targetId))}async function BL(r,t,e){const n=GL(r);try{const i=await(function(l,c){const h=Kt(l),d=Pe.now(),p=c.reduce(((E,b)=>E.add(b.key)),oe());let m,v;return h.persistence.runTransaction("Locally write mutations","readwrite",(E=>{let b=Ss(),T=oe();return h.Ns.getEntries(E,p).next((S=>{b=S,b.forEach(((C,D)=>{D.isValidDocument()||(T=T.add(C))}))})).next((()=>h.localDocuments.getOverlayedDocuments(E,b))).next((S=>{m=S;const C=[];for(const D of c){const O=XP(D,m.get(D.key).overlayedDocument);O!=null&&C.push(new Co(D.key,O,BS(O.value.mapValue),As.exists(!0)))}return h.mutationQueue.addMutationBatch(E,d,C,c)})).next((S=>{v=S;const C=S.applyToLocalDocumentSet(m,T);return h.documentOverlayCache.saveOverlays(E,S.batchId,C)}))})).then((()=>({batchId:v.batchId,changes:WS(m)})))})(n.localStore,t);n.sharedClientState.addPendingMutation(i.batchId),(function(l,c,h){let d=l.Vu[l.currentUser.toKey()];d||(d=new ze(ae)),d=d.insert(c,h),l.Vu[l.currentUser.toKey()]=d})(n,i.batchId,e),await hh(n,i.changes),await pp(n.remoteStore)}catch(i){const a=Pv(i,"Failed to persist write");e.reject(a)}}async function I1(r,t){const e=Kt(r);try{const n=await WM(e.localStore,t);t.targetChanges.forEach(((i,a)=>{const l=e.Au.get(a);l&&(be(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?l.hu=!0:i.modifiedDocuments.size>0?be(l.hu,14607):i.removedDocuments.size>0&&(be(l.hu,42227),l.hu=!1))})),await hh(e,n,t)}catch(n){await Jl(n)}}function r_(r,t,e){const n=Kt(r);if(n.isPrimaryClient&&e===0||!n.isPrimaryClient&&e===1){const i=[];n.Tu.forEach(((a,l)=>{const c=l.view.va(t);c.snapshot&&i.push(c.snapshot)})),(function(l,c){const h=Kt(l);h.onlineState=c;let d=!1;h.queries.forEach(((p,m)=>{for(const v of m.Sa)v.va(c)&&(d=!0)})),d&&Mv(h)})(n.eventManager,t),i.length&&n.Pu.H_(i),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function FL(r,t,e){const n=Kt(r);n.sharedClientState.updateQueryState(t,"rejected",e);const i=n.Au.get(t),a=i&&i.key;if(a){let l=new ze(kt.comparator);l=l.insert(a,Gn.newNoDocument(a,Wt.min()));const c=oe().add(a),h=new hp(Wt.min(),new Map,new ze(ae),l,c);await I1(n,h),n.du=n.du.remove(a),n.Au.delete(t),kv(n)}else await _y(n.localStore,t,!1).then((()=>Ry(n,t,e))).catch(Jl)}async function UL(r,t){const e=Kt(r),n=t.batch.batchId;try{const i=await YM(e.localStore,t);D1(e,n,null),x1(e,n),e.sharedClientState.updateMutationState(n,"acknowledged"),await hh(e,i)}catch(i){await Jl(i)}}async function VL(r,t,e){const n=Kt(r);try{const i=await(function(l,c){const h=Kt(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let p;return h.mutationQueue.lookupMutationBatch(d,c).next((m=>(be(m!==null,37113),p=m.keys(),h.mutationQueue.removeMutationBatch(d,m)))).next((()=>h.mutationQueue.performConsistencyCheck(d))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,c))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p))).next((()=>h.localDocuments.getDocuments(d,p)))}))})(n.localStore,t);D1(n,t,e),x1(n,t),n.sharedClientState.updateMutationState(t,"rejected",e),await hh(n,i)}catch(i){await Jl(i)}}function x1(r,t){(r.mu.get(t)||[]).forEach((e=>{e.resolve()})),r.mu.delete(t)}function D1(r,t,e){const n=Kt(r);let i=n.Vu[n.currentUser.toKey()];if(i){const a=i.get(t);a&&(e?a.reject(e):a.resolve(),i=i.remove(t)),n.Vu[n.currentUser.toKey()]=i}}function Ry(r,t,e=null){r.sharedClientState.removeLocalQueryTarget(t);for(const n of r.Iu.get(t))r.Tu.delete(n),e&&r.Pu.yu(n,e);r.Iu.delete(t),r.isPrimaryClient&&r.Ru.jr(t).forEach((n=>{r.Ru.containsKey(n)||O1(r,n)}))}function O1(r,t){r.Eu.delete(t.path.canonicalString());const e=r.du.get(t);e!==null&&(Iv(r.remoteStore,e),r.du=r.du.remove(t),r.Au.delete(e),kv(r))}function s_(r,t,e){for(const n of e)n instanceof S1?(r.Ru.addReference(n.key,t),jL(r,n)):n instanceof R1?(xt(Lv,"Document no longer in limbo: "+n.key),r.Ru.removeReference(n.key,t),r.Ru.containsKey(n.key)||O1(r,n.key)):Ht(19791,{wu:n})}function jL(r,t){const e=t.key,n=e.path.canonicalString();r.du.get(e)||r.Eu.has(n)||(xt(Lv,"New document in limbo: "+e),r.Eu.add(n),kv(r))}function kv(r){for(;r.Eu.size>0&&r.du.size<r.maxConcurrentLimboResolutions;){const t=r.Eu.values().next().value;r.Eu.delete(t);const e=new kt(He.fromString(t)),n=r.fu.next();r.Au.set(n,new DL(e)),r.du=r.du.insert(e,n),E1(r.remoteStore,new ha(Or(Ev(e.path)),n,"TargetPurposeLimboResolution",ip.ce))}}async function hh(r,t,e){const n=Kt(r),i=[],a=[],l=[];n.Tu.isEmpty()||(n.Tu.forEach(((c,h)=>{l.push(n.pu(h,t,e).then((d=>{if((d||e)&&n.isPrimaryClient){const p=d?!d.fromCache:e?.targetChanges.get(h.targetId)?.current;n.sharedClientState.updateQueryState(h.targetId,p?"current":"not-current")}if(d){i.push(d);const p=Rv.As(h.targetId,d);a.push(p)}})))})),await Promise.all(l),n.Pu.H_(i),await(async function(h,d){const p=Kt(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>At.forEach(d,(v=>At.forEach(v.Es,(E=>p.persistence.referenceDelegate.addReference(m,v.targetId,E))).next((()=>At.forEach(v.ds,(E=>p.persistence.referenceDelegate.removeReference(m,v.targetId,E)))))))))}catch(m){if(!Zl(m))throw m;xt(Cv,"Failed to update sequence numbers: "+m)}for(const m of d){const v=m.targetId;if(!m.fromCache){const E=p.Ms.get(v),b=E.snapshotVersion,T=E.withLastLimboFreeSnapshotVersion(b);p.Ms=p.Ms.insert(v,T)}}})(n.localStore,a))}async function HL(r,t){const e=Kt(r);if(!e.currentUser.isEqual(t)){xt(Lv,"User change. New user:",t.toKey());const n=await g1(e.localStore,t);e.currentUser=t,(function(a,l){a.mu.forEach((c=>{c.forEach((h=>{h.reject(new Mt(bt.CANCELLED,l))}))})),a.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await hh(e,n.Ls)}}function zL(r,t){const e=Kt(r),n=e.Au.get(t);if(n&&n.hu)return oe().add(n.key);{let i=oe();const a=e.Iu.get(t);if(!a)return i;for(const l of a){const c=e.Tu.get(l);i=i.unionWith(c.view.nu)}return i}}function N1(r){const t=Kt(r);return t.remoteStore.remoteSyncer.applyRemoteEvent=I1.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=zL.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=FL.bind(null,t),t.Pu.H_=SL.bind(null,t.eventManager),t.Pu.yu=RL.bind(null,t.eventManager),t}function GL(r){const t=Kt(r);return t.remoteStore.remoteSyncer.applySuccessfulWrite=UL.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=VL.bind(null,t),t}class zf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=dp(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return $M(this.persistence,new HM,t.initialUser,this.serializer)}Cu(t){return new p1(Sv.mi,this.serializer)}Du(t){return new JM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}zf.provider={build:()=>new zf};class $L extends zf{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){be(this.persistence.referenceDelegate instanceof jf,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new CM(n,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?hi.withCacheSize(this.cacheSizeBytes):hi.DEFAULT;return new p1((n=>jf.mi(n,e)),this.serializer)}}class Cy{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>r_(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=HL.bind(null,this.syncEngine),await AL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new TL})()}createDatastore(t){const e=dp(t.databaseInfo.databaseId),n=(function(a){return new iL(a)})(t.databaseInfo);return(function(a,l,c,h){return new oL(a,l,c,h)})(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return(function(n,i,a,l,c){return new cL(n,i,a,l,c)})(this.localStore,this.datastore,t.asyncQueue,(e=>r_(this.syncEngine,e,0)),(function(){return JT.v()?new JT:new ZM})())}createSyncEngine(t,e){return(function(i,a,l,c,h,d,p){const m=new OL(i,a,l,c,h,d);return p&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const n=Kt(e);xt(Eo,"RemoteStore shutting down."),n.Ea.add(5),await uh(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Cy.provider={build:()=>new Cy};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YL{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):ws("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a="FirestoreClient";class WL{constructor(t,e,n,i,a){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=zn.UNAUTHENTICATED,this.clientId=dv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,(async l=>{xt(_a,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(n,(l=>(xt(_a,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new ga;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=Pv(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Hm(r,t){r.asyncQueue.verifyOperationInProgress(),xt(_a,"Initializing OfflineComponentProvider");const e=r.configuration;await t.initialize(e);let n=e.initialUser;r.setCredentialChangeListener((async i=>{n.isEqual(i)||(await g1(t.localStore,i),n=i)})),t.persistence.setDatabaseDeletedListener((()=>r.terminate())),r._offlineComponents=t}async function a_(r,t){r.asyncQueue.verifyOperationInProgress();const e=await KL(r);xt(_a,"Initializing OnlineComponentProvider"),await t.initialize(e,r.configuration),r.setCredentialChangeListener((n=>t_(t.remoteStore,n))),r.setAppCheckTokenChangeListener(((n,i)=>t_(t.remoteStore,i))),r._onlineComponents=t}async function KL(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){xt(_a,"Using user provided OfflineComponentProvider");try{await Hm(r,r._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(i){return i.name==="FirebaseError"?i.code===bt.FAILED_PRECONDITION||i.code===bt.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(e))throw e;Ul("Error using user provided cache. Falling back to memory cache: "+e),await Hm(r,new zf)}}else xt(_a,"Using default OfflineComponentProvider"),await Hm(r,new $L(void 0));return r._offlineComponents}async function P1(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(xt(_a,"Using user provided OnlineComponentProvider"),await a_(r,r._uninitializedComponentsProvider._online)):(xt(_a,"Using default OnlineComponentProvider"),await a_(r,new Cy))),r._onlineComponents}function XL(r){return P1(r).then((t=>t.syncEngine))}async function qL(r){const t=await P1(r),e=t.eventManager;return e.onListen=NL.bind(null,t.syncEngine),e.onUnlisten=LL.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=PL.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=kL.bind(null,t.syncEngine),e}function QL(r,t,e={}){const n=new ga;return r.asyncQueue.enqueueAndForget((async()=>(function(a,l,c,h,d){const p=new YL({next:v=>{p.Nu(),l.enqueueAndForget((()=>wL(a,m)));const E=v.docs.has(c);!E&&v.fromCache?d.reject(new Mt(bt.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&v.fromCache&&h&&h.source==="server"?d.reject(new Mt(bt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(v)},error:v=>d.reject(v)}),m=new CL(Ev(c.path),p,{includeMetadataChanges:!0,qa:!0});return _L(a,m)})(await qL(r),r.asyncQueue,t,e,n))),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M1(r){const t={};return r.timeoutSeconds!==void 0&&(t.timeoutSeconds=r.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L1="firestore.googleapis.com",l_=!0;class c_{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new Mt(bt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=L1,this.ssl=l_}else this.host=t.host,this.ssl=t.ssl??l_;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=f1;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<SM)throw new Mt(bt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}lP("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=M1(t.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Mt(bt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Mt(bt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Mt(bt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(n,i){return n.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Bv{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new c_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Mt(bt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Mt(bt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new c_(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new QN;switch(n.type){case"firstParty":return new eP(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Mt(bt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const n=o_.get(e);n&&(xt("ComponentProvider","Removing Datastore"),o_.delete(e),n.terminate())})(this),Promise.resolve()}}function JL(r,t,e,n={}){r=Uu(r,Bv);const i=Ra(t),a=r._getSettings(),l={...a,emulatorOptions:r._getEmulatorOptions()},c=`${t}:${e}`;i&&(qy(`https://${c}`),Qy("Firestore",!0)),a.host!==L1&&a.host!==c&&Ul("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...a,host:c,ssl:i,emulatorOptions:n};if(!po(h,l)&&(r._setSettings(h),n.mockUserToken)){let d,p;if(typeof n.mockUserToken=="string")d=n.mockUserToken,p=zn.MOCK_USER;else{d=Pw(n.mockUserToken,r._app?.options.projectId);const m=n.mockUserToken.sub||n.mockUserToken.user_id;if(!m)throw new Mt(bt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new zn(m)}r._authCredentials=new JN(new RS(d,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Fv(this.firestore,t,this._query)}}class Rn{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yu(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Rn(this.firestore,t,this._key)}toJSON(){return{type:Rn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,n){if(oh(e,Rn._jsonSchema))return new Rn(t,n||null,new kt(He.fromString(e.referencePath)))}}Rn._jsonSchemaVersion="firestore/documentReference/1.0",Rn._jsonSchema={type:hn("string",Rn._jsonSchemaVersion),referencePath:hn("string")};class Yu extends Fv{constructor(t,e,n){super(t,e,Ev(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Rn(this.firestore,null,new kt(t))}withConverter(t){return new Yu(this.firestore,t,this._path)}}function Kd(r,t,...e){if(r=Ze(r),arguments.length===1&&(t=dv.newId()),oP("doc","path",t),r instanceof Bv){const n=He.fromString(t,...e);return _T(n),new Rn(r,null,new kt(n))}{if(!(r instanceof Rn||r instanceof Yu))throw new Mt(bt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(He.fromString(t,...e));return _T(n),new Rn(r.firestore,r instanceof Yu?r.converter:null,new kt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u_="AsyncQueue";class h_{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new y1(this,"async_queue_retry"),this._c=()=>{const n=jm();n&&xt(u_,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=t;const e=jm();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=jm();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new ga;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Xu.push(t),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!Zl(t))throw t;xt(u_,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((n=>{throw this.nc=n,this.rc=!1,ws("INTERNAL UNHANDLED ERROR: ",d_(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=e,e}enqueueAfterDelay(t,e,n){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const i=Nv.createAndSchedule(this,t,e,n,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Ht(47125,{Pc:d_(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,n)=>e.targetTimeMs-n.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function d_(r){let t=r.message||"";return r.stack&&(t=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),t}class Uv extends Bv{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new h_,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new h_(t),this._firestoreClient=void 0,await t}}}function ZL(r,t){const e=typeof r=="object"?r:tv(),n=typeof r=="string"?r:Mf,i=Zf(e,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=Dw("firestore");a&&JL(i,...a)}return i}function k1(r){if(r._terminated)throw new Mt(bt.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||tk(r),r._firestoreClient}function tk(r){const t=r._freezeSettings(),e=(function(i,a,l,c){return new EP(i,a,l,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,M1(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(r._databaseId,r._app?.options.appId||"",r._persistenceKey,t);r._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(r._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),r._firestoreClient=new WL(r._authCredentials,r._appCheckCredentials,r._queue,e,r._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(t){this._byteString=t}static fromBase64String(t){try{return new zi(Fn.fromBase64String(t))}catch(e){throw new Mt(bt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new zi(Fn.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:zi._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(oh(t,zi._jsonSchema))return zi.fromBase64String(t.bytes)}}zi._jsonSchemaVersion="firestore/bytes/1.0",zi._jsonSchema={type:hn("string",zi._jsonSchemaVersion),bytes:hn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new Mt(bt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kn(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Mt(bt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Mt(bt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return ae(this._lat,t._lat)||ae(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Pr._jsonSchemaVersion}}static fromJSON(t){if(oh(t,Pr._jsonSchema))return new Pr(t.latitude,t.longitude)}}Pr._jsonSchemaVersion="firestore/geoPoint/1.0",Pr._jsonSchema={type:hn("string",Pr._jsonSchemaVersion),latitude:hn("number"),longitude:hn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0})(this._values,t._values)}toJSON(){return{type:Mr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(oh(t,Mr._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new Mr(t.vectorValues);throw new Mt(bt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Mr._jsonSchemaVersion="firestore/vectorValue/1.0",Mr._jsonSchema={type:hn("string",Mr._jsonSchemaVersion),vectorValues:hn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek=/^__.*__$/;class nk{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return this.fieldMask!==null?new Co(t,this.data,this.fieldMask,e,this.fieldTransforms):new lh(t,this.data,e,this.fieldTransforms)}}function F1(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ht(40011,{Ac:r})}}class jv{constructor(t,e,n,i,a,l){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new jv({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){const e=this.path?.child(t),n=this.Vc({path:e,fc:!1});return n.gc(t),n}yc(t){const e=this.path?.child(t),n=this.Vc({path:e,fc:!1});return n.Rc(),n}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return Gf(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(F1(this.Ac)&&ek.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class ik{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||dp(t)}Cc(t,e,n,i=!1){return new jv({Ac:t,methodName:e,Dc:n,path:kn.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function rk(r){const t=r._freezeSettings(),e=dp(r._databaseId);return new ik(r._databaseId,!!t.ignoreUndefinedProperties,e)}function sk(r,t,e,n,i,a={}){const l=r.Cc(a.merge||a.mergeFields?2:0,t,e,i);H1("Data must be an object, but it was:",l,n);const c=V1(n,l);let h,d;if(a.merge)h=new er(l.fieldMask),d=l.fieldTransforms;else if(a.mergeFields){const p=[];for(const m of a.mergeFields){const v=ak(t,m,e);if(!l.contains(v))throw new Mt(bt.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);lk(p,v)||p.push(v)}h=new er(p),d=l.fieldTransforms.filter((m=>h.covers(m.field)))}else h=null,d=l.fieldTransforms;return new nk(new Hi(c),h,d)}function U1(r,t){if(j1(r=Ze(r)))return H1("Unsupported field value:",t,r),V1(r,t);if(r instanceof B1)return(function(n,i){if(!F1(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(r,t),null;if(r===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),r instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return(function(n,i){const a=[];let l=0;for(const c of n){let h=U1(c,i.wc(l));h==null&&(h={nullValue:"NULL_VALUE"}),a.push(h),l++}return{arrayValue:{values:a}}})(r,t)}return(function(n,i){if((n=Ze(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return zP(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=Pe.fromDate(n);return{timestampValue:Vf(i.serializer,a)}}if(n instanceof Pe){const a=new Pe(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Vf(i.serializer,a)}}if(n instanceof Pr)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof zi)return{bytesValue:a1(i.serializer,n._byteString)};if(n instanceof Rn){const a=i.databaseId,l=n.firestore._databaseId;if(!l.isEqual(a))throw i.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:_v(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Mr)return(function(l,c){return{mapValue:{fields:{[LS]:{stringValue:kS},[Lf]:{arrayValue:{values:l.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return Av(c.serializer,d)}))}}}}}})(n,i);throw i.Sc(`Unsupported field value: ${fv(n)}`)})(r,t)}function V1(r,t){const e={};return xS(r)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):So(r,((n,i)=>{const a=U1(i,t.mc(n));a!=null&&(e[n]=a)})),{mapValue:{fields:e}}}function j1(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof Pe||r instanceof Pr||r instanceof zi||r instanceof Rn||r instanceof B1||r instanceof Mr)}function H1(r,t,e){if(!j1(e)||!CS(e)){const n=fv(e);throw n==="an object"?t.Sc(r+" a custom object"):t.Sc(r+" "+n)}}function ak(r,t,e){if((t=Ze(t))instanceof Vv)return t._internalPath;if(typeof t=="string")return z1(r,t);throw Gf("Field path arguments must be of type string or ",r,!1,void 0,e)}const ok=new RegExp("[~\\*/\\[\\]]");function z1(r,t,e){if(t.search(ok)>=0)throw Gf(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,e);try{return new Vv(...t.split("."))._internalPath}catch{throw Gf(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,e)}}function Gf(r,t,e,n,i){const a=n&&!n.isEmpty(),l=i!==void 0;let c=`Function ${t}() called with invalid data`;e&&(c+=" (via `toFirestore()`)"),c+=". ";let h="";return(a||l)&&(h+=" (found",a&&(h+=` in field ${n}`),l&&(h+=` in document ${i}`),h+=")"),new Mt(bt.INVALID_ARGUMENT,c+r+h)}function lk(r,t){return r.some((e=>e.isEqual(t)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(t,e,n,i,a){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Rn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new ck(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field($1("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class ck extends G1{data(){return super.data()}}function $1(r,t){return typeof t=="string"?z1(r,t):t instanceof Vv?t._internalPath:t._delegate._internalPath}class uk{convertValue(t,e="none"){switch(ba(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Je(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Aa(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw Ht(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return So(t,((i,a)=>{n[i]=this.convertValue(a,e)})),n}convertVectorValue(t){const e=t.fields?.[Lf].arrayValue?.values?.map((n=>Je(n.doubleValue)));return new Mr(e)}convertGeoPoint(t){return new Pr(Je(t.latitude),Je(t.longitude))}convertArray(t,e){return(t.values||[]).map((n=>this.convertValue(n,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=sp(t);return n==null?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(ju(t));default:return null}}convertTimestamp(t){const e=Ea(t);return new Pe(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=He.fromString(t);be(d1(n),9688,{name:t});const i=new Hu(n.get(1),n.get(3)),a=new kt(n.popFirst(5));return i.isEqual(e)||ws(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(r,t,e){let n;return n=r?r.toFirestore(t):t,n}class Eu{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class uo extends G1{constructor(t,e,n,i,a,l){super(t,e,n,i,l),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Ef(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field($1("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Mt(bt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=uo._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}uo._jsonSchemaVersion="firestore/documentSnapshot/1.0",uo._jsonSchema={type:hn("string",uo._jsonSchemaVersion),bundleSource:hn("string","DocumentSnapshot"),bundleName:hn("string"),bundle:hn("string")};class Ef extends uo{data(t={}){return super.data(t)}}class Ou{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Eu(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new Ef(this._firestore,this._userDataWriter,n.key,n,new Eu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Mt(bt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map((c=>{const h=new Ef(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Eu(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}}))}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const h=new Ef(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Eu(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,p=-1;return c.type!==0&&(d=l.indexOf(c.doc.key),l=l.delete(c.doc.key)),c.type!==1&&(l=l.add(c.doc),p=l.indexOf(c.doc.key)),{type:dk(c.type),doc:h,oldIndex:d,newIndex:p}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Mt(bt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Ou._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=dv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],n=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(e.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function dk(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ht(61501,{type:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xd(r){r=Uu(r,Rn);const t=Uu(r.firestore,Uv);return QL(k1(t),r._key).then((e=>gk(t,r,e)))}Ou._jsonSchemaVersion="firestore/querySnapshot/1.0",Ou._jsonSchema={type:hn("string",Ou._jsonSchemaVersion),bundleSource:hn("string","QuerySnapshot"),bundleName:hn("string"),bundle:hn("string")};class fk extends uk{constructor(t){super(),this.firestore=t}convertBytes(t){return new zi(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Rn(this.firestore,null,e)}}function f_(r,t,e){r=Uu(r,Rn);const n=Uu(r.firestore,Uv),i=hk(r.converter,t);return pk(n,[sk(rk(n),"setDoc",r._key,i,r.converter!==null,e).toMutation(r._key,As.none())])}function pk(r,t){return(function(n,i){const a=new ga;return n.asyncQueue.enqueueAndForget((async()=>BL(await XL(n),i,a))),a.promise})(k1(r),t)}function gk(r,t,e){const n=e.docs.get(t._key),i=new fk(r);return new uo(r,i,t._key,n,new Eu(e.hasPendingWrites,e.fromCache),t.converter)}(function(t,e=!0){(function(i){Ql=i})(wo),go(new ya("firestore",((n,{instanceIdentifier:i,options:a})=>{const l=n.getProvider("app").getImmediate(),c=new Uv(new ZN(n.getProvider("auth-internal")),new nP(l,n.getProvider("app-check-internal")),(function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Mt(bt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hu(d.options.projectId,p)})(l,i),l);return a={useFetchStreams:e,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),xr(ET,AT,t),xr(ET,AT,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y1="firebasestorage.googleapis.com",W1="storageBucket",mk=120*1e3,yk=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We extends Ur{constructor(t,e,n=0){super(zm(t),`Firebase Storage: ${e} (${zm(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,We.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return zm(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ye;(function(r){r.UNKNOWN="unknown",r.OBJECT_NOT_FOUND="object-not-found",r.BUCKET_NOT_FOUND="bucket-not-found",r.PROJECT_NOT_FOUND="project-not-found",r.QUOTA_EXCEEDED="quota-exceeded",r.UNAUTHENTICATED="unauthenticated",r.UNAUTHORIZED="unauthorized",r.UNAUTHORIZED_APP="unauthorized-app",r.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",r.INVALID_CHECKSUM="invalid-checksum",r.CANCELED="canceled",r.INVALID_EVENT_NAME="invalid-event-name",r.INVALID_URL="invalid-url",r.INVALID_DEFAULT_BUCKET="invalid-default-bucket",r.NO_DEFAULT_BUCKET="no-default-bucket",r.CANNOT_SLICE_BLOB="cannot-slice-blob",r.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",r.NO_DOWNLOAD_URL="no-download-url",r.INVALID_ARGUMENT="invalid-argument",r.INVALID_ARGUMENT_COUNT="invalid-argument-count",r.APP_DELETED="app-deleted",r.INVALID_ROOT_OPERATION="invalid-root-operation",r.INVALID_FORMAT="invalid-format",r.INTERNAL_ERROR="internal-error",r.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ye||(Ye={}));function zm(r){return"storage/"+r}function Hv(){const r="An unknown error occurred, please check the error payload for server response.";return new We(Ye.UNKNOWN,r)}function vk(r){return new We(Ye.OBJECT_NOT_FOUND,"Object '"+r+"' does not exist.")}function Ek(r){return new We(Ye.QUOTA_EXCEEDED,"Quota for bucket '"+r+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Ak(){const r="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new We(Ye.UNAUTHENTICATED,r)}function bk(){return new We(Ye.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Tk(r){return new We(Ye.UNAUTHORIZED,"User does not have permission to access '"+r+"'.")}function _k(){return new We(Ye.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function wk(){return new We(Ye.CANCELED,"User canceled the upload/download.")}function Sk(r){return new We(Ye.INVALID_URL,"Invalid URL '"+r+"'.")}function Rk(r){return new We(Ye.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.")}function Ck(){return new We(Ye.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+W1+"' property when initializing the app?")}function Ik(){return new We(Ye.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function xk(){return new We(Ye.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Dk(r){return new We(Ye.UNSUPPORTED_ENVIRONMENT,`${r} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Iy(r){return new We(Ye.INVALID_ARGUMENT,r)}function K1(){return new We(Ye.APP_DELETED,"The Firebase app was deleted.")}function Ok(r){return new We(Ye.INVALID_ROOT_OPERATION,"The operation '"+r+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Nu(r,t){return new We(Ye.INVALID_FORMAT,"String does not match format '"+r+"': "+t)}function lu(r){throw new We(Ye.INTERNAL_ERROR,"Internal error: "+r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let n;try{n=ei.makeFromUrl(t,e)}catch{return new ei(t,"")}if(n.path==="")return n;throw Rk(t)}static makeFromUrl(t,e){let n=null;const i="([A-Za-z0-9.\\-_]+)";function a(F){F.path.charAt(F.path.length-1)==="/"&&(F.path_=F.path_.slice(0,-1))}const l="(/(.*))?$",c=new RegExp("^gs://"+i+l,"i"),h={bucket:1,path:3};function d(F){F.path_=decodeURIComponent(F.path)}const p="v[A-Za-z0-9_]+",m=e.replace(/[.]/g,"\\."),v="(/([^?#]*).*)?$",E=new RegExp(`^https?://${m}/${p}/b/${i}/o${v}`,"i"),b={bucket:1,path:3},T=e===Y1?"(?:storage.googleapis.com|storage.cloud.google.com)":e,S="([^?#]*)",C=new RegExp(`^https?://${T}/${i}/${S}`,"i"),O=[{regex:c,indices:h,postModify:a},{regex:E,indices:b,postModify:d},{regex:C,indices:{bucket:1,path:2},postModify:d}];for(let F=0;F<O.length;F++){const k=O[F],z=k.regex.exec(t);if(z){const P=z[k.indices.bucket];let N=z[k.indices.path];N||(N=""),n=new ei(P,N),k.postModify(n);break}}if(n==null)throw Sk(t);return n}}class Nk{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pk(r,t,e){let n=1,i=null,a=null,l=!1,c=0;function h(){return c===2}let d=!1;function p(...S){d||(d=!0,t.apply(null,S))}function m(S){i=setTimeout(()=>{i=null,r(E,h())},S)}function v(){a&&clearTimeout(a)}function E(S,...C){if(d){v();return}if(S){v(),p.call(null,S,...C);return}if(h()||l){v(),p.call(null,S,...C);return}n<64&&(n*=2);let O;c===1?(c=2,O=0):O=(n+Math.random())*1e3,m(O)}let b=!1;function T(S){b||(b=!0,v(),!d&&(i!==null?(S||(c=2),clearTimeout(i),m(0)):S||(c=1)))}return m(0),a=setTimeout(()=>{l=!0,T(!0)},e),T}function Mk(r){r(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lk(r){return r!==void 0}function kk(r){return typeof r=="object"&&!Array.isArray(r)}function zv(r){return typeof r=="string"||r instanceof String}function p_(r){return Gv()&&r instanceof Blob}function Gv(){return typeof Blob<"u"}function xy(r,t,e,n){if(n<t)throw Iy(`Invalid value for '${r}'. Expected ${t} or greater.`);if(n>e)throw Iy(`Invalid value for '${r}'. Expected ${e} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dh(r,t,e){let n=t;return e==null&&(n=`https://${t}`),`${e}://${n}/v0${r}`}function X1(r){const t=encodeURIComponent;let e="?";for(const n in r)if(r.hasOwnProperty(n)){const i=t(n)+"="+t(r[n]);e=e+i+"&"}return e=e.slice(0,-1),e}var ho;(function(r){r[r.NO_ERROR=0]="NO_ERROR",r[r.NETWORK_ERROR=1]="NETWORK_ERROR",r[r.ABORT=2]="ABORT"})(ho||(ho={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bk(r,t){const e=r>=500&&r<600,i=[408,429].indexOf(r)!==-1,a=t.indexOf(r)!==-1;return e||i||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fk{constructor(t,e,n,i,a,l,c,h,d,p,m,v=!0,E=!1){this.url_=t,this.method_=e,this.headers_=n,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=c,this.errorCallback_=h,this.timeout_=d,this.progressCallback_=p,this.connectionFactory_=m,this.retry=v,this.isUsingEmulator=E,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((b,T)=>{this.resolve_=b,this.reject_=T,this.start_()})}start_(){const t=(n,i)=>{if(i){n(!1,new qd(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const l=c=>{const h=c.loaded,d=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,d)};this.progressCallback_!==null&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const c=a.getErrorCode()===ho.NO_ERROR,h=a.getStatus();if(!c||Bk(h,this.additionalRetryCodes_)&&this.retry){const p=a.getErrorCode()===ho.ABORT;n(!1,new qd(!1,null,p));return}const d=this.successCodes_.indexOf(h)!==-1;n(!0,new qd(d,a))})},e=(n,i)=>{const a=this.resolve_,l=this.reject_,c=i.connection;if(i.wasSuccessCode)try{const h=this.callback_(c,c.getResponse());Lk(h)?a(h):a()}catch(h){l(h)}else if(c!==null){const h=Hv();h.serverResponse=c.getErrorText(),this.errorCallback_?l(this.errorCallback_(c,h)):l(h)}else if(i.canceled){const h=this.appDelete_?K1():wk();l(h)}else{const h=_k();l(h)}};this.canceled_?e(!1,new qd(!1,null,!0)):this.backoffId_=Pk(t,e,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&Mk(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class qd{constructor(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n}}function Uk(r,t){t!==null&&t.length>0&&(r.Authorization="Firebase "+t)}function Vk(r,t){r["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function jk(r,t){t&&(r["X-Firebase-GMPID"]=t)}function Hk(r,t){t!==null&&(r["X-Firebase-AppCheck"]=t)}function zk(r,t,e,n,i,a,l=!0,c=!1){const h=X1(r.urlParams),d=r.url+h,p=Object.assign({},r.headers);return jk(p,t),Uk(p,e),Vk(p,a),Hk(p,n),new Fk(d,r.method,p,r.body,r.successCodes,r.additionalRetryCodes,r.handler,r.errorHandler,r.timeout,r.progressCallback,i,l,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function $k(...r){const t=Gk();if(t!==void 0){const e=new t;for(let n=0;n<r.length;n++)e.append(r[n]);return e.getBlob()}else{if(Gv())return new Blob(r);throw new We(Ye.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Yk(r,t,e){return r.webkitSlice?r.webkitSlice(t,e):r.mozSlice?r.mozSlice(t,e):r.slice?r.slice(t,e):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wk(r){if(typeof atob>"u")throw Dk("base-64");return atob(r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ir={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Gm{constructor(t,e){this.data=t,this.contentType=e||null}}function Kk(r,t){switch(r){case Ir.RAW:return new Gm(q1(t));case Ir.BASE64:case Ir.BASE64URL:return new Gm(Q1(r,t));case Ir.DATA_URL:return new Gm(qk(t),Qk(t))}throw Hv()}function q1(r){const t=[];for(let e=0;e<r.length;e++){let n=r.charCodeAt(e);if(n<=127)t.push(n);else if(n<=2047)t.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(e<r.length-1&&(r.charCodeAt(e+1)&64512)===56320))t.push(239,191,189);else{const a=n,l=r.charCodeAt(++e);n=65536|(a&1023)<<10|l&1023,t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?t.push(239,191,189):t.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(t)}function Xk(r){let t;try{t=decodeURIComponent(r)}catch{throw Nu(Ir.DATA_URL,"Malformed data URL.")}return q1(t)}function Q1(r,t){switch(r){case Ir.BASE64:{const i=t.indexOf("-")!==-1,a=t.indexOf("_")!==-1;if(i||a)throw Nu(r,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Ir.BASE64URL:{const i=t.indexOf("+")!==-1,a=t.indexOf("/")!==-1;if(i||a)throw Nu(r,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let e;try{e=Wk(t)}catch(i){throw i.message.includes("polyfill")?i:Nu(r,"Invalid character found")}const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n}class J1{constructor(t){this.base64=!1,this.contentType=null;const e=t.match(/^data:([^,]+)?,/);if(e===null)throw Nu(Ir.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=e[1]||null;n!=null&&(this.base64=Jk(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=t.substring(t.indexOf(",")+1)}}function qk(r){const t=new J1(r);return t.base64?Q1(Ir.BASE64,t.rest):Xk(t.rest)}function Qk(r){return new J1(r).contentType}function Jk(r,t){return r.length>=t.length?r.substring(r.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(t,e){let n=0,i="";p_(t)?(this.data_=t,n=t.size,i=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,e){if(p_(this.data_)){const n=this.data_,i=Yk(n,t,e);return i===null?null:new la(i)}else{const n=new Uint8Array(this.data_.buffer,t,e-t);return new la(n,!0)}}static getBlob(...t){if(Gv()){const e=t.map(n=>n instanceof la?n.data_:n);return new la($k.apply(null,e))}else{const e=t.map(l=>zv(l)?Kk(Ir.RAW,l).data:l.data_);let n=0;e.forEach(l=>{n+=l.byteLength});const i=new Uint8Array(n);let a=0;return e.forEach(l=>{for(let c=0;c<l.length;c++)i[a++]=l[c]}),new la(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $v(r){let t;try{t=JSON.parse(r)}catch{return null}return kk(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zk(r){if(r.length===0)return null;const t=r.lastIndexOf("/");return t===-1?"":r.slice(0,t)}function t4(r,t){const e=t.split("/").filter(n=>n.length>0).join("/");return r.length===0?e:r+"/"+e}function Z1(r){const t=r.lastIndexOf("/",r.length-2);return t===-1?r:r.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e4(r,t){return t}class Qn{constructor(t,e,n,i){this.server=t,this.local=e||t,this.writable=!!n,this.xform=i||e4}}let Qd=null;function n4(r){return!zv(r)||r.length<2?r:Z1(r)}function tR(){if(Qd)return Qd;const r=[];r.push(new Qn("bucket")),r.push(new Qn("generation")),r.push(new Qn("metageneration")),r.push(new Qn("name","fullPath",!0));function t(a,l){return n4(l)}const e=new Qn("name");e.xform=t,r.push(e);function n(a,l){return l!==void 0?Number(l):l}const i=new Qn("size");return i.xform=n,r.push(i),r.push(new Qn("timeCreated")),r.push(new Qn("updated")),r.push(new Qn("md5Hash",null,!0)),r.push(new Qn("cacheControl",null,!0)),r.push(new Qn("contentDisposition",null,!0)),r.push(new Qn("contentEncoding",null,!0)),r.push(new Qn("contentLanguage",null,!0)),r.push(new Qn("contentType",null,!0)),r.push(new Qn("metadata","customMetadata",!0)),Qd=r,Qd}function i4(r,t){function e(){const n=r.bucket,i=r.fullPath,a=new ei(n,i);return t._makeStorageReference(a)}Object.defineProperty(r,"ref",{get:e})}function r4(r,t,e){const n={};n.type="file";const i=e.length;for(let a=0;a<i;a++){const l=e[a];n[l.local]=l.xform(n,t[l.server])}return i4(n,r),n}function eR(r,t,e){const n=$v(t);return n===null?null:r4(r,n,e)}function s4(r,t,e,n){const i=$v(t);if(i===null||!zv(i.downloadTokens))return null;const a=i.downloadTokens;if(a.length===0)return null;const l=encodeURIComponent;return a.split(",").map(d=>{const p=r.bucket,m=r.fullPath,v="/b/"+l(p)+"/o/"+l(m),E=dh(v,e,n),b=X1({alt:"media",token:d});return E+b})[0]}function a4(r,t){const e={},n=t.length;for(let i=0;i<n;i++){const a=t[i];a.writable&&(e[a.server]=r[a.local])}return JSON.stringify(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g_="prefixes",m_="items";function o4(r,t,e){const n={prefixes:[],items:[],nextPageToken:e.nextPageToken};if(e[g_])for(const i of e[g_]){const a=i.replace(/\/$/,""),l=r._makeStorageReference(new ei(t,a));n.prefixes.push(l)}if(e[m_])for(const i of e[m_]){const a=r._makeStorageReference(new ei(t,i.name));n.items.push(a)}return n}function l4(r,t,e){const n=$v(e);return n===null?null:o4(r,t,n)}class gp{constructor(t,e,n,i){this.url=t,this.method=e,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yv(r){if(!r)throw Hv()}function c4(r,t){function e(n,i){const a=eR(r,i,t);return Yv(a!==null),a}return e}function u4(r,t){function e(n,i){const a=l4(r,t,i);return Yv(a!==null),a}return e}function h4(r,t){function e(n,i){const a=eR(r,i,t);return Yv(a!==null),s4(a,i,r.host,r._protocol)}return e}function Wv(r){function t(e,n){let i;return e.getStatus()===401?e.getErrorText().includes("Firebase App Check token is invalid")?i=bk():i=Ak():e.getStatus()===402?i=Ek(r.bucket):e.getStatus()===403?i=Tk(r.path):i=n,i.status=e.getStatus(),i.serverResponse=n.serverResponse,i}return t}function nR(r){const t=Wv(r);function e(n,i){let a=t(n,i);return n.getStatus()===404&&(a=vk(r.path)),a.serverResponse=i.serverResponse,a}return e}function d4(r,t,e,n,i){const a={};t.isRoot?a.prefix="":a.prefix=t.path+"/",e.length>0&&(a.delimiter=e),n&&(a.pageToken=n),i&&(a.maxResults=i);const l=t.bucketOnlyServerUrl(),c=dh(l,r.host,r._protocol),h="GET",d=r.maxOperationRetryTime,p=new gp(c,h,u4(r,t.bucket),d);return p.urlParams=a,p.errorHandler=Wv(t),p}function f4(r,t,e){const n=t.fullServerUrl(),i=dh(n,r.host,r._protocol),a="GET",l=r.maxOperationRetryTime,c=new gp(i,a,h4(r,e),l);return c.errorHandler=nR(t),c}function p4(r,t){const e=t.fullServerUrl(),n=dh(e,r.host,r._protocol),i="DELETE",a=r.maxOperationRetryTime;function l(h,d){}const c=new gp(n,i,l,a);return c.successCodes=[200,204],c.errorHandler=nR(t),c}function g4(r,t){return r&&r.contentType||t&&t.type()||"application/octet-stream"}function m4(r,t,e){const n=Object.assign({},e);return n.fullPath=r.path,n.size=t.size(),n.contentType||(n.contentType=g4(null,t)),n}function y4(r,t,e,n,i){const a=t.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function c(){let O="";for(let F=0;F<2;F++)O=O+Math.random().toString().slice(2);return O}const h=c();l["Content-Type"]="multipart/related; boundary="+h;const d=m4(t,n,i),p=a4(d,e),m="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+p+`\r
--`+h+`\r
Content-Type: `+d.contentType+`\r
\r
`,v=`\r
--`+h+"--",E=la.getBlob(m,n,v);if(E===null)throw Ik();const b={name:d.fullPath},T=dh(a,r.host,r._protocol),S="POST",C=r.maxUploadRetryTime,D=new gp(T,S,c4(r,e),C);return D.urlParams=b,D.headers=l,D.body=E.uploadData(),D.errorHandler=Wv(t),D}class v4{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ho.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ho.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ho.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,e,n,i,a){if(this.sent_)throw lu("cannot .send() more than once");if(Ra(t)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(e,t,!0),a!==void 0)for(const l in a)a.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,a[l].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw lu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw lu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw lu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw lu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class E4 extends v4{initXhr(){this.xhr_.responseType="text"}}function mp(){return new E4}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(t,e){this._service=t,e instanceof ei?this._location=e:this._location=ei.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new Ao(t,e)}get root(){const t=new ei(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Z1(this._location.path)}get storage(){return this._service}get parent(){const t=Zk(this._location.path);if(t===null)return null;const e=new ei(this._location.bucket,t);return new Ao(this._service,e)}_throwIfRoot(t){if(this._location.path==="")throw Ok(t)}}function A4(r,t,e){r._throwIfRoot("uploadBytes");const n=y4(r.storage,r._location,tR(),new la(t,!0),e);return r.storage.makeRequestWithTokens(n,mp).then(i=>({metadata:i,ref:r}))}function b4(r){const t={prefixes:[],items:[]};return iR(r,t).then(()=>t)}async function iR(r,t,e){const i=await T4(r,{pageToken:e});t.prefixes.push(...i.prefixes),t.items.push(...i.items),i.nextPageToken!=null&&await iR(r,t,i.nextPageToken)}function T4(r,t){t!=null&&typeof t.maxResults=="number"&&xy("options.maxResults",1,1e3,t.maxResults);const e=t||{},n=d4(r.storage,r._location,"/",e.pageToken,e.maxResults);return r.storage.makeRequestWithTokens(n,mp)}function _4(r){r._throwIfRoot("getDownloadURL");const t=f4(r.storage,r._location,tR());return r.storage.makeRequestWithTokens(t,mp).then(e=>{if(e===null)throw xk();return e})}function w4(r){r._throwIfRoot("deleteObject");const t=p4(r.storage,r._location);return r.storage.makeRequestWithTokens(t,mp)}function S4(r,t){const e=t4(r._location.path,t),n=new ei(r._location.bucket,e);return new Ao(r.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R4(r){return/^[A-Za-z]+:\/\//.test(r)}function C4(r,t){return new Ao(r,t)}function rR(r,t){if(r instanceof Kv){const e=r;if(e._bucket==null)throw Ck();const n=new Ao(e,e._bucket);return t!=null?rR(n,t):n}else return t!==void 0?S4(r,t):r}function I4(r,t){if(t&&R4(t)){if(r instanceof Kv)return C4(r,t);throw Iy("To use ref(service, url), the first argument must be a Storage instance.")}else return rR(r,t)}function y_(r,t){const e=t?.[W1];return e==null?null:ei.makeFromBucketSpec(e,r)}function x4(r,t,e,n={}){r.host=`${t}:${e}`;const i=Ra(t);i&&(qy(`https://${r.host}/b`),Qy("Storage",!0)),r._isUsingEmulator=!0,r._protocol=i?"https":"http";const{mockUserToken:a}=n;a&&(r._overrideAuthToken=typeof a=="string"?a:Pw(a,r.app.options.projectId))}class Kv{constructor(t,e,n,i,a,l=!1){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._url=i,this._firebaseVersion=a,this._isUsingEmulator=l,this._bucket=null,this._host=Y1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=mk,this._maxUploadRetryTime=yk,this._requests=new Set,i!=null?this._bucket=ei.makeFromBucketSpec(i,this._host):this._bucket=y_(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=ei.makeFromBucketSpec(this._url,t):this._bucket=y_(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){xy("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){xy("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(e!==null)return e.accessToken}return null}async _getAppCheckToken(){if(di(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Ao(this,t)}_makeRequest(t,e,n,i,a=!0){if(this._deleted)return new Nk(K1());{const l=zk(t,this._appId,n,i,e,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(t,e){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,n,i).getPromise()}}const v_="@firebase/storage",E_="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR="storage";function D4(r,t,e){return r=Ze(r),A4(r,t,e)}function aR(r){return r=Ze(r),b4(r)}function O4(r){return r=Ze(r),_4(r)}function N4(r){return r=Ze(r),w4(r)}function $f(r,t){return r=Ze(r),I4(r,t)}function P4(r=tv(),t){r=Ze(r);const n=Zf(r,sR).getImmediate({identifier:t}),i=Dw("storage");return i&&M4(n,...i),n}function M4(r,t,e,n={}){x4(r,t,e,n)}function L4(r,{instanceIdentifier:t}){const e=r.getProvider("app").getImmediate(),n=r.getProvider("auth-internal"),i=r.getProvider("app-check-internal");return new Kv(e,n,i,t,wo)}function k4(){go(new ya(sR,L4,"PUBLIC").setMultipleInstances(!0)),xr(v_,E_,""),xr(v_,E_,"esm2020")}k4();const B4={apiKey:"AIzaSyBxD-ELTkbweIZnsiQQu-T97SrCpNEwi7Y",authDomain:"ldd-backend-910d6.firebaseapp.com",projectId:"ldd-backend-910d6",storageBucket:"ldd-backend-910d6.firebasestorage.app",messagingSenderId:"245318789124",appId:"1:245318789124:web:f6a04d784a4199a570ad51"},Xv=kw(B4),_i=XN(Xv),Dy=new gs,ji=P4(Xv),Au=ZL(Xv);console.log("Firebase initialized:",{auth:_i,db:Au,storage:ji});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function F4(r,t,e,n){function i(a){return a instanceof e?a:new e(function(l){l(a)})}return new(e||(e=Promise))(function(a,l){function c(p){try{d(n.next(p))}catch(m){l(m)}}function h(p){try{d(n.throw(p))}catch(m){l(m)}}function d(p){p.done?a(p.value):i(p.value).then(c,h)}d((n=n.apply(r,[])).next())})}function U4(r,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(d){return function(p){return h([d,p])}}function h(d){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(a=d[0]&2?i.return:d[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,d[1])).done)return a;switch(i=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return e.label++,{value:d[1],done:!1};case 5:e.label++,i=d[1],d=[0];continue;case 7:d=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){e=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){e.label=d[1];break}if(d[0]===6&&e.label<a[1]){e.label=a[1],a=d;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(d);break}a[2]&&e.ops.pop(),e.trys.pop();continue}d=t.call(r,e)}catch(p){d=[6,p],i=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Dl=function(){return Dl=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},Dl.apply(this,arguments)},oR=function(r){return{loading:r==null,value:r}},V4=function(){return function(r,t){switch(t.type){case"error":return Dl(Dl({},r),{error:t.error,loading:!1,value:void 0});case"reset":return oR(t.defaultValue);case"value":return Dl(Dl({},r),{error:void 0,loading:!1,value:t.value});default:return r}}},j4=(function(r){var t=r?r():void 0,e=at.useReducer(V4(),oR(t)),n=e[0],i=e[1],a=at.useCallback(function(){var h=r?r():void 0;i({type:"reset",defaultValue:h})},[r]),l=at.useCallback(function(h){i({type:"error",error:h})},[]),c=at.useCallback(function(h){i({type:"value",value:h})},[]);return at.useMemo(function(){return{error:n.error,loading:n.loading,reset:a,setError:l,setValue:c,value:n.value}},[n.error,n.loading,a,l,c,n.value])}),qv=(function(r,t){var e=j4(function(){return r.currentUser}),n=e.error,i=e.loading,a=e.setError,l=e.setValue,c=e.value;return at.useEffect(function(){var h=oS(r,function(d){return F4(void 0,void 0,void 0,function(){var p;return U4(this,function(m){switch(m.label){case 0:return[3,4];case 1:return m.trys.push([1,3,,4]),[4,t.onUserChanged(d)];case 2:return m.sent(),[3,4];case 3:return p=m.sent(),a(p),[3,4];case 4:return l(d),[2]}})})},a);return function(){h()}},[r]),[c,i,n]});const H4=()=>{const[r,t]=at.useState(!1),[e]=qv(_i),n=Xl();at.useEffect(()=>{const l=()=>{t(window.scrollY>50)};return window.addEventListener("scroll",l),()=>{window.removeEventListener("scroll",l)}},[]);const i=async()=>{await uy(_i),n("/auth")},a=()=>e?.photoURL?e.photoURL:`https://ui-avatars.com/api/?name=${e?.displayName||e?.email||"User"}&background=${Math.floor(Math.random()*16777215).toString(16)}&color=fff`;return Y.jsxs("nav",{className:`container ${r?"dark-nav":""}`,children:[Y.jsx("img",{src:qx,alt:"Logo",className:"logo"}),Y.jsxs("ul",{children:[Y.jsx("li",{children:Y.jsx(wu,{to:"/",className:"nav-link",children:"Home"})}),Y.jsx("li",{children:"Stories"}),Y.jsx("li",{children:"Document Scanner"}),Y.jsx("li",{children:"About Us"}),e?Y.jsxs(Y.Fragment,{children:[Y.jsx(wu,{to:"/profile",className:"profile-link",children:Y.jsxs("li",{className:"navbar-profile",children:[Y.jsx("img",{src:a(),alt:"profile",className:"profile-pic",style:{width:32,height:32,borderRadius:"50%",marginRight:8},onError:l=>{l.target.src=`https://ui-avatars.com/api/?name=${e.displayName||e.email||"User"}&background=${Math.floor(Math.random()*16777215).toString(16)}&color=fff`}}),Y.jsx("span",{children:e.displayName||e.email})]})}),Y.jsx("li",{children:Y.jsx("button",{className:"btn",onClick:i,children:"Sign Out"})})]}):Y.jsx("li",{children:Y.jsx(wu,{to:"/auth",className:"btn",children:"Login"})})]})]})},z4=()=>{const[r,t]=at.useState(!0),[e,n]=at.useState({email:"",password:""}),[i,a]=at.useState({name:"",phone:"",email:"",password:"",age:"",source:""}),[l,c]=at.useState(""),[h,d]=at.useState(""),[p,m]=at.useState(""),v=Xl();at.useEffect(()=>{const D=oS(_i,O=>{O?console.log("Auth State Changed:",{uid:O.uid,email:O.email}):(console.log("No user authenticated"),m("Please signup or login to continue."))});return()=>D()},[]);const E=(D,O)=>{const{name:F,value:k}=D.target;if(O==="signup"){if(F==="age"&&k&&isNaN(parseInt(k,10))){c("Age must be a valid number");return}a(z=>({...z,[F]:k})),F==="age"&&c("")}else n(z=>({...z,[F]:k}))},b=async D=>{D.preventDefault();const O=parseInt(i.age,10);if(O<18||isNaN(O)){c("Age must be a valid number and at least 18");return}if(!i.name||!i.phone||!i.email||!i.password||!i.source){d("All fields are required for signup.");return}try{const k=(await M2(_i,i.email,i.password)).user;await k2(k),alert("Verification email sent! Please check your inbox.");const z=Kd(Au,"users",k.uid);(await Xd(z)).exists()||await f_(z,{name:i.name,phone:i.phone,email:i.email,age:O,source:i.source,createdAt:new Date,providerId:k.providerId}),t(!0)}catch(F){console.error("Signup error:",F),F.code==="auth/email-already-in-use"?d("This email is already registered. Please log in."):d(F.message)}},T=async D=>{if(D.preventDefault(),!e.email||!e.password){d("Email and password are required.");return}try{const F=(await L2(_i,e.email,e.password)).user;if(!F.emailVerified){d("Please verify your email before logging in.");return}(await Xd(Kd(Au,"users",F.uid))).exists()?v("/"):(d("No user data found in database. Please sign up first."),await uy(_i))}catch(O){console.error("Login error:",O),O.code==="auth/user-not-found"?d("No account found with this email. Please sign up."):O.code==="auth/wrong-password"?d("Incorrect password. Please try again."):d(O.message)}},S=async()=>{d("");try{const O=(await uT(_i,Dy)).user,F=Kd(Au,"users",O.uid);(await Xd(F)).exists()||await f_(F,{name:O.displayName||"Google User",phone:"",email:O.email,age:0,source:"Google",createdAt:new Date,providerId:O.providerId}),v("/")}catch(D){console.error("Google signup error:",D),d(D.message)}},C=async()=>{d("");try{const O=(await uT(_i,Dy)).user,F=Kd(Au,"users",O.uid);if(!(await Xd(F)).exists()){try{await U2(O)}catch(z){console.warn("Could not delete user (might need re-auth):",z)}await uy(_i),d("You've not yet Signed up with us!");return}v("/")}catch(D){console.error("Google login error:",D),d(D.message)}};return Y.jsx("div",{className:"auth-container",children:Y.jsxs("div",{className:`form-flipper ${r?"":"show-signup"}`,children:[Y.jsx("div",{className:"form-wrapper login-form",children:Y.jsxs("form",{onSubmit:T,children:[Y.jsx("h2",{children:"Login"}),p&&Y.jsx("p",{className:"auth-message",children:p}),Y.jsxs("div",{className:"form-group",children:[Y.jsx("label",{htmlFor:"login-email",children:"Email ID"}),Y.jsx("input",{type:"email",id:"login-email",name:"email",value:e.email,onChange:D=>E(D,"login"),required:!0})]}),Y.jsxs("div",{className:"form-group",children:[Y.jsx("label",{htmlFor:"login-password",children:"Password"}),Y.jsx("input",{type:"password",id:"login-password",name:"password",value:e.password,onChange:D=>E(D,"login"),required:!0})]}),Y.jsx("button",{type:"submit",className:"btn",children:"Login"}),Y.jsx("button",{type:"button",className:"btn google-btn",onClick:C,children:"Login with Google"}),h&&Y.jsx("p",{className:"error-message",children:h}),Y.jsxs("p",{className:"toggle-text",children:["Don't have an account?"," ",Y.jsx("span",{onClick:()=>t(!1),children:"Sign Up"})]})]})}),Y.jsx("div",{className:"form-wrapper signup-form",children:Y.jsxs("form",{onSubmit:b,children:[Y.jsx("h2",{children:"Sign Up"}),Y.jsxs("div",{className:"form-group",children:[Y.jsx("label",{htmlFor:"name",children:"Name"}),Y.jsx("input",{type:"text",id:"name",name:"name",value:i.name,onChange:D=>E(D,"signup"),required:!0})]}),Y.jsxs("div",{className:"form-group",children:[Y.jsx("label",{htmlFor:"phone",children:"Phone Number"}),Y.jsx("input",{type:"tel",id:"phone",name:"phone",value:i.phone,onChange:D=>E(D,"signup"),required:!0})]}),Y.jsxs("div",{className:"form-group",children:[Y.jsx("label",{htmlFor:"signup-email",children:"Email ID"}),Y.jsx("input",{type:"email",id:"signup-email",name:"email",value:i.email,onChange:D=>E(D,"signup"),required:!0})]}),Y.jsxs("div",{className:"form-group",children:[Y.jsx("label",{htmlFor:"signup-password",children:"Password"}),Y.jsx("input",{type:"password",id:"signup-password",name:"password",value:i.password,onChange:D=>E(D,"signup"),required:!0})]}),Y.jsxs("div",{className:"form-group",children:[Y.jsx("label",{htmlFor:"age",children:"Age"}),Y.jsx("input",{type:"number",id:"age",name:"age",value:i.age,onChange:D=>E(D,"signup"),required:!0}),l&&Y.jsx("p",{className:"error-message",children:l})]}),Y.jsxs("div",{className:"form-group",children:[Y.jsx("label",{htmlFor:"source",children:"How did you hear about us?"}),Y.jsxs("select",{id:"source",name:"source",value:i.source,onChange:D=>E(D,"signup"),required:!0,children:[Y.jsx("option",{value:"",disabled:!0,children:"Select an option"}),Y.jsx("option",{value:"social-media",children:"Social Media"}),Y.jsx("option",{value:"friend",children:"From a friend"}),Y.jsx("option",{value:"search-engine",children:"Search Engine"}),Y.jsx("option",{value:"advertisement",children:"Advertisement"}),Y.jsx("option",{value:"other",children:"Other"})]})]}),Y.jsx("button",{type:"submit",className:"btn",children:"Sign Up"}),Y.jsx("button",{type:"button",className:"btn google-btn",onClick:S,children:"Sign Up with Google"}),h&&Y.jsx("p",{className:"error-message",children:h}),Y.jsxs("p",{className:"toggle-text",children:["Already have an account?"," ",Y.jsx("span",{onClick:()=>t(!0),children:"Login"})]})]})})]})})},G4=()=>{const r=Rs(),t=Xl(),{result:e}=r.state||{},n=at.useRef(null);at.useEffect(()=>{e&&e.verificationId&&console.log("RESULTS PAGE LOADED WITH VERIFICATION ID:",e.verificationId)},[e]);const i=l=>{if(n.current){const c=l==="left"?-200:200;n.current.scrollBy({left:c,behavior:"smooth"})}};if(!e)return Y.jsxs("div",{className:"error-container",children:[Y.jsx("h2",{children:"No results found"}),Y.jsx("button",{onClick:()=>t("/"),children:"Go Back"})]});const a=e.images?[...new Set(e.images)]:[];return Y.jsxs("div",{className:"results-container",children:[Y.jsxs("div",{className:"verdict-header",children:[Y.jsx("h1",{children:"Verification Results"}),Y.jsx("p",{className:e.status==="Original"?"verdict-original":"verdict-fake",children:e.status==="Original"?" Original Document":" Fake Document"}),e.verificationId&&Y.jsxs("p",{className:"verification-id",children:[Y.jsx("strong",{children:"Verification ID:"})," ",e.verificationId]})]}),Y.jsxs("div",{className:"summary-section",children:[Y.jsx("h3",{children:"Uploaded Document Preview"}),a.length>0?Y.jsxs("div",{className:"slider-container",children:[Y.jsx("button",{className:"slider-button slider-left",onClick:()=>i("left"),children:""}),Y.jsx("div",{className:"image-slider",ref:n,children:a.map((l,c)=>Y.jsxs("div",{className:"pdf-image-wrapper",children:[Y.jsx("img",{src:`data:image/png;base64,${l}`,alt:`Page ${c+1}`}),Y.jsxs("p",{children:["Page ",c+1]})]},c))}),Y.jsx("button",{className:"slider-button slider-right",onClick:()=>i("right"),children:""})]}):Y.jsx("p",{children:"No PDF images available."})]}),Y.jsxs("div",{className:"summary-section",children:[Y.jsx("h3",{children:"Page-wise Summaries"}),e.pageSummaries&&e.pageSummaries.length>0?e.pageSummaries.map((l,c)=>Y.jsxs("div",{className:"extracted-text-page",children:[Y.jsxs("h4",{children:["Page ",c+1]}),Y.jsx("div",{className:"page-html-content",children:l||"No summary available."})]},c)):Y.jsx("p",{children:"No summaries could be generated from the document."})]}),Y.jsxs("div",{className:"summary-section",children:[Y.jsx("h3",{children:"Analysis and Field Verification"}),e.analysis&&Y.jsx("p",{className:"analysis-text",children:e.analysis}),Y.jsx("div",{className:"comparison-table",children:Y.jsxs("table",{children:[Y.jsx("thead",{children:Y.jsxs("tr",{children:[Y.jsx("th",{children:"Field"}),Y.jsx("th",{children:"User Data"}),Y.jsx("th",{children:"Data From Document"}),Y.jsx("th",{children:"Status"})]})}),Y.jsx("tbody",{children:e.details&&e.details.length>0?e.details.map((l,c)=>Y.jsxs("tr",{children:[Y.jsx("td",{children:l.field}),Y.jsx("td",{className:"document-data-cell",children:l.userData||"-"}),Y.jsx("td",{className:"document-data-cell",children:l.dataFromDocument||"-"}),Y.jsx("td",{className:l.status===" Match"?"status-match":"status-mismatch",children:l.status})]},c)):Y.jsx("tr",{children:Y.jsx("td",{colSpan:"4",children:"No verification details available."})})})]})})]}),e.status!=="Original"&&Y.jsxs("div",{className:"mismatch-reason",children:[Y.jsx("strong",{children:'Reason for "Fake" Verdict:'}),Y.jsx("p",{children:"One or more fields did not match the data extracted from the document. Please review the mismatches highlighted in the table above."})]}),Y.jsx("button",{className:"back-link",onClick:()=>t("/"),children:"Verify Another Document"})]})},$4="/AuthentiDoc/assets/delete_icon-M_PWsJ8f.png",Y4=()=>{const[r,t]=qv(_i),[e,n]=at.useState([]),[i,a]=at.useState(""),l=async()=>{if(!r||!ji){a("Authentication or storage not initialized.");return}try{const h=$f(ji,`uploads/${r.uid}/`),p=(await aR(h)).items.map(m=>m.name);n(p)}catch(h){a(`Failed to list files. [${h.message}]`)}};at.useEffect(()=>{r&&!t&&ji&&l()},[r,t,ji]);const c=async h=>{if(!r||!ji){a("Authentication or storage not initialized.");return}try{const d=$f(ji,`uploads/${r.uid}/${h}`);await N4(d),n(e.filter(p=>p!==h))}catch(d){a(`Failed to delete file. [${d.message}]`)}};return t?Y.jsx("div",{className:"profile-container",children:"Loading profile..."}):r?Y.jsxs("div",{className:"profile-container",children:[Y.jsxs("h1",{children:["Hello, ",r.displayName||r.email,"!"]}),Y.jsxs("div",{className:"file-list-section",children:[Y.jsx("h2",{children:"Your Uploaded Files:"}),i&&Y.jsx("div",{className:"error-message",children:i}),e.length>0?Y.jsx("ul",{children:e.map((h,d)=>Y.jsxs("li",{className:"file-item",children:[h,Y.jsx("button",{className:"delete-btn",onClick:()=>c(h),children:Y.jsx("img",{src:$4,alt:"Delete",className:"delete-icon"})})]},d))}):Y.jsx("p",{children:"No files uploaded yet."})]})]}):Y.jsx("div",{className:"profile-container",children:"Please log in to view your profile."})},W4=()=>Y.jsx("div",{className:"hero container",children:Y.jsxs("div",{className:"hero-text",children:[Y.jsx("h1",{children:"Demistify Legal Documents  Upload, Scan & Verify Instantly"}),Y.jsx("p",{children:" Transform the way you handle official documents with our AI-powered document scanner. Simply upload any government document, ask questions in natural language, and get instant, accurate answers. With built-in multi-language translation, the system makes information accessible to everyone, bridging gaps and saving time."}),Y.jsx("button",{className:"btn",children:"Learn more"})]})}),K4="/AuthentiDoc/assets/program-1-m9P6QJUB.png",X4="/AuthentiDoc/assets/program-2-DSW_0IDX.png",q4="/AuthentiDoc/assets/program-3-BLYGjM74.png",Q4="/AuthentiDoc/assets/program-4-DEOdhSQu.png",J4="/AuthentiDoc/assets/pragram-icon-1-CKPnXbJj.png",Z4="/AuthentiDoc/assets/program-icon-2-xrxBF6Sy.png",t6="/AuthentiDoc/assets/program-icon-3-x3jSIxVf.png",e6="/AuthentiDoc/assets/program-icon-4-BZw1DVjS.png",n6=()=>Y.jsx("div",{children:Y.jsxs("div",{className:"program-container",children:[Y.jsxs("div",{className:"program-card",children:[Y.jsx("img",{src:K4,alt:"Power of Attorney"}),Y.jsxs("div",{className:"caption",children:[Y.jsx("img",{src:J4,alt:"icon"}),Y.jsx("p",{children:"POWER OF ATTORNEY"})]})]}),Y.jsxs("div",{className:"program-card",children:[Y.jsx("img",{src:X4,alt:"Rental Agreement"}),Y.jsxs("div",{className:"caption",children:[Y.jsx("img",{src:Z4,alt:"icon"}),Y.jsx("p",{children:"RENTAL AGREEMENT"})]})]}),Y.jsxs("div",{className:"program-card",children:[Y.jsx("img",{src:q4,alt:"Employment Agreement"}),Y.jsxs("div",{className:"caption",children:[Y.jsx("img",{src:t6,alt:"icon"}),Y.jsx("p",{children:"EMPLOYMENT AGREEMENT"})]})]}),Y.jsxs("div",{className:"program-card",children:[Y.jsx("img",{src:Q4,alt:"Partnership Agreement"}),Y.jsxs("div",{className:"caption",children:[Y.jsx("img",{src:e6,alt:"icon"}),Y.jsx("p",{children:"PARTNERSHIP AGREEMENT"})]})]})]})}),A_=({subTitle:r,title:t})=>Y.jsxs("div",{className:"title",children:[Y.jsx("p",{children:r}),Y.jsx("h2",{children:t})]}),i6="/AuthentiDoc/assets/Gemini_Generated_Image_mjrej0mjrej0mjre-DI4TlcrN.png",r6=()=>Y.jsxs("div",{className:"about",children:[Y.jsx("div",{className:"about-left",children:Y.jsx("img",{src:i6,alt:"About illustration",className:"about-img"})}),Y.jsxs("div",{className:"about-right",children:[Y.jsx("h3",{children:"ABOUT OUR WEBSITE"}),Y.jsx("h2",{children:"Turning Documents into Truth, Knowledge into Power"}),Y.jsx("p",{children:"Our AI-powered cloud platform is built to transform the way you handle official documents, making the process smarter, faster, and more reliable. It instantly checks whether a document is real and authentic, validates that the format is correct, and ensures compliance with official standards."}),Y.jsx("p",{children:"With integrated multi-language translation, you can convert documents across languages while preserving accuracy and meaning. Beyond simple verification, our intelligent system allows you to ask questions directly about your document, delivering clear, contextual answers that save time and eliminate confusion. Backed by secure cloud infrastructure, every document is processed and stored safely, giving you real-time accessibility, advanced protection against tampering, and complete peace of mind."}),Y.jsx("p",{children:"By combining the power of artificial intelligence and cloud technology, we bring you a platform that ensures trust, transparency, and efficiency in every document you manage. Our instant verification system automatically checks whether your document is genuine, ensuring there are no forgeries or invalid copies."})]})]});/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s6=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a6=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,n)=>n?n.toUpperCase():e.toLowerCase()),b_=r=>{const t=a6(r);return t.charAt(0).toUpperCase()+t.slice(1)},lR=(...r)=>r.filter((t,e,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===e).join(" ").trim(),o6=r=>{for(const t in r)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var l6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c6=at.forwardRef(({color:r="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:l,...c},h)=>at.createElement("svg",{ref:h,...l6,width:t,height:t,stroke:r,strokeWidth:n?Number(e)*24/Number(t):e,className:lR("lucide",i),...!a&&!o6(c)&&{"aria-hidden":"true"},...c},[...l.map(([d,p])=>at.createElement(d,p)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u6=(r,t)=>{const e=at.forwardRef(({className:n,...i},a)=>at.createElement(c6,{ref:a,iconNode:t,className:lR(`lucide-${s6(b_(r))}`,`lucide-${r}`,n),...i}));return e.displayName=b_(r),e};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h6=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],d6=u6("upload",h6);var f6={34:((r,t,e)=>{var n=e(4901);r.exports=function(i){return typeof i=="object"?i!==null:n(i)}}),81:((r,t,e)=>{var n=e(9565),i=e(9306),a=e(8551),l=e(6823),c=e(851),h=TypeError;r.exports=function(d,p){var m=arguments.length<2?c(d):p;if(i(m))return a(n(m,d));throw new h(l(d)+" is not iterable")}}),116:((r,t,e)=>{var n=e(6518),i=e(9565),a=e(2652),l=e(9306),c=e(8551),h=e(1767),d=e(9539),p=e(4549),m=p("find",TypeError);n({target:"Iterator",proto:!0,real:!0,forced:m},{find:function(E){c(this);try{l(E)}catch(S){d(this,"throw",S)}if(m)return i(m,this,E);var b=h(this),T=0;return a(b,function(S,C){if(E(S,T++))return C(S)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})}),283:((r,t,e)=>{var n=e(9504),i=e(9039),a=e(4901),l=e(9297),c=e(3724),h=e(350).CONFIGURABLE,d=e(3706),p=e(1181),m=p.enforce,v=p.get,E=String,b=Object.defineProperty,T=n("".slice),S=n("".replace),C=n([].join),D=c&&!i(function(){return b(function(){},"length",{value:8}).length!==8}),O=String(String).split("String"),F=r.exports=function(k,z,P){T(E(z),0,7)==="Symbol("&&(z="["+S(E(z),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),P&&P.getter&&(z="get "+z),P&&P.setter&&(z="set "+z),(!l(k,"name")||h&&k.name!==z)&&(c?b(k,"name",{value:z,configurable:!0}):k.name=z),D&&P&&l(P,"arity")&&k.length!==P.arity&&b(k,"length",{value:P.arity});try{P&&l(P,"constructor")&&P.constructor?c&&b(k,"prototype",{writable:!1}):k.prototype&&(k.prototype=void 0)}catch{}var N=m(k);return l(N,"source")||(N.source=C(O,typeof z=="string"?z:"")),k};Function.prototype.toString=F(function(){return a(this)&&v(this).source||d(this)},"toString")}),350:((r,t,e)=>{var n=e(3724),i=e(9297),a=Function.prototype,l=n&&Object.getOwnPropertyDescriptor,c=i(a,"name"),h=c&&(function(){}).name==="something",d=c&&(!n||n&&l(a,"name").configurable);r.exports={EXISTS:c,PROPER:h,CONFIGURABLE:d}}),397:((r,t,e)=>{var n=e(7751);r.exports=n("document","documentElement")}),421:(r=>{r.exports={}}),456:((r,t,e)=>{var n=e(6518),i=e(4576),a=e(9504),l=e(4154),c=e(5169),h=a(1.1.toString),d=i.Uint8Array,p=!d||!d.prototype.toHex||!(function(){try{var m=new d([255,255,255,255,255,255,255,255]);return m.toHex()==="ffffffffffffffff"}catch{return!1}})();d&&n({target:"Uint8Array",proto:!0,forced:p},{toHex:function(){l(this),c(this.buffer);for(var v="",E=0,b=this.length;E<b;E++){var T=h(this[E],16);v+=T.length===1?"0"+T:T}return v}})}),507:((r,t,e)=>{var n=e(9565);r.exports=function(i,a,l){for(var c=l?i:i.iterator,h=i.next,d,p;!(d=n(h,c)).done;)if(p=a(d.value),p!==void 0)return p}}),531:((r,t,e)=>{var n=e(6518),i=e(9565),a=e(9306),l=e(8551),c=e(1767),h=e(8646),d=e(9462),p=e(9539),m=e(6395),v=e(684),E=e(4549),b=!m&&!v("flatMap",function(){}),T=!m&&!b&&E("flatMap",TypeError),S=m||b||T,C=d(function(){for(var D=this.iterator,O=this.mapper,F,k;;){if(k=this.inner)try{if(F=l(i(k.next,k.iterator)),!F.done)return F.value;this.inner=null}catch(z){p(D,"throw",z)}if(F=l(i(this.next,D)),this.done=!!F.done)return;try{this.inner=h(O(F.value,this.counter++),!1)}catch(z){p(D,"throw",z)}}});n({target:"Iterator",proto:!0,real:!0,forced:S},{flatMap:function(O){l(this);try{a(O)}catch(F){p(this,"throw",F)}return T?i(T,this,O):new C(c(this),{mapper:O,inner:null})}})}),616:((r,t,e)=>{var n=e(9039);r.exports=!n(function(){var i=(function(){}).bind();return typeof i!="function"||i.hasOwnProperty("prototype")})}),655:((r,t,e)=>{var n=e(6955),i=String;r.exports=function(a){if(n(a)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return i(a)}}),679:((r,t,e)=>{var n=e(1625),i=TypeError;r.exports=function(a,l){if(n(l,a))return a;throw new i("Incorrect invocation")}}),684:(r=>{r.exports=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}}),741:(r=>{var t=Math.ceil,e=Math.floor;r.exports=Math.trunc||function(i){var a=+i;return(a>0?e:t)(a)}}),757:((r,t,e)=>{var n=e(7751),i=e(4901),a=e(1625),l=e(7040),c=Object;r.exports=l?function(h){return typeof h=="symbol"}:function(h){var d=n("Symbol");return i(d)&&a(d.prototype,c(h))}}),851:((r,t,e)=>{var n=e(6955),i=e(5966),a=e(4117),l=e(6269),c=e(8227),h=c("iterator");r.exports=function(d){if(!a(d))return i(d,h)||i(d,"@@iterator")||l[n(d)]}}),944:(r=>{var t=TypeError;r.exports=function(e){var n=e&&e.alphabet;if(n===void 0||n==="base64"||n==="base64url")return n||"base64";throw new t("Incorrect `alphabet` option")}}),1072:((r,t,e)=>{var n=e(1828),i=e(8727);r.exports=Object.keys||function(l){return n(l,i)}}),1103:(r=>{r.exports=function(t){try{return{error:!1,value:t()}}catch(e){return{error:!0,value:e}}}}),1108:((r,t,e)=>{var n=e(6955);r.exports=function(i){var a=n(i);return a==="BigInt64Array"||a==="BigUint64Array"}}),1148:((r,t,e)=>{var n=e(6518),i=e(9565),a=e(2652),l=e(9306),c=e(8551),h=e(1767),d=e(9539),p=e(4549),m=p("every",TypeError);n({target:"Iterator",proto:!0,real:!0,forced:m},{every:function(E){c(this);try{l(E)}catch(S){d(this,"throw",S)}if(m)return i(m,this,E);var b=h(this),T=0;return!a(b,function(S,C){if(!E(S,T++))return C()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}),1181:((r,t,e)=>{var n=e(8622),i=e(4576),a=e(34),l=e(6699),c=e(9297),h=e(7629),d=e(6119),p=e(421),m="Object already initialized",v=i.TypeError,E=i.WeakMap,b,T,S,C=function(k){return S(k)?T(k):b(k,{})},D=function(k){return function(z){var P;if(!a(z)||(P=T(z)).type!==k)throw new v("Incompatible receiver, "+k+" required");return P}};if(n||h.state){var O=h.state||(h.state=new E);O.get=O.get,O.has=O.has,O.set=O.set,b=function(k,z){if(O.has(k))throw new v(m);return z.facade=k,O.set(k,z),z},T=function(k){return O.get(k)||{}},S=function(k){return O.has(k)}}else{var F=d("state");p[F]=!0,b=function(k,z){if(c(k,F))throw new v(m);return z.facade=k,l(k,F,z),z},T=function(k){return c(k,F)?k[F]:{}},S=function(k){return c(k,F)}}r.exports={set:b,get:T,has:S,enforce:C,getterFor:D}}),1291:((r,t,e)=>{var n=e(741);r.exports=function(i){var a=+i;return a!==a||a===0?0:n(a)}}),1385:((r,t,e)=>{var n=e(9539);r.exports=function(i,a,l){for(var c=i.length-1;c>=0;c--)if(i[c]!==void 0)try{l=n(i[c].iterator,a,l)}catch(h){a="throw",l=h}if(a==="throw")throw l;return l}}),1548:((r,t,e)=>{var n=e(4576),i=e(9039),a=e(9519),l=e(4215),c=n.structuredClone;r.exports=!!c&&!i(function(){if(l==="DENO"&&a>92||l==="NODE"&&a>94||l==="BROWSER"&&a>97)return!1;var h=new ArrayBuffer(8),d=c(h,{transfer:[h]});return h.byteLength!==0||d.byteLength!==8})}),1549:((r,t,e)=>{e(6632)}),1625:((r,t,e)=>{var n=e(9504);r.exports=n({}.isPrototypeOf)}),1689:((r,t,e)=>{var n=e(6518),i=e(4576),a=e(8745),l=e(7680),c=e(6043),h=e(9306),d=e(1103),p=i.Promise,m=!1,v=!p||!p.try||d(function(){p.try(function(E){m=E===8},8)}).error||!m;n({target:"Promise",stat:!0,forced:v},{try:function(E){var b=arguments.length>1?l(arguments,1):[],T=c.f(this),S=d(function(){return a(h(E),void 0,b)});return(S.error?T.reject:T.resolve)(S.value),T.promise}})}),1698:((r,t,e)=>{var n=e(6518),i=e(4204),a=e(9835),l=e(4916),c=!l("union")||!a("union");n({target:"Set",proto:!0,real:!0,forced:c},{union:i})}),1701:((r,t,e)=>{var n=e(6518),i=e(9565),a=e(9306),l=e(8551),c=e(1767),h=e(9462),d=e(6319),p=e(9539),m=e(684),v=e(4549),E=e(6395),b=!E&&!m("map",function(){}),T=!E&&!b&&v("map",TypeError),S=E||b||T,C=h(function(){var D=this.iterator,O=l(i(this.next,D)),F=this.done=!!O.done;if(!F)return d(D,this.mapper,[O.value,this.counter++],!0)});n({target:"Iterator",proto:!0,real:!0,forced:S},{map:function(O){l(this);try{a(O)}catch(F){p(this,"throw",F)}return T?i(T,this,O):new C(c(this),{mapper:O})}})}),1767:(r=>{r.exports=function(t){return{iterator:t,next:t.next,done:!1}}}),1828:((r,t,e)=>{var n=e(9504),i=e(9297),a=e(5397),l=e(9617).indexOf,c=e(421),h=n([].push);r.exports=function(d,p){var m=a(d),v=0,E=[],b;for(b in m)!i(c,b)&&i(m,b)&&h(E,b);for(;p.length>v;)i(m,b=p[v++])&&(~l(E,b)||h(E,b));return E}}),2106:((r,t,e)=>{var n=e(283),i=e(4913);r.exports=function(a,l,c){return c.get&&n(c.get,l,{getter:!0}),c.set&&n(c.set,l,{setter:!0}),i.f(a,l,c)}}),2140:((r,t,e)=>{var n=e(8227),i=n("toStringTag"),a={};a[i]="z",r.exports=String(a)==="[object z]"}),2195:((r,t,e)=>{var n=e(9504),i=n({}.toString),a=n("".slice);r.exports=function(l){return a(i(l),8,-1)}}),2211:((r,t,e)=>{var n=e(9039);r.exports=!n(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype})}),2303:((r,t,e)=>{var n=e(4576),i=e(9504),a=n.Uint8Array,l=n.SyntaxError,c=n.parseInt,h=Math.min,d=/[^\da-f]/i,p=i(d.exec),m=i("".slice);r.exports=function(v,E){var b=v.length;if(b%2!==0)throw new l("String should be an even number of characters");for(var T=E?h(E.length,b/2):b/2,S=E||new a(T),C=0,D=0;D<T;){var O=m(v,C,C+=2);if(p(d,O))throw new l("String should only contain hex characters");S[D++]=c(O,16)}return{bytes:S,read:C}}}),2360:((r,t,e)=>{var n=e(8551),i=e(6801),a=e(8727),l=e(421),c=e(397),h=e(4055),d=e(6119),p=">",m="<",v="prototype",E="script",b=d("IE_PROTO"),T=function(){},S=function(k){return m+E+p+k+m+"/"+E+p},C=function(k){k.write(S("")),k.close();var z=k.parentWindow.Object;return k=null,z},D=function(){var k=h("iframe"),z="java"+E+":",P;return k.style.display="none",c.appendChild(k),k.src=String(z),P=k.contentWindow.document,P.open(),P.write(S("document.F=Object")),P.close(),P.F},O,F=function(){try{O=new ActiveXObject("htmlfile")}catch{}F=typeof document<"u"?document.domain&&O?C(O):D():C(O);for(var k=a.length;k--;)delete F[v][a[k]];return F()};l[b]=!0,r.exports=Object.create||function(z,P){var N;return z!==null?(T[v]=n(z),N=new T,T[v]=null,N[b]=z):N=F(),P===void 0?N:i.f(N,P)}}),2475:((r,t,e)=>{var n=e(6518),i=e(8527),a=e(4916),l=!a("isSupersetOf",function(c){return!c});n({target:"Set",proto:!0,real:!0,forced:l},{isSupersetOf:i})}),2489:((r,t,e)=>{var n=e(6518),i=e(9565),a=e(9306),l=e(8551),c=e(1767),h=e(9462),d=e(6319),p=e(6395),m=e(9539),v=e(684),E=e(4549),b=!p&&!v("filter",function(){}),T=!p&&!b&&E("filter",TypeError),S=p||b||T,C=h(function(){for(var D=this.iterator,O=this.predicate,F=this.next,k,z,P;;){if(k=l(i(F,D)),z=this.done=!!k.done,z)return;if(P=k.value,d(D,O,[P,this.counter++],!0))return P}});n({target:"Iterator",proto:!0,real:!0,forced:S},{filter:function(O){l(this);try{a(O)}catch(F){m(this,"throw",F)}return T?i(T,this,O):new C(c(this),{predicate:O})}})}),2529:(r=>{r.exports=function(t,e){return{value:t,done:e}}}),2603:((r,t,e)=>{var n=e(655);r.exports=function(i,a){return i===void 0?arguments.length<2?"":a:n(i)}}),2652:((r,t,e)=>{var n=e(6080),i=e(9565),a=e(8551),l=e(6823),c=e(4209),h=e(6198),d=e(1625),p=e(81),m=e(851),v=e(9539),E=TypeError,b=function(S,C){this.stopped=S,this.result=C},T=b.prototype;r.exports=function(S,C,D){var O=D&&D.that,F=!!(D&&D.AS_ENTRIES),k=!!(D&&D.IS_RECORD),z=!!(D&&D.IS_ITERATOR),P=!!(D&&D.INTERRUPTED),N=n(C,O),M,V,H,$,j,Tt,St,X=function(ht){return M&&v(M,"normal"),new b(!0,ht)},Z=function(ht){return F?(a(ht),P?N(ht[0],ht[1],X):N(ht[0],ht[1])):P?N(ht,X):N(ht)};if(k)M=S.iterator;else if(z)M=S;else{if(V=m(S),!V)throw new E(l(S)+" is not iterable");if(c(V)){for(H=0,$=h(S);$>H;H++)if(j=Z(S[H]),j&&d(T,j))return j;return new b(!1)}M=p(S,V)}for(Tt=k?S.next:M.next;!(St=i(Tt,M)).done;){try{j=Z(St.value)}catch(ht){v(M,"throw",ht)}if(typeof j=="object"&&j&&d(T,j))return j}return new b(!1)}}),2777:((r,t,e)=>{var n=e(9565),i=e(34),a=e(757),l=e(5966),c=e(4270),h=e(8227),d=TypeError,p=h("toPrimitive");r.exports=function(m,v){if(!i(m)||a(m))return m;var E=l(m,p),b;if(E){if(v===void 0&&(v="default"),b=n(E,m,v),!i(b)||a(b))return b;throw new d("Can't convert object to primitive value")}return v===void 0&&(v="number"),c(m,v)}}),2787:((r,t,e)=>{var n=e(9297),i=e(4901),a=e(8981),l=e(6119),c=e(2211),h=l("IE_PROTO"),d=Object,p=d.prototype;r.exports=c?d.getPrototypeOf:function(m){var v=a(m);if(n(v,h))return v[h];var E=v.constructor;return i(E)&&v instanceof E?E.prototype:v instanceof d?p:null}}),2796:((r,t,e)=>{var n=e(9039),i=e(4901),a=/#|\.prototype\./,l=function(m,v){var E=h[c(m)];return E===p?!0:E===d?!1:i(v)?n(v):!!v},c=l.normalize=function(m){return String(m).replace(a,".").toLowerCase()},h=l.data={},d=l.NATIVE="N",p=l.POLYFILL="P";r.exports=l}),2804:(r=>{var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=t+"+/",n=t+"-_",i=function(a){for(var l={},c=0;c<64;c++)l[a.charAt(c)]=c;return l};r.exports={i2c:e,c2i:i(e),i2cUrl:n,c2iUrl:i(n)}}),2812:(r=>{var t=TypeError;r.exports=function(e,n){if(e<n)throw new t("Not enough arguments");return e}}),2839:((r,t,e)=>{var n=e(4576),i=n.navigator,a=i&&i.userAgent;r.exports=a?String(a):""}),2967:((r,t,e)=>{var n=e(6706),i=e(34),a=e(7750),l=e(3506);r.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var c=!1,h={},d;try{d=n(Object.prototype,"__proto__","set"),d(h,[]),c=h instanceof Array}catch{}return function(m,v){return a(m),l(v),i(m)&&(c?d(m,v):m.__proto__=v),m}})():void 0)}),3068:((r,t,e)=>{var n=e(6518),i=e(9504),a=e(2652),l=RangeError,c=TypeError,h=1/0,d=NaN,p=Math.abs,m=Math.pow,v=i([].push),E=m(2,1023),b=m(2,53)-1,T=Number.MAX_VALUE,S=m(2,971),C={},D={},O={},F={},k={},z=function(P,N){var M=P+N,V=N-(M-P);return{hi:M,lo:V}};n({target:"Math",stat:!0},{sumPrecise:function(N){var M=[],V=0,H=F;switch(a(N,function(ut){if(++V>=b)throw new l("Maximum allowed index exceeded");if(typeof ut!="number")throw new c("Value is not a number");H!==C&&(ut!==ut?H=C:ut===h?H=H===D?C:O:ut===-h?H=H===O?C:D:(ut!==0||1/ut===h)&&(H===F||H===k)&&(H=k,v(M,ut)))}),H){case C:return d;case D:return-h;case O:return h;case F:return-0}for(var $=[],j=0,Tt,St,X,Z,ht,Rt,W=0;W<M.length;W++){Tt=M[W];for(var lt=0,q=0;q<$.length;q++){if(St=$[q],p(Tt)<p(St)&&(Rt=Tt,Tt=St,St=Rt),X=z(Tt,St),Z=X.hi,ht=X.lo,p(Z)===h){var it=Z===h?1:-1;j+=it,Tt=Tt-it*E-it*E,p(Tt)<p(St)&&(Rt=Tt,Tt=St,St=Rt),X=z(Tt,St),Z=X.hi,ht=X.lo}ht!==0&&($[lt++]=ht),Tt=Z}$.length=lt,Tt!==0&&v($,Tt)}var yt=$.length-1;if(Z=0,ht=0,j!==0){var _t=yt>=0?$[yt]:0;if(yt--,p(j)>1||j>0&&_t>0||j<0&&_t<0)return j>0?h:-h;if(X=z(j*E,_t/2),Z=X.hi,ht=X.lo,ht*=2,p(2*Z)===h)return Z>0?Z===E&&ht===-(S/2)&&yt>=0&&$[yt]<0?T:h:Z===-E&&ht===S/2&&yt>=0&&$[yt]>0?-T:-h;ht!==0&&($[++yt]=ht,ht=0),Z*=2}for(;yt>=0&&(X=z(Z,$[yt--]),Z=X.hi,ht=X.lo,ht===0););return yt>=0&&(ht<0&&$[yt]<0||ht>0&&$[yt]>0)&&(St=ht*2,Tt=Z+St,St===Tt-Z&&(Z=Tt)),Z}})}),3167:((r,t,e)=>{var n=e(4901),i=e(34),a=e(2967);r.exports=function(l,c,h){var d,p;return a&&n(d=c.constructor)&&d!==h&&i(p=d.prototype)&&p!==h.prototype&&a(l,p),l}}),3238:((r,t,e)=>{var n=e(4576),i=e(7811),a=e(7394),l=n.DataView;r.exports=function(c){if(!i||a(c)!==0)return!1;try{return new l(c),!1}catch{return!0}}}),3392:((r,t,e)=>{var n=e(9504),i=0,a=Math.random(),l=n(1.1.toString);r.exports=function(c){return"Symbol("+(c===void 0?"":c)+")_"+l(++i+a,36)}}),3440:((r,t,e)=>{var n=e(7080),i=e(4402),a=e(9286),l=e(5170),c=e(3789),h=e(8469),d=e(507),p=i.has,m=i.remove;r.exports=function(E){var b=n(this),T=c(E),S=a(b);return l(b)<=T.size?h(b,function(C){T.includes(C)&&m(S,C)}):d(T.getIterator(),function(C){p(S,C)&&m(S,C)}),S}}),3463:(r=>{var t=TypeError;r.exports=function(e){if(typeof e=="string")return e;throw new t("Argument is not a string")}}),3506:((r,t,e)=>{var n=e(3925),i=String,a=TypeError;r.exports=function(l){if(n(l))return l;throw new a("Can't set "+i(l)+" as a prototype")}}),3579:((r,t,e)=>{var n=e(6518),i=e(9565),a=e(2652),l=e(9306),c=e(8551),h=e(1767),d=e(9539),p=e(4549),m=p("some",TypeError);n({target:"Iterator",proto:!0,real:!0,forced:m},{some:function(E){c(this);try{l(E)}catch(S){d(this,"throw",S)}if(m)return i(m,this,E);var b=h(this),T=0;return a(b,function(S,C){if(E(S,T++))return C()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}),3650:((r,t,e)=>{var n=e(7080),i=e(4402),a=e(9286),l=e(3789),c=e(507),h=i.add,d=i.has,p=i.remove;r.exports=function(v){var E=n(this),b=l(v).getIterator(),T=a(E);return c(b,function(S){d(E,S)?p(T,S):h(T,S)}),T}}),3706:((r,t,e)=>{var n=e(9504),i=e(4901),a=e(7629),l=n(Function.toString);i(a.inspectSource)||(a.inspectSource=function(c){return l(c)}),r.exports=a.inspectSource}),3717:((r,t)=>{t.f=Object.getOwnPropertySymbols}),3724:((r,t,e)=>{var n=e(9039);r.exports=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})}),3789:((r,t,e)=>{var n=e(9306),i=e(8551),a=e(9565),l=e(1291),c=e(1767),h="Invalid size",d=RangeError,p=TypeError,m=Math.max,v=function(E,b){this.set=E,this.size=m(b,0),this.has=n(E.has),this.keys=n(E.keys)};v.prototype={getIterator:function(){return c(i(a(this.keys,this.set)))},includes:function(E){return a(this.has,this.set,E)}},r.exports=function(E){i(E);var b=+E.size;if(b!==b)throw new p(h);var T=l(b);if(T<0)throw new d(h);return new v(E,T)}}),3838:((r,t,e)=>{var n=e(7080),i=e(5170),a=e(8469),l=e(3789);r.exports=function(h){var d=n(this),p=l(h);return i(d)>p.size?!1:a(d,function(m){if(!p.includes(m))return!1},!0)!==!1}}),3853:((r,t,e)=>{var n=e(6518),i=e(4449),a=e(4916),l=!a("isDisjointFrom",function(c){return!c});n({target:"Set",proto:!0,real:!0,forced:l},{isDisjointFrom:i})}),3925:((r,t,e)=>{var n=e(34);r.exports=function(i){return n(i)||i===null}}),3972:((r,t,e)=>{var n=e(34),i=String,a=TypeError;r.exports=function(l){if(l===void 0||n(l))return l;throw new a(i(l)+" is not an object or undefined")}}),4055:((r,t,e)=>{var n=e(4576),i=e(34),a=n.document,l=i(a)&&i(a.createElement);r.exports=function(c){return l?a.createElement(c):{}}}),4114:((r,t,e)=>{var n=e(6518),i=e(8981),a=e(6198),l=e(4527),c=e(6837),h=e(9039),d=h(function(){return[].push.call({length:4294967296},1)!==4294967297}),p=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(v){return v instanceof TypeError}},m=d||!p();n({target:"Array",proto:!0,arity:1,forced:m},{push:function(E){var b=i(this),T=a(b),S=arguments.length;c(T+S);for(var C=0;C<S;C++)b[T]=arguments[C],T++;return l(b,T),T}})}),4117:(r=>{r.exports=function(t){return t==null}}),4149:(r=>{var t=RangeError;r.exports=function(e){if(e===e)return e;throw new t("NaN is not allowed")}}),4154:((r,t,e)=>{var n=e(6955),i=TypeError;r.exports=function(a){if(n(a)==="Uint8Array")return a;throw new i("Argument is not an Uint8Array")}}),4204:((r,t,e)=>{var n=e(7080),i=e(4402).add,a=e(9286),l=e(3789),c=e(507);r.exports=function(d){var p=n(this),m=l(d).getIterator(),v=a(p);return c(m,function(E){i(v,E)}),v}}),4209:((r,t,e)=>{var n=e(8227),i=e(6269),a=n("iterator"),l=Array.prototype;r.exports=function(c){return c!==void 0&&(i.Array===c||l[a]===c)}}),4215:((r,t,e)=>{var n=e(4576),i=e(2839),a=e(2195),l=function(c){return i.slice(0,c.length)===c};r.exports=(function(){return l("Bun/")?"BUN":l("Cloudflare-Workers")?"CLOUDFLARE":l("Deno/")?"DENO":l("Node.js/")?"NODE":n.Bun&&typeof Bun.version=="string"?"BUN":n.Deno&&typeof Deno.version=="object"?"DENO":a(n.process)==="process"?"NODE":n.window&&n.document?"BROWSER":"REST"})()}),4226:((r,t,e)=>{var n=e(6518),i=e(4576),a=e(3463),l=e(4154),c=e(5169),h=e(2303);i.Uint8Array&&n({target:"Uint8Array",proto:!0},{setFromHex:function(p){l(this),a(p),c(this.buffer);var m=h(p,this).read;return{read:m,written:m/2}}})}),4235:((r,t,e)=>{e(3068)}),4270:((r,t,e)=>{var n=e(9565),i=e(4901),a=e(34),l=TypeError;r.exports=function(c,h){var d,p;if(h==="string"&&i(d=c.toString)&&!a(p=n(d,c))||i(d=c.valueOf)&&!a(p=n(d,c))||h!=="string"&&i(d=c.toString)&&!a(p=n(d,c)))return p;throw new l("Can't convert object to primitive value")}}),4376:((r,t,e)=>{var n=e(2195);r.exports=Array.isArray||function(a){return n(a)==="Array"}}),4402:((r,t,e)=>{var n=e(9504),i=Set.prototype;r.exports={Set,add:n(i.add),has:n(i.has),remove:n(i.delete),proto:i}}),4449:((r,t,e)=>{var n=e(7080),i=e(4402).has,a=e(5170),l=e(3789),c=e(8469),h=e(507),d=e(9539);r.exports=function(m){var v=n(this),E=l(m);if(a(v)<=E.size)return c(v,function(T){if(E.includes(T))return!1},!0)!==!1;var b=E.getIterator();return h(b,function(T){if(i(v,T))return d(b,"normal",!1)})!==!1}}),4483:((r,t,e)=>{var n=e(4576),i=e(9429),a=e(1548),l=n.structuredClone,c=n.ArrayBuffer,h=n.MessageChannel,d=!1,p,m,v,E;if(a)d=function(b){l(b,{transfer:[b]})};else if(c)try{h||(p=i("worker_threads"),p&&(h=p.MessageChannel)),h&&(m=new h,v=new c(2),E=function(b){m.port1.postMessage(null,[b])},v.byteLength===2&&(E(v),v.byteLength===0&&(d=E)))}catch{}r.exports=d}),4495:((r,t,e)=>{var n=e(9519),i=e(9039),a=e(4576),l=a.String;r.exports=!!Object.getOwnPropertySymbols&&!i(function(){var c=Symbol("symbol detection");return!l(c)||!(Object(c)instanceof Symbol)||!Symbol.sham&&n&&n<41})}),4527:((r,t,e)=>{var n=e(3724),i=e(4376),a=TypeError,l=Object.getOwnPropertyDescriptor,c=n&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(h){return h instanceof TypeError}})();r.exports=c?function(h,d){if(i(h)&&!l(h,"length").writable)throw new a("Cannot set read only .length");return h.length=d}:function(h,d){return h.length=d}}),4549:((r,t,e)=>{var n=e(4576);r.exports=function(i,a){var l=n.Iterator,c=l&&l.prototype,h=c&&c[i],d=!1;if(h)try{h.call({next:function(){return{done:!0}},return:function(){d=!0}},-1)}catch(p){p instanceof a||(d=!1)}if(!d)return h}}),4576:(function(r){var t=function(e){return e&&e.Math===Math&&e};r.exports=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof global=="object"&&global)||t(typeof this=="object"&&this)||(function(){return this})()||Function("return this")()}),4603:((r,t,e)=>{var n=e(6840),i=e(9504),a=e(655),l=e(2812),c=URLSearchParams,h=c.prototype,d=i(h.append),p=i(h.delete),m=i(h.forEach),v=i([].push),E=new c("a=1&a=2&b=3");E.delete("a",1),E.delete("b",void 0),E+""!="a=2"&&n(h,"delete",function(b){var T=arguments.length,S=T<2?void 0:arguments[1];if(T&&S===void 0)return p(this,b);var C=[];m(this,function(M,V){v(C,{key:V,value:M})}),l(T,1);for(var D=a(b),O=a(S),F=0,k=0,z=!1,P=C.length,N;F<P;)N=C[F++],z||N.key===D?(z=!0,p(this,N.key)):k++;for(;k<P;)N=C[k++],N.key===D&&N.value===O||d(this,N.key,N.value)},{enumerable:!0,unsafe:!0})}),4628:((r,t,e)=>{var n=e(6518),i=e(6043);n({target:"Promise",stat:!0},{withResolvers:function(){var l=i.f(this);return{promise:l.promise,resolve:l.resolve,reject:l.reject}}})}),4644:((r,t,e)=>{var n=e(7811),i=e(3724),a=e(4576),l=e(4901),c=e(34),h=e(9297),d=e(6955),p=e(6823),m=e(6699),v=e(6840),E=e(2106),b=e(1625),T=e(2787),S=e(2967),C=e(8227),D=e(3392),O=e(1181),F=O.enforce,k=O.get,z=a.Int8Array,P=z&&z.prototype,N=a.Uint8ClampedArray,M=N&&N.prototype,V=z&&T(z),H=P&&T(P),$=Object.prototype,j=a.TypeError,Tt=C("toStringTag"),St=D("TYPED_ARRAY_TAG"),X="TypedArrayConstructor",Z=n&&!!S&&d(a.opera)!=="Opera",ht=!1,Rt,W,lt,q={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},it={BigInt64Array:8,BigUint64Array:8},yt=function(qt){if(!c(qt))return!1;var Xt=d(qt);return Xt==="DataView"||h(q,Xt)||h(it,Xt)},_t=function(It){var qt=T(It);if(c(qt)){var Xt=k(qt);return Xt&&h(Xt,X)?Xt[X]:_t(qt)}},ut=function(It){if(!c(It))return!1;var qt=d(It);return h(q,qt)||h(it,qt)},ft=function(It){if(ut(It))return It;throw new j("Target is not a typed array")},pt=function(It){if(l(It)&&(!S||b(V,It)))return It;throw new j(p(It)+" is not a typed array constructor")},Ct=function(It,qt,Xt,ne){if(i){if(Xt)for(var Te in q){var me=a[Te];if(me&&h(me.prototype,It))try{delete me.prototype[It]}catch{try{me.prototype[It]=qt}catch{}}}(!H[It]||Xt)&&v(H,It,Xt?qt:Z&&P[It]||qt,ne)}},Vt=function(It,qt,Xt){var ne,Te;if(i){if(S){if(Xt){for(ne in q)if(Te=a[ne],Te&&h(Te,It))try{delete Te[It]}catch{}}if(!V[It]||Xt)try{return v(V,It,Xt?qt:Z&&V[It]||qt)}catch{}else return}for(ne in q)Te=a[ne],Te&&(!Te[It]||Xt)&&v(Te,It,qt)}};for(Rt in q)W=a[Rt],lt=W&&W.prototype,lt?F(lt)[X]=W:Z=!1;for(Rt in it)W=a[Rt],lt=W&&W.prototype,lt&&(F(lt)[X]=W);if((!Z||!l(V)||V===Function.prototype)&&(V=function(){throw new j("Incorrect invocation")},Z))for(Rt in q)a[Rt]&&S(a[Rt],V);if((!Z||!H||H===$)&&(H=V.prototype,Z))for(Rt in q)a[Rt]&&S(a[Rt].prototype,H);if(Z&&T(M)!==H&&S(M,H),i&&!h(H,Tt)){ht=!0,E(H,Tt,{configurable:!0,get:function(){return c(this)?this[St]:void 0}});for(Rt in q)a[Rt]&&m(a[Rt],St,Rt)}r.exports={NATIVE_ARRAY_BUFFER_VIEWS:Z,TYPED_ARRAY_TAG:ht&&St,aTypedArray:ft,aTypedArrayConstructor:pt,exportTypedArrayMethod:Ct,exportTypedArrayStaticMethod:Vt,getTypedArrayConstructor:_t,isView:yt,isTypedArray:ut,TypedArray:V,TypedArrayPrototype:H}}),4659:((r,t,e)=>{var n=e(3724),i=e(4913),a=e(6980);r.exports=function(l,c,h){n?i.f(l,c,a(0,h)):l[c]=h}}),4901:(r=>{var t=typeof document=="object"&&document.all;r.exports=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"}}),4913:((r,t,e)=>{var n=e(3724),i=e(5917),a=e(8686),l=e(8551),c=e(6969),h=TypeError,d=Object.defineProperty,p=Object.getOwnPropertyDescriptor,m="enumerable",v="configurable",E="writable";t.f=n?a?function(T,S,C){if(l(T),S=c(S),l(C),typeof T=="function"&&S==="prototype"&&"value"in C&&E in C&&!C[E]){var D=p(T,S);D&&D[E]&&(T[S]=C.value,C={configurable:v in C?C[v]:D[v],enumerable:m in C?C[m]:D[m],writable:!1})}return d(T,S,C)}:d:function(T,S,C){if(l(T),S=c(S),l(C),i)try{return d(T,S,C)}catch{}if("get"in C||"set"in C)throw new h("Accessors not supported");return"value"in C&&(T[S]=C.value),T}}),4916:((r,t,e)=>{var n=e(7751),i=function(l){return{size:l,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},a=function(l){return{size:l,has:function(){return!0},keys:function(){throw new Error("e")}}};r.exports=function(l,c){var h=n("Set");try{new h()[l](i(0));try{return new h()[l](i(-1)),!1}catch{if(!c)return!0;try{return new h()[l](a(-1/0)),!1}catch{var d=new h;return d.add(1),d.add(2),c(d[l](a(1/0)))}}}catch{return!1}}}),4972:((r,t,e)=>{var n=e(6518),i=e(9565),a=e(8551),l=e(1767),c=e(4149),h=e(9590),d=e(9462),p=e(9539),m=e(4549),v=e(6395),E=!v&&m("take",RangeError),b=d(function(){var T=this.iterator;if(!this.remaining--)return this.done=!0,p(T,"normal",void 0);var S=a(i(this.next,T)),C=this.done=!!S.done;if(!C)return S.value});n({target:"Iterator",proto:!0,real:!0,forced:v||E},{take:function(S){a(this);var C;try{C=h(c(+S))}catch(D){p(this,"throw",D)}return E?i(E,this,C):new b(l(this),{remaining:C})}})}),4979:((r,t,e)=>{var n=e(6518),i=e(4576),a=e(7751),l=e(6980),c=e(4913).f,h=e(9297),d=e(679),p=e(3167),m=e(2603),v=e(5002),E=e(8574),b=e(3724),T=e(6395),S="DOMException",C=a("Error"),D=a(S),O=function(){d(this,F);var X=arguments.length,Z=m(X<1?void 0:arguments[0]),ht=m(X<2?void 0:arguments[1],"Error"),Rt=new D(Z,ht),W=new C(Z);return W.name=S,c(Rt,"stack",l(1,E(W.stack,1))),p(Rt,this,O),Rt},F=O.prototype=D.prototype,k="stack"in new C(S),z="stack"in new D(1,2),P=D&&b&&Object.getOwnPropertyDescriptor(i,S),N=!!P&&!(P.writable&&P.configurable),M=k&&!N&&!z;n({global:!0,constructor:!0,forced:T||M},{DOMException:M?O:D});var V=a(S),H=V.prototype;if(H.constructor!==V){T||c(H,"constructor",l(1,V));for(var $ in v)if(h(v,$)){var j=v[$],Tt=j.s;h(V,Tt)||c(V,Tt,l(6,j.c))}}}),5002:(r=>{r.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}}),5024:((r,t,e)=>{var n=e(6518),i=e(3650),a=e(9835),l=e(4916),c=!l("symmetricDifference")||!a("symmetricDifference");n({target:"Set",proto:!0,real:!0,forced:c},{symmetricDifference:i})}),5031:((r,t,e)=>{var n=e(7751),i=e(9504),a=e(8480),l=e(3717),c=e(8551),h=i([].concat);r.exports=n("Reflect","ownKeys")||function(p){var m=a.f(c(p)),v=l.f;return v?h(m,v(p)):m}}),5169:((r,t,e)=>{var n=e(3238),i=TypeError;r.exports=function(a){if(n(a))throw new i("ArrayBuffer is detached");return a}}),5170:((r,t,e)=>{var n=e(6706),i=e(4402);r.exports=n(i.proto,"size","get")||function(a){return a.size}}),5213:((r,t,e)=>{var n=e(6518),i=e(4576),a=e(5370),l=e(9143),c=i.Uint8Array,h=!c||!c.fromBase64||!(function(){try{c.fromBase64("a");return}catch{}try{c.fromBase64("",null)}catch{return!0}})();c&&n({target:"Uint8Array",stat:!0,forced:h},{fromBase64:function(p){var m=l(p,arguments.length>1?arguments[1]:void 0,null,9007199254740991);return a(c,m.bytes)}})}),5370:((r,t,e)=>{var n=e(6198);r.exports=function(i,a,l){for(var c=0,h=arguments.length>2?l:n(a),d=new i(h);h>c;)d[c]=a[c++];return d}}),5397:((r,t,e)=>{var n=e(7055),i=e(7750);r.exports=function(a){return n(i(a))}}),5610:((r,t,e)=>{var n=e(1291),i=Math.max,a=Math.min;r.exports=function(l,c){var h=n(l);return h<0?i(h+c,0):a(h,c)}}),5623:((r,t,e)=>{e(456)}),5636:((r,t,e)=>{var n=e(4576),i=e(9504),a=e(6706),l=e(7696),c=e(5169),h=e(7394),d=e(4483),p=e(1548),m=n.structuredClone,v=n.ArrayBuffer,E=n.DataView,b=Math.min,T=v.prototype,S=E.prototype,C=i(T.slice),D=a(T,"resizable","get"),O=a(T,"maxByteLength","get"),F=i(S.getInt8),k=i(S.setInt8);r.exports=(p||d)&&function(z,P,N){var M=h(z),V=P===void 0?M:l(P),H=!D||!D(z),$;if(c(z),p&&(z=m(z,{transfer:[z]}),M===V&&(N||H)))return z;if(M>=V&&(!N||H))$=C(z,0,V);else{var j=N&&!H&&O?{maxByteLength:O(z)}:void 0;$=new v(V,j);for(var Tt=new E(z),St=new E($),X=b(V,M),Z=0;Z<X;Z++)k(St,Z,F(Tt,Z))}return p||d(z),$}}),5745:((r,t,e)=>{var n=e(7629);r.exports=function(i,a){return n[i]||(n[i]=a||{})}}),5781:((r,t,e)=>{var n=e(6518),i=e(7751),a=e(2812),l=e(655),c=e(7416),h=i("URL");n({target:"URL",stat:!0,forced:!c},{parse:function(p){var m=a(arguments.length,1),v=l(p),E=m<2||arguments[1]===void 0?void 0:l(arguments[1]);try{return new h(v,E)}catch{return null}}})}),5854:((r,t,e)=>{var n=e(2777),i=TypeError;r.exports=function(a){var l=n(a,"number");if(typeof l=="number")throw new i("Can't convert number to bigint");return BigInt(l)}}),5876:((r,t,e)=>{var n=e(6518),i=e(3838),a=e(4916),l=!a("isSubsetOf",function(c){return c});n({target:"Set",proto:!0,real:!0,forced:l},{isSubsetOf:i})}),5917:((r,t,e)=>{var n=e(3724),i=e(9039),a=e(4055);r.exports=!n&&!i(function(){return Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a!==7})}),5966:((r,t,e)=>{var n=e(9306),i=e(4117);r.exports=function(a,l){var c=a[l];return i(c)?void 0:n(c)}}),6043:((r,t,e)=>{var n=e(9306),i=TypeError,a=function(l){var c,h;this.promise=new l(function(d,p){if(c!==void 0||h!==void 0)throw new i("Bad Promise constructor");c=d,h=p}),this.resolve=n(c),this.reject=n(h)};r.exports.f=function(l){return new a(l)}}),6080:((r,t,e)=>{var n=e(7476),i=e(9306),a=e(616),l=n(n.bind);r.exports=function(c,h){return i(c),h===void 0?c:a?l(c,h):function(){return c.apply(h,arguments)}}}),6119:((r,t,e)=>{var n=e(5745),i=e(3392),a=n("keys");r.exports=function(l){return a[l]||(a[l]=i(l))}}),6193:((r,t,e)=>{var n=e(4215);r.exports=n==="NODE"}),6198:((r,t,e)=>{var n=e(8014);r.exports=function(i){return n(i.length)}}),6269:(r=>{r.exports={}}),6279:((r,t,e)=>{var n=e(6840);r.exports=function(i,a,l){for(var c in a)n(i,c,a[c],l);return i}}),6319:((r,t,e)=>{var n=e(8551),i=e(9539);r.exports=function(a,l,c,h){try{return h?l(n(c)[0],c[1]):l(c)}catch(d){i(a,"throw",d)}}}),6395:(r=>{r.exports=!1}),6518:((r,t,e)=>{var n=e(4576),i=e(7347).f,a=e(6699),l=e(6840),c=e(9433),h=e(7740),d=e(2796);r.exports=function(p,m){var v=p.target,E=p.global,b=p.stat,T,S,C,D,O,F;if(E?S=n:b?S=n[v]||c(v,{}):S=n[v]&&n[v].prototype,S)for(C in m){if(O=m[C],p.dontCallGetSet?(F=i(S,C),D=F&&F.value):D=S[C],T=d(E?C:v+(b?".":"#")+C,p.forced),!T&&D!==void 0){if(typeof O==typeof D)continue;h(O,D)}(p.sham||D&&D.sham)&&a(O,"sham",!0),l(S,C,O,p)}}}),6573:((r,t,e)=>{var n=e(3724),i=e(2106),a=e(3238),l=ArrayBuffer.prototype;n&&!("detached"in l)&&i(l,"detached",{configurable:!0,get:function(){return a(this)}})}),6632:((r,t,e)=>{var n=e(6518),i=e(4576),a=e(9143),l=e(4154),c=i.Uint8Array,h=!c||!c.prototype.setFromBase64||!(function(){var d=new c([255,255,255,255,255]);try{d.setFromBase64("",null);return}catch{}try{d.setFromBase64("a");return}catch{}try{d.setFromBase64("MjYyZg===")}catch{return d[0]===50&&d[1]===54&&d[2]===50&&d[3]===255&&d[4]===255}})();c&&n({target:"Uint8Array",proto:!0,forced:h},{setFromBase64:function(p){l(this);var m=a(p,arguments.length>1?arguments[1]:void 0,this,this.length);return{read:m.read,written:m.written}}})}),6699:((r,t,e)=>{var n=e(3724),i=e(4913),a=e(6980);r.exports=n?function(l,c,h){return i.f(l,c,a(1,h))}:function(l,c,h){return l[c]=h,l}}),6706:((r,t,e)=>{var n=e(9504),i=e(9306);r.exports=function(a,l,c){try{return n(i(Object.getOwnPropertyDescriptor(a,l)[c]))}catch{}}}),6801:((r,t,e)=>{var n=e(3724),i=e(8686),a=e(4913),l=e(8551),c=e(5397),h=e(1072);t.f=n&&!i?Object.defineProperties:function(p,m){l(p);for(var v=c(m),E=h(m),b=E.length,T=0,S;b>T;)a.f(p,S=E[T++],v[S]);return p}}),6823:(r=>{var t=String;r.exports=function(e){try{return t(e)}catch{return"Object"}}}),6837:(r=>{var t=TypeError,e=9007199254740991;r.exports=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n}}),6840:((r,t,e)=>{var n=e(4901),i=e(4913),a=e(283),l=e(9433);r.exports=function(c,h,d,p){p||(p={});var m=p.enumerable,v=p.name!==void 0?p.name:h;if(n(d)&&a(d,v,p),p.global)m?c[h]=d:l(h,d);else{try{p.unsafe?c[h]&&(m=!0):delete c[h]}catch{}m?c[h]=d:i.f(c,h,{value:d,enumerable:!1,configurable:!p.nonConfigurable,writable:!p.nonWritable})}return c}}),6955:((r,t,e)=>{var n=e(2140),i=e(4901),a=e(2195),l=e(8227),c=l("toStringTag"),h=Object,d=a((function(){return arguments})())==="Arguments",p=function(m,v){try{return m[v]}catch{}};r.exports=n?a:function(m){var v,E,b;return m===void 0?"Undefined":m===null?"Null":typeof(E=p(v=h(m),c))=="string"?E:d?a(v):(b=a(v))==="Object"&&i(v.callee)?"Arguments":b}}),6969:((r,t,e)=>{var n=e(2777),i=e(757);r.exports=function(a){var l=n(a,"string");return i(l)?l:l+""}}),6980:(r=>{r.exports=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}}),7040:((r,t,e)=>{var n=e(4495);r.exports=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}),7055:((r,t,e)=>{var n=e(9504),i=e(9039),a=e(2195),l=Object,c=n("".split);r.exports=i(function(){return!l("z").propertyIsEnumerable(0)})?function(h){return a(h)==="String"?c(h,""):l(h)}:l}),7080:((r,t,e)=>{var n=e(4402).has;r.exports=function(i){return n(i),i}}),7347:((r,t,e)=>{var n=e(3724),i=e(9565),a=e(8773),l=e(6980),c=e(5397),h=e(6969),d=e(9297),p=e(5917),m=Object.getOwnPropertyDescriptor;t.f=n?m:function(E,b){if(E=c(E),b=h(b),p)try{return m(E,b)}catch{}if(d(E,b))return l(!i(a.f,E,b),E[b])}}),7394:((r,t,e)=>{var n=e(4576),i=e(6706),a=e(2195),l=n.ArrayBuffer,c=n.TypeError;r.exports=l&&i(l.prototype,"byteLength","get")||function(h){if(a(h)!=="ArrayBuffer")throw new c("ArrayBuffer expected");return h.byteLength}}),7416:((r,t,e)=>{var n=e(9039),i=e(8227),a=e(3724),l=e(6395),c=i("iterator");r.exports=!n(function(){var h=new URL("b?a=1&b=2&c=3","https://a"),d=h.searchParams,p=new URLSearchParams("a=1&a=2&b=3"),m="";return h.pathname="c%20d",d.forEach(function(v,E){d.delete("b"),m+=E+v}),p.delete("a",2),p.delete("b",void 0),l&&(!h.toJSON||!p.has("a",1)||p.has("a",2)||!p.has("a",void 0)||p.has("b"))||!d.size&&(l||!a)||!d.sort||h.href!=="https://a/c%20d?a=1&c=3"||d.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!d[c]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://").host!=="xn--e1aybc"||new URL("https://a#").hash!=="#%D0%B1"||m!=="a1c3"||new URL("https://x",void 0).host!=="x"})}),7476:((r,t,e)=>{var n=e(2195),i=e(9504);r.exports=function(a){if(n(a)==="Function")return i(a)}}),7566:((r,t,e)=>{var n=e(6840),i=e(9504),a=e(655),l=e(2812),c=URLSearchParams,h=c.prototype,d=i(h.getAll),p=i(h.has),m=new c("a=1");(m.has("a",2)||!m.has("a",void 0))&&n(h,"has",function(E){var b=arguments.length,T=b<2?void 0:arguments[1];if(b&&T===void 0)return p(this,E);var S=d(this,E);l(b,1);for(var C=a(T),D=0;D<S.length;)if(S[D++]===C)return!0;return!1},{enumerable:!0,unsafe:!0})}),7588:((r,t,e)=>{var n=e(6518),i=e(9565),a=e(2652),l=e(9306),c=e(8551),h=e(1767),d=e(9539),p=e(4549),m=p("forEach",TypeError);n({target:"Iterator",proto:!0,real:!0,forced:m},{forEach:function(E){c(this);try{l(E)}catch(S){d(this,"throw",S)}if(m)return i(m,this,E);var b=h(this),T=0;a(b,function(S){E(S,T++)},{IS_RECORD:!0})}})}),7629:((r,t,e)=>{var n=e(6395),i=e(4576),a=e(9433),l="__core-js_shared__",c=r.exports=i[l]||a(l,{});(c.versions||(c.versions=[])).push({version:"3.45.0",mode:n?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.45.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),7642:((r,t,e)=>{var n=e(6518),i=e(3440),a=e(9039),l=e(4916),c=!l("difference",function(d){return d.size===0}),h=c||a(function(){var d={size:1,has:function(){return!0},keys:function(){var m=0;return{next:function(){var v=m++>1;return p.has(1)&&p.clear(),{done:v,value:2}}}}},p=new Set([1,2,3,4]);return p.difference(d).size!==3});n({target:"Set",proto:!0,real:!0,forced:h},{difference:i})}),7657:((r,t,e)=>{var n=e(9039),i=e(4901),a=e(34),l=e(2360),c=e(2787),h=e(6840),d=e(8227),p=e(6395),m=d("iterator"),v=!1,E,b,T;[].keys&&(T=[].keys(),"next"in T?(b=c(c(T)),b!==Object.prototype&&(E=b)):v=!0);var S=!a(E)||n(function(){var C={};return E[m].call(C)!==C});S?E={}:p&&(E=l(E)),i(E[m])||h(E,m,function(){return this}),r.exports={IteratorPrototype:E,BUGGY_SAFARI_ITERATORS:v}}),7680:((r,t,e)=>{var n=e(9504);r.exports=n([].slice)}),7696:((r,t,e)=>{var n=e(1291),i=e(8014),a=RangeError;r.exports=function(l){if(l===void 0)return 0;var c=n(l),h=i(c);if(c!==h)throw new a("Wrong length or index");return h}}),7740:((r,t,e)=>{var n=e(9297),i=e(5031),a=e(7347),l=e(4913);r.exports=function(c,h,d){for(var p=i(h),m=l.f,v=a.f,E=0;E<p.length;E++){var b=p[E];!n(c,b)&&!(d&&n(d,b))&&m(c,b,v(h,b))}}}),7750:((r,t,e)=>{var n=e(4117),i=TypeError;r.exports=function(a){if(n(a))throw new i("Can't call method on "+a);return a}}),7751:((r,t,e)=>{var n=e(4576),i=e(4901),a=function(l){return i(l)?l:void 0};r.exports=function(l,c){return arguments.length<2?a(n[l]):n[l]&&n[l][c]}}),7811:(r=>{r.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"}),7936:((r,t,e)=>{var n=e(6518),i=e(5636);i&&n({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return i(this,arguments.length?arguments[0]:void 0,!1)}})}),8004:((r,t,e)=>{var n=e(6518),i=e(9039),a=e(8750),l=e(4916),c=!l("intersection",function(h){return h.size===2&&h.has(1)&&h.has(2)})||i(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});n({target:"Set",proto:!0,real:!0,forced:c},{intersection:a})}),8014:((r,t,e)=>{var n=e(1291),i=Math.min;r.exports=function(a){var l=n(a);return l>0?i(l,9007199254740991):0}}),8100:((r,t,e)=>{var n=e(6518),i=e(5636);i&&n({target:"ArrayBuffer",proto:!0},{transfer:function(){return i(this,arguments.length?arguments[0]:void 0,!0)}})}),8111:((r,t,e)=>{var n=e(6518),i=e(4576),a=e(679),l=e(8551),c=e(4901),h=e(2787),d=e(2106),p=e(4659),m=e(9039),v=e(9297),E=e(8227),b=e(7657).IteratorPrototype,T=e(3724),S=e(6395),C="constructor",D="Iterator",O=E("toStringTag"),F=TypeError,k=i[D],z=S||!c(k)||k.prototype!==b||!m(function(){k({})}),P=function(){if(a(this,b),h(this)===b)throw new F("Abstract class Iterator not directly constructable")},N=function(M,V){T?d(b,M,{configurable:!0,get:function(){return V},set:function(H){if(l(this),this===b)throw new F("You can't redefine this property");v(this,M)?this[M]=H:p(this,M,H)}}):b[M]=V};v(b,O)||N(O,D),(z||!v(b,C)||b[C]===Object)&&N(C,P),P.prototype=b,n({global:!0,constructor:!0,forced:z},{Iterator:P})}),8227:((r,t,e)=>{var n=e(4576),i=e(5745),a=e(9297),l=e(3392),c=e(4495),h=e(7040),d=n.Symbol,p=i("wks"),m=h?d.for||d:d&&d.withoutSetter||l;r.exports=function(v){return a(p,v)||(p[v]=c&&a(d,v)?d[v]:m("Symbol."+v)),p[v]}}),8235:((r,t,e)=>{var n=e(9504),i=e(9297),a=SyntaxError,l=parseInt,c=String.fromCharCode,h=n("".charAt),d=n("".slice),p=n(/./.exec),m={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},v=/^[\da-f]{4}$/i,E=/^[\u0000-\u001F]$/;r.exports=function(b,T){for(var S=!0,C="";T<b.length;){var D=h(b,T);if(D==="\\"){var O=d(b,T,T+2);if(i(m,O))C+=m[O],T+=2;else if(O==="\\u"){T+=2;var F=d(b,T,T+4);if(!p(v,F))throw new a("Bad Unicode escape at: "+T);C+=c(l(F,16)),T+=4}else throw new a('Unknown escape sequence: "'+O+'"')}else if(D==='"'){S=!1,T++;break}else{if(p(E,D))throw new a("Bad control character in string literal at: "+T);C+=D,T++}}if(S)throw new a("Unterminated string at: "+T);return{value:C,end:T}}}),8237:((r,t,e)=>{var n=e(6518),i=e(2652),a=e(9306),l=e(8551),c=e(1767),h=e(9539),d=e(4549),p=e(8745),m=e(9039),v=TypeError,E=m(function(){[].keys().reduce(function(){},void 0)}),b=!E&&d("reduce",v);n({target:"Iterator",proto:!0,real:!0,forced:E||b},{reduce:function(S){l(this);try{a(S)}catch(k){h(this,"throw",k)}var C=arguments.length<2,D=C?void 0:arguments[1];if(b)return p(b,this,C?[S]:[S,D]);var O=c(this),F=0;if(i(O,function(k){C?(C=!1,D=k):D=S(D,k,F),F++},{IS_RECORD:!0}),C)throw new v("Reduce of empty iterator with no initial value");return D}})}),8335:((r,t,e)=>{var n=e(6518),i=e(3724),a=e(4576),l=e(7751),c=e(9504),h=e(9565),d=e(4901),p=e(34),m=e(4376),v=e(9297),E=e(655),b=e(6198),T=e(4659),S=e(9039),C=e(8235),D=e(4495),O=a.JSON,F=a.Number,k=a.SyntaxError,z=O&&O.parse,P=l("Object","keys"),N=Object.getOwnPropertyDescriptor,M=c("".charAt),V=c("".slice),H=c(/./.exec),$=c([].push),j=/^\d$/,Tt=/^[1-9]$/,St=/^[\d-]$/,X=/^[\t\n\r ]$/,Z=0,ht=1,Rt=function(ut,ft){ut=E(ut);var pt=new it(ut,0),Ct=pt.parse(),Vt=Ct.value,It=pt.skip(X,Ct.end);if(It<ut.length)throw new k('Unexpected extra character: "'+M(ut,It)+'" after the parsed data at: '+It);return d(ft)?W({"":Vt},"",ft,Ct):Vt},W=function(ut,ft,pt,Ct){var Vt=ut[ft],It=Ct&&Vt===Ct.value,qt=It&&typeof Ct.source=="string"?{source:Ct.source}:{},Xt,ne,Te,me,_e;if(p(Vt)){var Yi=m(Vt),ii=It?Ct.nodes:Yi?[]:{};if(Yi)for(Xt=ii.length,Te=b(Vt),me=0;me<Te;me++)lt(Vt,me,W(Vt,""+me,pt,me<Xt?ii[me]:void 0));else for(ne=P(Vt),Te=b(ne),me=0;me<Te;me++)_e=ne[me],lt(Vt,_e,W(Vt,_e,pt,v(ii,_e)?ii[_e]:void 0))}return h(pt,ut,ft,Vt,qt)},lt=function(ut,ft,pt){if(i){var Ct=N(ut,ft);if(Ct&&!Ct.configurable)return}pt===void 0?delete ut[ft]:T(ut,ft,pt)},q=function(ut,ft,pt,Ct){this.value=ut,this.end=ft,this.source=pt,this.nodes=Ct},it=function(ut,ft){this.source=ut,this.index=ft};it.prototype={fork:function(ut){return new it(this.source,ut)},parse:function(){var ut=this.source,ft=this.skip(X,this.index),pt=this.fork(ft),Ct=M(ut,ft);if(H(St,Ct))return pt.number();switch(Ct){case"{":return pt.object();case"[":return pt.array();case'"':return pt.string();case"t":return pt.keyword(!0);case"f":return pt.keyword(!1);case"n":return pt.keyword(null)}throw new k('Unexpected character: "'+Ct+'" at: '+ft)},node:function(ut,ft,pt,Ct,Vt){return new q(ft,Ct,ut?null:V(this.source,pt,Ct),Vt)},object:function(){for(var ut=this.source,ft=this.index+1,pt=!1,Ct={},Vt={};ft<ut.length;){if(ft=this.until(['"',"}"],ft),M(ut,ft)==="}"&&!pt){ft++;break}var It=this.fork(ft).string(),qt=It.value;ft=It.end,ft=this.until([":"],ft)+1,ft=this.skip(X,ft),It=this.fork(ft).parse(),T(Vt,qt,It),T(Ct,qt,It.value),ft=this.until([",","}"],It.end);var Xt=M(ut,ft);if(Xt===",")pt=!0,ft++;else if(Xt==="}"){ft++;break}}return this.node(ht,Ct,this.index,ft,Vt)},array:function(){for(var ut=this.source,ft=this.index+1,pt=!1,Ct=[],Vt=[];ft<ut.length;){if(ft=this.skip(X,ft),M(ut,ft)==="]"&&!pt){ft++;break}var It=this.fork(ft).parse();if($(Vt,It),$(Ct,It.value),ft=this.until([",","]"],It.end),M(ut,ft)===",")pt=!0,ft++;else if(M(ut,ft)==="]"){ft++;break}}return this.node(ht,Ct,this.index,ft,Vt)},string:function(){var ut=this.index,ft=C(this.source,this.index+1);return this.node(Z,ft.value,ut,ft.end)},number:function(){var ut=this.source,ft=this.index,pt=ft;if(M(ut,pt)==="-"&&pt++,M(ut,pt)==="0")pt++;else if(H(Tt,M(ut,pt)))pt=this.skip(j,pt+1);else throw new k("Failed to parse number at: "+pt);if(M(ut,pt)==="."&&(pt=this.skip(j,pt+1)),M(ut,pt)==="e"||M(ut,pt)==="E"){pt++,(M(ut,pt)==="+"||M(ut,pt)==="-")&&pt++;var Ct=pt;if(pt=this.skip(j,pt),Ct===pt)throw new k("Failed to parse number's exponent value at: "+pt)}return this.node(Z,F(V(ut,ft,pt)),ft,pt)},keyword:function(ut){var ft=""+ut,pt=this.index,Ct=pt+ft.length;if(V(this.source,pt,Ct)!==ft)throw new k("Failed to parse value at: "+pt);return this.node(Z,ut,pt,Ct)},skip:function(ut,ft){for(var pt=this.source;ft<pt.length&&H(ut,M(pt,ft));ft++);return ft},until:function(ut,ft){ft=this.skip(X,ft);for(var pt=M(this.source,ft),Ct=0;Ct<ut.length;Ct++)if(ut[Ct]===pt)return ft;throw new k('Unexpected character: "'+pt+'" at: '+ft)}};var yt=S(function(){var ut="9007199254740993",ft;return z(ut,function(pt,Ct,Vt){ft=Vt.source}),ft!==ut}),_t=D&&!S(function(){return 1/z("-0 	")!==-1/0});n({target:"JSON",stat:!0,forced:yt},{parse:function(ft,pt){return _t&&!d(pt)?z(ft):Rt(ft,pt)}})}),8469:((r,t,e)=>{var n=e(9504),i=e(507),a=e(4402),l=a.Set,c=a.proto,h=n(c.forEach),d=n(c.keys),p=d(new l).next;r.exports=function(m,v,E){return E?i({iterator:d(m),next:p},v):h(m,v)}}),8480:((r,t,e)=>{var n=e(1828),i=e(8727),a=i.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(c){return n(c,a)}}),8527:((r,t,e)=>{var n=e(7080),i=e(4402).has,a=e(5170),l=e(3789),c=e(507),h=e(9539);r.exports=function(p){var m=n(this),v=l(p);if(a(m)<v.size)return!1;var E=v.getIterator();return c(E,function(b){if(!i(m,b))return h(E,"normal",!1)})!==!1}}),8551:((r,t,e)=>{var n=e(34),i=String,a=TypeError;r.exports=function(l){if(n(l))return l;throw new a(i(l)+" is not an object")}}),8574:((r,t,e)=>{var n=e(9504),i=Error,a=n("".replace),l=(function(d){return String(new i(d).stack)})("zxcasd"),c=/\n\s*at [^:]*:[^\n]*/,h=c.test(l);r.exports=function(d,p){if(h&&typeof d=="string"&&!i.prepareStackTrace)for(;p--;)d=a(d,c,"");return d}}),8622:((r,t,e)=>{var n=e(4576),i=e(4901),a=n.WeakMap;r.exports=i(a)&&/native code/.test(String(a))}),8646:((r,t,e)=>{var n=e(9565),i=e(8551),a=e(1767),l=e(851);r.exports=function(c,h){(!h||typeof c!="string")&&i(c);var d=l(c);return a(i(d!==void 0?n(d,c):c))}}),8686:((r,t,e)=>{var n=e(3724),i=e(9039);r.exports=n&&i(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})}),8721:((r,t,e)=>{var n=e(3724),i=e(9504),a=e(2106),l=URLSearchParams.prototype,c=i(l.forEach);n&&!("size"in l)&&a(l,"size",{get:function(){var d=0;return c(this,function(){d++}),d},configurable:!0,enumerable:!0})}),8727:(r=>{r.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]}),8745:((r,t,e)=>{var n=e(616),i=Function.prototype,a=i.apply,l=i.call;r.exports=typeof Reflect=="object"&&Reflect.apply||(n?l.bind(a):function(){return l.apply(a,arguments)})}),8750:((r,t,e)=>{var n=e(7080),i=e(4402),a=e(5170),l=e(3789),c=e(8469),h=e(507),d=i.Set,p=i.add,m=i.has;r.exports=function(E){var b=n(this),T=l(E),S=new d;return a(b)>T.size?h(T.getIterator(),function(C){m(b,C)&&p(S,C)}):c(b,function(C){T.includes(C)&&p(S,C)}),S}}),8773:((r,t)=>{var e={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,i=n&&!e.call({1:2},1);t.f=i?function(l){var c=n(this,l);return!!c&&c.enumerable}:e}),8981:((r,t,e)=>{var n=e(7750),i=Object;r.exports=function(a){return i(n(a))}}),9039:(r=>{r.exports=function(t){try{return!!t()}catch{return!0}}}),9143:((r,t,e)=>{var n=e(4576),i=e(9504),a=e(3972),l=e(3463),c=e(9297),h=e(2804),d=e(944),p=e(5169),m=h.c2i,v=h.c2iUrl,E=n.SyntaxError,b=n.TypeError,T=i("".charAt),S=function(O,F){for(var k=O.length;F<k;F++){var z=T(O,F);if(z!==" "&&z!=="	"&&z!==`
`&&z!=="\f"&&z!=="\r")break}return F},C=function(O,F,k){var z=O.length;z<4&&(O+=z===2?"AA":"A");var P=(F[T(O,0)]<<18)+(F[T(O,1)]<<12)+(F[T(O,2)]<<6)+F[T(O,3)],N=[P>>16&255,P>>8&255,P&255];if(z===2){if(k&&N[1]!==0)throw new E("Extra bits");return[N[0]]}if(z===3){if(k&&N[2]!==0)throw new E("Extra bits");return[N[0],N[1]]}return N},D=function(O,F,k){for(var z=F.length,P=0;P<z;P++)O[k+P]=F[P];return k+z};r.exports=function(O,F,k,z){l(O),a(F);var P=d(F)==="base64"?m:v,N=F?F.lastChunkHandling:void 0;if(N===void 0&&(N="loose"),N!=="loose"&&N!=="strict"&&N!=="stop-before-partial")throw new b("Incorrect `lastChunkHandling` option");k&&p(k.buffer);var M=O.length,V=k||[],H=0,$=0,j="",Tt=0;if(z)for(;;){if(Tt=S(O,Tt),Tt===M){if(j.length>0){if(N==="stop-before-partial")break;if(N==="loose"){if(j.length===1)throw new E("Malformed padding: exactly one additional character");H=D(V,C(j,P,!1),H)}else throw new E("Missing padding")}$=M;break}var St=T(O,Tt);if(++Tt,St==="="){if(j.length<2)throw new E("Padding is too early");if(Tt=S(O,Tt),j.length===2){if(Tt===M){if(N==="stop-before-partial")break;throw new E("Malformed padding: only one =")}T(O,Tt)==="="&&(++Tt,Tt=S(O,Tt))}if(Tt<M)throw new E("Unexpected character after padding");H=D(V,C(j,P,N==="strict"),H),$=M;break}if(!c(P,St))throw new E("Unexpected character");var X=z-H;if(X===1&&j.length===2||X===2&&j.length===3||(j+=St,j.length===4&&(H=D(V,C(j,P,!1),H),j="",$=Tt,H===z)))break}return{bytes:V,read:$,written:H}}}),9286:((r,t,e)=>{var n=e(4402),i=e(8469),a=n.Set,l=n.add;r.exports=function(c){var h=new a;return i(c,function(d){l(h,d)}),h}}),9297:((r,t,e)=>{var n=e(9504),i=e(8981),a=n({}.hasOwnProperty);r.exports=Object.hasOwn||function(c,h){return a(i(c),h)}}),9306:((r,t,e)=>{var n=e(4901),i=e(6823),a=TypeError;r.exports=function(l){if(n(l))return l;throw new a(i(l)+" is not a function")}}),9314:((r,t,e)=>{var n=e(6518),i=e(9565),a=e(8551),l=e(1767),c=e(4149),h=e(9590),d=e(9539),p=e(9462),m=e(684),v=e(4549),E=e(6395),b=!E&&!m("drop",0),T=!E&&!b&&v("drop",RangeError),S=E||b||T,C=p(function(){for(var D=this.iterator,O=this.next,F,k;this.remaining;)if(this.remaining--,F=a(i(O,D)),k=this.done=!!F.done,k)return;if(F=a(i(O,D)),k=this.done=!!F.done,!k)return F.value});n({target:"Iterator",proto:!0,real:!0,forced:S},{drop:function(O){a(this);var F;try{F=h(c(+O))}catch(k){d(this,"throw",k)}return T?i(T,this,F):new C(l(this),{remaining:F})}})}),9429:((r,t,e)=>{var n=e(4576),i=e(6193);r.exports=function(a){if(i){try{return n.process.getBuiltinModule(a)}catch{}try{return Function('return require("'+a+'")')()}catch{}}}}),9432:((r,t,e)=>{e(5213)}),9433:((r,t,e)=>{var n=e(4576),i=Object.defineProperty;r.exports=function(a,l){try{i(n,a,{value:l,configurable:!0,writable:!0})}catch{n[a]=l}return l}}),9462:((r,t,e)=>{var n=e(9565),i=e(2360),a=e(6699),l=e(6279),c=e(8227),h=e(1181),d=e(5966),p=e(7657).IteratorPrototype,m=e(2529),v=e(9539),E=e(1385),b=c("toStringTag"),T="IteratorHelper",S="WrapForValidIterator",C="normal",D="throw",O=h.set,F=function(P){var N=h.getterFor(P?S:T);return l(i(p),{next:function(){var V=N(this);if(P)return V.nextHandler();if(V.done)return m(void 0,!0);try{var H=V.nextHandler();return V.returnHandlerResult?H:m(H,V.done)}catch($){throw V.done=!0,$}},return:function(){var M=N(this),V=M.iterator;if(M.done=!0,P){var H=d(V,"return");return H?n(H,V):m(void 0,!0)}if(M.inner)try{v(M.inner.iterator,C)}catch($){return v(V,D,$)}if(M.openIters)try{E(M.openIters,C)}catch($){return v(V,D,$)}return V&&v(V,C),m(void 0,!0)}})},k=F(!0),z=F(!1);a(z,b,"Iterator Helper"),r.exports=function(P,N,M){var V=function($,j){j?(j.iterator=$.iterator,j.next=$.next):j=$,j.type=N?S:T,j.returnHandlerResult=!!M,j.nextHandler=P,j.counter=0,j.done=!1,O(this,j)};return V.prototype=N?k:z,V}}),9486:((r,t,e)=>{var n=e(6518),i=e(4576),a=e(9504),l=e(3972),c=e(4154),h=e(5169),d=e(2804),p=e(944),m=d.i2c,v=d.i2cUrl,E=a("".charAt),b=i.Uint8Array,T=!b||!b.prototype.toBase64||!(function(){try{var S=new b;S.toBase64(null)}catch{return!0}})();b&&n({target:"Uint8Array",proto:!0,forced:T},{toBase64:function(){var C=c(this),D=arguments.length?l(arguments[0]):void 0,O=p(D)==="base64"?m:v,F=!!D&&!!D.omitPadding;h(this.buffer);for(var k="",z=0,P=C.length,N,M=function(V){return E(O,N>>6*V&63)};z+2<P;z+=3)N=(C[z]<<16)+(C[z+1]<<8)+C[z+2],k+=M(3)+M(2)+M(1)+M(0);return z+2===P?(N=(C[z]<<16)+(C[z+1]<<8),k+=M(3)+M(2)+M(1)+(F?"":"=")):z+1===P&&(N=C[z]<<16,k+=M(3)+M(2)+(F?"":"==")),k}})}),9504:((r,t,e)=>{var n=e(616),i=Function.prototype,a=i.call,l=n&&i.bind.bind(a,a);r.exports=n?l:function(c){return function(){return a.apply(c,arguments)}}}),9519:((r,t,e)=>{var n=e(4576),i=e(2839),a=n.process,l=n.Deno,c=a&&a.versions||l&&l.version,h=c&&c.v8,d,p;h&&(d=h.split("."),p=d[0]>0&&d[0]<4?1:+(d[0]+d[1])),!p&&i&&(d=i.match(/Edge\/(\d+)/),(!d||d[1]>=74)&&(d=i.match(/Chrome\/(\d+)/),d&&(p=+d[1]))),r.exports=p}),9539:((r,t,e)=>{var n=e(9565),i=e(8551),a=e(5966);r.exports=function(l,c,h){var d,p;i(l);try{if(d=a(l,"return"),!d){if(c==="throw")throw h;return h}d=n(d,l)}catch(m){p=!0,d=m}if(c==="throw")throw h;if(p)throw d;return i(d),h}}),9565:((r,t,e)=>{var n=e(616),i=Function.prototype.call;r.exports=n?i.bind(i):function(){return i.apply(i,arguments)}}),9577:((r,t,e)=>{var n=e(9928),i=e(4644),a=e(1108),l=e(1291),c=e(5854),h=i.aTypedArray,d=i.getTypedArrayConstructor,p=i.exportTypedArrayMethod,m=(function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(E){return E===8}})(),v=m&&(function(){try{new Int8Array(1).with(-.5,1)}catch{return!0}})();p("with",function(E,b){var T=h(this),S=l(E),C=a(T)?c(b):+b;return n(T,d(T),S,C)},!m||v)}),9590:((r,t,e)=>{var n=e(1291),i=RangeError;r.exports=function(a){var l=n(a);if(l<0)throw new i("The argument can't be less than 0");return l}}),9617:((r,t,e)=>{var n=e(5397),i=e(5610),a=e(6198),l=function(c){return function(h,d,p){var m=n(h),v=a(m);if(v===0)return!c&&-1;var E=i(p,v),b;if(c&&d!==d){for(;v>E;)if(b=m[E++],b!==b)return!0}else for(;v>E;E++)if((c||E in m)&&m[E]===d)return c||E||0;return!c&&-1}};r.exports={includes:l(!0),indexOf:l(!1)}}),9631:((r,t,e)=>{e(9486)}),9797:((r,t,e)=>{e(4226)}),9835:(r=>{r.exports=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},i=e[t](n);return i.size===1&&i.values().next().value===4}catch{return!1}}}),9928:((r,t,e)=>{var n=e(6198),i=e(1291),a=RangeError;r.exports=function(l,c,h,d){var p=n(l),m=i(h),v=m<0?p+m:m;if(v>=p||v<0)throw new a("Incorrect index");for(var E=new c(p),b=0;b<p;b++)E[b]=b===v?d:l[b];return E}})},T_={};function Qt(r){var t=T_[r];if(t!==void 0)return t.exports;var e=T_[r]={exports:{}};return f6[r].call(e.exports,e,e.exports,Qt),e.exports}Qt.d=(r,t)=>{for(var e in t)Qt.o(t,e)&&!Qt.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:t[e]})};Qt.o=(r,t)=>Object.prototype.hasOwnProperty.call(r,t);Qt(4114);Qt(6573);Qt(8100);Qt(7936);Qt(8111);Qt(8237);Qt(1689);Qt(9577);Qt(4235);Qt(9432);Qt(1549);Qt(9797);Qt(9631);Qt(5623);Qt(4979);Qt(5781);const Zn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Oy=[.001,0,0,.001,0,0],$m=1.35,Ti={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},ca={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},cR="pdfjs_internal_editor_",$t={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},le={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},p6={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Nn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Af={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},on={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Cl={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},yp={ERRORS:0,WARNINGS:1,INFOS:5},Wu={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Jd={moveTo:0,lineTo:1,curveTo:2,closePath:3},g6={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let vp=yp.WARNINGS;function m6(r){Number.isInteger(r)&&(vp=r)}function y6(){return vp}function Ep(r){vp>=yp.INFOS&&console.log(`Info: ${r}`)}function Gt(r){vp>=yp.WARNINGS&&console.log(`Warning: ${r}`)}function De(r){throw new Error(r)}function un(r,t){r||De(t)}function v6(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function uR(r,t=null,e=null){if(!r)return null;if(e&&typeof r=="string"&&(e.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),e.tryConvertEncoding))try{r=_6(r)}catch{}const n=t?URL.parse(r,t):URL.parse(r);return v6(n)?n:null}function hR(r,t,e=!1){const n=URL.parse(r);return n?(n.hash=t,n.href):e&&uR(r,"http://example.com")?r.split("#",1)[0]+`${t?`#${t}`:""}`:""}function ee(r,t,e,n=!1){return Object.defineProperty(r,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const xo=(function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t})();class __ extends xo{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Ym extends xo{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Ny extends xo{constructor(t){super(t,"InvalidPDFException")}}class Yf extends xo{constructor(t,e,n){super(t,"ResponseException"),this.status=e,this.missing=n}}class E6 extends xo{constructor(t){super(t,"FormatError")}}class wa extends xo{constructor(t){super(t,"AbortException")}}function dR(r){(typeof r!="object"||r?.length===void 0)&&De("Invalid argument for bytesToString");const t=r.length,e=8192;if(t<e)return String.fromCharCode.apply(null,r);const n=[];for(let i=0;i<t;i+=e){const a=Math.min(i+e,t),l=r.subarray(i,a);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function fh(r){typeof r!="string"&&De("Invalid argument for stringToBytes");const t=r.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=r.charCodeAt(n)&255;return e}function A6(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function b6(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function T6(){try{return new Function(""),!0}catch{return!1}}class Bn{static get isLittleEndian(){return ee(this,"isLittleEndian",b6())}static get isEvalSupported(){return ee(this,"isEvalSupported",T6())}static get isOffscreenCanvasSupported(){return ee(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ee(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return ee(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return ee(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Wm=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));class Nt{static makeHexColor(t,e,n){return`#${Wm[t]}${Wm[e]}${Wm[n]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,n=0){const i=t[n],a=t[n+1];t[n]=i*e[0]+a*e[2]+e[4],t[n+1]=i*e[1]+a*e[3]+e[5]}static applyTransformToBezier(t,e,n=0){const i=e[0],a=e[1],l=e[2],c=e[3],h=e[4],d=e[5];for(let p=0;p<6;p+=2){const m=t[n+p],v=t[n+p+1];t[n+p]=m*i+v*l+h,t[n+p+1]=m*a+v*c+d}}static applyInverseTransform(t,e){const n=t[0],i=t[1],a=e[0]*e[3]-e[1]*e[2];t[0]=(n*e[3]-i*e[2]+e[2]*e[5]-e[4]*e[3])/a,t[1]=(-n*e[1]+i*e[0]+e[4]*e[1]-e[5]*e[0])/a}static axialAlignedBoundingBox(t,e,n){const i=e[0],a=e[1],l=e[2],c=e[3],h=e[4],d=e[5],p=t[0],m=t[1],v=t[2],E=t[3];let b=i*p+h,T=b,S=i*v+h,C=S,D=c*m+d,O=D,F=c*E+d,k=F;if(a!==0||l!==0){const z=a*p,P=a*v,N=l*m,M=l*E;b+=N,C+=N,S+=M,T+=M,D+=z,k+=z,F+=P,O+=P}n[0]=Math.min(n[0],b,S,T,C),n[1]=Math.min(n[1],D,F,O,k),n[2]=Math.max(n[2],b,S,T,C),n[3]=Math.max(n[3],D,F,O,k)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const n=t[0],i=t[1],a=t[2],l=t[3],c=n**2+i**2,h=n*a+i*l,d=a**2+l**2,p=(c+d)/2,m=Math.sqrt(p**2-(c*d-h**2));e[0]=Math.sqrt(p+m||1),e[1]=Math.sqrt(p-m||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>i)return null;const a=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return a>l?null:[n,a,i,l]}static pointBoundingBox(t,e,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}static rectBoundingBox(t,e,n,i,a){a[0]=Math.min(a[0],t,n),a[1]=Math.min(a[1],e,i),a[2]=Math.max(a[2],t,n),a[3]=Math.max(a[3],e,i)}static#t(t,e,n,i,a,l,c,h,d,p){if(d<=0||d>=1)return;const m=1-d,v=d*d,E=v*d,b=m*(m*(m*t+3*d*e)+3*v*n)+E*i,T=m*(m*(m*a+3*d*l)+3*v*c)+E*h;p[0]=Math.min(p[0],b),p[1]=Math.min(p[1],T),p[2]=Math.max(p[2],b),p[3]=Math.max(p[3],T)}static#e(t,e,n,i,a,l,c,h,d,p,m,v){if(Math.abs(d)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,e,n,i,a,l,c,h,-m/p,v);return}const E=p**2-4*m*d;if(E<0)return;const b=Math.sqrt(E),T=2*d;this.#t(t,e,n,i,a,l,c,h,(-p+b)/T,v),this.#t(t,e,n,i,a,l,c,h,(-p-b)/T,v)}static bezierBoundingBox(t,e,n,i,a,l,c,h,d){d[0]=Math.min(d[0],t,c),d[1]=Math.min(d[1],e,h),d[2]=Math.max(d[2],t,c),d[3]=Math.max(d[3],e,h),this.#e(t,n,a,c,e,i,l,h,3*(-t+3*(n-a)+c),6*(t-2*n+a),3*(n-t),d),this.#e(t,n,a,c,e,i,l,h,3*(-e+3*(i-l)+h),6*(e-2*i+l),3*(i-e),d)}}function _6(r){return decodeURIComponent(escape(r))}let Km=null,w_=null;function w6(r){return Km||(Km=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,w_=new Map([["","t"]])),r.replaceAll(Km,(t,e,n)=>e?e.normalize("NFKC"):w_.get(n))}function fR(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),dR(r)}const Qv="pdfjs_internal_id_";function S6(r,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[n,i,...a]=e;if(!r(n)&&!Number.isInteger(n)||!t(i))return!1;const l=a.length;let c=!0;switch(i.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;c=!1;break;default:return!1}for(const h of a)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function ti(r,t,e){return Math.min(Math.max(r,t),e)}function pR(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(dR(r))}function R6(r){return Uint8Array.fromBase64?Uint8Array.fromBase64(r):fh(atob(r))}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((t,e)=>t+e,0)});typeof AbortSignal.any!="function"&&(AbortSignal.any=function(r){const t=new AbortController,{signal:e}=t;for(const n of r)if(n.aborted)return t.abort(n.reason),e;for(const n of r)n.addEventListener("abort",()=>{t.abort(n.reason)},{signal:e});return e});Qt(1701);Qt(4972);Qt(4628);Qt(7642);Qt(8004);Qt(3853);Qt(5876);Qt(2475);Qt(5024);Qt(1698);Qt(4603);Qt(7566);Qt(8721);Qt(9314);Qt(1148);Qt(3579);Qt(8335);const ds="http://www.w3.org/2000/svg";class $l{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function ph(r,t="text"){if(bu(r,document.baseURI)){const e=await fetch(r);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const i=new XMLHttpRequest;i.open("GET",r,!0),i.responseType=t,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(i.response);return}e(i.responseText);return}n(new Error(i.statusText))}},i.send(null)})}class gh{constructor({viewBox:t,userUnit:e,scale:n,rotation:i,offsetX:a=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=t,this.userUnit=e,this.scale=n,this.rotation=i,this.offsetX=a,this.offsetY=l,n*=e;const h=(t[2]+t[0])/2,d=(t[3]+t[1])/2;let p,m,v,E;switch(i%=360,i<0&&(i+=360),i){case 180:p=-1,m=0,v=0,E=1;break;case 90:p=0,m=1,v=1,E=0;break;case 270:p=0,m=-1,v=-1,E=0;break;case 0:p=1,m=0,v=0,E=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(v=-v,E=-E);let b,T,S,C;p===0?(b=Math.abs(d-t[1])*n+a,T=Math.abs(h-t[0])*n+l,S=(t[3]-t[1])*n,C=(t[2]-t[0])*n):(b=Math.abs(h-t[0])*n+a,T=Math.abs(d-t[1])*n+l,S=(t[2]-t[0])*n,C=(t[3]-t[1])*n),this.transform=[p*n,m*n,v*n,E*n,b-p*n*h-v*n*d,T-m*n*h-E*n*d],this.width=S,this.height=C}get rawDims(){const t=this.viewBox;return ee(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:a=!1}={}){return new gh({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:a})}convertToViewportPoint(t,e){const n=[t,e];return Nt.applyTransform(n,this.transform),n}convertToViewportRectangle(t){const e=[t[0],t[1]];Nt.applyTransform(e,this.transform);const n=[t[2],t[3]];return Nt.applyTransform(n,this.transform),[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){const n=[t,e];return Nt.applyInverseTransform(n,this.transform),n}}class Jv extends xo{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Ap(r){const t=r.length;let e=0;for(;e<t&&r[e].trim()==="";)e++;return r.substring(e,e+5).toLowerCase()==="data:"}function Zv(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function C6(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function I6(r,t="document.pdf"){if(typeof r!="string")return t;if(Ap(r))return Gt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(r);if(!n)return t;const i=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},a=/\.pdf$/i,l=n.pathname.split("/").at(-1);if(a.test(l))return i(l);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const d of c)if(a.test(d))return i(d);const h=Array.from(n.searchParams.keys()).reverse();for(const d of h)if(a.test(d))return i(d)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return i(h[0])}return t}class S_{started=Object.create(null);times=[];time(t){t in this.started&&Gt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Gt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:i,end:a}of this.times)t.push(`${n.padEnd(e)} ${a-i}ms
`);return t.join("")}}function bu(r,t){const e=t?URL.parse(r,t):URL.parse(r);return e?.protocol==="http:"||e?.protocol==="https:"}function $i(r){r.preventDefault()}function cn(r){r.preventDefault(),r.stopPropagation()}function x6(r){console.log("Deprecated API usage: "+r)}class Py{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const n=parseInt(e[1],10);let i=parseInt(e[2],10);i=i>=1&&i<=12?i-1:0;let a=parseInt(e[3],10);a=a>=1&&a<=31?a:1;let l=parseInt(e[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(e[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const d=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let m=parseInt(e[9],10)||0;return m=m>=0&&m<=59?m:0,d==="-"?(l+=p,c+=m):d==="+"&&(l-=p,c-=m),new Date(Date.UTC(n,i,a,l,c,h))}}function D6(r,{scale:t=1,rotation:e=0}){const{width:n,height:i}=r.attributes.style,a=[0,0,parseInt(n),parseInt(i)];return new gh({viewBox:a,userUnit:1,scale:t,rotation:e})}function bp(r){if(r.startsWith("#")){const t=parseInt(r.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(t=>parseInt(t)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Gt(`Not a valid color format: "${r}"`),[0,0,0])}function O6(r){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of r.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;r.set(e,bp(n))}t.remove()}function je(r){const{a:t,b:e,c:n,d:i,e:a,f:l}=r.getTransform();return[t,e,n,i,a,l]}function _r(r){const{a:t,b:e,c:n,d:i,e:a,f:l}=r.getTransform().invertSelf();return[t,e,n,i,a,l]}function bo(r,t,e=!1,n=!0){if(t instanceof gh){const{pageWidth:i,pageHeight:a}=t.rawDims,{style:l}=r,c=Bn.isCSSRoundSupported,h=`var(--total-scale-factor) * ${i}px`,d=`var(--total-scale-factor) * ${a}px`,p=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,m=c?`round(down, ${d}, var(--scale-round-y))`:`calc(${d})`;!e||t.rotation%180===0?(l.width=p,l.height=m):(l.width=m,l.height=p)}n&&r.setAttribute("data-main-rotation",t.rotation)}class Br{constructor(){const{pixelRatio:t}=Br;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,n,i,a=-1){let l=1/0,c=1/0,h=1/0;n=Br.capPixels(n,a),n>0&&(l=Math.sqrt(n/(t*e))),i!==-1&&(c=i/t,h=i/e);const d=Math.min(l,c,h);return this.sx>d||this.sy>d?(this.sx=d,this.sy=d,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,n):n}return t}}const My=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Pu{#t=null;#e=null;#n;#i=null;#s=null;#r=null;#a=null;static#o=null;constructor(t){this.#n=t,Pu.#o||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#n._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",$i,{signal:e}),t.addEventListener("pointerdown",Pu.#l,{signal:e}));const n=this.#i=document.createElement("div");n.className="buttons",t.append(n);const i=this.#n.toolbarPosition;if(i){const{style:a}=t,l=this.#n._uiManager.direction==="ltr"?1-i[0]:i[0];a.insetInlineEnd=`${100*l}%`,a.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#c(t){this.#n._focusEventsAllowed=!1,cn(t)}#d(t){this.#n._focusEventsAllowed=!0,cn(t)}#u(t){const e=this.#n._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#c.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",$i,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#s?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#n,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",Pu.#o[t]),this.#u(n)&&n.addEventListener("click",i=>{e.delete()},{signal:e._signal}),this.#i.append(n)}get#f(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#u(e),this.#i.append(e,this.#f),this.#s=t}addComment(t){if(this.#r)return;const e=t.render();e&&(this.#u(e),this.#i.append(e,this.#f),this.#r=t,t.toolbar=this)}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#u(e),this.#i.append(e,this.#f)}async addEditSignatureButton(t){const e=this.#a=await t.renderEditButton(this.#n);this.#u(e),this.#i.append(e,this.#f)}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(e);break}}updateEditSignatureButton(t){this.#a&&(this.#a.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class N6{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#n._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",$i,{signal:e});const n=this.#t=document.createElement("div");return n.className="buttons",t.append(n),this.#n.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#s(t,e){let n=0,i=0;for(const a of t){const l=a.y+a.height;if(l<n)continue;const c=a.x+(e?a.width:0);if(l>n){i=c,n=l;continue}e?c>i&&(i=c):c<i&&(i=c)}return[e?1-i:i,n]}show(t,e,n){const[i,a]=this.#s(e,n),{style:l}=this.#e||=this.#i();t.append(this.#e),l.insetInlineEnd=`${100*i}%`,l.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#r(t,e,n,i){const a=document.createElement("button");a.classList.add("basic",t),a.tabIndex=0,a.setAttribute("data-l10n-id",e);const l=document.createElement("span");a.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",n);const c=this.#n._signal;c instanceof AbortSignal&&!c.aborted&&(a.addEventListener("contextmenu",$i,{signal:c}),a.addEventListener("click",i,{signal:c})),this.#t.append(a)}}function gR(r,t,e){for(const n of e)t.addEventListener(n,r[n].bind(r))}class P6{#t=0;get id(){return`${cR}${this.#t++}`}}class t0{#t=fR();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=t;const a=i.decode().then(()=>(n.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return ee(this,"_isSVGFittingCanvas",a)}async#i(t,e){this.#n||=new Map;let n=this.#n.get(t);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let i;if(typeof e=="string"?(n.url=e,i=await ph(e,"blob")):e instanceof File?i=n.file=e:e instanceof Blob&&(i=e),i.type==="image/svg+xml"){const a=t0._isSVGFittingCanvas,l=new FileReader,c=new Image,h=new Promise((d,p)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,d()},l.onload=async()=>{const m=n.svgUrl=l.result;c.src=await a?`${m}#svgView(preserveAspectRatio(none))`:m},c.onerror=l.onerror=p});l.readAsDataURL(i),await h}else n.bitmap=await createImageBitmap(i);n.refCounter=1}catch(i){Gt(i),n=null}return this.#n.set(t,n),n&&this.#n.set(n.id,n),n}async getFromFile(t){const{lastModified:e,name:n,size:i,type:a}=t;return this.#i(`${e}_${n}_${i}_${a}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,e){const n=await e;return this.#i(t,n)}async getFromId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#n||=new Map;let n=this.#n.get(t);if(n?.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(e.width,e.height);return i.getContext("2d").drawImage(e,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,n),this.#n.set(n.id,n),n}getSvgUrl(t){const e=this.#n.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const i=new OffscreenCanvas(n.width,n.height);i.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=i.convertToBlob()}n.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class M6{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:e,post:n,mustExec:i,type:a=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(i&&t(),this.#e)return;const h={cmd:t,undo:e,post:n,type:a};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(h);return}if(l&&this.#t[this.#i].type===a){c&&(h.undo=this.#t[this.#i].undo),this.#t[this.#i]=h;return}const d=this.#i+1;d===this.#n?this.#t.splice(0,1):(this.#i=d,d<this.#t.length&&this.#t.splice(d)),this.#t.push(h)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let e=this.#i;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#i-e),this.#i=e;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class mh{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Bn.platform;for(const[n,i,a={}]of t)for(const l of n){const c=l.startsWith("mac+");e&&c?(this.callbacks.set(l.slice(4),{callback:i,options:a}),this.allKeys.add(l.split("+").at(-1))):!e&&!c&&(this.callbacks.set(l,{callback:i,options:a}),this.allKeys.add(l.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(this.#t(e));if(!n)return;const{callback:i,options:{bubbles:a=!1,args:l=[],checker:c=null}}=n;c&&!c(t,e)||(i.bind(t,...l,e)(),a||cn(e))}}class e0{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return O6(t),ee(this,"_colors",t)}convert(t){const e=bp(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,i]of this._colors)if(i.every((a,l)=>a===e[l]))return e0._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?Nt.makeHexColor(...e):t}}class Sa{#t=new AbortController;#e=null;#n=null;#i=new Map;#s=new Map;#r=null;#a=null;#o=null;#l=new M6;#c=null;#d=null;#u=null;#f=0;#g=new Set;#p=null;#h=null;#m=new Set;_editorUndoBar=null;#E=!1;#y=!1;#b=!1;#T=null;#v=null;#_=null;#I=null;#R=!1;#w=null;#N=new P6;#C=!1;#x=!1;#L=!1;#P=null;#M=null;#k=null;#O=null;#U=null;#S=$t.NONE;#A=new Set;#V=null;#j=null;#z=null;#K=null;#Y=null;#W={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#B=[0,0];#G=null;#$=null;#J=null;#Z=null;#F=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Sa.prototype,e=l=>l.#$.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},i=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return ee(this,"_keyboardManager",new mh([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#$.contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#$.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}]]))}constructor(t,e,n,i,a,l,c,h,d,p,m,v,E,b,T,S){const C=this._signal=this.#t.signal;this.#$=t,this.#J=e,this.#Z=n,this.#r=i,this.#c=a,this.#j=l,this.#Y=h,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:C}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:C}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:C}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:C}),c._on("setpreference",this.onSetPreference.bind(this),{signal:C}),c._on("switchannotationeditorparams",D=>this.updateParams(D.type,D.value),{signal:C}),window.addEventListener("pointerdown",()=>{this.#x=!0},{capture:!0,signal:C}),window.addEventListener("pointerup",()=>{this.#x=!1},{capture:!0,signal:C}),this.#lt(),this.#dt(),this.#et(),this.#a=h.annotationStorage,this.#T=h.filterFactory,this.#z=d,this.#I=p||null,this.#E=m,this.#y=v,this.#b=E,this.#U=b||null,this.viewParameters={realScale:$l.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=T||null,this._supportsPinchToZoom=S!==!1}destroy(){this.#F?.resolve(),this.#F=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#s.values())t.destroy();this.#s.clear(),this.#i.clear(),this.#m.clear(),this.#O?.clear(),this.#e=null,this.#A.clear(),this.#l.destroy(),this.#r?.destroy(),this.#c?.destroy(),this.#j?.destroy(),this.#w?.hide(),this.#w=null,this.#k?.destroy(),this.#k=null,this.#n=null,this.#v&&(clearTimeout(this.#v),this.#v=null),this.#G&&(clearTimeout(this.#G),this.#G=null),this._editorUndoBar?.destroy(),this.#Y=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#U}get useNewAltTextFlow(){return this.#y}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return ee(this,"hcmFilter",this.#z?this.#T.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return ee(this,"direction",getComputedStyle(this.#$).direction)}get _highlightColors(){return ee(this,"_highlightColors",this.#I?new Map(this.#I.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return ee(this,"highlightColors",null);const e=new Map,n=!!this.#z;for(const[i,a]of t){const l=i.endsWith("_HCM");if(n&&l){e.set(i.replace("_HCM",""),a);continue}!n&&!l&&e.set(i,a)}return ee(this,"highlightColors",e)}get highlightColorNames(){return ee(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#u=t}setMainHighlightColorPicker(t){this.#k=t}editAltText(t,e=!1){this.#r?.editAltText(this,t,e)}hasCommentManager(){return!!this.#c}editComment(t,e){this.#c?.open(this,t,e)}getSignature(t){this.#j?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#j}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#b=e;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#$.focus()}findParent(t,e){for(const n of this.#s.values()){const{x:i,y:a,width:l,height:c}=n.div.getBoundingClientRect();if(t>=i&&t<=i+l&&e>=a&&e<=a+c)return n}return null}disableUserSelect(t=!1){this.#J.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#m.add(t)}removeShouldRescale(t){this.#m.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*$l.PDF_TO_CSS_UNITS;for(const e of this.#m)e.onScaleChanging();this.#u?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of this.#s.values())if(n.hasTextLayer(t))return n;return null}highlightSelection(t="",e=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:i,anchorOffset:a,focusNode:l,focusOffset:c}=n,h=n.toString(),p=this.#Q(n).closest(".textLayer"),m=this.getSelectionBoxes(p);if(!m)return;n.empty();const v=this.#tt(p),E=this.#S===$t.NONE,b=()=>{const T=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:m,anchorNode:i,anchorOffset:a,focusNode:l,focusOffset:c,text:h});E&&this.showAllEditors("highlight",!0,!0),e&&T?.editComment()};if(E){this.switchToMode($t.HIGHLIGHT,b);return}b()}commentSelection(t=""){this.highlightSelection(t,!0)}#at(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=this.#Q(t).closest(".textLayer"),i=this.getSelectionBoxes(n);i&&(this.#w||=new N6(this),this.#w.show(n,i,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#a&&!this.#a.has(t.id)&&this.#a.setValue(t.id,t)}a11yAlert(t,e=null){const n=this.#Z;n&&(n.setAttribute("data-l10n-id",t),e?n.setAttribute("data-l10n-args",JSON.stringify(e)):n.removeAttribute("data-l10n-args"))}#ot(){const t=document.getSelection();if(!t||t.isCollapsed){this.#V&&(this.#w?.hide(),this.#V=null,this.#D({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#V)return;const i=this.#Q(t).closest(".textLayer");if(!i){this.#V&&(this.#w?.hide(),this.#V=null,this.#D({hasSelectedText:!1}));return}if(this.#w?.hide(),this.#V=e,this.#D({hasSelectedText:!0}),!(this.#S!==$t.HIGHLIGHT&&this.#S!==$t.NONE)&&(this.#S===$t.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#R=this.isShiftKeyDown,!this.isShiftKeyDown)){const a=this.#S===$t.HIGHLIGHT?this.#tt(i):null;if(a?.toggleDrawing(),this.#x){const l=new AbortController,c=this.combinedSignal(l),h=d=>{d.type==="pointerup"&&d.button!==0||(l.abort(),a?.toggleDrawing(!0),d.type==="pointerup"&&this.#X("main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}else a?.toggleDrawing(!0),this.#X("main_toolbar")}}#X(t=""){this.#S===$t.HIGHLIGHT?this.highlightSelection(t):this.#E&&this.#at()}#lt(){document.addEventListener("selectionchange",this.#ot.bind(this),{signal:this._signal})}#ct(){if(this.#_)return;this.#_=new AbortController;const t=this.combinedSignal(this.#_);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ut(){this.#_?.abort(),this.#_=null}blur(){if(this.isShiftKeyDown=!1,this.#R&&(this.#R=!1,this.#X("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#A)if(e.div.contains(t)){this.#M=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#M)return;const[t,e]=this.#M;this.#M=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#P)return;this.#P=new AbortController;const t=this.combinedSignal(this.#P);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ht(){this.#P?.abort(),this.#P=null}#nt(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#it(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.#nt()}removeEditListeners(){this.#ht(),this.#it()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of this.#h)if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of this.#h)if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const n of this.#A){const i=n.serialize(!0);i&&e.push(i)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const a of e.items)for(const l of this.#h)if(l.isHandlingMimeForPasting(a.type)){l.paste(a,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(a){Gt(`paste: "${a.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const a=[];for(const h of n){const d=await i.deserialize(h);if(!d)return;a.push(d)}const l=()=>{for(const h of a)this.#rt(h);this.#st(a)},c=()=>{for(const h of a)h.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(a){Gt(`paste: "${a.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#S!==$t.NONE&&!this.isEditorHandlingKeyboard&&Sa._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#R&&(this.#R=!1,this.#X("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#D(t){Object.entries(t).some(([n,i])=>this.#W[n]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#W,t)}),this.#S===$t.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#H([[le.HIGHLIGHT_FREE,!0]]))}#H(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ct(),this.#nt(),this.#D({isEditing:this.#S!==$t.NONE,isEmpty:this.#q(),hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:this.#l.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ut(),this.#it(),this.#D({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#h){this.#h=t;for(const e of this.#h)this.#H(e.defaultPropertiesToUpdate)}}getId(){return this.#N.id}get currentLayer(){return this.#s.get(this.#f)}getLayer(t){return this.#s.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#s.set(t.pageIndex,t),this.#C?t.enable():t.disable()}removeLayer(t){this.#s.delete(t.pageIndex)}async updateMode(t,e=null,n=!1,i=!1,a=!1){if(this.#S!==t&&!(this.#F&&(await this.#F.promise,!this.#F))){if(this.#F=Promise.withResolvers(),this.#u?.commitOrRemove(),this.#S===$t.POPUP&&this.#c?.hideSidebar(),this.#S=t,t===$t.NONE){this.setEditingState(!1),this.#pt(),this._editorUndoBar?.hide(),this.#F.resolve();return}t===$t.SIGNATURE&&await this.#j?.loadSignatures(),t===$t.POPUP&&(this.#n||=await this.#Y.getAnnotationsByType(new Set(this.#h.map(l=>l._editorType))),this.#c?.showSidebar(this.#n)),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const l of this.#s.values())l.updateMode(t);if(!e){n&&this.addNewEditorFromKeyboard(),this.#F.resolve();return}for(const l of this.#i.values())l.annotationElementId===e||l.id===e?(this.setSelected(l),a?l.editComment():i&&l.enterInEditMode()):l.unselect();this.#F.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#S&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#h){switch(t){case le.CREATE:this.currentLayer.addNewEditor(e);return;case le.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#K||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const n of this.#A)n.updateParams(t,e);else for(const n of this.#h)n.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){for(const a of this.#i.values())a.editorType===t&&a.show(e);(this.#K?.get(le.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#H([[le.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#L!==t){this.#L=t;for(const e of this.#s.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#C){this.#C=!0;const t=[];for(const e of this.#s.values())t.push(e.enable());await Promise.all(t);for(const e of this.#i.values())e.enable()}}#pt(){if(this.unselectAll(),this.#C){this.#C=!1;for(const t of this.#s.values())t.disable();for(const t of this.#i.values())t.disable()}}getEditors(t){const e=[];for(const n of this.#i.values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.focusMainContainer(),this.#v=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#O?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#g.has(t.annotationElementId))&&this.#a?.remove(t.id)}addDeletedAnnotationElement(t){this.#g.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#g.has(t)}removeDeletedAnnotationElement(t){this.#g.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#rt(t){const e=this.#s.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#H(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#A);return t}updateUI(t){this.#gt===t&&this.#H(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#H(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#A.has(t)){this.#A.delete(t),t.unselect(),this.#D({hasSelectedEditor:this.hasSelection});return}this.#A.add(t),t.select(),this.#H(t.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),this.#u?.commitOrRemove();for(const e of this.#A)e!==t&&e.unselect();this.#A.clear(),this.#A.add(t),t.select(),this.#H(t.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}isSelected(t){return this.#A.has(t)}get firstSelectedEditor(){return this.#A.values().next().value}unselect(t){t.unselect(),this.#A.delete(t),this.#D({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#A.size!==0}get isEnterHandled(){return this.#A.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#l.undo(),this.#D({hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#q()}),this._editorUndoBar?.hide()}redo(){this.#l.redo(),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:this.#l.hasSomethingToRedo(),isEmpty:this.#q()})}addCommands(t){this.#l.add(t),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#q()})}cleanUndoStack(t){this.#l.cleanType(t)}#q(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#A],n=()=>{this._editorUndoBar?.show(i,e.length===1?e[0].editorType:e.length);for(const a of e)a.remove()},i=()=>{for(const a of e)this.#rt(a)};this.addCommands({cmd:n,undo:i,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#st(t){for(const e of this.#A)e.unselect();this.#A.clear();for(const e of t)e.isEmpty()||(this.#A.add(e),e.select());this.#D({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#A)t.commit();this.#st(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#S!==$t.NONE))&&!this.#u?.commitOrRemove()&&this.hasSelection){for(const t of this.#A)t.unselect();this.#A.clear(),this.#D({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#B[0]+=t,this.#B[1]+=e;const[i,a]=this.#B,l=[...this.#A],c=1e3;this.#G&&clearTimeout(this.#G),this.#G=setTimeout(()=>{this.#G=null,this.#B[0]=this.#B[1]=0,this.addCommands({cmd:()=>{for(const h of l)this.#i.has(h.id)&&(h.translateInPage(i,a),h.translationDone())},undo:()=>{for(const h of l)this.#i.has(h.id)&&(h.translateInPage(-i,-a),h.translationDone())},mustExec:!1})},c);for(const h of l)h.translateInPage(t,e),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const t of this.#A)this.#p.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const t=this.#p;this.#p=null;let e=!1;for(const[{x:i,y:a,pageIndex:l},c]of t)c.newX=i,c.newY=a,c.newPageIndex=l,e||=i!==c.savedX||a!==c.savedY||l!==c.savedPageIndex;if(!e)return!1;const n=(i,a,l,c)=>{if(this.#i.has(i.id)){const h=this.#s.get(c);h?i._setParentAndPosition(h,a,l):(i.pageIndex=c,i.x=a,i.y=l)}};return this.addCommands({cmd:()=>{for(const[i,{newX:a,newY:l,newPageIndex:c}]of t)n(i,a,l,c)},undo:()=>{for(const[i,{savedX:a,savedY:l,savedPageIndex:c}]of t)n(i,a,l,c)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#p)for(const n of this.#p.keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#A.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#S}get imageManager(){return ee(this,"imageManager",new t0)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let d=0,p=e.rangeCount;d<p;d++)if(!t.contains(e.getRangeAt(d).commonAncestorContainer))return null;const{x:n,y:i,width:a,height:l}=t.getBoundingClientRect();let c;switch(t.getAttribute("data-main-rotation")){case"90":c=(d,p,m,v)=>({x:(p-i)/l,y:1-(d+m-n)/a,width:v/l,height:m/a});break;case"180":c=(d,p,m,v)=>({x:1-(d+m-n)/a,y:1-(p+v-i)/l,width:m/a,height:v/l});break;case"270":c=(d,p,m,v)=>({x:1-(p+v-i)/l,y:(d-n)/a,width:v/l,height:m/a});break;default:c=(d,p,m,v)=>({x:(d-n)/a,y:(p-i)/l,width:m/a,height:v/l});break}const h=[];for(let d=0,p=e.rangeCount;d<p;d++){const m=e.getRangeAt(d);if(!m.collapsed)for(const{x:v,y:E,width:b,height:T}of m.getClientRects())b===0||T===0||h.push(c(v,E,b,T))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const n=this.#a.getRawValue(e);n&&(this.#S===$t.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}setMissingCanvas(t,e,n){const i=this.#O?.get(t);i&&(i.setCanvas(e,n),this.#O.delete(t))}addMissingCanvas(t,e){(this.#O||=new Map).set(t,e)}}class Cr{#t=null;#e=!1;#n=null;#i=null;#s=null;#r=null;#a=!1;#o=null;#l=null;#c=null;#d=null;#u=!1;static#f=null;static _l10n=null;constructor(t){this.#l=t,this.#u=t._uiManager.useNewAltTextFlow,Cr.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Cr._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#i=document.createElement("span");t.append(e),this.#u?(t.classList.add("new"),t.setAttribute("data-l10n-id",Cr.#f.missing),e.setAttribute("data-l10n-id",Cr.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#l._uiManager._signal;t.addEventListener("contextmenu",$i,{signal:n}),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const i=a=>{a.preventDefault(),this.#l._uiManager.editAltText(this.#l),this.#u&&this.#l._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return t.addEventListener("click",i,{capture:!0,signal:n}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#a=!0,i(a))},{signal:n}),await this.#p(),t}get#g(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#a}),this.#a=!1)}isEmpty(){return this.#u?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#u?this.#t!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(t){this.#t===null&&(this.#c=t,this.#d=await Cr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#u||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#l.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#c===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#c,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:i,cancel:a=!1}){n&&(this.#c=n,this.#d=i),!(this.#t===t&&this.#e===e)&&(a||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#n&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#n.disabled=!t)}shown(){this.#l._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#s=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#n;if(!t)return;if(this.#u){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Cr.#f[this.#g]),this.#i?.setAttribute("data-l10n-id",Cr.#f[`${this.#g}-label`]),!this.#t){this.#s?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#s?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#s;if(!e){this.#s=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#l.id}`;const i=100,a=this.#l._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#s.classList.add("show"),this.#l._reportTelemetry({action:"alt_text_tooltip"})},i)},{signal:a}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#s?.classList.remove("show")},{signal:a})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#l.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class Zd{#t=null;#e=!1;#n=null;#i=null;#s=null;#r=null;#a=!1;constructor(t){this.#n=t,this.toolbar=null}render(){if(!this.#n._uiManager.hasCommentManager())return null;const t=this.#t=document.createElement("button");t.className="comment",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button");const e=this.#n._uiManager._signal;if(!(e instanceof AbortSignal)||e.aborted)return t;t.addEventListener("contextmenu",$i,{signal:e}),t.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:e});const n=i=>{i.preventDefault(),this.edit()};return t.addEventListener("click",n,{capture:!0,signal:e}),t.addEventListener("keydown",i=>{i.target===t&&i.key==="Enter"&&(this.#e=!0,n(i))},{signal:e}),t}edit(){const{bottom:t,left:e,right:n}=this.#n.getClientDimensions(),i={top:t};this.#n._uiManager.direction==="ltr"?i.right=n:i.left=e,this.#n._uiManager.editComment(this.#n,i)}finish(){this.#t&&(this.#t.focus({focusVisible:this.#e}),this.#e=!1)}isDeleted(){return this.#a||this.#s===""}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#i}serialize(){return this.data}get data(){return{text:this.#s,date:this.#r,deleted:this.#a}}set data(t){if(t===null){this.#s="",this.#a=!0;return}this.#s=t,this.#r=new Date,this.#a=!1}setInitialText(t){this.#i=t,this.data=t}toggle(t=!1){this.#t&&(this.#t.disabled=!t)}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#s="",this.#r=null,this.#n=null,this.#e=!1,this.#a=!1}}class Tp{#t;#e=!1;#n=null;#i;#s;#r;#a;#o=null;#l;#c=null;#d;#u=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:i=null,onPinching:a=null,onPinchEnd:l=null,signal:c}){this.#t=t,this.#n=n,this.#i=e,this.#s=i,this.#r=a,this.#a=l,this.#d=new AbortController,this.#l=AbortSignal.any([c,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#l})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Br.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const i=this.#o=new AbortController,a=AbortSignal.any([this.#l,i.signal]),l=this.#t,c={capture:!0,signal:a,passive:!1},h=d=>{d.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};l.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(cn(d),h(d))},c),l.addEventListener("pointerup",h,c),l.addEventListener("pointercancel",h,c);return}if(!this.#u){this.#u=new AbortController;const i=AbortSignal.any([this.#l,this.#u.signal]),a=this.#t,l={signal:i,capture:!1,passive:!1};a.addEventListener("touchmove",this.#g.bind(this),l);const c=this.#p.bind(this);a.addEventListener("touchend",c,l),a.addEventListener("touchcancel",c,l),l.capture=!0,a.addEventListener("pointerdown",cn,l),a.addEventListener("pointermove",cn,l),a.addEventListener("pointercancel",cn,l),a.addEventListener("pointerup",cn,l),this.#s?.()}if(cn(t),t.touches.length!==2||this.#n?.()){this.#c=null;return}let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]),this.#c={touch0X:e.screenX,touch0Y:e.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#g(t){if(!this.#c||t.touches.length!==2)return;cn(t);let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]);const{screenX:i,screenY:a}=e,{screenX:l,screenY:c}=n,h=this.#c,{touch0X:d,touch0Y:p,touch1X:m,touch1Y:v}=h,E=m-d,b=v-p,T=l-i,S=c-a,C=Math.hypot(T,S)||1,D=Math.hypot(E,b)||1;if(!this.#e&&Math.abs(D-C)<=Tp.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=i,h.touch0Y=a,h.touch1X=l,h.touch1Y=c,!this.#e){this.#e=!0;return}const O=[(i+l)/2,(a+c)/2];this.#r?.(O,D,C)}#p(t){t.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#a?.()),this.#c&&(cn(t),this.#c=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class Lt{#t=null;#e=null;#n=null;#i=null;#s=!1;#r=null;#a="";#o=!1;#l=null;#c=null;#d=null;#u=null;#f="";#g=!1;#p=null;#h=!1;#m=!1;#E=!1;#y=null;#b=0;#T=0;#v=null;#_=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#I=!1;#R=Lt._zIndex++;static _borderLineWidth=-1;static _colorManager=new e0;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Lt.prototype._resizeWithKeyboard,e=Sa.TRANSLATE_SMALL,n=Sa.TRANSLATE_BIG;return ee(this,"_resizerKeyboardManager",new mh([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],Lt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:i,pageX:a,pageY:l}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[a,l];const[c,h]=this.parentDimensions;this.x=t.x/c,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return ee(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new L6({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Lt._l10n??=t,Lt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Lt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Lt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){De("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#I}set _isDraggable(t){this.#I=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#R}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#B(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,i){const[a,l]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(t+n)/a,this.y=(e+i)/l,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[n,i]=this.parentDimensions;this.setAt(t*n,e*i,this.width*n,this.height*i),this._onTranslated()}#w([t,e],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/t,this.y+=i/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#w(this.parentDimensions,t,e)}translateInPage(t,e){this.#p||=[this.x,this.y,this.width,this.height],this.#w(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#p||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[i,a]}=this;if(this.x+=t/i,this.y+=e/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[h,d]=this.getBaseTranslation();l+=h,c+=d;const{style:p}=n;p.left=`${(100*l).toFixed(2)}%`,p.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#p&&(this.#p[0]!==this.x||this.#p[1]!==this.y)}get _hasBeenResized(){return!!this.#p&&(this.#p[2]!==this.width||this.#p[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=Lt,i=n/t,a=n/e;switch(this.rotation){case 90:return[-i,a];case 180:return[i,a];case 270:return[i,-a];default:return[-i,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[n,i]}=this;let{x:a,y:l,width:c,height:h}=this;if(c*=n,h*=i,a*=n,l*=i,this._mustFixPosition)switch(t){case 0:a=ti(a,0,n-c),l=ti(l,0,i-h);break;case 90:a=ti(a,0,n-h),l=ti(l,c,i);break;case 180:a=ti(a,c,n),l=ti(l,h,i);break;case 270:a=ti(a,h,n),l=ti(l,0,i-c);break}this.x=a/=n,this.y=l/=i;const[d,p]=this.getBaseTranslation();a+=d,l+=p,e.left=`${(100*a).toFixed(2)}%`,e.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#N(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Lt.#N(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Lt.#N(t,e,360-this.parentRotation)}#C(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,i]=this.parentDimensions,{style:a}=this.div;a.width=`${(100*t/n).toFixed(2)}%`,this.#o||(a.height=`${(100*e/i).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,i=n.endsWith("%"),a=!this.#o&&e.endsWith("%");if(i&&a)return;const[l,c]=this.parentDimensions;i||(t.width=`${(100*parseFloat(n)/l).toFixed(2)}%`),!this.#o&&!a&&(t.height=`${(100*parseFloat(e)/c).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#x(){if(this.#l)return;this.#l=document.createElement("div"),this.#l.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const i=document.createElement("div");this.#l.append(i),i.classList.add("resizer",n),i.setAttribute("data-resizer-name",n),i.addEventListener("pointerdown",this.#L.bind(this,n),{signal:e}),i.addEventListener("contextmenu",$i,{signal:e}),i.tabIndex=-1}this.div.prepend(this.#l)}#L(t,e){e.preventDefault();const{isMac:n}=Bn.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#n?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,this.#c=[e.screenX,e.screenY];const a=new AbortController,l=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#k.bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",cn,{passive:!1,signal:l}),window.addEventListener("contextmenu",$i,{signal:l}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const d=()=>{a.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=c,this.div.style.cursor=h,this.#M()};window.addEventListener("pointerup",d,{signal:l}),window.addEventListener("blur",d,{signal:l})}#P(t,e,n,i){this.width=n,this.height=i,this.x=t,this.y=e;const[a,l]=this.parentDimensions;this.setDims(a*n,l*i),this.fixAndSetPosition(),this._onResized()}_onResized(){}#M(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:i}=this.#d;this.#d=null;const a=this.x,l=this.y,c=this.width,h=this.height;a===t&&l===e&&c===n&&h===i||this.addCommands({cmd:this.#P.bind(this,a,l,c,h),undo:this.#P.bind(this,t,e,n,i),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#k(t,e){const[n,i]=this.parentDimensions,a=this.x,l=this.y,c=this.width,h=this.height,d=Lt.MIN_SIZE/n,p=Lt.MIN_SIZE/i,m=this.#C(this.rotation),v=(X,Z)=>[m[0]*X+m[2]*Z,m[1]*X+m[3]*Z],E=this.#C(360-this.rotation),b=(X,Z)=>[E[0]*X+E[2]*Z,E[1]*X+E[3]*Z];let T,S,C=!1,D=!1;switch(t){case"topLeft":C=!0,T=(X,Z)=>[0,0],S=(X,Z)=>[X,Z];break;case"topMiddle":T=(X,Z)=>[X/2,0],S=(X,Z)=>[X/2,Z];break;case"topRight":C=!0,T=(X,Z)=>[X,0],S=(X,Z)=>[0,Z];break;case"middleRight":D=!0,T=(X,Z)=>[X,Z/2],S=(X,Z)=>[0,Z/2];break;case"bottomRight":C=!0,T=(X,Z)=>[X,Z],S=(X,Z)=>[0,0];break;case"bottomMiddle":T=(X,Z)=>[X/2,Z],S=(X,Z)=>[X/2,0];break;case"bottomLeft":C=!0,T=(X,Z)=>[0,Z],S=(X,Z)=>[X,0];break;case"middleLeft":D=!0,T=(X,Z)=>[0,Z/2],S=(X,Z)=>[X,Z/2];break}const O=T(c,h),F=S(c,h);let k=v(...F);const z=Lt._round(a+k[0]),P=Lt._round(l+k[1]);let N=1,M=1,V,H;if(e.fromKeyboard)({deltaX:V,deltaY:H}=e);else{const{screenX:X,screenY:Z}=e,[ht,Rt]=this.#c;[V,H]=this.screenToPageTranslation(X-ht,Z-Rt),this.#c[0]=X,this.#c[1]=Z}if([V,H]=b(V/n,H/i),C){const X=Math.hypot(c,h);N=M=Math.max(Math.min(Math.hypot(F[0]-O[0]-V,F[1]-O[1]-H)/X,1/c,1/h),d/c,p/h)}else D?N=ti(Math.abs(F[0]-O[0]-V),d,1)/c:M=ti(Math.abs(F[1]-O[1]-H),p,1)/h;const $=Lt._round(c*N),j=Lt._round(h*M);k=v(...S($,j));const Tt=z-k[0],St=P-k[1];this.#p||=[this.x,this.y,this.width,this.height],this.width=$,this.height=j,this.x=Tt,this.y=St,this.setDims(n*$,i*j),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#m)return this._editToolbar;this._editToolbar=new Pu(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,n]of t)await this._editToolbar.addButton(e,n);return this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(Cr.initialize(Lt._l10n),this.#n=new Cr(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}addCommentButton(){return this.#i?this.#i:this.#i=new Zd(this)}get commentColor(){return null}get comment(){const t=this.#i;return{text:t.data.text,date:t.data.date,deleted:t.isDeleted(),color:this.commentColor}}set comment(t){this.#i||(this.#i=new Zd(this)),this.#i.data=t}setCommentData(t){this.#i||(this.#i=new Zd(this)),this.#i.setInitialText(t)}get hasEditedComment(){return this.#i?.hasBeenEdited()}async editComment(){this.#i||(this.#i=new Zd(this)),this.#i.edit()}addComment(t){if(this.hasEditedComment){const[,,,i]=t.rect,[a]=this.pageDimensions,[l]=this.pageTranslation,c=l+a+1,h=i-100,d=c+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,d,i]}}}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#s?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#j();const[e,n]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*n/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/n).toFixed(2)}%`);const[i,a]=this.getInitialTranslation();return this.translate(i,a),gR(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#_||=new Tp({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#O.bind(this),onPinching:this.#U.bind(this),onPinchEnd:this.#S.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),t}#O(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#U(t,e,n){let a=.7*(n/e)+1-.7;if(a===1)return;const l=this.#C(this.rotation),c=(z,P)=>[l[0]*z+l[2]*P,l[1]*z+l[3]*P],[h,d]=this.parentDimensions,p=this.x,m=this.y,v=this.width,E=this.height,b=Lt.MIN_SIZE/h,T=Lt.MIN_SIZE/d;a=Math.max(Math.min(a,1/v,1/E),b/v,T/E);const S=Lt._round(v*a),C=Lt._round(E*a);if(S===v&&C===E)return;this.#p||=[p,m,v,E];const D=c(v/2,E/2),O=Lt._round(p+D[0]),F=Lt._round(m+D[1]),k=c(S/2,C/2);this.x=O-k[0],this.y=F-k[1],this.width=S,this.height=C,this.setDims(h*S,d*C),this.fixAndSetPosition(),this._onResizing()}#S(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#M()}pointerdown(t){const{isMac:e}=Bn.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#V(t);return}this.#A(t)}#A(t){const{isMac:e}=Bn.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#V(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,a=this._uiManager.combinedSignal(i),l={capture:!0,passive:!1,signal:a},c=d=>{i.abort(),this.#r=null,this.#g=!1,this._uiManager.endDragSession()||this.#A(d),n&&this._onStopDragging()};e&&(this.#b=t.clientX,this.#T=t.clientY,this.#r=t.pointerId,this.#a=t.pointerType,window.addEventListener("pointermove",d=>{n||(n=!0,this._onStartDragging());const{clientX:p,clientY:m,pointerId:v}=d;if(v!==this.#r){cn(d);return}const[E,b]=this.screenToPageTranslation(p-this.#b,m-this.#T);this.#b=p,this.#T=m,this._uiManager.dragSelectedEditors(E,b)},l),window.addEventListener("touchmove",cn,l),window.addEventListener("pointerdown",d=>{d.pointerType===this.#a&&(this.#_||d.isPrimary)&&c(d),cn(d)},l));const h=d=>{if(!this.#r||this.#r===d.pointerId){c(d);return}cn(d)};window.addEventListener("pointerup",h,{signal:a}),window.addEventListener("blur",h,{signal:a})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,n=this.rotation){const i=this.parentScale,[a,l]=this.pageDimensions,[c,h]=this.pageTranslation,d=t/i,p=e/i,m=this.x*a,v=this.y*l,E=this.width*a,b=this.height*l;switch(n){case 0:return[m+d+c,l-v-p-b+h,m+d+E+c,l-v-p+h];case 90:return[m+p+c,l-v+d+h,m+p+b+c,l-v+d+E+h];case 180:return[m-d-E+c,l-v+p+h,m-d+c,l-v+p+b+h];case 270:return[m-p-b+c,l-v-d-E+h,m-p+c,l-v-d+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,i,a,l]=t,c=a-n,h=l-i;switch(this.rotation){case 0:return[n,e-l,c,h];case 90:return[n,e-i,h,c];case 180:return[a,e-i,c,h];case 270:return[a,e-l,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#m=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#m=!1,!0):!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#E}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:a,innerWidth:l}=window;return e<l&&i>0&&t<a&&n>0}#j(){if(this.#u||!this.div)return;this.#u=new AbortController;const t=this._uiManager.combinedSignal(this.#u);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#j()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){De("An editor must be serializable")}static async deserialize(t,e,n){const i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n,annotationElementId:t.annotationElementId});i.rotation=t.rotation,i.#t=t.accessibilityData,i._isCopy=t.isCopy||!1;const[a,l]=i.pageDimensions,[c,h,d,p]=i.getRectInCurrentCoords(t.rect,l);return i.x=c/a,i.y=h/l,i.width=d/a,i.height=p/l,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#u?.abort(),this.#u=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#B(),this.removeEditToolbar(),this.#v){for(const t of this.#v.values())clearTimeout(t);this.#v=null}this.parent=null,this.#_?.destroy(),this.#_=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#x(),this.#l.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#l.children;if(!this.#e){this.#e=Array.from(e);const l=this.#z.bind(this),c=this.#K.bind(this),h=this._uiManager._signal;for(const d of this.#e){const p=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",l,{signal:h}),d.addEventListener("blur",c,{signal:h}),d.addEventListener("focus",this.#Y.bind(this,p),{signal:h}),d.setAttribute("data-l10n-id",Lt._l10nResizer[p])}}const n=this.#e[0];let i=0;for(const l of e){if(l===n)break;i++}const a=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(a!==i){if(a<i)for(let c=0;c<i-a;c++)this.#l.append(this.#l.firstChild);else if(a>i)for(let c=0;c<a-i;c++)this.#l.firstChild.before(this.#l.lastChild);let l=0;for(const c of e){const d=this.#e[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",Lt._l10nResizer[d])}}this.#W(0),this.#E=!0,this.#l.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#z(t){Lt._resizerKeyboardManager.exec(this,t)}#K(t){this.#E&&t.relatedTarget?.parentNode!==this.#l&&this.#B()}#Y(t){this.#f=this.#E?t:""}#W(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#E&&this.#k(this.#f,{deltaX:t,deltaY:e,fromKeyboard:!0})}#B(){this.#E=!1,this.#W(-1),this.#M()}_stopResizingWithKeyboard(){this.#B(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#l?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#h}set isEditing(t){this.#h=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#o=!0;const n=t/e,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#v||=new Map;const{action:n}=t;let i=this.#v.get(n);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(t),this.#v.delete(n),this.#v.size===0&&(this.#v=null)},Lt._telemetryTimeout),this.#v.set(n,i);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#s=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#s=!0}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class L6 extends Lt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const R_=3285377520,Fi=4294901760,wr=65535;class mR{constructor(t){this.h1=t?t&4294967295:R_,this.h2=t?t&4294967295:R_}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let T=0,S=t.length;T<S;T++){const C=t.charCodeAt(T);C<=255?e[n++]=C:(e[n++]=C>>>8,e[n++]=C&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=n>>2,a=n-i*4,l=new Uint32Array(e.buffer,0,i);let c=0,h=0,d=this.h1,p=this.h2;const m=3432918353,v=461845907,E=m&wr,b=v&wr;for(let T=0;T<i;T++)T&1?(c=l[T],c=c*m&Fi|c*E&wr,c=c<<15|c>>>17,c=c*v&Fi|c*b&wr,d^=c,d=d<<13|d>>>19,d=d*5+3864292196):(h=l[T],h=h*m&Fi|h*E&wr,h=h<<15|h>>>17,h=h*v&Fi|h*b&wr,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(c=0,a){case 3:c^=e[i*4+2]<<16;case 2:c^=e[i*4+1]<<8;case 1:c^=e[i*4],c=c*m&Fi|c*E&wr,c=c<<15|c>>>17,c=c*v&Fi|c*b&wr,i&1?d^=c:p^=c}this.h1=d,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Fi|t*36045&wr,e=e*4283543511&Fi|((e<<16|t>>>16)*2950163797&Fi)>>>16,t^=e>>>1,t=t*444984403&Fi|t*60499&wr,e=e*3301882366&Fi|((e<<16|t>>>16)*3120437893&Fi)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Ly=Object.freeze({map:null,hash:"",transfer:void 0});class n0{#t=!1;#e=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=this.#n.get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return this.#n.get(t)}remove(t){if(this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of this.#n.values())if(e instanceof Lt)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=this.#n.get(t);let i=!1;if(n!==void 0)for(const[a,l]of Object.entries(e))n[a]!==l&&(i=!0,n[a]=l);else i=!0,this.#n.set(t,e);i&&this.#i(),e instanceof Lt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#n.has(t)}get size(){return this.#n.size}#i(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new yR(this)}get serializable(){if(this.#n.size===0)return Ly;const t=new Map,e=new mR,n=[],i=Object.create(null);let a=!1;for(const[l,c]of this.#n){const h=c instanceof Lt?c.serialize(!1,i):c;h&&(t.set(l,h),e.update(`${l}:${JSON.stringify(h)}`),a||=!!h.bitmap)}if(a)for(const l of t.values())l.bitmap&&n.push(l.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:Ly}get editorStats(){let t=null;const e=new Map;for(const n of this.#n.values()){if(!(n instanceof Lt))continue;const i=n.telemetryFinalData;if(!i)continue;const{type:a}=i;e.has(a)||e.set(a,Object.getPrototypeOf(n).constructor),t||=Object.create(null);const l=t[a]||=new Map;for(const[c,h]of Object.entries(i)){if(c==="type")continue;let d=l.get(c);d||(d=new Map,l.set(c,d));const p=d.get(h)??0;d.set(h,p+1)}}for(const[n,i]of e)t[n]=i.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;const t=[];for(const e of this.#n.values())!(e instanceof Lt)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class yR extends n0{#t;constructor(t){super();const{map:e,hash:n,transfer:i}=t.serializable,a=structuredClone(e,i?{transfer:i}:null);this.#t={map:a,hash:n,transfer:i}}get print(){De("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return ee(this,"modifiedIds",{ids:new Set,hash:""})}}class k6{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:n}){if(!(!t||this.#t.has(t.loadedName))){if(un(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:a,style:l}=t,c=new FontFace(i,a,l);this.addNativeFontFace(c);try{await c.load(),this.#t.add(i),n?.(t)}catch{Gt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}De("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(i){throw Gt(`Failed to load font '${n.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const i=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,i)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return ee(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return ee(this,"isSyncFontLoadingSupported",Zn||Bn.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(un(!i.done,"completeRequest() cannot be called twice."),i.done=!0;n.length>0&&n[0].done;){const a=n.shift();setTimeout(a.callback,0)}}const{loadingRequests:n}=this,i={done:!1,complete:e,callback:t};return n.push(i),i}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ee(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(F,k){return F.charCodeAt(k)<<24|F.charCodeAt(k+1)<<16|F.charCodeAt(k+2)<<8|F.charCodeAt(k+3)&255}function i(F,k,z,P){const N=F.substring(0,k),M=F.substring(k+z);return N+P+M}let a,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let d=0;function p(F,k){if(++d>30){Gt("Load test font never loaded."),k();return}if(h.font="30px "+F,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){k();return}setTimeout(p.bind(null,F,k))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=i(v,976,m.length,m);const b=16,T=1482184792;let S=n(v,b);for(a=0,l=m.length-3;a<l;a+=4)S=S-T+n(m,a)|0;a<m.length&&(S=S-T+n(m+"XXX",a)|0),v=i(v,b,4,A6(S));const C=`url(data:font/opentype;base64,${btoa(v)});`,D=`@font-face {font-family:"${m}";src:${C}}`;this.insertRule(D);const O=this._document.createElement("div");O.style.visibility="hidden",O.style.width=O.style.height="10px",O.style.position="absolute",O.style.top=O.style.left="0px";for(const F of[t.loadedName,m]){const k=this._document.createElement("span");k.textContent="Hi",k.style.fontFamily=F,O.append(k)}this._document.body.append(O),p(m,()=>{O.remove(),e.complete()})}}class B6{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const n in t)this[n]=t[n];this._inspectFont=e}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${pR(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let i;try{i=t.get(n)}catch(l){Gt(`getPathGenerator - ignoring character: "${l}".`)}const a=new Path2D(i||"");return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=a}}function F6(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(Zn)return r;const t=URL.parse(r,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function U6(r){if(Zn&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return fh(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function tf(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const ky=r=>typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0,V6=r=>typeof r=="object"&&typeof r?.name=="string",j6=S6.bind(null,ky,V6);class H6{#t=new Map;#e=Promise.resolve();postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[i]of this.#t)i.call(this,n)})}addEventListener(t,e,n=null){let i=null;if(n?.signal instanceof AbortSignal){const{signal:a}=n;if(a.aborted){Gt("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,e);i=()=>a.removeEventListener("abort",l),a.addEventListener("abort",l)}this.#t.set(e,i)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const ef={DATA:1,ERROR:2},an={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function C_(){}function ci(r){if(r instanceof wa||r instanceof Ny||r instanceof __||r instanceof Yf||r instanceof Ym)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||De('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new wa(r.message);case"InvalidPDFException":return new Ny(r.message);case"PasswordException":return new __(r.message,r.code);case"ResponseException":return new Yf(r.message,r.status,r.missing);case"UnknownErrorException":return new Ym(r.message,r.details)}return new Ym(r.message,r.toString())}class Tu{#t=new AbortController;constructor(t,e,n){this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const n=t.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===ef.DATA)i.resolve(t.data);else if(t.callback===ef.ERROR)i.reject(ci(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,i=t.sourceName,a=this.comObj;Promise.try(e,t.data).then(function(l){a.postMessage({sourceName:n,targetName:i,callback:ef.DATA,callbackId:t.callbackId,data:l})},function(l){a.postMessage({sourceName:n,targetName:i,callback:ef.ERROR,callbackId:t.callbackId,reason:ci(l)})});return}if(t.streamId){this.#n(t);return}e(t.data)}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const i=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[i]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},n)}catch(l){a.reject(l)}return a.promise}sendWithStream(t,e,n,i){const a=this.streamId++,l=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:d=>{const p=Promise.withResolvers();return this.streamControllers[a]={controller:d,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:c,action:t,streamId:a,data:e,desiredSize:d.desiredSize},i),p.promise},pull:d=>{const p=Promise.withResolvers();return this.streamControllers[a].pullCall=p,h.postMessage({sourceName:l,targetName:c,stream:an.PULL,streamId:a,desiredSize:d.desiredSize}),p.promise},cancel:d=>{un(d instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[a].cancelCall=p,this.streamControllers[a].isClosed=!0,h.postMessage({sourceName:l,targetName:c,stream:an.CANCEL,streamId:a,reason:ci(d)}),p.promise}},n)}#n(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,a=this.comObj,l=this,c=this.actionHandler[t.action],h={enqueue(d,p=1,m){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=p,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:n,targetName:i,stream:an.ENQUEUE,streamId:e,chunk:d},m)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:i,stream:an.CLOSE,streamId:e}),delete l.streamSinks[e])},error(d){un(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:i,stream:an.ERROR,streamId:e,reason:ci(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(c,t.data,h).then(function(){a.postMessage({sourceName:n,targetName:i,stream:an.START_COMPLETE,streamId:e,success:!0})},function(d){a.postMessage({sourceName:n,targetName:i,stream:an.START_COMPLETE,streamId:e,reason:ci(d)})})}#i(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,a=this.comObj,l=this.streamControllers[e],c=this.streamSinks[e];switch(t.stream){case an.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(ci(t.reason));break;case an.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(ci(t.reason));break;case an.PULL:if(!c){a.postMessage({sourceName:n,targetName:i,stream:an.PULL_COMPLETE,streamId:e,success:!0});break}c.desiredSize<=0&&t.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=t.desiredSize,Promise.try(c.onPull||C_).then(function(){a.postMessage({sourceName:n,targetName:i,stream:an.PULL_COMPLETE,streamId:e,success:!0})},function(d){a.postMessage({sourceName:n,targetName:i,stream:an.PULL_COMPLETE,streamId:e,reason:ci(d)})});break;case an.ENQUEUE:if(un(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case an.CLOSE:if(un(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#s(l,e);break;case an.ERROR:un(l,"error should have stream controller"),l.controller.error(ci(t.reason)),this.#s(l,e);break;case an.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(ci(t.reason)),this.#s(l,e);break;case an.CANCEL:if(!c)break;const h=ci(t.reason);Promise.try(c.onCancel||C_,h).then(function(){a.postMessage({sourceName:n,targetName:i,stream:an.CANCEL_COMPLETE,streamId:e,success:!0})},function(d){a.postMessage({sourceName:n,targetName:i,stream:an.CANCEL_COMPLETE,streamId:e,reason:ci(d)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#s(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class vR{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){De("Abstract method `_createCanvas` called.")}}class z6 extends vR{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}class ER{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){De("Abstract method `_fetch` called.")}}class I_ extends ER{async _fetch(t){const e=await ph(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):fh(e)}}Qt(2489);class AR{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,i,a){return"none"}destroy(t=!1){}}class G6 extends AR{#t;#e;#n;#i;#s;#r;#a=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#i=t,this.#s=e}get#o(){return this.#e||=new Map}get#l(){return this.#r||=new Map}get#c(){if(!this.#n){const t=this.#s.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const n=this.#s.createElementNS(ds,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#n=this.#s.createElementNS(ds,"defs"),t.append(n),n.append(this.#n),this.#s.body.append(t)}return this.#n}#d(t){if(t.length===1){const h=t[0],d=new Array(256);for(let m=0;m<256;m++)d[m]=h[m]/255;const p=d.join(",");return[p,p,p]}const[e,n,i]=t,a=new Array(256),l=new Array(256),c=new Array(256);for(let h=0;h<256;h++)a[h]=e[h]/255,l[h]=n[h]/255,c[h]=i[h]/255;return[a.join(","),l.join(","),c.join(",")]}#u(t){if(this.#t===void 0){this.#t="";const e=this.#s.URL;e!==this.#s.baseURI&&(Ap(e)?Gt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=hR(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[n,i,a]=this.#d(t),l=t.length===1?n:`${n}${i}${a}`;if(e=this.#o.get(l),e)return this.#o.set(t,e),e;const c=`g_${this.#i}_transfer_map_${this.#a++}`,h=this.#u(c);this.#o.set(t,h),this.#o.set(l,h);const d=this.#p(c);return this.#m(n,i,a,d),h}addHCMFilter(t,e){const n=`${t}-${e}`,i="base";let a=this.#l.get(i);if(a?.key===n||(a?(a.filter?.remove(),a.key=n,a.url="none",a.filter=null):(a={key:n,url:"none",filter:null},this.#l.set(i,a)),!t||!e))return a.url;const l=this.#y(t);t=Nt.makeHexColor(...l);const c=this.#y(e);if(e=Nt.makeHexColor(...c),this.#c.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return a.url;const h=new Array(256);for(let E=0;E<=255;E++){const b=E/255;h[E]=b<=.03928?b/12.92:((b+.055)/1.055)**2.4}const d=h.join(","),p=`g_${this.#i}_hcm_filter`,m=a.filter=this.#p(p);this.#m(d,d,d,m),this.#g(m);const v=(E,b)=>{const T=l[E]/255,S=c[E]/255,C=new Array(b+1);for(let D=0;D<=b;D++)C[D]=T+D/b*(S-T);return C.join(",")};return this.#m(v(0,5),v(1,5),v(2,5),m),a.url=this.#u(p),a.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[n]=this.#d([t]),i=`alpha_${n}`;if(e=this.#o.get(i),e)return this.#o.set(t,e),e;const a=`g_${this.#i}_alpha_map_${this.#a++}`,l=this.#u(a);this.#o.set(t,l),this.#o.set(i,l);const c=this.#p(a);return this.#E(n,c),l}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let n,i;if(t?([n]=this.#d([t]),i=`luminosity_${n}`):i="luminosity",e=this.#o.get(i),e)return this.#o.set(t,e),e;const a=`g_${this.#i}_luminosity_map_${this.#a++}`,l=this.#u(a);this.#o.set(t,l),this.#o.set(i,l);const c=this.#p(a);return this.#f(c),t&&this.#E(n,c),l}addHighlightHCMFilter(t,e,n,i,a){const l=`${e}-${n}-${i}-${a}`;let c=this.#l.get(t);if(c?.key===l||(c?(c.filter?.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},this.#l.set(t,c)),!e||!n))return c.url;const[h,d]=[e,n].map(this.#y.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),m=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[v,E]=[i,a].map(this.#y.bind(this));m<p&&([p,m,v,E]=[m,p,E,v]),this.#c.style.color="";const b=(C,D,O)=>{const F=new Array(256),k=(m-p)/O,z=C/255,P=(D-C)/(255*O);let N=0;for(let M=0;M<=O;M++){const V=Math.round(p+M*k),H=z+M*P;for(let $=N;$<=V;$++)F[$]=H;N=V+1}for(let M=N;M<256;M++)F[M]=F[N-1];return F.join(",")},T=`g_${this.#i}_hcm_${t}_filter`,S=c.filter=this.#p(T);return this.#g(S),this.#m(b(v[0],E[0],5),b(v[1],E[1],5),b(v[2],E[2],5),S),c.url=this.#u(T),c.url}destroy(t=!1){t&&this.#r?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#r?.clear(),this.#r=null,this.#a=0)}#f(t){const e=this.#s.createElementNS(ds,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#g(t){const e=this.#s.createElementNS(ds,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#s.createElementNS(ds,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#c.append(e),e}#h(t,e,n){const i=this.#s.createElementNS(ds,e);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),t.append(i)}#m(t,e,n,i){const a=this.#s.createElementNS(ds,"feComponentTransfer");i.append(a),this.#h(a,"feFuncR",t),this.#h(a,"feFuncG",e),this.#h(a,"feFuncB",n)}#E(t,e){const n=this.#s.createElementNS(ds,"feComponentTransfer");e.append(n),this.#h(n,"feFuncA",t)}#y(t){return this.#c.style.color=t,bp(getComputedStyle(this.#c).getPropertyValue("color"))}}class bR{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){De("Abstract method `_fetch` called.")}}class x_ extends bR{async _fetch(t){const e=await ph(t,"arraybuffer");return new Uint8Array(e)}}class TR{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){De("Abstract method `_fetch` called.")}}class D_ extends TR{async _fetch(t){const e=await ph(t,"arraybuffer");return new Uint8Array(e)}}if(Zn){let r;try{const t=process.getBuiltinModule("module").createRequire(import.meta.url);try{r=t("@napi-rs/canvas")}catch(e){Gt(`Cannot load "@napi-rs/canvas" package: "${e}".`)}}catch(t){Gt(`Cannot access the \`require\` function: "${t}".`)}globalThis.DOMMatrix||(r?.DOMMatrix?globalThis.DOMMatrix=r.DOMMatrix:Gt("Cannot polyfill `DOMMatrix`, rendering may be broken.")),globalThis.ImageData||(r?.ImageData?globalThis.ImageData=r.ImageData:Gt("Cannot polyfill `ImageData`, rendering may be broken.")),globalThis.Path2D||(r?.Path2D?globalThis.Path2D=r.Path2D:Gt("Cannot polyfill `Path2D`, rendering may be broken.")),globalThis.navigator?.language||(globalThis.navigator={language:"en-US",platform:"",userAgent:""})}async function i0(r){const e=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(e)}class $6 extends AR{}class Y6 extends vR{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class W6 extends ER{async _fetch(t){return i0(t)}}class K6 extends bR{async _fetch(t){return i0(t)}}class X6 extends TR{async _fetch(t){return i0(t)}}Qt(7588);const Al="__forcedDependency";class q6{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[Al]:[]};#n=new Map;#i=[];#s=[];#r=[[1,0,0,1,0,0]];#a=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#l=-1;#c=new Set;#d=new Map;#u=new Map;#f;#g;constructor(t){this.#f=t.width,this.#g=t.height}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[Al]:{__proto__:this.#e[Al]}},this.#a={__proto__:this.#a},this.#i.push([t,null]),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#a=Object.getPrototypeOf(this.#a);const n=this.#i.pop();return n!==void 0&&(n[1]=t),this}recordOpenMarker(t){return this.#i.push([t,null]),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)[0]}recordCloseMarker(t){const e=this.#i.pop();return e!==void 0&&(e[1]=t),this}beginMarkedContent(t){return this.#s.push([t,null]),this}endMarkedContent(t){const e=this.#s.pop();return e!==void 0&&(e[1]=t),this}pushBaseTransform(t){return this.#r.push(Nt.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#n.set(t,e),this}recordFutureForcedDependency(t,e){return this.recordIncrementalData(Al,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#c)this.recordFutureForcedDependency(Al,t);return this}resetBBox(t){return this.#l=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0,this}get hasPendingBBox(){return this.#l!==-1}recordClipBox(t,e,n,i,a,l){const c=Nt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform()),h=[1/0,1/0,-1/0,-1/0];Nt.axialAlignedBoundingBox([n,a,i,l],c,h);const d=Nt.intersect(this.#a,h);return d?(this.#a[0]=d[0],this.#a[1]=d[1],this.#a[2]=d[2],this.#a[3]=d[3]):(this.#a[0]=this.#a[1]=1/0,this.#a[2]=this.#a[3]=-1/0),this}recordBBox(t,e,n,i,a,l){const c=this.#a;if(c[0]===1/0)return this;const h=Nt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform());if(c[0]===-1/0)return Nt.axialAlignedBoundingBox([n,a,i,l],h,this.#o),this;const d=[1/0,1/0,-1/0,-1/0];return Nt.axialAlignedBoundingBox([n,a,i,l],h,d),this.#o[0]=Math.min(this.#o[0],Math.max(d[0],c[0])),this.#o[1]=Math.min(this.#o[1],Math.max(d[1],c[1])),this.#o[2]=Math.max(this.#o[2],Math.min(d[2],c[2])),this.#o[3]=Math.max(this.#o[3],Math.min(d[3],c[3])),this}recordCharacterBBox(t,e,n,i=1,a=0,l=0,c){const h=n.bbox;let d,p;if(h&&(d=h[2]!==h[0]&&h[3]!==h[1]&&this.#u.get(n),d!==!1&&(p=[0,0,0,0],Nt.axialAlignedBoundingBox(h,n.fontMatrix,p),(i!==1||a!==0||l!==0)&&Nt.scaleMinMax([i,0,0,-i,a,l],p),d)))return this.recordBBox(t,e,p[0],p[2],p[1],p[3]);if(!c)return this.recordFullPageBBox(t);const m=c();return h&&p&&d===void 0&&(d=p[0]<=a-m.actualBoundingBoxLeft&&p[2]>=a+m.actualBoundingBoxRight&&p[1]<=l-m.actualBoundingBoxAscent&&p[3]>=l+m.actualBoundingBoxDescent,this.#u.set(n,d),d)?this.recordBBox(t,e,p[0],p[2],p[1],p[3]):this.recordBBox(t,e,a-m.actualBoundingBoxLeft,a+m.actualBoundingBoxRight,l-m.actualBoundingBoxAscent,l+m.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#a[0]),this.#o[1]=Math.max(0,this.#a[1]),this.#o[2]=Math.min(this.#f,this.#a[2]),this.#o[3]=Math.min(this.#g,this.#a[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const n=this.#c,i=this.#t,a=this.#e;for(const l of e)l in this.#t?n.add(i[l]):l in a&&a[l].forEach(n.add,n);return this}copyDependenciesFromIncrementalOperation(t,e){const n=this.#d,i=this.#c;for(const a of this.#e[e])n.get(a).dependencies.forEach(i.add,i.add(a));return this}recordNamedDependency(t,e){return this.#n.has(e)&&this.#c.add(this.#n.get(e)),this}recordOperation(t,e=!1){this.recordDependencies(t,[Al]);const n=new Set(this.#c),i=this.#i.concat(this.#s),a=this.#l===t?{minX:this.#o[0],minY:this.#o[1],maxX:this.#o[2],maxY:this.#o[3]}:null;return this.#d.set(t,{bbox:a,pairs:i,dependencies:n}),e||(this.#l=-1),this.#c.clear(),this}bboxToClipBoxDropOperation(t){return this.#l!==-1&&(this.#l=-1,this.#a[0]=Math.max(this.#a[0],this.#o[0]),this.#a[1]=Math.max(this.#a[1],this.#o[1]),this.#a[2]=Math.min(this.#a[2],this.#o[2]),this.#a[3]=Math.min(this.#a[3],this.#o[3])),this.#c.clear(),this}_takePendingDependencies(){const t=this.#c;return this.#c=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#c.add(e)}take(){return this.#u.clear(),Array.from(this.#d,([t,{bbox:e,pairs:n,dependencies:i}])=>(n.forEach(a=>a.forEach(i.add,i)),i.delete(t),{minX:(e?.minX??0)/this.#f,maxX:(e?.maxX??this.#f)/this.#f,minY:(e?.minY??0)/this.#g,maxY:(e?.maxY??this.#g)/this.#g,dependencies:Array.from(i).sort((a,l)=>a-l),idx:t}))}}class Wf{#t;#e;#n=0;#i;#s=0;constructor(t,e){if(t instanceof Wf)return t;this.#t=t,this.#i=t._takePendingDependencies(),this.#e=e}save(t){return this.#s++,this.#t.save(this.#e),this}restore(t){return this.#s>0&&(this.#t.restore(this.#e),this.#s--),this}recordOpenMarker(t){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#n--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#t.hasPendingBBox||this.#t.resetBBox(this.#e),this}get hasPendingBBox(){return this.#t.hasPendingBBox}recordClipBox(t,e,n,i,a,l){return this.#t.recordClipBox(this.#e,e,n,i,a,l),this}recordBBox(t,e,n,i,a,l){return this.#t.recordBBox(this.#e,e,n,i,a,l),this}recordCharacterBBox(t,e,n,i,a,l,c){return this.#t.recordCharacterBBox(this.#e,e,n,i,a,l,c),this}recordFullPageBBox(t){return this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}copyDependenciesFromIncrementalOperation(t,e){return this.#t.copyDependenciesFromIncrementalOperation(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){this.#t.recordOperation(this.#e,!0);const e=this.#t._extractOperation(this.#e);for(const n of e.dependencies)this.#i.add(n);return this.#i.delete(this.#e),this.#i.delete(null),this}bboxToClipBoxDropOperation(t){return this.#t.bboxToClipBoxDropOperation(this.#e),this}recordNestedDependencies(){this.#t._pushPendingDependencies(this.#i)}take(){throw new Error("Unreachable")}}const Ui={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation"],transform:["transform"],transformAndFill:["transform","fillColor"]},Ln={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function By(r,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],e,n),r.clip(i)}class r0{isModifyingCurrentTransform(){return!1}getPattern(){De("Abstract method `getPattern` called.")}}class Q6 extends r0{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)e.addColorStop(n[0],n[1]);return e}getPattern(t,e,n,i){let a;if(i===Ln.STROKE||i===Ln.FILL){const l=e.current.getClippedPathBoundingBox(i,je(t))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,d=e.cachedCanvases.getCanvas("pattern",c,h),p=d.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-l[0],-l[1]),n=Nt.transform(n,[1,0,0,1,l[0],l[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),By(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),a=t.createPattern(d.canvas,"no-repeat");const m=new DOMMatrix(n);a.setTransform(m)}else By(t,this._bbox),a=this._createGradient(t);return a}}function Xm(r,t,e,n,i,a,l,c){const h=t.coords,d=t.colors,p=r.data,m=r.width*4;let v;h[e+1]>h[n+1]&&(v=e,e=n,n=v,v=a,a=l,l=v),h[n+1]>h[i+1]&&(v=n,n=i,i=v,v=l,l=c,c=v),h[e+1]>h[n+1]&&(v=e,e=n,n=v,v=a,a=l,l=v);const E=(h[e]+t.offsetX)*t.scaleX,b=(h[e+1]+t.offsetY)*t.scaleY,T=(h[n]+t.offsetX)*t.scaleX,S=(h[n+1]+t.offsetY)*t.scaleY,C=(h[i]+t.offsetX)*t.scaleX,D=(h[i+1]+t.offsetY)*t.scaleY;if(b>=D)return;const O=d[a],F=d[a+1],k=d[a+2],z=d[l],P=d[l+1],N=d[l+2],M=d[c],V=d[c+1],H=d[c+2],$=Math.round(b),j=Math.round(D);let Tt,St,X,Z,ht,Rt,W,lt;for(let q=$;q<=j;q++){if(q<S){const ft=q<b?0:(b-q)/(b-S);Tt=E-(E-T)*ft,St=O-(O-z)*ft,X=F-(F-P)*ft,Z=k-(k-N)*ft}else{let ft;q>D?ft=1:S===D?ft=0:ft=(S-q)/(S-D),Tt=T-(T-C)*ft,St=z-(z-M)*ft,X=P-(P-V)*ft,Z=N-(N-H)*ft}let it;q<b?it=0:q>D?it=1:it=(b-q)/(b-D),ht=E-(E-C)*it,Rt=O-(O-M)*it,W=F-(F-V)*it,lt=k-(k-H)*it;const yt=Math.round(Math.min(Tt,ht)),_t=Math.round(Math.max(Tt,ht));let ut=m*q+yt*4;for(let ft=yt;ft<=_t;ft++)it=(Tt-ft)/(Tt-ht),it<0?it=0:it>1&&(it=1),p[ut++]=St-(St-Rt)*it|0,p[ut++]=X-(X-W)*it|0,p[ut++]=Z-(Z-lt)*it|0,p[ut++]=255}}function J6(r,t,e){const n=t.coords,i=t.colors;let a,l;switch(t.type){case"lattice":const c=t.verticesPerRow,h=Math.floor(n.length/c)-1,d=c-1;for(a=0;a<h;a++){let p=a*c;for(let m=0;m<d;m++,p++)Xm(r,e,n[p],n[p+1],n[p+c],i[p],i[p+1],i[p+c]),Xm(r,e,n[p+c+1],n[p+1],n[p+c],i[p+c+1],i[p+1],i[p+c])}break;case"triangles":for(a=0,l=n.length;a<l;a+=3)Xm(r,e,n[a],n[a+1],n[a+2],i[a],i[a+1],i[a+2]);break;default:throw new Error("illegal figure")}}class Z6 extends r0{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,n){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-c,p=Math.ceil(this._bounds[3])-h,m=Math.min(Math.ceil(Math.abs(d*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),E=d/m,b=p/v,T={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/E,scaleY:1/b},S=m+4,C=v+4,D=n.getCanvas("mesh",S,C),O=D.context,F=O.createImageData(m,v);if(e){const z=F.data;for(let P=0,N=z.length;P<N;P+=4)z[P]=e[0],z[P+1]=e[1],z[P+2]=e[2],z[P+3]=255}for(const z of this._figures)J6(F,z,T);return O.putImageData(F,2,2),{canvas:D.canvas,offsetX:c-2*E,offsetY:h-2*b,scaleX:E,scaleY:b}}isModifyingCurrentTransform(){return!0}getPattern(t,e,n,i){By(t,this._bbox);const a=new Float32Array(2);if(i===Ln.SHADING)Nt.singularValueDecompose2dScale(je(t),a);else if(this.matrix){Nt.singularValueDecompose2dScale(this.matrix,a);const[c,h]=a;Nt.singularValueDecompose2dScale(e.baseTransform,a),a[0]*=c,a[1]*=h}else Nt.singularValueDecompose2dScale(e.baseTransform,a);const l=this._createMeshCanvas(a,i===Ln.SHADING?null:this._background,e.cachedCanvases);return i!==Ln.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class tB extends r0{getPattern(){return"hotpink"}}function eB(r){switch(r[0]){case"RadialAxial":return new Q6(r);case"Mesh":return new Z6(r);case"Dummy":return new tB}throw new Error(`Unknown IR type: ${r[0]}`)}const O_={COLORED:1,UNCOLORED:2};class s0{static MAX_PATTERN_SIZE=3e3;constructor(t,e,n,i){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:i,tilingType:a,color:l,canvasGraphicsFactory:c}=this;let{xstep:h,ystep:d}=this;h=Math.abs(h),d=Math.abs(d),Ep("TilingType: "+a);const p=e[0],m=e[1],v=e[2],E=e[3],b=v-p,T=E-m,S=new Float32Array(2);Nt.singularValueDecompose2dScale(this.matrix,S);const[C,D]=S;Nt.singularValueDecompose2dScale(this.baseTransform,S);const O=C*S[0],F=D*S[1];let k=b,z=T,P=!1,N=!1;const M=Math.ceil(h*O),V=Math.ceil(d*F),H=Math.ceil(b*O),$=Math.ceil(T*F);M>=H?k=h:P=!0,V>=$?z=d:N=!0;const j=this.getSizeAndScale(k,this.ctx.canvas.width,O),Tt=this.getSizeAndScale(z,this.ctx.canvas.height,F),St=t.cachedCanvases.getCanvas("pattern",j.size,Tt.size),X=St.context,Z=c.createCanvasGraphics(X);if(Z.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(Z,i,l),X.translate(-j.scale*p,-Tt.scale*m),Z.transform(0,j.scale,0,0,Tt.scale,0,0),X.save(),Z.dependencyTracker?.save(),this.clipBbox(Z,p,m,v,E),Z.baseTransform=je(Z.ctx),Z.executeOperatorList(n),Z.endDrawing(),Z.dependencyTracker?.restore().recordNestedDependencies?.(),X.restore(),P||N){const ht=St.canvas;P&&(k=h),N&&(z=d);const Rt=this.getSizeAndScale(k,this.ctx.canvas.width,O),W=this.getSizeAndScale(z,this.ctx.canvas.height,F),lt=Rt.size,q=W.size,it=t.cachedCanvases.getCanvas("pattern-workaround",lt,q),yt=it.context,_t=P?Math.floor(b/h):0,ut=N?Math.floor(T/d):0;for(let ft=0;ft<=_t;ft++)for(let pt=0;pt<=ut;pt++)yt.drawImage(ht,lt*ft,q*pt,lt,q,0,0,lt,q);return{canvas:it.canvas,scaleX:Rt.scale,scaleY:W.scale,offsetX:p,offsetY:m}}return{canvas:St.canvas,scaleX:j.scale,scaleY:Tt.scale,offsetX:p,offsetY:m}}getSizeAndScale(t,e,n){const i=Math.max(s0.MAX_PATTERN_SIZE,e);let a=Math.ceil(t*n);return a>=i?a=i:n=a/t,{scale:n,size:a}}clipBbox(t,e,n,i,a){const l=i-e,c=a-n;t.ctx.rect(e,n,l,c),Nt.axialAlignedBoundingBox([e,n,i,a],je(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const i=t.ctx,a=t.current;switch(e){case O_.COLORED:const{fillStyle:l,strokeStyle:c}=this.ctx;i.fillStyle=a.fillColor=l,i.strokeStyle=a.strokeColor=c;break;case O_.UNCOLORED:i.fillStyle=i.strokeStyle=n,a.fillColor=a.strokeColor=n;break;default:throw new E6(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,n,i){let a=n;i!==Ln.SHADING&&(a=Nt.transform(a,e.baseTransform),this.matrix&&(a=Nt.transform(a,this.matrix)));const l=this.createPatternCanvas(e);let c=new DOMMatrix(a);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const h=t.createPattern(l.canvas,"repeat");return h.setTransform(c),h}}function nB({src:r,srcPos:t=0,dest:e,width:n,height:i,nonBlackColor:a=4294967295,inverseDecode:l=!1}){const c=Bn.isLittleEndian?4278190080:255,[h,d]=l?[a,c]:[c,a],p=n>>3,m=n&7,v=r.length;e=new Uint32Array(e.buffer);let E=0;for(let b=0;b<i;b++){for(const S=t+p;t<S;t++){const C=t<v?r[t]:255;e[E++]=C&128?d:h,e[E++]=C&64?d:h,e[E++]=C&32?d:h,e[E++]=C&16?d:h,e[E++]=C&8?d:h,e[E++]=C&4?d:h,e[E++]=C&2?d:h,e[E++]=C&1?d:h}if(m===0)continue;const T=t<v?r[t++]:255;for(let S=0;S<m;S++)e[E++]=T&1<<7-S?d:h}return{srcPos:t,destPos:E}}const N_=16,P_=100,iB=15,M_=10,ui=16,qm=new DOMMatrix,wi=new Float32Array(2),Ol=new Float32Array([1/0,1/0,-1/0,-1/0]);function rB(r,t){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){t.save(),this.__originalSave()},r.restore=function(){t.restore(),this.__originalRestore()},r.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},r.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},r.transform=function(e,n,i,a,l,c){t.transform(e,n,i,a,l,c),this.__originalTransform(e,n,i,a,l,c)},r.setTransform=function(e,n,i,a,l,c){t.setTransform(e,n,i,a,l,c),this.__originalSetTransform(e,n,i,a,l,c)},r.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},r.rotate=function(e){t.rotate(e),this.__originalRotate(e)},r.clip=function(e){t.clip(e),this.__originalClip(e)},r.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},r.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},r.bezierCurveTo=function(e,n,i,a,l,c){t.bezierCurveTo(e,n,i,a,l,c),this.__originalBezierCurveTo(e,n,i,a,l,c)},r.rect=function(e,n,i,a){t.rect(e,n,i,a),this.__originalRect(e,n,i,a)},r.closePath=function(){t.closePath(),this.__originalClosePath()},r.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class sB{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let i;return this.cache[t]!==void 0?(i=this.cache[t],this.canvasFactory.reset(i,e,n)):(i=this.canvasFactory.create(e,n),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function nf(r,t,e,n,i,a,l,c,h,d){const[p,m,v,E,b,T]=je(r);if(m===0&&v===0){const D=l*p+b,O=Math.round(D),F=c*E+T,k=Math.round(F),z=(l+h)*p+b,P=Math.abs(Math.round(z)-O)||1,N=(c+d)*E+T,M=Math.abs(Math.round(N)-k)||1;return r.setTransform(Math.sign(p),0,0,Math.sign(E),O,k),r.drawImage(t,e,n,i,a,0,0,P,M),r.setTransform(p,m,v,E,b,T),[P,M]}if(p===0&&E===0){const D=c*v+b,O=Math.round(D),F=l*m+T,k=Math.round(F),z=(c+d)*v+b,P=Math.abs(Math.round(z)-O)||1,N=(l+h)*m+T,M=Math.abs(Math.round(N)-k)||1;return r.setTransform(0,Math.sign(m),Math.sign(v),0,O,k),r.drawImage(t,e,n,i,a,0,0,M,P),r.setTransform(p,m,v,E,b,T),[M,P]}r.drawImage(t,e,n,i,a,l,c,h,d);const S=Math.hypot(p,m),C=Math.hypot(v,E);return[S*h,C*d]}class L_{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Oy;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Nn.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,n){n?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Ol.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Ln.FILL,e=null){const n=this.minMax.slice();if(t===Ln.STROKE){e||De("Stroke bounding box must include transform."),Nt.singularValueDecompose2dScale(e,wi);const i=wi[0]*this.lineWidth/2,a=wi[1]*this.lineWidth/2;n[0]-=i,n[1]-=a,n[2]+=i,n[3]+=a}return n}updateClipFromPath(){const t=Nt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Ol,0)}getClippedPathBoundingBox(t=Ln.FILL,e=null){return Nt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function k_(r,t){if(t instanceof ImageData){r.putImageData(t,0,0);return}const e=t.height,n=t.width,i=e%ui,a=(e-i)/ui,l=i===0?a:a+1,c=r.createImageData(n,ui);let h=0,d;const p=t.data,m=c.data;let v,E,b,T;if(t.kind===Af.GRAYSCALE_1BPP){const S=p.byteLength,C=new Uint32Array(m.buffer,0,m.byteLength>>2),D=C.length,O=n+7>>3,F=4294967295,k=Bn.isLittleEndian?4278190080:255;for(v=0;v<l;v++){for(b=v<a?ui:i,d=0,E=0;E<b;E++){const z=S-h;let P=0;const N=z>O?n:z*8-7,M=N&-8;let V=0,H=0;for(;P<M;P+=8)H=p[h++],C[d++]=H&128?F:k,C[d++]=H&64?F:k,C[d++]=H&32?F:k,C[d++]=H&16?F:k,C[d++]=H&8?F:k,C[d++]=H&4?F:k,C[d++]=H&2?F:k,C[d++]=H&1?F:k;for(;P<N;P++)V===0&&(H=p[h++],V=128),C[d++]=H&V?F:k,V>>=1}for(;d<D;)C[d++]=0;r.putImageData(c,0,v*ui)}}else if(t.kind===Af.RGBA_32BPP){for(E=0,T=n*ui*4,v=0;v<a;v++)m.set(p.subarray(h,h+T)),h+=T,r.putImageData(c,0,E),E+=ui;v<l&&(T=n*i*4,m.set(p.subarray(h,h+T)),r.putImageData(c,0,E))}else if(t.kind===Af.RGB_24BPP)for(b=ui,T=n*b,v=0;v<l;v++){for(v>=a&&(b=i,T=n*b),d=0,E=T;E--;)m[d++]=p[h++],m[d++]=p[h++],m[d++]=p[h++],m[d++]=255;r.putImageData(c,0,v*ui)}else throw new Error(`bad image kind: ${t.kind}`)}function B_(r,t){if(t.bitmap){r.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,i=e%ui,a=(e-i)/ui,l=i===0?a:a+1,c=r.createImageData(n,ui);let h=0;const d=t.data,p=c.data;for(let m=0;m<l;m++){const v=m<a?ui:i;({srcPos:h}=nB({src:d,srcPos:h,dest:p,width:n,height:v,nonBlackColor:0})),r.putImageData(c,0,m*ui)}}function cu(r,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)r[n]!==void 0&&(t[n]=r[n]);r.setLineDash!==void 0&&(t.setLineDash(r.getLineDash()),t.lineDashOffset=r.lineDashOffset)}function rf(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:t}=r;t!=="none"&&t!==""&&(r.filter="none")}function F_(r,t){if(t)return!0;Nt.singularValueDecompose2dScale(r,wi);const e=Math.fround(Br.pixelRatio*$l.PDF_TO_CSS_UNITS);return wi[0]<=e&&wi[1]<=e}const aB=["butt","round","square"],oB=["miter","round","bevel"],lB={},U_={};class Bl{constructor(t,e,n,i,a,{optionalContentConfig:l,markedContentStack:c=null},h,d,p){this.ctx=t,this.current=new L_(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=i,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new sB(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,e,n=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):n}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:i=null}){const a=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,a,l),this.ctx.fillStyle=c,n){const h=this.cachedCanvases.getCanvas("transparent",a,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...je(this.compositeCtx))}this.ctx.save(),rf(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=je(this.ctx)}executeOperatorList(t,e,n,i,a){const l=t.argsArray,c=t.fnArray;let h=e||0;const d=l.length;if(d===h)return h;const p=d-h>M_&&typeof n=="function",m=p?Date.now()+iB:0;let v=0;const E=this.commonObjs,b=this.objs;let T,S;for(;;){if(i!==void 0&&h===i.nextBreakPoint)return i.breakIt(h,n),h;if(!a||a.has(h))if(T=c[h],S=l[h]??null,T!==Wu.dependency)S===null?this[T](h):this[T](h,...S);else for(const C of S){this.dependencyTracker?.recordNamedData(C,h);const D=C.startsWith("g_")?E:b;if(!D.has(C))return D.get(C,n),h}if(h++,h===d)return h;if(p&&++v>M_){if(Date.now()>m)return n(),h;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const n=t.width??t.displayWidth,i=t.height??t.displayHeight;let a=Math.max(Math.hypot(e[0],e[1]),1),l=Math.max(Math.hypot(e[2],e[3]),1),c=n,h=i,d="prescale1",p,m;for(;a>2&&c>1||l>2&&h>1;){let v=c,E=h;a>2&&c>1&&(v=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),a/=c/v),l>2&&h>1&&(E=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/E),p=this.cachedCanvases.getCanvas(d,v,E),m=p.context,m.clearRect(0,0,v,E),m.drawImage(t,0,0,c,h,0,0,v,E),t=p.canvas,c=v,h=E,d=d==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:c,paintHeight:h}}_createMaskCanvas(t,e){const n=this.ctx,{width:i,height:a}=e,l=this.current.fillColor,c=this.current.patternFill,h=je(n);let d,p,m,v;if((e.bitmap||e.data)&&e.count>1){const V=e.bitmap||e.data.buffer;p=JSON.stringify(c?h:[h.slice(0,4),l]),d=this._cachedBitmapsMap.get(V),d||(d=new Map,this._cachedBitmapsMap.set(V,d));const H=d.get(p);if(H&&!c){const $=Math.round(Math.min(h[0],h[2])+h[4]),j=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,Ui.transformAndFill),{canvas:H,offsetX:$,offsetY:j}}m=H}m||(v=this.cachedCanvases.getCanvas("maskCanvas",i,a),B_(v.context,e));let E=Nt.transform(h,[1/i,0,0,-1/a,0,0]);E=Nt.transform(E,[1,0,0,1,0,-a]);const b=Ol.slice();Nt.axialAlignedBoundingBox([0,0,i,a],E,b);const[T,S,C,D]=b,O=Math.round(C-T)||1,F=Math.round(D-S)||1,k=this.cachedCanvases.getCanvas("fillCanvas",O,F),z=k.context,P=T,N=S;z.translate(-P,-N),z.transform(...E),m||(m=this._scaleImage(v.canvas,_r(z)),m=m.img,d&&c&&d.set(p,m)),z.imageSmoothingEnabled=F_(je(z),e.interpolate),nf(z,m,0,0,m.width,m.height,0,0,i,a),z.globalCompositeOperation="source-in";const M=Nt.transform(_r(z),[1,0,0,1,-P,-N]);return z.fillStyle=c?l.getPattern(n,this,M,Ln.FILL):l,z.fillRect(0,0,i,a),d&&!c&&(this.cachedCanvases.delete("fillCanvas"),d.set(p,k.canvas)),this.dependencyTracker?.recordDependencies(t,Ui.transformAndFill),{canvas:k.canvas,offsetX:Math.round(P),offsetY:Math.round(N)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=aB[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=oB[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,n){this.dependencyTracker?.recordSimpleData("dash",t);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=n)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[n,i]of e)switch(n){case"LW":this.setLineWidth(t,i);break;case"LC":this.setLineCap(t,i);break;case"LJ":this.setLineJoin(t,i);break;case"ML":this.setMiterLimit(t,i);break;case"D":this.setDash(t,i[0],i[1]);break;case"RI":this.setRenderingIntent(t,i);break;case"FL":this.setFlatness(t,i);break;case"Font":this.setFont(t,i[0],i[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=i;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=i;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=i;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,n=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(i,e,n);this.suspendedCtx=this.ctx;const l=this.ctx=a.context;l.setTransform(this.suspendedCtx.getTransform()),cu(this.suspendedCtx,l),rB(l,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),cu(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,i){const a=i[0],l=i[1],c=i[2]-a,h=i[3]-l;c===0||h===0||(this.genericComposeSMask(e.context,n,c,h,e.subtype,e.backdrop,e.transferMap,a,l,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,i,a,l,c,h,d,p,m){let v=t.canvas,E=h-p,b=d-m;if(l)if(E<0||b<0||E+n>v.width||b+i>v.height){const S=this.cachedCanvases.getCanvas("maskExtension",n,i),C=S.context;C.drawImage(v,-E,-b),C.globalCompositeOperation="destination-atop",C.fillStyle=l,C.fillRect(0,0,n,i),C.globalCompositeOperation="source-over",v=S.canvas,E=b=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const S=new Path2D;S.rect(E,b,n,i),t.clip(S),t.globalCompositeOperation="destination-atop",t.fillStyle=l,t.fillRect(E,b,n,i),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),a==="Alpha"&&c?e.filter=this.filterFactory.addAlphaFilter(c):a==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(c));const T=new Path2D;T.rect(h,d,n,i),e.clip(T),e.globalCompositeOperation="destination-in",e.drawImage(v,E,b,n,i,h,d,n,i),e.restore()}save(t){this.inSMaskMode&&cu(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&cu(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,n,i,a,l,c){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,n,i,a,l,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n,i){let[a]=n;if(!i){a||=n[0]=new Path2D,this[e](t,a);return}if(this.dependencyTracker!==null){const l=e===Wu.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,i[0]-l,i[2]+l,i[1]-l,i[3]+l).recordDependencies(t,["transform"])}if(!(a instanceof Path2D)){const l=n[0]=new Path2D;for(let c=0,h=a.length;c<h;)switch(a[c++]){case Jd.moveTo:l.moveTo(a[c++],a[c++]);break;case Jd.lineTo:l.lineTo(a[c++],a[c++]);break;case Jd.curveTo:l.bezierCurveTo(a[c++],a[c++],a[c++],a[c++],a[c++],a[c++]);break;case Jd.closePath:l.closePath();break;default:Gt(`Unrecognized drawing path operator: ${a[c-1]}`);break}a=l}Nt.axialAlignedBoundingBox(i,je(this.ctx),this.current.minMax),this[e](t,a),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,n=!0){const i=this.ctx,a=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&a?.getPattern){const l=a.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=a.getPattern(i,this,_r(i),Ln.STROKE),l){const c=new Path2D;c.addPath(e,i.getTransform().invertSelf().multiplySelf(l)),e=c}this.rescaleAndStroke(e,!1),i.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,Ui.stroke),n&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(Ln.STROKE,je(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,n=!0){const i=this.ctx,a=this.current.fillColor,l=this.current.patternFill;let c=!1;if(l){const d=a.isModifyingCurrentTransform()?i.getTransform():null;if(this.dependencyTracker?.save(t),i.save(),i.fillStyle=a.getPattern(i,this,_r(i),Ln.FILL),d){const p=new Path2D;p.addPath(e,i.getTransform().invertSelf().multiplySelf(d)),e=p}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(i.fill(e,"evenodd"),this.pendingEOFill=!1):i.fill(e)),this.dependencyTracker?.recordDependencies(t,Ui.fill),c&&(i.restore(),this.dependencyTracker?.restore(t)),n&&this.consumePath(t,e,h)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,Ui.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=lB}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=U_}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;e!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",t),i.recordCloseMarker(t)}if(e!==void 0){const i=new Path2D,a=n.getTransform().invertSelf();for(const{transform:l,x:c,y:h,fontSize:d,path:p}of e)p&&i.addPath(p,new DOMMatrix(l).preMultiplySelf(a).translate(c,h).scale(d,-d));n.clip(i)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,n){this.dependencyTracker?.recordSimpleData("font",t).recordNamedDependency(t,e);const i=this.commonObjs.get(e),a=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(a.fontMatrix=i.fontMatrix||Oy,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&Gt("Invalid font matrix for font "+e),n<0?(n=-n,a.fontDirection=-1):a.fontDirection=1,this.current.font=i,this.current.fontSize=n,i.isType3Font)return;const l=i.loadedName||"sans-serif",c=i.systemFontInfo?.css||`"${l}", ${i.fallbackName}`;let h="normal";i.black?h="900":i.bold&&(h="bold");const d=i.italic?"italic":"normal";let p=n;n<N_?p=N_:n>P_&&(p=P_),this.current.fontSizeScale=n/p,this.ctx.font=`${d} ${h} ${p}px ${c}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=n}setLeadingMoveText(t,e,n){this.setLeading(t,-n),this.moveText(t,e,n)}setTextMatrix(t,e){this.dependencyTracker?.recordSimpleData("textMatrix",t);const{current:n}=this;n.textMatrix=e,n.textMatrixScale=Math.hypot(e[0],e[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,e,n){const i=new Path2D;return i.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),i}paintChar(t,e,n,i,a,l){const c=this.ctx,h=this.current,d=h.font,p=h.textRenderingMode,m=h.fontSize/h.fontSizeScale,v=p&Nn.FILL_STROKE_MASK,E=!!(p&Nn.ADD_TO_PATH_FLAG),b=h.patternFill&&!d.missingFile,T=h.patternStroke&&!d.missingFile;let S;if((d.disableFontFace||E||b||T)&&!d.missingFile&&(S=d.getPathGenerator(this.commonObjs,e)),S&&(d.disableFontFace||b||T)){c.save(),c.translate(n,i),c.scale(m,-m),this.dependencyTracker?.recordCharacterBBox(t,c,d);let C;if(v===Nn.FILL||v===Nn.FILL_STROKE)if(a){C=c.getTransform(),c.setTransform(...a);const D=this.#n(S,C,a);c.fill(D)}else c.fill(S);if(v===Nn.STROKE||v===Nn.FILL_STROKE)if(l){C||=c.getTransform(),c.setTransform(...l);const{a:D,b:O,c:F,d:k}=C,z=Nt.inverseTransform(l),P=Nt.transform([D,O,F,k,0,0],z);Nt.singularValueDecompose2dScale(P,wi),c.lineWidth*=Math.max(wi[0],wi[1])/m,c.stroke(this.#n(S,C,l))}else c.lineWidth/=m,c.stroke(S);c.restore()}else(v===Nn.FILL||v===Nn.FILL_STROKE)&&(c.fillText(e,n,i),this.dependencyTracker?.recordCharacterBBox(t,c,d,m,n,i,()=>c.measureText(e))),(v===Nn.STROKE||v===Nn.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,c,d,m,n,i,()=>c.measureText(e)).recordDependencies(t,Ui.stroke),c.strokeText(e,n,i));E&&((this.pendingTextPaths||=[]).push({transform:je(c),x:n,y:i,fontSize:m,path:S}),this.dependencyTracker?.recordCharacterBBox(t,c,d,m,n,i))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<e.length;i+=4)if(e[i]>0&&e[i]<255){n=!0;break}return ee(this,"isFontSubpixelAAEnabled",n)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Ui.showText).copyDependenciesFromIncrementalOperation(t,"sameLineText").resetBBox(t),this.current.textRenderingMode&Nn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,i=n.font;if(i.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordOperation(t).recordIncrementalData("sameLineText",t);return}const a=n.fontSize;if(a===0){this.dependencyTracker?.recordOperation(t);return}const l=this.ctx,c=n.fontSizeScale,h=n.charSpacing,d=n.wordSpacing,p=n.fontDirection,m=n.textHScale*p,v=e.length,E=i.vertical,b=E?1:-1,T=i.defaultVMetrics,S=a*n.fontMatrix[0],C=n.textRenderingMode===Nn.FILL&&!i.disableFontFace&&!n.patternFill;l.save(),n.textMatrix&&l.transform(...n.textMatrix),l.translate(n.x,n.y+n.textRise),p>0?l.scale(m,-1):l.scale(m,1);let D,O;if(n.patternFill){l.save();const N=n.fillColor.getPattern(l,this,_r(l),Ln.FILL);D=je(l),l.restore(),l.fillStyle=N}if(n.patternStroke){l.save();const N=n.strokeColor.getPattern(l,this,_r(l),Ln.STROKE);O=je(l),l.restore(),l.strokeStyle=N}let F=n.lineWidth;const k=n.textMatrixScale;if(k===0||F===0){const N=n.textRenderingMode&Nn.FILL_STROKE_MASK;(N===Nn.STROKE||N===Nn.FILL_STROKE)&&(F=this.getSinglePixelWidth())}else F/=k;if(c!==1&&(l.scale(c,c),F/=c),l.lineWidth=F,i.isInvalidPDFjsFont){const N=[];let M=0;for(const H of e)N.push(H.unicode),M+=H.width;const V=N.join("");if(l.fillText(V,0,0),this.dependencyTracker!==null){const H=l.measureText(V);this.dependencyTracker.recordBBox(t,this.ctx,-H.actualBoundingBoxLeft,H.actualBoundingBoxRight,-H.actualBoundingBoxAscent,H.actualBoundingBoxDescent).recordOperation(t).recordIncrementalData("sameLineText",t)}n.x+=M*S*m,l.restore(),this.compose();return}let z=0,P;for(P=0;P<v;++P){const N=e[P];if(typeof N=="number"){z+=b*N*a/1e3;continue}let M=!1;const V=(N.isSpace?d:0)+h,H=N.fontChar,$=N.accent;let j,Tt,St=N.width;if(E){const ht=N.vmetric||T,Rt=-(N.vmetric?ht[1]:St*.5)*S,W=ht[2]*S;St=ht?-ht[0]:St,j=Rt/c,Tt=(z+W)/c}else j=z/c,Tt=0;let X;if(i.remeasure&&St>0){X=l.measureText(H);const ht=X.width*1e3/a*c;if(St<ht&&this.isFontSubpixelAAEnabled){const Rt=St/ht;M=!0,l.save(),l.scale(Rt,1),j/=Rt}else St!==ht&&(j+=(St-ht)/2e3*a/c)}if(this.contentVisible&&(N.isInFont||i.missingFile)){if(C&&!$)l.fillText(H,j,Tt),this.dependencyTracker?.recordCharacterBBox(t,l,X?{bbox:null}:i,a/c,j,Tt,()=>X??l.measureText(H));else if(this.paintChar(t,H,j,Tt,D,O),$){const ht=j+a*$.offset.x/c,Rt=Tt-a*$.offset.y/c;this.paintChar(t,$.fontChar,ht,Rt,D,O)}}const Z=E?St*S-V*p:St*S+V*p;z+=Z,M&&l.restore()}E?n.y-=z:n.x+=z*m,l.restore(),this.compose(),this.dependencyTracker?.recordOperation(t).recordIncrementalData("sameLineText",t)}showType3Text(t,e){const n=this.ctx,i=this.current,a=i.font,l=i.fontSize,c=i.fontDirection,h=a.vertical?1:-1,d=i.charSpacing,p=i.wordSpacing,m=i.textHScale*c,v=i.fontMatrix||Oy,E=e.length,b=i.textRenderingMode===Nn.INVISIBLE;let T,S,C,D;if(b||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),i.textMatrix&&n.transform(...i.textMatrix),n.translate(i.x,i.y+i.textRise),n.scale(m,c);const O=this.dependencyTracker;for(this.dependencyTracker=O?new Wf(O,t):null,T=0;T<E;++T){if(S=e[T],typeof S=="number"){D=h*S*l/1e3,this.ctx.translate(D,0),i.x+=D*m;continue}const F=(S.isSpace?p:0)+d,k=a.charProcOperatorList[S.operatorListId];k?this.contentVisible&&(this.save(),n.scale(l,l),n.transform(...v),this.executeOperatorList(k),this.restore()):Gt(`Type3 character "${S.operatorListId}" is not available.`);const z=[S.width,0];Nt.applyTransform(z,v),C=z[0]*l+F,n.translate(C,0),i.x+=C*m}n.restore(),O&&(this.dependencyTracker.recordNestedDependencies(),this.dependencyTracker=O)}setCharWidth(t,e,n){}setCharWidthAndBounds(t,e,n,i,a,l,c){const h=new Path2D;h.rect(i,a,l-i,c-a),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,i,l,a,c).recordClipBox(t,this.ctx,i,l,a,c),this.endPath(t)}getColorN_Pattern(t,e){let n;if(e[0]==="TilingPattern"){const i=this.baseTransform||je(this.ctx),a={createCanvasGraphics:l=>new Bl(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Wf(this.dependencyTracker,t):null)};n=new s0(e,this.ctx,a,i)}else n=this._getPattern(t,e[1],e[2]);return n}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,n=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=eB(this.getObject(t,e)),this.cachedPatterns.set(e,i)),n&&(i.matrix=n),i}shadingFill(t,e){if(!this.contentVisible)return;const n=this.ctx;this.save(t);const i=this._getPattern(t,e);n.fillStyle=i.getPattern(n,this,_r(n),Ln.SHADING);const a=_r(n);if(a){const{width:l,height:c}=n.canvas,h=Ol.slice();Nt.axialAlignedBoundingBox([0,0,l,c],a,h);const[d,p,m,v]=h;this.ctx.fillRect(d,p,m-d,v-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Ui.transform).recordDependencies(t,Ui.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){De("Should not call beginInlineImage")}beginImageData(){De("Should not call beginImageData")}paintFormXObjectBegin(t,e,n){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=je(this.ctx),n)){Nt.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[i,a,l,c]=n,h=new Path2D;h.rect(i,a,l-i,c-a),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,i,l,a,c),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;e.isolated||Ep("TODO: Support non-isolated groups."),e.knockout&&Gt("Knockout groups not supported.");const i=je(n);if(e.matrix&&n.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let a=Ol.slice();Nt.axialAlignedBoundingBox(e.bbox,je(n),a);const l=[0,0,n.canvas.width,n.canvas.height];a=Nt.intersect(a,l)||[0,0,0,0];const c=Math.floor(a[0]),h=Math.floor(a[1]),d=Math.max(Math.ceil(a[2])-c,1),p=Math.max(Math.ceil(a[3])-h,1);this.current.startNewPathAndClipBox([0,0,d,p]);let m="groupAt"+this.groupLevel;e.smask&&(m+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(m,d,p),E=v.context;E.translate(-c,-h),E.transform(...i);let b=new Path2D;const[T,S,C,D]=e.bbox;if(b.rect(T,S,C-T,D-S),e.matrix){const O=new Path2D;O.addPath(b,new DOMMatrix(e.matrix)),b=O}E.clip(b),e.smask&&this.smaskStack.push({canvas:v.canvas,context:E,offsetX:c,offsetY:h,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(c,h),n.save()),cu(n,E),this.ctx=E,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=je(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...a);const l=Ol.slice();Nt.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],a,l),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,e,n,i,a,l){if(this.#t(),rf(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const c=n[2]-n[0],h=n[3]-n[1];if(l&&this.annotationCanvasMap){i=i.slice(),i[4]-=n[0],i[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=c,n[3]=h,Nt.singularValueDecompose2dScale(je(this.ctx),wi);const{viewportScale:d}=this,p=Math.ceil(c*this.outputScaleX*d),m=Math.ceil(h*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(p,m);const{canvas:v,context:E}=this.annotationCanvas;this.annotationCanvasMap.set(e,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=E,this.ctx.save(),this.ctx.setTransform(wi[0],0,0,-wi[1],0,h*wi[1]),rf(this.ctx)}else{rf(this.ctx),this.endPath(t);const d=new Path2D;d.rect(n[0],n[1],c,h),this.ctx.clip(d)}}this.current=new L_(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...i),this.transform(t,...a)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const n=e.count;e=this.getObject(t,e.data,e),e.count=n;const i=this.ctx,a=this._createMaskCanvas(t,e),l=a.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(l,a.offsetX,a.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,a.offsetX,a.offsetX+l.width,a.offsetY,a.offsetY+l.height).recordOperation(t),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n,i=0,a=0,l,c){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const h=this.ctx;h.save();const d=je(h);h.transform(n,i,a,l,0,0);const p=this._createMaskCanvas(t,e);h.setTransform(1,0,0,1,p.offsetX-d[4],p.offsetY-d[5]),this.dependencyTracker?.resetBBox(t);for(let m=0,v=c.length;m<v;m+=2){const E=Nt.transform(d,[n,i,a,l,c[m],c[m+1]]);h.drawImage(p.canvas,E[4],E[5]),this.dependencyTracker?.recordBBox(t,this.ctx,E[4],E[4]+p.canvas.width,E[5],E[5]+p.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx,i=this.current.fillColor,a=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Ui.transformAndFill);for(const l of e){const{data:c,width:h,height:d,transform:p}=l,m=this.cachedCanvases.getCanvas("maskCanvas",h,d),v=m.context;v.save();const E=this.getObject(t,c,l);B_(v,E),v.globalCompositeOperation="source-in",v.fillStyle=a?i.getPattern(v,this,_r(n),Ln.FILL):i,v.fillRect(0,0,h,d),v.restore(),n.save(),n.transform(...p),n.scale(1,-1),nf(n,m.canvas,0,0,h,d,0,-1,1,1),this.dependencyTracker?.recordBBox(t,n,0,h,0,d),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const n=this.getObject(t,e);if(!n){Gt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,n)}paintImageXObjectRepeat(t,e,n,i,a){if(!this.contentVisible)return;const l=this.getObject(t,e);if(!l){Gt("Dependent image isn't ready yet");return}const c=l.width,h=l.height,d=[];for(let p=0,m=a.length;p<m;p+=2)d.push({transform:[n,0,0,i,a[p],a[p+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(t,l,d)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:i}=t,a=this.cachedCanvases.getCanvas("inlineImage",n,i),l=a.context;return l.filter=this.current.transferMaps,l.drawImage(e,0,0),l.filter="none",a.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const n=e.width,i=e.height,a=this.ctx;this.save(t);const{filter:l}=a;l!=="none"&&l!==""&&(a.filter="none"),a.scale(1/n,-1/i);let c;if(e.bitmap)c=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)c=e;else{const p=this.cachedCanvases.getCanvas("inlineImage",n,i).context;k_(p,e),c=this.applyTransferMapsToCanvas(p)}const h=this._scaleImage(c,_r(a));a.imageSmoothingEnabled=F_(je(a),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,a,0,n,-i,0).recordDependencies(t,Ui.imageXObject).recordOperation(t),nf(a,h.img,0,0,h.paintWidth,h.paintHeight,0,-i,n,i),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,n){if(!this.contentVisible)return;const i=this.ctx;let a;if(e.bitmap)a=e.bitmap;else{const l=e.width,c=e.height,d=this.cachedCanvases.getCanvas("inlineImage",l,c).context;k_(d,e),a=this.applyTransferMapsToCanvas(d)}this.dependencyTracker?.resetBBox(t);for(const l of n)i.save(),i.transform(...l.transform),i.scale(1,-1),nf(i,a,l.x,l.y,l.w,l.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,1,-1,0),i.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Ui.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,n){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,n){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,n){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const a=this.ctx;this.pendingClip?(i||(this.pendingClip===U_?a.clip(e,"evenodd"):a.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=je(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:i,d:a}=this.ctx.getTransform();let l,c;if(n===0&&i===0){const h=Math.abs(e),d=Math.abs(a);if(h===d)if(t===0)l=c=1/h;else{const p=h*t;l=c=p<1?1/p:1}else if(t===0)l=1/h,c=1/d;else{const p=h*t,m=d*t;l=p<1?1/p:1,c=m<1?1/m:1}}else{const h=Math.abs(e*a-n*i),d=Math.hypot(e,n),p=Math.hypot(i,a);if(t===0)l=p/h,c=d/h;else{const m=t*h;l=p>m?p/m:1,c=d>m?d/m:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:n,current:{lineWidth:i}}=this,[a,l]=this.getScaleForStroking();if(a===l){n.lineWidth=(i||1)*a,n.stroke(t);return}const c=n.getLineDash();e&&n.save(),n.scale(a,l),qm.a=1/a,qm.d=1/l;const h=new Path2D;if(h.addPath(t,qm),c.length>0){const d=Math.max(a,l);n.setLineDash(c.map(p=>p/d)),n.lineDashOffset/=d}n.lineWidth=i||1,n.stroke(h),e&&n.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const r in Wu)Bl.prototype[r]!==void 0&&(Bl.prototype[Wu[r]]=Bl.prototype[r]);class fo{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class cB{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Il=Symbol("INTERNAL");class uB{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:e,intent:n,usage:i,rbGroups:a}){this.#t=!!(t&Ti.DISPLAY),this.#e=!!(t&Ti.PRINT),this.name=e,this.intent=n,this.usage=i,this.rbGroups=a}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,n=!1){t!==Il&&De("Internal method `_setVisible` called."),this.#n=n,this.#i=e}}class hB{#t=null;#e=new Map;#n=null;#i=null;constructor(t,e=Ti.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const n of t.groups)this.#e.set(n.id,new uB(e,n));if(t.baseState==="OFF")for(const n of this.#e.values())n._setVisible(Il,!1);for(const n of t.on)this.#e.get(n)._setVisible(Il,!0);for(const n of t.off)this.#e.get(n)._setVisible(Il,!1);this.#n=this.getHash()}}#s(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let i=1;i<e;i++){const a=t[i];let l;if(Array.isArray(a))l=this.#s(a);else if(this.#e.has(a))l=this.#e.get(a).visible;else return Gt(`Optional content group not found: ${a}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Ep("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(Gt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#s(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return Gt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return Gt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return Gt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return Gt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return Gt(`Unknown optional content policy ${t.policy}.`),!0}return Gt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){const i=this.#e.get(t);if(!i){Gt(`Optional content group not found: ${t}`);return}if(n&&e&&i.rbGroups.length)for(const a of i.rbGroups)for(const l of a)l!==t&&this.#e.get(l)?._setVisible(Il,!1,!0);i._setVisible(Il,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let n;for(const i of t){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const a=this.#e.get(i);if(a)switch(n){case"ON":this.setVisibility(i,!0,e);break;case"OFF":this.setVisibility(i,!1,e);break;case"Toggle":this.setVisibility(i,!a.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new mR;for(const[e,n]of this.#e)t.update(`${e}:${n.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class dB{constructor(t,{disableRange:e=!1,disableStream:n=!1}){un(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:a,progressiveDone:l,contentDispositionFilename:c}=t;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,a?.length>0){const h=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,d)=>{this._onReceiveData({begin:h,chunk:d})}),t.addProgressListener((h,d)=>{this._onProgress({loaded:h,total:d})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const i=this._rangeReaders.some(function(a){return a._begin!==t?!1:(a._enqueue(n),!0)});un(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){un(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new fB(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new pB(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class fB{constructor(t,e,n=!1,i=null){this._stream=t,this._done=n||!1,this._filename=Zv(i)?i:null,this._queuedChunks=e||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class pB{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function gB(r){let t=!0,e=n("filename\\*","i").exec(r);if(e){e=e[1];let p=c(e);return p=unescape(p),p=h(p),p=d(p),a(p)}if(e=l(r),e){const p=d(e);return a(p)}if(e=n("filename","i").exec(r),e){e=e[1];let p=c(e);return p=d(p),a(p)}function n(p,m){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function i(p,m){if(p){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const v=new TextDecoder(p,{fatal:!0}),E=fh(m);m=v.decode(E),t=!1}catch{}}return m}function a(p){return t&&/[\x80-\xff]/.test(p)&&(p=i("utf-8",p),t&&(p=i("iso-8859-1",p))),p}function l(p){const m=[];let v;const E=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=E.exec(p))!==null;){let[,T,S,C]=v;if(T=parseInt(T,10),T in m){if(T===0)break;continue}m[T]=[S,C]}const b=[];for(let T=0;T<m.length&&T in m;++T){let[S,C]=m[T];C=c(C),S&&(C=unescape(C),T===0&&(C=h(C))),b.push(C)}return b.join("")}function c(p){if(p.startsWith('"')){const m=p.slice(1).split('\\"');for(let v=0;v<m.length;++v){const E=m[v].indexOf('"');E!==-1&&(m[v]=m[v].slice(0,E),m.length=v+1),m[v]=m[v].replaceAll(/\\(.)/g,"$1")}p=m.join('"')}return p}function h(p){const m=p.indexOf("'");if(m===-1)return p;const v=p.slice(0,m),b=p.slice(m+1).replace(/^[^']*'/,"");return i(v,b)}function d(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,v,E,b){if(E==="q"||E==="Q")return b=b.replaceAll("_"," "),b=b.replaceAll(/=([0-9a-fA-F]{2})/g,function(T,S){return String.fromCharCode(parseInt(S,16))}),i(v,b);try{b=atob(b)}catch{}return i(v,b)})}return""}function _R(r,t){const e=new Headers;if(!r||!t||typeof t!="object")return e;for(const n in t){const i=t[n];i!==void 0&&e.append(n,i)}return e}function _p(r){return URL.parse(r)?.origin??null}function wR({responseHeaders:r,isHttp:t,rangeChunkSize:e,disableRange:n}){const i={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(r.get("Content-Length"),10);return!Number.isInteger(a)||(i.suggestedLength=a,a<=2*e)||n||!t||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function SR(r){const t=r.get("Content-Disposition");if(t){let e=gB(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Zv(e))return e}return null}function yh(r,t){return new Yf(`Unexpected server response (${r}) while retrieving PDF "${t}".`,r,r===404||r===0&&t.startsWith("file:"))}function RR(r){return r===200||r===206}function CR(r,t,e){return{method:"GET",headers:r,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function IR(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(Gt(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class mB{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=_R(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return un(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new yB(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new vB(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class yB{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),i=e.url;fetch(i,CR(n,this._withCredentials,this._abortController)).then(a=>{if(t._responseOrigin=_p(a.url),!RR(a.status))throw yh(a.status,i);this._reader=a.body.getReader(),this._headersCapability.resolve();const l=a.headers,{allowRangeRequests:c,suggestedLength:h}=wR({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=SR(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new wa("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:IR(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class vB{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const a=new Headers(t.headers);a.append("Range",`bytes=${e}-${n-1}`);const l=i.url;fetch(l,CR(a,this._withCredentials,this._abortController)).then(c=>{const h=_p(c.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!RR(c.status))throw yh(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:IR(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Qm=200,Jm=206;function EB(r){const t=r.response;return typeof t!="string"?t:fh(t).buffer}class AB{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:n}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=_R(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[a,l]of this.headers)e.setRequestHeader(a,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.expectedStatus=Jm):i.expectedStatus=Qm,e.responseType="arraybuffer",un(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){const n=this.pendingRequests[t];n&&n.onProgress?.(e)}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),i.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],i.status===0&&this.isHttp){n.onError(i.status);return}const a=i.status||Qm;if(!(a===Qm&&n.expectedStatus===Jm)&&a!==n.expectedStatus){n.onError(i.status);return}const c=EB(i);if(a===Jm){const h=i.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);d?n.onDone({begin:parseInt(d[1],10),chunk:c}):(Gt('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class bB{constructor(t){this._source=t,this._manager=new AB(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return un(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new TB(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new _B(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class TB{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=_p(e.responseURL);const n=e.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...d]=c.split(": ");return[h,d.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:l}=wR({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=SR(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=yh(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class _B{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=_p(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=yh(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const wB=/^[a-z][a-z0-9\-+.]+:/i;function SB(r){if(wB.test(r))return new URL(r);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(r))}class RB{constructor(t){this.source=t,this.url=SB(t.url),un(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return un(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new CB(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new IB(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class CB{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=yh(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new wa("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class IB{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=t.source;this._isStreamingSupported=!i.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const uu=Symbol("INITIAL_DATA");class xR{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:uu}}get(t,e=null){if(e){const i=this.#e(t);return i.promise.then(()=>e(i.data)),null}const n=this.#t[t];if(!n||n.data===uu)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=this.#t[t];return!!e&&e.data!==uu}delete(t){const e=this.#t[t];return!e||e.data===uu?!1:(delete this.#t[t],!0)}resolve(t,e=null){const n=this.#e(t);n.data=e,n.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==uu&&(yield[t,e])}}}const xB=1e5,V_=30;class Jn{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#s=null;#r=null;#a=0;#o=0;#l=null;#c=null;#d=0;#u=0;#f=Object.create(null);#g=[];#p=null;#h=[];#m=new WeakMap;#E=null;static#y=new Map;static#b=new Map;static#T=new WeakMap;static#v=null;static#_=new Set;constructor({textContentSource:t,container:e,viewport:n}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#c=e,this.#u=n.scale*Br.pixelRatio,this.#d=n.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:a,pageX:l,pageY:c}=n.rawDims;this.#E=[1,0,0,-1,-l,c+a],this.#o=i,this.#a=a,Jn.#x(),bo(e,n),this.#t.promise.finally(()=>{Jn.#_.delete(this),this.#r=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Bn.platform;return ee(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#l.read().then(({value:e,done:n})=>{if(n){this.#t.resolve();return}this.#s??=e.lang,Object.assign(this.#f,e.styles),this.#I(e.items),t()},this.#t.reject)};return this.#l=this.#p.getReader(),Jn.#_.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const n=t.scale*Br.pixelRatio,i=t.rotation;if(i!==this.#d&&(e?.(),this.#d=i,bo(this.#c,{rotation:i})),n!==this.#u){e?.(),this.#u=n;const a={div:null,properties:null,ctx:Jn.#N(this.#s)};for(const l of this.#h)a.properties=this.#m.get(l),a.div=l,this.#w(a)}}cancel(){const t=new wa("TextLayer task cancelled.");this.#l?.cancel(t).catch(()=>{}),this.#l=null,this.#t.reject(t)}get textDivs(){return this.#h}get textContentItemsStr(){return this.#g}#I(t){if(this.#n)return;this.#r.ctx??=Jn.#N(this.#s);const e=this.#h,n=this.#g;for(const i of t){if(e.length>xB){Gt("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){const a=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),i.id&&this.#e.setAttribute("id",`${i.id}`),a.append(this.#e)}else i.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}n.push(i.str),this.#R(i)}}#R(t){const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#h.push(e);const i=Nt.transform(this.#E,t.transform);let a=Math.atan2(i[1],i[0]);const l=this.#f[t.fontName];l.vertical&&(a+=Math.PI/2);let c=this.#i&&l.fontSubstitution||l.fontFamily;c=Jn.fontFamilyMap.get(c)||c;const h=Math.hypot(i[2],i[3]),d=h*Jn.#L(c,l,this.#s);let p,m;a===0?(p=i[4],m=i[5]-d):(p=i[4]+d*Math.sin(a),m=i[5]-d*Math.cos(a));const v="calc(var(--total-scale-factor) *",E=e.style;this.#e===this.#c?(E.left=`${(100*p/this.#o).toFixed(2)}%`,E.top=`${(100*m/this.#a).toFixed(2)}%`):(E.left=`${v}${p.toFixed(2)}px)`,E.top=`${v}${m.toFixed(2)}px)`),E.fontSize=`${v}${(Jn.#v*h).toFixed(2)}px)`,E.fontFamily=c,n.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#i&&(e.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),a!==0&&(n.angle=a*(180/Math.PI));let b=!1;if(t.str.length>1)b=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const T=Math.abs(t.transform[0]),S=Math.abs(t.transform[3]);T!==S&&Math.max(T,S)/Math.min(T,S)>1.5&&(b=!0)}if(b&&(n.canvasWidth=l.vertical?t.height:t.width),this.#m.set(e,n),this.#r.div=e,this.#r.properties=n,this.#w(this.#r),n.hasText&&this.#e.append(e),n.hasEOL){const T=document.createElement("br");T.setAttribute("role","presentation"),this.#e.append(T)}}#w(t){const{div:e,properties:n,ctx:i}=t,{style:a}=e;let l="";if(Jn.#v>1&&(l=`scale(${1/Jn.#v})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:c}=a,{canvasWidth:h,fontSize:d}=n;Jn.#C(i,d*this.#u,c);const{width:p}=i.measureText(e.textContent);p>0&&(l=`scaleX(${h*this.#u/p}) ${l}`)}n.angle!==0&&(l=`rotate(${n.angle}deg) ${l}`),l.length>0&&(a.transform=l)}static cleanup(){if(!(this.#_.size>0)){this.#y.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#N(t=null){let e=this.#b.get(t||="");if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,e),this.#T.set(e,{size:0,family:""})}return e}static#C(t,e,n){const i=this.#T.get(t);e===i.size&&n===i.family||(t.font=`${e}px ${n}`,i.size=e,i.family=n)}static#x(){if(this.#v!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#v=t.getBoundingClientRect().height,t.remove()}static#L(t,e,n){const i=this.#y.get(t);if(i)return i;const a=this.#N(n);a.canvas.width=a.canvas.height=V_,this.#C(a,V_,t);const l=a.measureText(""),c=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let d=.8;return c?d=c/(c+h):(Bn.platform.isFirefox&&Gt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?d=e.ascent:e.descent&&(d=1+e.descent)),this.#y.set(t,d),d}}class Ku{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function i(a){if(!a)return;let l=null;const c=a.name;if(c==="#text")l=a.value;else if(Ku.shouldBuildText(c))a?.attributes?.textContent?l=a.attributes.textContent:a.value&&(l=a.value);else return;if(l!==null&&e.push({str:l}),!!a.children)for(const h of a.children)i(h)}return i(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const DB=100;function DR(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const t=new a0,{docId:e}=t,n=r.url?F6(r.url):null,i=r.data?U6(r.data):null,a=r.httpHeaders||null,l=r.withCredentials===!0,c=r.password??null,h=r.range instanceof OR?r.range:null,d=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let p=r.worker instanceof Xu?r.worker:null;const m=r.verbosity,v=typeof r.docBaseUrl=="string"&&!Ap(r.docBaseUrl)?r.docBaseUrl:null,E=tf(r.cMapUrl),b=r.cMapPacked!==!1,T=r.CMapReaderFactory||(Zn?W6:I_),S=tf(r.iccUrl),C=tf(r.standardFontDataUrl),D=r.StandardFontDataFactory||(Zn?K6:x_),O=tf(r.wasmUrl),F=r.WasmFactory||(Zn?X6:D_),k=r.stopAtErrors!==!0,z=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,P=r.isEvalSupported!==!1,N=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!Zn,M=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!Zn&&(Bn.platform.isFirefox||!globalThis.chrome),V=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,H=typeof r.disableFontFace=="boolean"?r.disableFontFace:Zn,$=r.fontExtraProperties===!0,j=r.enableXfa===!0,Tt=r.ownerDocument||globalThis.document,St=r.disableRange===!0,X=r.disableStream===!0,Z=r.disableAutoFetch===!0,ht=r.pdfBug===!0,Rt=r.CanvasFactory||(Zn?Y6:z6),W=r.FilterFactory||(Zn?$6:G6),lt=r.enableHWA===!0,q=r.useWasm!==!1,it=h?h.length:r.length??NaN,yt=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!Zn&&!H,_t=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(T===I_&&D===x_&&F===D_&&E&&C&&O&&bu(E,document.baseURI)&&bu(C,document.baseURI)&&bu(O,document.baseURI)),ut=null;m6(m);const ft={canvasFactory:new Rt({ownerDocument:Tt,enableHWA:lt}),filterFactory:new W({docId:e,ownerDocument:Tt}),cMapReaderFactory:_t?null:new T({baseUrl:E,isCompressed:b}),standardFontDataFactory:_t?null:new D({baseUrl:C}),wasmFactory:_t?null:new F({baseUrl:O})};p||(p=Xu.create({verbosity:m,port:fo.workerPort}),t._worker=p);const pt={docId:e,apiVersion:"5.4.149",data:i,password:c,disableAutoFetch:Z,rangeChunkSize:d,length:it,docBaseUrl:v,enableXfa:j,evaluatorOptions:{maxImageSize:z,disableFontFace:H,ignoreErrors:k,isEvalSupported:P,isOffscreenCanvasSupported:N,isImageDecoderSupported:M,canvasMaxAreaInBytes:V,fontExtraProperties:$,useSystemFonts:yt,useWasm:q,useWorkerFetch:_t,cMapUrl:E,iccUrl:S,standardFontDataUrl:C,wasmUrl:O}},Ct={ownerDocument:Tt,pdfBug:ht,styleElement:ut,loadingParams:{disableAutoFetch:Z,enableXfa:j}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Vt=p.messageHandler.sendWithPromise("GetDocRequest",pt,i?[i.buffer]:null);let It;if(h)It=new dB(h,{disableRange:St,disableStream:X});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");const qt=bu(n)?mB:Zn?RB:bB;It=new qt({url:n,length:it,httpHeaders:a,withCredentials:l,rangeChunkSize:d,disableRange:St,disableStream:X})}return Vt.then(qt=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Xt=new Tu(e,qt,p.port),ne=new PB(Xt,t,It,Ct,ft,lt);t._transport=ne,Xt.send("Ready",null)})}).catch(t._capability.reject),t}class a0{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${a0.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class OR{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#s=[];constructor(t,e,n=!1,i=null){this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=i}addRangeListener(t){this.#s.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const n of this.#s)n(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const n of this.#i)n(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#n)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){De("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class OB{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ee(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class NB{#t=!1;constructor(t,e,n,i=!1){this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=i?new S_:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new xR,this._intentStates=new Map,this.destroyed=!1,this.recordedGroups=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:a=!1}={}){return new gh({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:a})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ee(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:n,intent:i="display",annotationMode:a=ca.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:d=null,pageColors:p=null,printAnnotationStorage:m=null,isEditing:v=!1,recordOperations:E=!1,filteredOperationIndexes:b=null}){this._stats?.time("Overall");const T=this._transport.getRenderingIntent(i,a,m,v),{renderingIntent:S,cacheKey:C}=T;this.#t=!1,h||=this._transport.getOptionalContentConfig(S);let D=this._intentStates.get(C);D||(D=Object.create(null),this._intentStates.set(C,D)),D.streamReaderCancelTimeout&&(clearTimeout(D.streamReaderCancelTimeout),D.streamReaderCancelTimeout=null);const O=!!(S&Ti.PRINT);D.displayReadyCapability||(D.displayReadyCapability=Promise.withResolvers(),D.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(T));const F=!this.recordedGroups&&(E||this._pdfBug&&globalThis.StepperManager?.enabled),k=N=>{if(D.renderTasks.delete(z),F){const M=z.gfx?.dependencyTracker.take();M?(z.stepper?.setOperatorGroups(M),E&&(this.recordedGroups=M)):E&&(this.recordedGroups=[])}O&&(this.#t=!0),this.#e(),N?(z.capability.reject(N),this._abortOperatorList({intentState:D,reason:N instanceof Error?N:new Error(N)})):z.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},z=new Nl({callback:k,params:{canvas:e,canvasContext:t,dependencyTracker:F?new q6(e):null,viewport:n,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:D.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!O,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,filteredOperationIndexes:b});(D.renderTasks||=new Set).add(z);const P=z.task;return Promise.all([D.displayReadyCapability.promise,h]).then(([N,M])=>{if(this.destroyed){k();return}if(this._stats?.time("Rendering"),!(M.renderingIntent&S))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");z.initializeGraphics({transparency:N,optionalContentConfig:M}),z.operatorListChanged()}).catch(k),P}getOperatorList({intent:t="display",annotationMode:e=ca.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){function a(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(t,e,n,i,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=a,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Ku.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,i){function a(){l.read().then(function({value:h,done:d}){if(d){n(c);return}c.lang??=h.lang,Object.assign(c.styles,h.styles),c.items.push(...h.items),a()},i)}const l=e.getReader(),c={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new S_),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const n=this._intentStates.get(e);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let n=0,i=t.length;n<i;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:i}){const{map:a,transfer:l}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:a,modifiedIds:i},l).getReader(),d=this._intentStates.get(e);d.streamReader=h;const p=()=>{h.read().then(({value:m,done:v})=>{if(v){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,d),p())},m=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const v of d.renderTasks)v.operatorListChanged();this.#e()}if(d.displayReadyCapability)d.displayReadyCapability.reject(m);else if(d.opListReadCapability)d.opListReadCapability.reject(m);else throw m}})};p()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof Jv){let i=DB;e.extraDelay>0&&e.extraDelay<1e3&&(i+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},i);return}}if(t.streamReader.cancel(new wa(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[i,a]of this._intentStates)if(a===t){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}var ua,Zi,ps,oo,Xf,lo,co,ni,bf,NR,PR,_u,Fl,Tf;const Fe=class Fe{constructor({name:t=null,port:e=null,verbosity:n=y6()}={}){br(this,ni);br(this,ua,Promise.withResolvers());br(this,Zi,null);br(this,ps,null);br(this,oo,null);if(this.name=t,this.destroyed=!1,this.verbosity=n,e){if(Be(Fe,co).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Be(Fe,co).set(e,this),Tr(this,ni,NR).call(this,e)}else Tr(this,ni,PR).call(this)}get promise(){return Be(this,ua).promise}get port(){return Be(this,ps)}get messageHandler(){return Be(this,Zi)}destroy(){this.destroyed=!0,Be(this,oo)?.terminate(),li(this,oo,null),Be(Fe,co).delete(Be(this,ps)),li(this,ps,null),Be(this,Zi)?.destroy(),li(this,Zi,null)}static create(t){const e=Be(this,co).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Fe(t)}static get workerSrc(){if(fo.workerSrc)return fo.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ee(this,"_setupFakeWorkerGlobal",(async()=>Be(this,Fl,Tf)?Be(this,Fl,Tf):(await import(this.workerSrc)).WorkerMessageHandler)())}};ua=new WeakMap,Zi=new WeakMap,ps=new WeakMap,oo=new WeakMap,Xf=new WeakMap,lo=new WeakMap,co=new WeakMap,ni=new WeakSet,bf=function(){Be(this,ua).resolve(),Be(this,Zi).send("configure",{verbosity:this.verbosity})},NR=function(t){li(this,ps,t),li(this,Zi,new Tu("main","worker",t)),Be(this,Zi).on("ready",()=>{}),Tr(this,ni,bf).call(this)},PR=function(){if(Be(Fe,lo)||Be(Fe,Fl,Tf)){Tr(this,ni,_u).call(this);return}let{workerSrc:t}=Fe;try{Fe._isSameOrigin(window.location,t)||(t=Fe._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new Tu("main","worker",e),i=()=>{a.abort(),n.destroy(),e.terminate(),this.destroyed?Be(this,ua).reject(new Error("Worker was destroyed")):Tr(this,ni,_u).call(this)},a=new AbortController;e.addEventListener("error",()=>{Be(this,oo)||i()},{signal:a.signal}),n.on("test",c=>{if(a.abort(),this.destroyed||!c){i();return}li(this,Zi,n),li(this,ps,e),li(this,oo,e),Tr(this,ni,bf).call(this)}),n.on("ready",c=>{if(a.abort(),this.destroyed){i();return}try{l()}catch{Tr(this,ni,_u).call(this)}});const l=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};l();return}catch{Ep("The worker has been disabled.")}Tr(this,ni,_u).call(this)},_u=function(){Be(Fe,lo)||(Gt("Setting up fake worker."),li(Fe,lo,!0)),Fe._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Be(this,ua).reject(new Error("Worker was destroyed"));return}const e=new H6;li(this,ps,e);const n=`fake${Sb(Fe,Xf)._++}`,i=new Tu(n+"_worker",n,e);t.setup(i,e),li(this,Zi,new Tu(n,n+"_worker",e)),Tr(this,ni,bf).call(this)}).catch(t=>{Be(this,ua).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Fl=new WeakSet,Tf=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},br(Fe,Fl),br(Fe,Xf,0),br(Fe,lo,!1),br(Fe,co,new WeakMap),Zn&&(li(Fe,lo,!0),fo.workerSrc||="./pdf.worker.mjs"),Fe._isSameOrigin=(t,e)=>{const n=URL.parse(t);if(!n?.origin||n.origin==="null")return!1;const i=new URL(e,n);return n.origin===i.origin},Fe._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Fe.fromPort=t=>{if(x6("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Fe.create(t)};let Xu=Fe;class PB{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#s=null;constructor(t,e,n,i,a,l){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new xR,this.fontLoader=new k6({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}#r(t,e=null){const n=this.#t.get(t);if(n)return n;const i=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,i),i}get annotationStorage(){return ee(this,"annotationStorage",new n0)}getRenderingIntent(t,e=ca.ENABLE,n=null,i=!1,a=!1){let l=Ti.DISPLAY,c=Ly;switch(t){case"any":l=Ti.ANY;break;case"display":break;case"print":l=Ti.PRINT;break;default:Gt(`getRenderingIntent - invalid intent: ${t}`)}const h=l&Ti.PRINT&&n instanceof yR?n:this.annotationStorage;switch(e){case ca.DISABLE:l+=Ti.ANNOTATIONS_DISABLE;break;case ca.ENABLE:break;case ca.ENABLE_FORMS:l+=Ti.ANNOTATIONS_FORMS;break;case ca.ENABLE_STORAGE:l+=Ti.ANNOTATIONS_STORAGE,c=h.serializable;break;default:Gt(`getRenderingIntent - invalid annotationMode: ${e}`)}i&&(l+=Ti.IS_EDITING),a&&(l+=Ti.OPLIST);const{ids:d,hash:p}=h.modifiedIds,m=[l,c.hash,p];return{renderingIntent:l,cacheKey:m.join("_"),annotationStorageSerializable:c,modifiedIds:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of this.#e.values())t.push(n._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Jn.cleanup(),this._networkStream?.cancelAllRequests(new wa("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,i)=>{un(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},i.onPull=()=>{this._fullReader.read().then(function({value:a,done:l}){if(l){i.close();return}un(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{this._fullReader.cancel(a),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:a,contentLength:l}=this._fullReader;return(!i||!a)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{e.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:i,isRangeSupported:a,contentLength:l}}),t.on("GetRangeReader",(n,i)=>{un(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(n.begin,n.end);if(!a){i.close();return}i.onPull=()=>{a.read().then(function({value:l,done:c}){if(c){i.close();return}un(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{i.error(l)})},i.onCancel=l=>{a.cancel(l),i.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new OB(n,this))}),t.on("DocException",n=>{e._capability.reject(ci(n))}),t.on("PasswordRequest",n=>{this.#s=Promise.withResolvers();try{if(!e.onPassword)throw ci(n);const i=a=>{a instanceof Error?this.#s.reject(a):this.#s.resolve({password:a})};e.onPassword(i,n.code)}catch(i){this.#s.reject(i)}return this.#s.promise}),t.on("DataLoaded",n=>{e.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;this.#e.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,i,a])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(i){case"Font":if("error"in a){const d=a.error;Gt(`Error during font loading: ${d}`),this.commonObjs.resolve(n,d);break}const l=this._params.pdfBug&&globalThis.FontInspector?.enabled?(d,p)=>globalThis.FontInspector.fontAdded(d,p):null,c=new B6(a,l);this.fontLoader.bind(c).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!c.fontExtraProperties&&c.data&&(c.data=null),this.commonObjs.resolve(n,c)});break;case"CopyLocalImage":const{imageRef:h}=a;un(h,"The imageRef must be defined.");for(const d of this.#e.values())for(const[,p]of d.objs)if(p?.ref===h)return p.dataLen?(this.commonObjs.resolve(n,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,a);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),t.on("obj",([n,i,a,l])=>{if(this.destroyed)return;const c=this.#e.get(i);if(!c.objs.has(n)){if(c._intentStates.size===0){l?.bitmap?.close();return}switch(a){case"Image":case"Pattern":c.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${a}`)}}}),t.on("DocProgress",n=>{this.destroyed||e.onProgress?.({loaded:n.loaded,total:n.total})}),t.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[n.type];if(!i)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Gt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=this.#n.get(e);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&this.#i.set(a.refStr,t);const l=new NB(e,a,this,this._params.pdfBug);return this.#e.set(e,l),l});return this.#n.set(e,i),i}getPageIndex(t){return ky(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#r("GetOptionalContentConfig").then(e=>new hB(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(i=>({info:i[0],metadata:i[1]?new cB(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Jn.cleanup()}}cachedPageNumber(t){if(!ky(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(e)??null}}class MB{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Nl{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:n,commonObjs:i,annotationCanvasMap:a,operatorList:l,pageIndex:c,canvasFactory:h,filterFactory:d,useRequestAnimationFrame:p=!1,pdfBug:m=!1,pageColors:v=null,enableHWA:E=!1,filteredOperationIndexes:b=null}){this.callback=t,this.params=e,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=d,this._pdfBug=m,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new MB(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=E,this._dependencyTracker=e.dependencyTracker,this._filteredOperationIndexes=b}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Nl.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Nl.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:i,background:a,dependencyTracker:l}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Bl(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:i,viewport:n,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Nl.#e.delete(this._canvas),t||=new Jv(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._filteredOperationIndexes),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Nl.#e.delete(this._canvas),this.callback())))}}const LB="5.4.149",kB="9e2e9e209";class Vi{#t=null;#e=null;#n;#i=null;#s=!1;#r=!1;#a=null;#o;#l=null;#c=null;static#d=null;static get _keyboardManager(){return ee(this,"_keyboardManager",new mh([[["Escape","mac+Escape"],Vi.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Vi.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Vi.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Vi.prototype._moveToPrevious],[["Home","mac+Home"],Vi.prototype._moveToBeginning],[["End","mac+End"],Vi.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#r=!1,this.#a=t):this.#r=!0,this.#c=t?._uiManager||e,this.#o=this.#c._eventBus,this.#n=t?.color?.toUpperCase()||this.#c?.highlightColors.values().next().value||"#FFFF98",Vi.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#a&&(t.ariaControls=`${this.#a.id}_colorpicker_dropdown`);const e=this.#c._signal;t.addEventListener("click",this.#p.bind(this),{signal:e}),t.addEventListener("keydown",this.#g.bind(this),{signal:e});const n=this.#e=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#n,t.append(n),t}renderMainDropdown(){const t=this.#i=this.#u();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#u(){const t=document.createElement("div"),e=this.#c._signal;t.addEventListener("contextmenu",$i,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#a&&(t.id=`${this.#a.id}_colorpicker_dropdown`);for(const[n,i]of this.#c.highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",i),a.title=n,a.setAttribute("data-l10n-id",Vi.#d[n]);const l=document.createElement("span");a.append(l),l.className="swatch",l.style.backgroundColor=i,a.ariaSelected=i===this.#n,a.addEventListener("click",this.#f.bind(this,i),{signal:e}),t.append(a)}return t.addEventListener("keydown",this.#g.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:le.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#p(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#m){this.#p(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#m&&this._hideDropdownFromKeyboard();return}this.#m||this.#p(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#m){this.#p(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#m){this.#p(t);return}this.#i.lastChild?.focus()}#g(t){Vi._keyboardManager.exec(this,t)}#p(t){if(this.#m){this.hideDropdown();return}if(this.#s=t.detail===0,this.#l||(this.#l=new AbortController,window.addEventListener("pointerdown",this.#h.bind(this),{signal:this.#c.combinedSignal(this.#l)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const e=this.#i=this.#u();this.#t.append(e)}#h(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#l?.abort(),this.#l=null}get#m(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#m){this.#a?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const e=this.#c.highlightColors.values();for(const n of this.#i.children)n.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class qu{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,qu.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,colorValue:n}=this.#e,i=this.#t=document.createElement("input");return i.type="color",i.value=n||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",qu.#i[t]),i.addEventListener("input",()=>{this.#n.updateParams(e,i.value)},{signal:this.#n._signal}),i}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}Qt(116);Qt(531);function j_(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function hu(r){return Math.max(0,Math.min(255,255*r))}class H_{static CMYK_G([t,e,n,i]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+i)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=hu(t),[t,t,t]}static G_HTML([t]){const e=j_(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(hu)}static RGB_HTML(t){return`#${t.map(j_).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,i]){return["RGB",1-Math.min(1,t+i),1-Math.min(1,n+i),1-Math.min(1,e+i)]}static CMYK_rgb([t,e,n,i]){return[hu(1-Math.min(1,t+i)),hu(1-Math.min(1,n+i)),hu(1-Math.min(1,e+i))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const i=1-t,a=1-e,l=1-n,c=Math.min(i,a,l);return["CMYK",i,a,l,c]}}class BB{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${e}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${e}`),i}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){De("Abstract method `_createSVG` called.")}}class Kf extends BB{_createSVG(t){return document.createElementNS(ds,t)}}class MR{static setupStorage(t,e,n,i,a){const l=i.getValue(e,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),a==="print")break;t.addEventListener("input",c=>{i.setValue(e,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?t.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&t.removeAttribute("checked"),a==="print")break;t.addEventListener("change",c=>{i.setValue(e,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),a==="print")break;t.addEventListener("input",c=>{i.setValue(e,{value:c.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const c of n.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}t.addEventListener("input",c=>{const h=c.target.options,d=h.selectedIndex===-1?"":h[h.selectedIndex].value;i.setValue(e,{value:d})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:i,linkService:a}){const{attributes:l}=e,c=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${i}`);for(const[h,d]of Object.entries(l))if(d!=null)switch(h){case"class":d.length&&t.setAttribute(h,d.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",d);break;case"style":Object.assign(t.style,d);break;case"textContent":t.textContent=d;break;default:(!c||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,d)}c&&a.addLinkAttributes(t,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(t,l.dataId,e,n)}static render(t){const e=t.annotationStorage,n=t.linkService,i=t.xfaHtml,a=t.intent||"display",l=document.createElement(i.name);i.attributes&&this.setAttributes({html:l,element:i,intent:a,linkService:n});const c=a!=="richText",h=t.div;if(h.append(l),t.viewport){const m=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=m}c&&h.setAttribute("class","xfaLayer xfaFont");const d=[];if(i.children.length===0){if(i.value){const m=document.createTextNode(i.value);l.append(m),c&&Ku.shouldBuildText(i.name)&&d.push(m)}return{textDivs:d}}const p=[[i,-1,l]];for(;p.length>0;){const[m,v,E]=p.at(-1);if(v+1===m.children.length){p.pop();continue}const b=m.children[++p.at(-1)[1]];if(b===null)continue;const{name:T}=b;if(T==="#text"){const C=document.createTextNode(b.value);d.push(C),E.append(C);continue}const S=b?.attributes?.xmlns?document.createElementNS(b.attributes.xmlns,T):document.createElement(T);if(E.append(S),b.attributes&&this.setAttributes({html:S,element:b,storage:e,intent:a,linkService:n}),b.children?.length>0)p.push([b,-1,S]);else if(b.value){const C=document.createTextNode(b.value);c&&Ku.shouldBuildText(T)&&d.push(C),S.append(C)}}for(const m of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:d}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const FB=9,To=new WeakSet,UB=new Date().getTimezoneOffset()*60*1e3;class z_{static create(t){switch(t.data.annotationType){case on.LINK:return new o0(t);case on.TEXT:return new VB(t);case on.WIDGET:switch(t.data.fieldType){case"Tx":return new jB(t);case"Btn":return t.data.radioButton?new LR(t):t.data.checkBox?new zB(t):new GB(t);case"Ch":return new $B(t);case"Sig":return new HB(t)}return new Do(t);case on.POPUP:return new Fy(t);case on.FREETEXT:return new kR(t);case on.LINE:return new WB(t);case on.SQUARE:return new KB(t);case on.CIRCLE:return new XB(t);case on.POLYLINE:return new BR(t);case on.CARET:return new QB(t);case on.INK:return new l0(t);case on.POLYGON:return new qB(t);case on.HIGHLIGHT:return new FR(t);case on.UNDERLINE:return new JB(t);case on.SQUIGGLY:return new ZB(t);case on.STRIKEOUT:return new tF(t);case on.STAMP:return new UR(t);case on.FILEATTACHMENT:return new eF(t);default:return new tn(t)}}}class tn{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return tn._hasPopupData(this.data)}get hasCommentButton(){return this.enableComment&&this._isEditable&&this.hasPopupElement}get commentButtonPosition(){const{quadPoints:t,rect:e}=this.data;let n=-1/0,i=-1/0;if(t?.length>=8){for(let a=0;a<t.length;a+=8)t[a+1]>i?(i=t[a+1],n=t[a+2]):t[a+1]===i&&(n=Math.max(n,t[a+2]));return[n,i]}return e?[e[2],e[3]]:null}get commentButtonColor(){if(!this.data.color)return null;const[t,e,n]=this.data.color,a=255*(1-(this.data.opacity??1));return this.#i(Math.min(t+a,255),Math.min(e+a,255),Math.min(n+a,255))}#i(t,e,n){t/=255,e/=255,n/=255;const i=Math.max(t,e,n),a=Math.min(t,e,n),l=(i+a)/2,c=((1+Math.sqrt(l))/2*100).toFixed(2);if(i===a)return`hsl(0, 0%, ${c}%)`;const h=i-a;let d;i===t?d=(e-n)/h+(e<n?6:0):i===e?d=(n-t)/h+2:d=(t-e)/h+4,d=(d*60).toFixed(2);const p=(h/(1-Math.abs(2*l-1))*100).toFixed(2);return`hsl(${d}, ${p}%, ${c}%)`}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:n,pageHeight:i,pageX:a,pageY:l}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-a)/n,t[1]=100*(t[1]-l)/i,t}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:n}=t;e&&this.#s(e);let i=this.#n?.popup||this.popup;!i&&n?.text&&(this._createPopup(n),i=this.#n.popup),i&&(i.updateEdited(t),n?.deleted&&(i.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#s(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#s(t){const{container:{style:e},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:l,pageX:c,pageY:h}}}}=this;n?.splice(0,4,...t),e.left=`${100*(t[0]-c)/a}%`,e.top=`${100*(l-t[3]+h)/l}%`,i===0?(e.width=`${100*(t[2]-t[0])/a}%`,e.height=`${100*(t[3]-t[1])/l}%`):this.setRotation(i)}_createContainer(t){const{data:e,parent:{page:n,viewport:i}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",e.id),!(this instanceof Do)&&!(this instanceof o0)&&(a.tabIndex=0);const{style:l}=a;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(a.title=e.alternativeText),e.noRotate&&a.classList.add("norotate"),!e.rect||this instanceof Fy){const{rotation:T}=e;return!e.hasOwnCanvas&&T!==0&&this.setRotation(T,a),a}const{width:c,height:h}=this;if(!t&&e.borderStyle.width>0){l.borderWidth=`${e.borderStyle.width}px`;const T=e.borderStyle.horizontalCornerRadius,S=e.borderStyle.verticalCornerRadius;if(T>0||S>0){const D=`calc(${T}px * var(--total-scale-factor)) / calc(${S}px * var(--total-scale-factor))`;l.borderRadius=D}else if(this instanceof LR){const D=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=D}switch(e.borderStyle.style){case Cl.SOLID:l.borderStyle="solid";break;case Cl.DASHED:l.borderStyle="dashed";break;case Cl.BEVELED:Gt("Unimplemented border style: beveled");break;case Cl.INSET:Gt("Unimplemented border style: inset");break;case Cl.UNDERLINE:l.borderBottomStyle="solid";break}const C=e.borderColor||null;C?(this.#e=!0,l.borderColor=Nt.makeHexColor(C[0]|0,C[1]|0,C[2]|0)):l.borderWidth=0}const d=Nt.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:p,pageHeight:m,pageX:v,pageY:E}=i.rawDims;l.left=`${100*(d[0]-v)/p}%`,l.top=`${100*(d[1]-E)/m}%`;const{rotation:b}=e;return e.hasOwnCanvas||b===0?(l.width=`${100*c/p}%`,l.height=`${100*h/m}%`):this.setRotation(b,a),a}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims;let{width:a,height:l}=this;t%180!==0&&([a,l]=[l,a]),e.style.width=`${100*a/n}%`,e.style.height=`${100*l/i}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,i)=>{const a=i.detail[e],l=a[0],c=a.slice(1);i.target.style[n]=H_[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:H_[`${l}_rgb`](c)})};return ee(this,"_commonActions",{display:e=>{const{display:n}=e.detail,i=n%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const i of Object.keys(e.detail))(t[i]||n[i])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[i,a]of Object.entries(e)){const l=n[i];if(l){const c={detail:{[i]:a},target:t};l(c),delete e[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,i,a]=this.data.rect.map(T=>Math.fround(T));if(t.length===8){const[T,S,C,D]=t.subarray(2,6);if(i===T&&a===S&&e===C&&n===D)return}const{style:l}=this.container;let c;if(this.#e){const{borderColor:T,borderWidth:S}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${T}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const h=i-e,d=a-n,{svgFactory:p}=this,m=p.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0),m.role="none";const v=p.createElement("defs");m.append(v);const E=p.createElement("clipPath"),b=`clippath_${this.data.id}`;E.setAttribute("id",b),E.setAttribute("clipPathUnits","objectBoundingBox"),v.append(E);for(let T=2,S=t.length;T<S;T+=8){const C=t[T],D=t[T+1],O=t[T+2],F=t[T+3],k=p.createElement("rect"),z=(O-e)/h,P=(a-D)/d,N=(C-O)/h,M=(D-F)/d;k.setAttribute("x",z),k.setAttribute("y",P),k.setAttribute("width",N),k.setAttribute("height",M),E.append(k),c?.push(`<rect vector-effect="non-scaling-stroke" x="${z}" y="${P}" width="${N}" height="${M}"/>`)}this.#e&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(m),this.container.style.clipPath=`url(#${b})`}_createPopup(t=null){const{data:e}=this;let n,i;t?(n={str:t.text},i=t.date):(n=e.contentsObj,i=e.modificationDate);const a=this.#n=new Fy({data:{color:e.color,titleObj:e.titleObj,modificationDate:i,contentsObj:n,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent.div.append(a.render())}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}render(){De("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:a,id:l,exportValues:c}of i){if(a===-1||l===e)continue;const h=typeof c=="string"?c:null,d=document.querySelector(`[data-element-id="${l}"]`);if(d&&!To.has(d)){Gt(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:h,domElement:d})}return n}for(const i of document.getElementsByName(t)){const{exportValue:a}=i,l=i.getAttribute("data-element-id");l!==e&&To.has(i)&&n.push({id:l,exportValue:a,domElement:i})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class o0 extends tn{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let i=!1;return t.url?(e.addLinkAttributes(n,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(n,t.action,t.overlaidText),i=!0):t.attachment?(this.#e(n,t.attachment,t.overlaidText,t.attachmentDest),i=!0):t.setOCGState?(this.#n(n,t.setOCGState,t.overlaidText),i=!0):t.dest?(this._bindLink(n,t.dest,t.overlaidText),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),i=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(n),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,n=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),n&&(t.title=n)}_bindNamedAction(t,e,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),n&&(t.title=n),this.#t()}#e(t,e,n="",i=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:n&&(t.title=n),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,i),!1),this.#t()}#n(t,e,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),n&&(t.title=n),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(e.actions)){const a=n.get(i);a&&(t[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:i}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){Gt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(t.onclick=()=>!1);return}t.onclick=()=>{n?.();const{fields:i,refs:a,include:l}=e,c=[];if(i.length!==0||a.length!==0){const p=new Set(a);for(const m of i){const v=this._fieldObjects[m]||[];for(const{id:E}of v)p.add(E)}for(const m of Object.values(this._fieldObjects))for(const v of m)p.has(v.id)===l&&c.push(v)}else for(const p of Object.values(this._fieldObjects))c.push(...p);const h=this.annotationStorage,d=[];for(const p of c){const{id:m}=p;switch(d.push(m),p.type){case"text":{const E=p.defaultValue||"";h.setValue(m,{value:E});break}case"checkbox":case"radiobutton":{const E=p.defaultValue===p.exportValues;h.setValue(m,{value:E});break}case"combobox":case"listbox":{const E=p.defaultValue||"";h.setValue(m,{value:E});break}default:continue}const v=document.querySelector(`[data-element-id="${m}"]`);if(v){if(!To.has(v)){Gt(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}}class VB extends tn{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Do extends tn{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Bn.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,i,a){n.includes("mouse")?t.addEventListener(n,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:a(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(n,l=>{if(n==="blur"){if(!e.focused||!l.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:a(l)}})})}_setEventListeners(t,e,n,i){for(const[a,l]of n)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,a,l,i),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Nt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||FB,a=t.style;let l;const c=2,h=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c),p=Math.round(d/($m*i))||1,m=d/p;l=Math.min(i,h(m/$m))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(i,h(d/$m))}a.fontSize=`calc(${l}px * var(--total-scale-factor))`,a.color=Nt.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(a.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class jB extends Do{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,i){const a=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[e]=n),a.setValue(l.id,{[i]:n})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const i=t.getValue(e,{value:this.data.fieldValue});let a=i.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let c=i.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:a,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=c??a,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",c??a),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),To.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:d,datetimeType:p,timeStep:m}=this.data,v=!!p&&this.enableScripting;d&&(n.title=d),this._setRequired(n,this.data.required),l&&(n.maxLength=l),n.addEventListener("input",b=>{t.setValue(e,{value:b.target.value}),this.setPropertyOnSiblings(n,"value",b.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",b=>{const T=this.data.defaultFieldValue??"";n.value=h.userValue=T,h.formattedValue=null});let E=b=>{const{formattedValue:T}=h;T!=null&&(b.target.value=T),b.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",T=>{if(h.focused)return;const{target:S}=T;if(v&&(S.type=p,m&&(S.step=m)),h.userValue){const C=h.userValue;if(v)if(p==="time"){const D=new Date(C),O=[D.getHours(),D.getMinutes(),D.getSeconds()];S.value=O.map(F=>F.toString().padStart(2,"0")).join(":")}else S.value=new Date(C-UB).toISOString().split(p==="date"?"T":".",1)[0];else S.value=C}h.lastCommittedValue=S.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",T=>{this.showElementAndHideCanvas(T.target);const S={value(C){h.userValue=C.detail.value??"",v||t.setValue(e,{value:h.userValue.toString()}),C.target.value=h.userValue},formattedValue(C){const{formattedValue:D}=C.detail;h.formattedValue=D,D!=null&&C.target!==document.activeElement&&(C.target.value=D);const O={formattedValue:D};v&&(O.value=D),t.setValue(e,O)},selRange(C){C.target.setSelectionRange(...C.detail.selRange)},charLimit:C=>{const{charLimit:D}=C.detail,{target:O}=C;if(D===0){O.removeAttribute("maxLength");return}O.setAttribute("maxLength",D);let F=h.userValue;!F||F.length<=D||(F=F.slice(0,D),O.value=h.userValue=F,t.setValue(e,{value:F}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:F,willCommit:!0,commitKey:1,selStart:O.selectionStart,selEnd:O.selectionEnd}}))}};this._dispatchEventFromSandbox(S,T)}),n.addEventListener("keydown",T=>{h.commitKey=1;let S=-1;if(T.key==="Escape"?S=0:T.key==="Enter"&&!this.data.multiLine?S=2:T.key==="Tab"&&(h.commitKey=3),S===-1)return;const{value:C}=T.target;h.lastCommittedValue!==C&&(h.lastCommittedValue=C,h.userValue=C,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,willCommit:!0,commitKey:S,selStart:T.target.selectionStart,selEnd:T.target.selectionEnd}}))});const b=E;E=null,n.addEventListener("blur",T=>{if(!h.focused||!T.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:S}=T;let{value:C}=S;if(v){if(C&&p==="time"){const D=C.split(":").map(O=>parseInt(O,10));C=new Date(2e3,0,1,D[0],D[1],D[2]||0).valueOf(),S.step=""}else C=new Date(C).valueOf();S.type="text"}h.userValue=C,h.lastCommittedValue!==C&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,willCommit:!0,commitKey:h.commitKey,selStart:T.target.selectionStart,selEnd:T.target.selectionEnd}}),b(T)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",T=>{h.lastCommittedValue=null;const{data:S,target:C}=T,{value:D,selectionStart:O,selectionEnd:F}=C;let k=O,z=F;switch(T.inputType){case"deleteWordBackward":{const P=D.substring(0,O).match(/\w*[^\w]*$/);P&&(k-=P[0].length);break}case"deleteWordForward":{const P=D.substring(O).match(/^[^\w]*\w*/);P&&(z+=P[0].length);break}case"deleteContentBackward":O===F&&(k-=1);break;case"deleteContentForward":O===F&&(z+=1);break}T.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:D,change:S||"",willCommit:!1,selStart:k,selEnd:z}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],T=>T.target.value)}if(E&&n.addEventListener("blur",E),this.data.comb){const T=(this.data.rect[2]-this.data.rect[0])/l;n.classList.add("comb"),n.style.letterSpacing=`calc(${T}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class HB extends Do{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class zB extends Do{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",t.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return To.add(a),a.setAttribute("data-element-id",n),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=e.fieldName,i&&a.setAttribute("checked",!0),a.setAttribute("exportValue",e.exportValue),a.tabIndex=0,a.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const d of this._getElementsByName(c,n)){const p=h&&d.exportValue===e.exportValue;d.domElement&&(d.domElement.checked=p),t.setValue(d.id,{value:p})}t.setValue(n,{value:h})}),a.addEventListener("resetform",l=>{const c=e.defaultFieldValue||"Off";l.target.checked=c===e.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",l=>{const c={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class LR extends Do{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof i=="string"&&(i=i!==e.buttonValue,t.setValue(n,{value:i})),i)for(const l of this._getElementsByName(e.fieldName,n))t.setValue(l.id,{value:!1});const a=document.createElement("input");if(To.add(a),a.setAttribute("data-element-id",n),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=e.fieldName,i&&a.setAttribute("checked",!0),a.tabIndex=0,a.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const d of this._getElementsByName(c,n))t.setValue(d.id,{value:!1});t.setValue(n,{value:h})}),a.addEventListener("resetform",l=>{const c=e.defaultFieldValue;l.target.checked=c!=null&&c===e.buttonValue}),this.enableScripting&&this.hasJSActions){const l=e.buttonValue;a.addEventListener("updatefromsandbox",c=>{const h={value:d=>{const p=l===d.detail.value;for(const m of this._getElementsByName(d.target.name)){const v=p&&m.id===n;m.domElement&&(m.domElement.checked=v),t.setValue(m.id,{value:v})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class GB extends o0{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class $B extends Do{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),i=document.createElement("select");To.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",p=>{const m=this.data.defaultFieldValue;for(const v of i.options)v.selected=v.value===m});for(const p of this.data.options){const m=document.createElement("option");m.textContent=p.displayValue,m.value=p.exportValue,n.value.includes(p.exportValue)&&(m.setAttribute("selected",!0),a=!1),i.append(m)}let l=null;if(a){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),i.prepend(p),l=()=>{p.remove(),i.removeEventListener("input",l),l=null},i.addEventListener("input",l)}const c=p=>{const m=p?"value":"textContent",{options:v,multiple:E}=i;return E?Array.prototype.filter.call(v,b=>b.selected).map(b=>b[m]):v.selectedIndex===-1?null:v[v.selectedIndex][m]};let h=c(!1);const d=p=>{const m=p.target.options;return Array.prototype.map.call(m,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",p=>{const m={value(v){l?.();const E=v.detail.value,b=new Set(Array.isArray(E)?E:[E]);for(const T of i.options)T.selected=b.has(T.value);t.setValue(e,{value:c(!0)}),h=c(!1)},multipleSelection(v){i.multiple=!0},remove(v){const E=i.options,b=v.detail.remove;E[b].selected=!1,i.remove(b),E.length>0&&Array.prototype.findIndex.call(E,S=>S.selected)===-1&&(E[0].selected=!0),t.setValue(e,{value:c(!0),items:d(v)}),h=c(!1)},clear(v){for(;i.length!==0;)i.remove(0);t.setValue(e,{value:null,items:[]}),h=c(!1)},insert(v){const{index:E,displayValue:b,exportValue:T}=v.detail.insert,S=i.children[E],C=document.createElement("option");C.textContent=b,C.value=T,S?S.before(C):i.append(C),t.setValue(e,{value:c(!0),items:d(v)}),h=c(!1)},items(v){const{items:E}=v.detail;for(;i.length!==0;)i.remove(0);for(const b of E){const{displayValue:T,exportValue:S}=b,C=document.createElement("option");C.textContent=T,C.value=S,i.append(C)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(e,{value:c(!0),items:d(v)}),h=c(!1)},indices(v){const E=new Set(v.detail.indices);for(const b of v.target.options)b.selected=E.has(b.index);t.setValue(e,{value:c(!0)}),h=c(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(m,p)}),i.addEventListener("input",p=>{const m=c(!0),v=c(!1);t.setValue(e,{value:m}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:v,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):i.addEventListener("input",function(p){t.setValue(e,{value:c(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Fy extends tn{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:tn._hasPopupData(e)}),this.elements=n,this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=new YB({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,eventBus:this.linkService.eventBus}),n=[];for(const i of this.elements)i.popup=e,i.container.ariaHasPopup="dialog",n.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(i=>`${Qv}${i}`).join(",")),this.container}}class YB{#t=this.#M.bind(this);#e=this.#S.bind(this);#n=this.#U.bind(this);#i=this.#O.bind(this);#s=null;#r=null;#a=null;#o=null;#l=null;#c=null;#d=null;#u=null;#f=!1;#g=null;#p=null;#h=null;#m=null;#E=null;#y=null;#b=null;#T=null;#v=null;#_=null;#I=!1;constructor({container:t,color:e,elements:n,titleObj:i,modificationDate:a,contentsObj:l,richText:c,parent:h,rect:d,parentRect:p,open:m,eventBus:v=null}){this.#r=t,this.#v=i,this.#a=l,this.#T=c,this.#d=h,this.#s=e,this.#b=d,this.#u=p,this.#l=n,this.#c=v,this.#o=Py.toDateObject(a),this.trigger=n.flatMap(E=>E.getElementsToTriggerPopup()),this.#R(),this.#r.hidden=!0,m&&this.#O()}#R(){if(this.#p)return;this.#p=new AbortController;const{signal:t}=this.#p;for(const e of this.trigger)e.addEventListener("click",this.#i,{signal:t}),e.addEventListener("mouseenter",this.#n,{signal:t}),e.addEventListener("mouseleave",this.#e,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#t,{signal:t});this.#N()}#w(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#E=t._normalizePoint(t.commentButtonPosition),this.#y=t.commentButtonColor)}#N(){if(this.#m||(this.#E||this.#w(),!this.#E))return;const t=this.#m=document.createElement("button");t.className="annotationCommentButton";const e=this.#l[0].container;t.style.zIndex=e.style.zIndex+1,t.tabIndex=0;const{signal:n}=this.#p;t.addEventListener("hover",this.#i,{signal:n}),t.addEventListener("keydown",this.#t,{signal:n}),t.addEventListener("click",()=>{const[{data:{id:a},annotationEditorType:l}]=this.#l;this.#c?.dispatch("switchannotationeditormode",{source:this,editId:a,mode:l,editComment:!0})},{signal:n});const{style:i}=t;i.left=`calc(${this.#E[0]}%)`,i.top=`calc(${this.#E[1]}% - var(--comment-button-dim))`,this.#y&&(i.backgroundColor=this.#y),e.after(t)}render(){if(this.#g)return;const t=this.#g=document.createElement("div");if(t.className="popup",this.#s){const i=t.style.outlineColor=Nt.makeHexColor(...this.#s);t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#v?.str){const i=document.createElement("span");i.className="title",e.append(i),{dir:i.dir,str:i.textContent}=this.#v}if(t.append(e),this.#o){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),i.dateTime=this.#o.toISOString(),e.append(i)}const n=this.#C;if(n)MR.render({xfaHtml:n,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const i=this._formatContents(this.#a);t.append(i)}this.#r.append(t)}get#C(){const t=this.#T,e=this.#a;return t?.str&&(!e?.str||e.str===t.str)&&this.#T.html||null}get#x(){return this.#C?.attributes?.style?.fontSize||0}get#L(){return this.#C?.attributes?.style?.color||null}#P(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},i={style:{color:this.#L,fontSize:this.#x?`calc(${this.#x}px * var(--total-scale-factor))`:""}};for(const a of t.split(`
`))e.push({name:"span",value:a,attributes:i});return n}_formatContents({str:t,dir:e}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=e;const i=t.split(/(?:\r\n?|\n)/);for(let a=0,l=i.length;a<l;++a){const c=i[a];n.append(document.createTextNode(c)),a<l-1&&n.append(document.createElement("br"))}return n}#M(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#O()}updateEdited({rect:t,popup:e,deleted:n}){if(n||e?.deleted){this.remove();return}this.#R(),this.#_||={contentsObj:this.#a,richText:this.#T},t&&(this.#h=null),e&&(this.#T=this.#P(e.text),this.#o=Py.toDateObject(e.date),this.#a=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#_&&({contentsObj:this.#a,richText:this.#T}=this.#_,this.#_=null,this.#g?.remove(),this.#g=null,this.#h=null)}remove(){this.#p?.abort(),this.#p=null,this.#g?.remove(),this.#g=null,this.#I=!1,this.#f=!1;for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#k(){if(this.#h!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:i,pageY:a}}}=this.#d;let l=!!this.#u,c=l?this.#u:this.#b;for(const b of this.#l)if(!c||Nt.intersect(b.data.rect,c)!==null){c=b.data.rect,l=!0;break}const h=Nt.normalizeRect([c[0],t[3]-c[1]+t[1],c[2],t[3]-c[3]+t[1]]),p=l?c[2]-c[0]+5:0,m=h[0]+p,v=h[1];this.#h=[100*(m-i)/e,100*(v-a)/n];const{style:E}=this.#r;E.left=`${this.#h[0]}%`,E.top=`${this.#h[1]}%`}#O(){this.#f=!this.#f,this.#f?(this.#U(),this.#r.addEventListener("click",this.#i),this.#r.addEventListener("keydown",this.#t)):(this.#S(),this.#r.removeEventListener("click",this.#i),this.#r.removeEventListener("keydown",this.#t))}#U(){this.#g||this.render(),this.isVisible?this.#f&&this.#r.classList.add("focused"):(this.#k(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#S(){this.#r.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#I=this.isVisible,this.#I&&(this.#r.hidden=!0)}maybeShow(){this.#R(),this.#I&&(this.#g||this.#U(),this.#I=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}}class kR extends tn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=$t.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class WB extends tn{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:n}=this,i=this.svgFactory.create(e,n,!0),a=this.#t=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class KB extends tn{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:n}=this,i=this.svgFactory.create(e,n,!0),a=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",a/2),l.setAttribute("y",a/2),l.setAttribute("width",e-a),l.setAttribute("height",n-a),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),i.append(l),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class XB extends tn{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:n}=this,i=this.svgFactory.create(e,n,!0),a=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",e/2),l.setAttribute("cy",n/2),l.setAttribute("rx",e/2-a/2),l.setAttribute("ry",n/2-a/2),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),i.append(l),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class BR extends tn{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:n,popupRef:i},width:a,height:l}=this;if(!e)return this.container;const c=this.svgFactory.create(a,l,!0);let h=[];for(let p=0,m=e.length;p<m;p+=2){const v=e[p]-t[0],E=t[3]-e[p+1];h.push(`${v},${E}`)}h=h.join(" ");const d=this.#t=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",h),d.setAttribute("stroke-width",n.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),c.append(d),this.container.append(c),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class qB extends BR{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class QB extends tn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class l0 extends tn{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?$t.HIGHLIGHT:$t.INK}#n(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:n,borderStyle:i,popupRef:a}}=this,{transform:l,width:c,height:h}=this.#n(e,t),d=this.svgFactory.create(c,h,!0),p=this.#t=this.svgFactory.createElement("svg:g");d.append(p),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",l);for(let m=0,v=n.length;m<v;m++){const E=this.svgFactory.createElement(this.svgElementName);this.#e.push(E),E.setAttribute("points",n[m].join(",")),p.append(E)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:n,rect:i}=t,a=this.#t;if(e>=0&&a.setAttribute("stroke-width",e||1),n)for(let l=0,c=this.#e.length;l<c;l++)this.#e[l].setAttribute("points",n[l].join(","));if(i){const{transform:l,width:c,height:h}=this.#n(this.data.rotation,i);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),a.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}get commentButtonPosition(){const{inkLists:t,rect:e}=this.data;if(t?.length>=1){let n=-1/0,i=-1/0;for(const a of t)for(let l=0,c=a.length;l<c;l+=2)a[l+1]>i?(i=a[l+1],n=a[l]):a[l+1]===i&&(n=Math.max(n,a[l]));if(n!==1/0)return[n,i]}return e?[e[2],e[3]]:null}}class FR extends tn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=$t.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class JB extends tn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class ZB extends tn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class tF extends tn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class UR extends tn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=$t.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class eF extends tn{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let n;e.hasAppearance||e.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#e.bind(this)),this.#t=n;const{isMac:i}=Bn.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(i?a.metaKey:a.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class c0{#t=null;#e=null;#n=new Map;#i=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:i,page:a,viewport:l,structTreeLayer:c}){this.div=t,this.#t=e,this.#e=n,this.#i=c||null,this.page=a,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return this.#n.size>0}async#s(t,e,n){const i=t.firstChild||t,a=i.id=`${Qv}${e}`,l=await this.#i?.getAriaAttributes(a);if(l)for(const[c,h]of l)i.setAttribute(c,h);n?n.at(-1).container.after(t):(this.div.append(t),this.#t?.moveElementInDOM(this.div,t,i,!1))}async render(t){const{annotations:e}=t,n=this.div;bo(n,this.viewport);const i=new Map,a={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Kf,annotationStorage:t.annotationStorage||new n0,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of e){if(l.noHTML)continue;const c=l.annotationType===on.POPUP;if(c){const p=i.get(l.id);if(!p)continue;a.elements=p}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;a.data=l;const h=z_.create(a);if(!h.isRenderable)continue;if(!c&&l.popupRef){const p=i.get(l.popupRef);p?p.push(h):i.set(l.popupRef,[h])}const d=h.render();l.hidden&&(d.style.visibility="hidden"),await this.#s(d,l.id,a.elements),h._isEditable&&(this.#n.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}this.#r()}async addLinkAnnotations(t,e){const n={data:null,layer:this.div,linkService:e,svgFactory:new Kf,parent:this};for(const i of t){i.borderStyle||=c0._defaultBorderStyle,n.data=i;const a=z_.create(n);if(!a.isRenderable)continue;const l=a.render();await this.#s(l,i.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,bo(e,{rotation:t.rotation}),this.#r(),e.hidden=!1}#r(){if(!this.#e)return;const t=this.div;for(const[e,n]of this.#e){const i=t.querySelector(`[data-annotation-id="${e}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:a}=i;a?a.nodeName==="CANVAS"?a.replaceWith(n):a.classList.contains("annotationContent")?a.after(n):a.before(n):i.append(n);const l=this.#n.get(e);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,i.id,n),l._hasNoCanvas=!1):l.canvas=n)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}static get _defaultBorderStyle(){return ee(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Cl.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const sf=/\r\n?|\n/g;class wn extends Lt{#t;#e="";#n=`${this.id}-editor`;#i=null;#s;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=wn.prototype,e=a=>a.isEmpty(),n=Sa.TRANSLATE_SMALL,i=Sa.TRANSLATE_BIG;return ee(this,"_keyboardManager",new mh([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}]]))}static _type="freetext";static _editorType=$t.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#t=t.color||wn._defaultColor||Lt._defaultLineColor,this.#s=t.fontSize||wn._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(t,e){Lt.initialize(t,e);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case le.FREETEXT_SIZE:wn._defaultFontSize=e;break;case le.FREETEXT_COLOR:wn._defaultColor=e;break}}updateParams(t,e){switch(t){case le.FREETEXT_SIZE:this.#r(e);break;case le.FREETEXT_COLOR:this.#a(e);break}}static get defaultPropertiesToUpdate(){return[[le.FREETEXT_SIZE,wn._defaultFontSize],[le.FREETEXT_COLOR,wn._defaultColor||Lt._defaultLineColor]]}get propertiesToUpdate(){return[[le.FREETEXT_SIZE,this.#s],[le.FREETEXT_COLOR,this.#t]]}get toolbarButtons(){return this._colorPicker||=new qu(this),[["colorPicker",this._colorPicker]]}get colorType(){return le.FREETEXT_COLOR}get colorValue(){return this.#t}#r(t){const e=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-this.#s)*this.parentScale),this.#s=i,this.#l()},n=this.#s;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:le.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#a(t){const e=i=>{this.#t=this.editorDiv.style.color=i,this._colorPicker?.update(i)},n=this.#t;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:le.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-wn._internalPadding*t,-(wn._internalPadding+this.#s)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const t=[];this.editorDiv.normalize();let e=null;for(const n of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(t.push(wn.#c(n)),e=n);return t.join(`
`)}#l(){const[t,e]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:i,div:a}=this,l=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",i.div.append(this.div),n=a.getBoundingClientRect(),a.remove(),a.style.display=l,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/t,this.height=n.height/e):(this.width=n.height/t,this.height=n.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#e,e=this.#e=this.#o().trimEnd();if(t===e)return;const n=i=>{if(this.#e=i,!i){this.remove();return}this.#d(),this._uiManager.rebuild(this),this.#l()};this.addCommands({cmd:()=>{n(e)},undo:()=>{n(t)},mustExec:!1}),this.#l()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){wn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,n.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,a]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[d,p]=this.pageDimensions,[m,v]=this.pageTranslation;let E,b;switch(this.rotation){case 0:E=t+(l[0]-m)/d,b=e+this.height-(l[1]-v)/p;break;case 90:E=t+(l[0]-m)/d,b=e-(l[1]-v)/p,[c,h]=[h,-c];break;case 180:E=t-this.width+(l[0]-m)/d,b=e-(l[1]-v)/p,[c,h]=[-c,-h];break;case 270:E=t+(l[0]-m-this.height*p)/d,b=e+(l[1]-v-this.width*d)/p,[c,h]=[-h,c];break}this.setAt(E*i,b*a,c,h)}else this._moveAfterPaste(t,e);this.#d(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(sf,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:n}=e;if(n.length===1&&n[0]==="text/plain")return;t.preventDefault();const i=wn.#f(e.getData("text")||"").replaceAll(sf,`
`);if(!i)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const l=a.getRangeAt(0);if(!i.includes(`
`)){l.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:h}=l,d=[],p=[];if(c.nodeType===Node.TEXT_NODE){const E=c.parentElement;if(p.push(c.nodeValue.slice(h).replaceAll(sf,"")),E!==this.editorDiv){let b=d;for(const T of this.editorDiv.childNodes){if(T===E){b=p;continue}b.push(wn.#c(T))}}d.push(c.nodeValue.slice(0,h).replaceAll(sf,""))}else if(c===this.editorDiv){let E=d,b=0;for(const T of this.editorDiv.childNodes)b++===h&&(E=p),E.push(wn.#c(T))}this.#e=`${d.join(`
`)}${i}${p.join(`
`)}`,this.#d();const m=new Range;let v=Math.sumPrecise(d.map(E=>E.length));for(const{firstChild:E}of this.editorDiv.childNodes)if(E.nodeType===Node.TEXT_NODE){const b=E.nodeValue.length;if(v<=b){m.setStart(E,v),m.setEnd(E,v);break}v-=b}a.removeAllRanges(),a.addRange(m)}#d(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const t of this.#e.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#u(){return this.#e.replaceAll(""," ")}static#f(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=wn._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,n){let i=null;if(t instanceof kR){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:d,id:p,popupRef:m,contentsObj:v},textContent:E,textPosition:b,parent:{page:{pageNumber:T}}}=t;if(!E||E.length===0)return null;i=t={annotationType:$t.FREETEXT,color:Array.from(c),fontSize:l,value:E.join(`
`),position:b,pageIndex:T-1,rect:h.slice(0),rotation:d,annotationElementId:p,id:p,deleted:!1,popupRef:m,comment:v?.str||null}}const a=await super.deserialize(t,e,n);return a.#s=t.fontSize,a.#t=Nt.makeHexColor(...t.color),a.#e=wn.#f(t.value),a._initialData=i,t.comment&&a.setCommentData(t.comment),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=this.getPDFRect(),n=Lt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),i={annotationType:$t.FREETEXT,color:n,fontSize:this.#s,value:this.#u(),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!this.#g(i)?null:(i.id=this.annotationElementId,i)}#g(t){const{value:e,fontSize:n,color:i,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==n||t.color.some((l,c)=>l!==i[c])||t.pageIndex!==a}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:n}=e;n.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,n.color=this.#t,e.replaceChildren();for(const a of this.#e.split(`
`)){const l=document.createElement("div");l.append(a?document.createTextNode(a):document.createElement("br")),e.append(l)}const i={rect:this.getPDFRect()};return i.popup=this.hasEditedComment?this.comment:{text:this.#e},t.updateEdited(i),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class Dt{static PRECISION=1e-4;toSVGPath(){De("Abstract method `toSVGPath` must be implemented.")}get box(){De("Abstract getter `box` must be implemented.")}serialize(t,e){De("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,i,a,l){l||=new Float32Array(t.length);for(let c=0,h=t.length;c<h;c+=2)l[c]=e+t[c]*i,l[c+1]=n+t[c+1]*a;return l}static _rescaleAndSwap(t,e,n,i,a,l){l||=new Float32Array(t.length);for(let c=0,h=t.length;c<h;c+=2)l[c]=e+t[c+1]*i,l[c+1]=n+t[c]*a;return l}static _translate(t,e,n,i){i||=new Float32Array(t.length);for(let a=0,l=t.length;a<l;a+=2)i[a]=e+t[a],i[a+1]=n+t[a+1];return i}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,n,i,a){switch(a){case 90:return[1-e/n,t/i];case 180:return[1-t/n,1-e/i];case 270:return[e/n,1-t/i];default:return[t/n,e/i]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,i,a,l){return[(t+5*n)/6,(e+5*i)/6,(5*n+a)/6,(5*i+l)/6,(n+a)/2,(i+l)/2]}}class ao{#t;#e=[];#n;#i;#s=[];#r=new Float32Array(18);#a;#o;#l;#c;#d;#u;#f=[];static#g=8;static#p=2;static#h=ao.#g+ao.#p;constructor({x:t,y:e},n,i,a,l,c=0){this.#t=n,this.#u=a*i,this.#i=l,this.#r.set([NaN,NaN,NaN,NaN,t,e],6),this.#n=c,this.#c=ao.#g*i,this.#l=ao.#h*i,this.#d=i,this.#f.push(t,e)}isEmpty(){return isNaN(this.#r[8])}#m(){const t=this.#r.subarray(4,6),e=this.#r.subarray(16,18),[n,i,a,l]=this.#t;return[(this.#a+(t[0]-e[0])/2-n)/a,(this.#o+(t[1]-e[1])/2-i)/l,(this.#a+(e[0]-t[0])/2-n)/a,(this.#o+(e[1]-t[1])/2-i)/l]}add({x:t,y:e}){this.#a=t,this.#o=e;const[n,i,a,l]=this.#t;let[c,h,d,p]=this.#r.subarray(8,12);const m=t-d,v=e-p,E=Math.hypot(m,v);if(E<this.#l)return!1;const b=E-this.#c,T=b/E,S=T*m,C=T*v;let D=c,O=h;c=d,h=p,d+=S,p+=C,this.#f?.push(t,e);const F=-C/b,k=S/b,z=F*this.#u,P=k*this.#u;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([d+z,p+P],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([d-z,p-P],16),isNaN(this.#r[6])?(this.#s.length===0&&(this.#r.set([c+z,h+P],2),this.#s.push(NaN,NaN,NaN,NaN,(c+z-n)/a,(h+P-i)/l),this.#r.set([c-z,h-P],14),this.#e.push(NaN,NaN,NaN,NaN,(c-z-n)/a,(h-P-i)/l)),this.#r.set([D,O,c,h,d,p],6),!this.isEmpty()):(this.#r.set([D,O,c,h,d,p],6),Math.abs(Math.atan2(O-h,D-c)-Math.atan2(C,S))<Math.PI/2?([c,h,d,p]=this.#r.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((c+d)/2-n)/a,((h+p)/2-i)/l),[c,h,D,O]=this.#r.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((D+c)/2-n)/a,((O+h)/2-i)/l),!0):([D,O,c,h,d,p]=this.#r.subarray(0,6),this.#s.push(((D+5*c)/6-n)/a,((O+5*h)/6-i)/l,((5*c+d)/6-n)/a,((5*h+p)/6-i)/l,((c+d)/2-n)/a,((h+p)/2-i)/l),[d,p,c,h,D,O]=this.#r.subarray(12,18),this.#e.push(((D+5*c)/6-n)/a,((O+5*h)/6-i)/l,((5*c+d)/6-n)/a,((5*h+p)/6-i)/l,((c+d)/2-n)/a,((h+p)/2-i)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#s,e=this.#e;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#E();const n=[];n.push(`M${t[4]} ${t[5]}`);for(let i=6;i<t.length;i+=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);this.#b(n);for(let i=e.length-6;i>=6;i-=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);return this.#y(n),n.join(" ")}#E(){const[t,e,n,i]=this.#t,[a,l,c,h]=this.#m();return`M${(this.#r[2]-t)/n} ${(this.#r[3]-e)/i} L${(this.#r[4]-t)/n} ${(this.#r[5]-e)/i} L${a} ${l} L${c} ${h} L${(this.#r[16]-t)/n} ${(this.#r[17]-e)/i} L${(this.#r[14]-t)/n} ${(this.#r[15]-e)/i} Z`}#y(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#b(t){const[e,n,i,a]=this.#t,l=this.#r.subarray(4,6),c=this.#r.subarray(16,18),[h,d,p,m]=this.#m();t.push(`L${(l[0]-e)/i} ${(l[1]-n)/a} L${h} ${d} L${p} ${m} L${(c[0]-e)/i} ${(c[1]-n)/a}`)}newFreeDrawOutline(t,e,n,i,a,l){return new VR(t,e,n,i,a,l)}getOutlines(){const t=this.#s,e=this.#e,n=this.#r,[i,a,l,c]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let m=0,v=h.length-2;m<v;m+=2)h[m]=(this.#f[m]-i)/l,h[m+1]=(this.#f[m+1]-a)/c;if(h[h.length-2]=(this.#a-i)/l,h[h.length-1]=(this.#o-a)/c,isNaN(n[6])&&!this.isEmpty())return this.#T(h);const d=new Float32Array(this.#s.length+24+this.#e.length);let p=t.length;for(let m=0;m<p;m+=2){if(isNaN(t[m])){d[m]=d[m+1]=NaN;continue}d[m]=t[m],d[m+1]=t[m+1]}p=this.#_(d,p);for(let m=e.length-6;m>=6;m-=6)for(let v=0;v<6;v+=2){if(isNaN(e[m+v])){d[p]=d[p+1]=NaN,p+=2;continue}d[p]=e[m+v],d[p+1]=e[m+v+1],p+=2}return this.#v(d,p),this.newFreeDrawOutline(d,h,this.#t,this.#d,this.#n,this.#i)}#T(t){const e=this.#r,[n,i,a,l]=this.#t,[c,h,d,p]=this.#m(),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(e[2]-n)/a,(e[3]-i)/l,NaN,NaN,NaN,NaN,(e[4]-n)/a,(e[5]-i)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,(e[16]-n)/a,(e[17]-i)/l,NaN,NaN,NaN,NaN,(e[14]-n)/a,(e[15]-i)/l],0),this.newFreeDrawOutline(m,t,this.#t,this.#d,this.#n,this.#i)}#v(t,e){const n=this.#e;return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6}#_(t,e){const n=this.#r.subarray(4,6),i=this.#r.subarray(16,18),[a,l,c,h]=this.#t,[d,p,m,v]=this.#m();return t.set([NaN,NaN,NaN,NaN,(n[0]-a)/c,(n[1]-l)/h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,m,v,NaN,NaN,NaN,NaN,(i[0]-a)/c,(i[1]-l)/h],e),e+=24}}class VR extends Dt{#t;#e=new Float32Array(4);#n;#i;#s;#r;#a;constructor(t,e,n,i,a,l){super(),this.#a=t,this.#s=e,this.#t=n,this.#r=i,this.#n=a,this.#i=l,this.lastPoint=[NaN,NaN],this.#o(l);const[c,h,d,p]=this.#e;for(let m=0,v=t.length;m<v;m+=2)t[m]=(t[m]-c)/d,t[m+1]=(t[m+1]-h)/p;for(let m=0,v=e.length;m<v;m+=2)e[m]=(e[m]-c)/d,e[m+1]=(e[m+1]-h)/p}toSVGPath(){const t=[`M${this.#a[4]} ${this.#a[5]}`];for(let e=6,n=this.#a.length;e<n;e+=6){if(isNaN(this.#a[e])){t.push(`L${this.#a[e+4]} ${this.#a[e+5]}`);continue}t.push(`C${this.#a[e]} ${this.#a[e+1]} ${this.#a[e+2]} ${this.#a[e+3]} ${this.#a[e+4]} ${this.#a[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,n,i],a){const l=n-t,c=i-e;let h,d;switch(a){case 0:h=Dt._rescale(this.#a,t,i,l,-c),d=Dt._rescale(this.#s,t,i,l,-c);break;case 90:h=Dt._rescaleAndSwap(this.#a,t,e,l,c),d=Dt._rescaleAndSwap(this.#s,t,e,l,c);break;case 180:h=Dt._rescale(this.#a,n,e,-l,c),d=Dt._rescale(this.#s,n,e,-l,c);break;case 270:h=Dt._rescaleAndSwap(this.#a,n,i,-l,-c),d=Dt._rescaleAndSwap(this.#s,n,i,-l,-c);break}return{outline:Array.from(h),points:[Array.from(d)]}}#o(t){const e=this.#a;let n=e[4],i=e[5];const a=[n,i,n,i];let l=n,c=i;const h=t?Math.max:Math.min;for(let p=6,m=e.length;p<m;p+=6){const v=e[p+4],E=e[p+5];if(isNaN(e[p]))Nt.pointBoundingBox(v,E,a),c<E?(l=v,c=E):c===E&&(l=h(l,v));else{const b=[1/0,1/0,-1/0,-1/0];Nt.bezierBoundingBox(n,i,...e.slice(p,p+6),b),Nt.rectBoundingBox(...b,a),c<b[3]?(l=b[2],c=b[3]):c===b[3]&&(l=h(l,b[2]))}n=v,i=E}const d=this.#e;d[0]=a[0]-this.#n,d[1]=a[1]-this.#n,d[2]=a[2]-a[0]+2*this.#n,d[3]=a[3]-a[1]+2*this.#n,this.lastPoint=[l,c]}get box(){return this.#e}newOutliner(t,e,n,i,a,l=0){return new ao(t,e,n,i,a,l)}getNewOutline(t,e){const[n,i,a,l]=this.#e,[c,h,d,p]=this.#t,m=a*d,v=l*p,E=n*d+c,b=i*p+h,T=this.newOutliner({x:this.#s[0]*m+E,y:this.#s[1]*v+b},this.#t,this.#r,t,this.#i,e??this.#n);for(let S=2;S<this.#s.length;S+=2)T.add({x:this.#s[S]*m+E,y:this.#s[S+1]*v+b});return T.getOutlines()}}class Uy{#t;#e;#n=[];#i=[];constructor(t,e=0,n=0,i=!0){const a=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:E,y:b,width:T,height:S}of t){const C=Math.floor((E-e)/l)*l,D=Math.ceil((E+T+e)/l)*l,O=Math.floor((b-e)/l)*l,F=Math.ceil((b+S+e)/l)*l,k=[C,O,F,!0],z=[D,O,F,!1];this.#n.push(k,z),Nt.rectBoundingBox(C,O,D,F,a)}const c=a[2]-a[0]+2*n,h=a[3]-a[1]+2*n,d=a[0]-n,p=a[1]-n,m=this.#n.at(i?-1:-2),v=[m[0],m[2]];for(const E of this.#n){const[b,T,S]=E;E[0]=(b-d)/c,E[1]=(T-p)/h,E[2]=(S-p)/h}this.#t=new Float32Array([d,p,c,h]),this.#e=v}getOutlines(){this.#n.sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#l(e)),this.#a(e)):(this.#o(e),t.push(...this.#l(e)));return this.#s(t)}#s(t){const e=[],n=new Set;for(const l of t){const[c,h,d]=l;e.push([c,h,l],[c,d,l])}e.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=e.length;l<c;l+=2){const h=e[l][2],d=e[l+1][2];h.push(d),d.push(h),n.add(h),n.add(d)}const i=[];let a;for(;n.size>0;){const l=n.values().next().value;let[c,h,d,p,m]=l;n.delete(l);let v=c,E=h;for(a=[c,d],i.push(a);;){let b;if(n.has(p))b=p;else if(n.has(m))b=m;else break;n.delete(b),[c,h,d,p,m]=b,v!==c&&(a.push(v,E,c,E===h?h:d),v=c),E=E===h?d:h}a.push(v,E)}return new nF(i,this.#t,this.#e)}#r(t){const e=this.#i;let n=0,i=e.length-1;for(;n<=i;){const a=n+i>>1,l=e[a][0];if(l===t)return a;l<t?n=a+1:i=a-1}return i+1}#a([,t,e]){const n=this.#r(t);this.#i.splice(n,0,[t,e])}#o([,t,e]){const n=this.#r(t);for(let i=n;i<this.#i.length;i++){const[a,l]=this.#i[i];if(a!==t)break;if(a===t&&l===e){this.#i.splice(i,1);return}}for(let i=n-1;i>=0;i--){const[a,l]=this.#i[i];if(a!==t)break;if(a===t&&l===e){this.#i.splice(i,1);return}}}#l(t){const[e,n,i]=t,a=[[e,n,i]],l=this.#r(i);for(let c=0;c<l;c++){const[h,d]=this.#i[c];for(let p=0,m=a.length;p<m;p++){const[,v,E]=a[p];if(!(d<=v||E<=h)){if(v>=h){if(E>d)a[p][1]=d;else{if(m===1)return[];a.splice(p,1),p--,m--}continue}a[p][2]=h,E>d&&a.push([e,d,E])}}}return a}}class nF extends Dt{#t;#e;constructor(t,e,n){super(),this.#e=t,this.#t=e,this.lastPoint=n}toSVGPath(){const t=[];for(const e of this.#e){let[n,i]=e;t.push(`M${n} ${i}`);for(let a=2;a<e.length;a+=2){const l=e[a],c=e[a+1];l===n?(t.push(`V${c}`),i=c):c===i&&(t.push(`H${l}`),n=l)}t.push("Z")}return t.join(" ")}serialize([t,e,n,i],a){const l=[],c=n-t,h=i-e;for(const d of this.#e){const p=new Array(d.length);for(let m=0;m<d.length;m+=2)p[m]=t+d[m]*c,p[m+1]=i-d[m+1]*h;l.push(p)}return l}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Vy extends ao{newFreeDrawOutline(t,e,n,i,a,l){return new iF(t,e,n,i,a,l)}}class iF extends VR{newOutliner(t,e,n,i,a,l=0){return new Vy(t,e,n,i,a,l)}}class Qe extends Lt{#t=null;#e=0;#n;#i=null;#s=null;#r=null;#a=null;#o=0;#l=null;#c=null;#d=null;#u=!1;#f=null;#g;#p=null;#h="";#m;#E="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=$t.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=Qe.prototype;return ee(this,"_keyboardManager",new mh([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||Qe._defaultColor,this.#m=t.thickness||Qe._defaultThickness,this.#g=t.opacity||Qe._defaultOpacity,this.#n=t.boxes||null,this.#E=t.methodOfCreation||"",this.#h=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#u=!0,this.#b(t),this.#R()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#a=t.focusNode,this.#o=t.focusOffset,this.#y(),this.#R(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#m,methodOfCreation:this.#E}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}get commentColor(){return this.color}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#y(){const t=new Uy(this.#n,.001);this.#c=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const e=new Uy(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#r=e.getOutlines();const{lastPoint:n}=this.#r;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:e,clipPathId:n}){this.#c=t;const i=1.5;if(this.#r=t.getNewOutline(this.#m/2+i,.0025),e>=0)this.#d=e,this.#i=n,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:Qe.#w(this.#c.box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:Qe.#w(this.#r.box,p),path:{d:this.#r.toSVGPath()}})}const[a,l,c,h]=t.box;switch(this.rotation){case 0:this.x=a,this.y=l,this.width=c,this.height=h;break;case 90:{const[p,m]=this.parentDimensions;this.x=l,this.y=1-a,this.width=c*m/p,this.height=h*p/m;break}case 180:this.x=1-a,this.y=1-l,this.width=c,this.height=h;break;case 270:{const[p,m]=this.parentDimensions;this.x=1-l,this.y=a,this.width=c*m/p,this.height=h*p/m;break}}const{lastPoint:d}=this.#r;this.#f=[(d[0]-a)/c,(d[1]-l)/h]}static initialize(t,e){Lt.initialize(t,e),Qe._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case le.HIGHLIGHT_COLOR:Qe._defaultColor=e;break;case le.HIGHLIGHT_THICKNESS:Qe._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#f}updateParams(t,e){switch(t){case le.HIGHLIGHT_COLOR:this.#T(e);break;case le.HIGHLIGHT_THICKNESS:this.#v(e);break}}static get defaultPropertiesToUpdate(){return[[le.HIGHLIGHT_COLOR,Qe._defaultColor],[le.HIGHLIGHT_THICKNESS,Qe._defaultThickness]]}get propertiesToUpdate(){return[[le.HIGHLIGHT_COLOR,this.color||Qe._defaultColor],[le.HIGHLIGHT_THICKNESS,this.#m||Qe._defaultThickness],[le.HIGHLIGHT_FREE,this.#u]]}#T(t){const e=(a,l)=>{this.color=a,this.#g=l,this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:a,"fill-opacity":l}}),this.#s?.updateColor(a)},n=this.color,i=this.#g;this.addCommands({cmd:e.bind(this,t,Qe._defaultOpacity),undo:e.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:le.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#v(t){const e=this.#m,n=i=>{this.#m=i,this.#_(i)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:le.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#s=new Vi({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#x())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#x())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#I(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#R(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#I():t&&(this.#R(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#_(t){if(!this.#u)return;this.#b({highlightOutlines:this.#c.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,n]=this.parentDimensions;this.setDims(this.width*e,this.height*n)}#I(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#R(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#g},rootClass:{highlight:!0,free:this.#u},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#u),this.#l&&(this.#l.style.clipPath=this.#i))}static#w([t,e,n,i],a){switch(a){case 90:return[1-e-i,t,i,n];case 180:return[1-t-n,1-e-i,n,i];case 270:return[e,1-t-n,i,n]}return[t,e,n,i]}rotate(t){const{drawLayer:e}=this.parent;let n;this.#u?(t=(t-this.rotation+360)%360,n=Qe.#w(this.#c.box,t)):n=Qe.#w([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:n,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:Qe.#w(this.#r.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#h&&(t.setAttribute("aria-label",this.#h),t.setAttribute("role","mark")),this.#u?t.classList.add("free"):this.div.addEventListener("keydown",this.#N.bind(this),{signal:this._uiManager._signal});const e=this.#l=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#i;const[n,i]=this.parentDimensions;return this.setDims(this.width*n,this.height*i),gR(this,this.#l,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#N(t){Qe._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#C(!0);break;case 1:case 3:this.#C(!1);break}}#C(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#a,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#C(!1))}get _mustFixPosition(){return!this.#u}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#x(){return this.#u?this.rotation:0}#L(){if(this.#u)return null;const[t,e]=this.pageDimensions,[n,i]=this.pageTranslation,a=this.#n,l=new Float32Array(a.length*8);let c=0;for(const{x:h,y:d,width:p,height:m}of a){const v=h*t+n,E=(1-d)*e+i;l[c]=l[c+4]=v,l[c+1]=l[c+3]=E,l[c+2]=l[c+6]=v+p*t,l[c+5]=l[c+7]=E-m*e,c+=8}return l}#P(t){return this.#c.serialize(t,this.#x())}static startHighlighting(t,e,{target:n,x:i,y:a}){const{x:l,y:c,width:h,height:d}=n.getBoundingClientRect(),p=new AbortController,m=t.combinedSignal(p),v=E=>{p.abort(),this.#k(t,E)};window.addEventListener("blur",v,{signal:m}),window.addEventListener("pointerup",v,{signal:m}),window.addEventListener("pointerdown",cn,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",$i,{signal:m}),n.addEventListener("pointermove",this.#M.bind(this,t),{signal:m}),this._freeHighlight=new Vy({x:i,y:a},[l,c,h,d],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#M(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#k(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,n){let i=null;if(t instanceof FR){const{data:{quadPoints:b,rect:T,rotation:S,id:C,color:D,opacity:O,popupRef:F,contentsObj:k},parent:{page:{pageNumber:z}}}=t;i=t={annotationType:$t.HIGHLIGHT,color:Array.from(D),opacity:O,quadPoints:b,boxes:null,pageIndex:z-1,rect:T.slice(0),rotation:S,annotationElementId:C,id:C,deleted:!1,popupRef:F,comment:k?.str||null}}else if(t instanceof l0){const{data:{inkLists:b,rect:T,rotation:S,id:C,color:D,borderStyle:{rawWidth:O},popupRef:F,contentsObj:k},parent:{page:{pageNumber:z}}}=t;i=t={annotationType:$t.HIGHLIGHT,color:Array.from(D),thickness:O,inkLists:b,boxes:null,pageIndex:z-1,rect:T.slice(0),rotation:S,annotationElementId:C,id:C,deleted:!1,popupRef:F,comment:k?.str||null}}const{color:a,quadPoints:l,inkLists:c,opacity:h}=t,d=await super.deserialize(t,e,n);d.color=Nt.makeHexColor(...a),d.#g=h||1,c&&(d.#m=t.thickness),d._initialData=i,t.comment&&d.setCommentData(t.comment);const[p,m]=d.pageDimensions,[v,E]=d.pageTranslation;if(l){const b=d.#n=[];for(let T=0;T<l.length;T+=8)b.push({x:(l[T]-v)/p,y:1-(l[T+1]-E)/m,width:(l[T+2]-l[T])/p,height:(l[T+1]-l[T+5])/m});d.#y(),d.#R(),d.rotate(d.rotation)}else if(c){d.#u=!0;const b=c[0],T={x:b[0]-v,y:m-(b[1]-E)},S=new Vy(T,[0,0,p,m],1,d.#m/2,!0,.001);for(let O=0,F=b.length;O<F;O+=2)T.x=b[O]-v,T.y=m-(b[O+1]-E),S.add(T);const{id:C,clipPathId:D}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:S.toSVGPath()}},!0,!0);d.#b({highlightOutlines:S.getOutlines(),highlightId:C,clipPathId:D}),d.#R(),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getPDFRect(),n=Lt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i={annotationType:$t.HIGHLIGHT,color:n,opacity:this.#g,thickness:this.#m,quadPoints:this.#L(),outlines:this.#P(e),pageIndex:this.pageIndex,rect:e,rotation:this.#x(),structTreeParentId:this._structTreeParentId};return this.addComment(i),this.annotationElementId&&!this.#O(i)?null:(i.id=this.annotationElementId,i)}#O(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((n,i)=>n!==e[i])}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const e={rect:this.getPDFRect()};return this.hasEditedComment&&(e.popup=this.comment),t.updateEdited(e),null}static canCreateNewEmptyEditor(){return!1}}class jR{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,n)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){De("Not implemented")}}class Ut extends Lt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#s=null;static#r=NaN;static#a=null;static#o=null;static#l=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(this.#c(t),this.#f())}#c({drawOutlines:t,drawId:e,drawingOptions:n}){this.#t=t,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#h(t.box)}#d(t,e){const{id:n}=e.drawLayer.draw(Ut._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(t,e){const n=new Set(Object.keys(t));for(const[i,a]of Object.entries(e))n.has(i)?Object.assign(t[i],a):t[i]=a;return t}static getDefaultDrawingOptions(t){De("Not implemented")}static get typesMap(){De("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,e),this._currentParent&&(Ut.#n.updateProperty(n,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[n,i]of this.typesMap)t.push([n,e[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[n,i]of this.constructor.typesMap)t.push([n,e[i]]);return t}_updateProperty(t,e,n){const i=this._drawingOptions,a=i[e],l=c=>{i.updateProperty(e,c);const h=this.#t.updateProperty(e,c);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),t===this.colorType&&this._colorPicker?.update(c)};this.addCommands({cmd:l.bind(this,n),undo:l.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Ut._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#m()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Ut._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#m()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#m()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Ut._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#m()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#u()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#g([t,e,n,i]){const{parentDimensions:[a,l],rotation:c}=this;switch(c){case 90:return[e,1-t,n*(l/a),i*(a/l)];case 180:return[1-t,1-e,n,i];case 270:return[1-e,t,n*(l/a),i*(a/l)];default:return[t,e,n,i]}}#p(){const{x:t,y:e,width:n,height:i,parentDimensions:[a,l],rotation:c}=this;switch(c){case 90:return[1-e,t,n*(a/l),i*(l/a)];case 180:return[1-t,1-e,n,i];case 270:return[e,1-t,n*(a/l),i*(l/a)];default:return[t,e,n,i]}}#h(t){if([this.x,this.y,this.width,this.height]=this.#g(t),this.div){this.fixAndSetPosition();const[e,n]=this.parentDimensions;this.setDims(this.width*e,this.height*n)}this._onResized()}#m(){const{x:t,y:e,width:n,height:i,rotation:a,parentRotation:l,parentDimensions:[c,h]}=this;switch((a*4+l)/90){case 1:return[1-e-i,t,i,n];case 2:return[1-t-n,1-e-i,n,i];case 3:return[e,1-t-n,i,n];case 4:return[t,e-n*(c/h),i*(h/c),n*(c/h)];case 5:return[1-e,t,n*(c/h),i*(h/c)];case 6:return[1-t-i*(h/c),1-e,i*(h/c),n*(c/h)];case 7:return[e-n*(c/h),1-t-i*(h/c),n*(c/h),i*(h/c)];case 8:return[t-n,e-i,n,i];case 9:return[1-e,t-n,i,n];case 10:return[1-t,1-e,n,i];case 11:return[e-i,1-t,i,n];case 12:return[t-i*(h/c),e,i*(h/c),n*(c/h)];case 13:return[1-e-n*(c/h),t-i*(h/c),n*(c/h),i*(h/c)];case 14:return[1-t,1-e-n*(c/h),i*(h/c),n*(c/h)];case 15:return[e,1-t,n*(c/h),i*(h/c)];default:return[t,e,n,i]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Ut._mergeSVGProperties({bbox:this.#m()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const n=super.render();n.classList.add("draw");const i=document.createElement("div");n.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[a,l]=this.parentDimensions;return this.setDims(this.width*a,this.height*l),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),n}static createDrawerInstance(t,e,n,i,a){De("Not implemented")}static startDrawing(t,e,n,i){const{target:a,offsetX:l,offsetY:c,pointerId:h,pointerType:d}=i;if(Ut.#a&&Ut.#a!==d)return;const{viewport:{rotation:p}}=t,{width:m,height:v}=a.getBoundingClientRect(),E=Ut.#i=new AbortController,b=t.combinedSignal(E);if(Ut.#r||=h,Ut.#a??=d,window.addEventListener("pointerup",T=>{Ut.#r===T.pointerId?this._endDraw(T):Ut.#o?.delete(T.pointerId)},{signal:b}),window.addEventListener("pointercancel",T=>{Ut.#r===T.pointerId?this._currentParent.endDrawingSession():Ut.#o?.delete(T.pointerId)},{signal:b}),window.addEventListener("pointerdown",T=>{Ut.#a===T.pointerType&&((Ut.#o||=new Set).add(T.pointerId),Ut.#n.isCancellable()&&(Ut.#n.removeLastElement(),Ut.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",$i,{signal:b}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:b}),a.addEventListener("touchmove",T=>{T.timeStamp===Ut.#l&&cn(T)},{signal:b}),t.toggleDrawing(),e._editorUndoBar?.hide(),Ut.#n){t.drawLayer.updateProperties(this._currentDrawId,Ut.#n.startNew(l,c,m,v,p));return}e.updateUIForDefaultProperties(this),Ut.#n=this.createDrawerInstance(l,c,m,v,p),Ut.#s=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Ut.#s.toSVGProperties(),Ut.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Ut.#l=-1,!Ut.#n)return;const{offsetX:e,offsetY:n,pointerId:i}=t;if(Ut.#r===i){if(Ut.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Ut.#n.add(e,n)),Ut.#l=t.timeStamp,cn(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Ut.#n=null,Ut.#s=null,Ut.#a=null,Ut.#l=NaN),Ut.#i&&(Ut.#i.abort(),Ut.#i=null,Ut.#r=NaN,Ut.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Ut.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const n=Ut.#n,i=this._currentDrawId,a=n.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(i,n.setLastElement(a))},undo:()=>{e.drawLayer.updateProperties(i,n.removeLastElement())},mustExec:!1,type:le.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(le.DRAW_STEP),!Ut.#n.isEmpty()){const{pageDimensions:[n,i],scale:a}=e,l=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Ut.#n.getOutlines(n*a,i*a,a,this._INNER_MARGIN),drawingOptions:Ut.#s,mustBeCommitted:!t});return this._cleanup(!0),l}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,n,i,a,l){De("Not implemented")}static async deserialize(t,e,n){const{rawDims:{pageWidth:i,pageHeight:a,pageX:l,pageY:c}}=e.viewport,h=this.deserializeDraw(l,c,i,a,this._INNER_MARGIN,t),d=await super.deserialize(t,e,n);return d.createDrawingOptions(t),d.#c({drawOutlines:h}),d.#f(),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[e,n]=this.pageTranslation,[i,a]=this.pageDimensions;return this.#t.serialize([e,n,i,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class rF{#t=new Float64Array(6);#e;#n;#i;#s;#r;#a="";#o=0;#l=new vh;#c;#d;constructor(t,e,n,i,a,l){this.#c=n,this.#d=i,this.#i=a,this.#s=l,[t,e]=this.#u(t,e);const c=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e],this.#n=[{line:c,points:this.#r}],this.#t.set(c,0)}updateProperty(t,e){t==="stroke-width"&&(this.#s=e)}#u(t,e){return Dt._normalizePoint(t,e,this.#c,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#r.length<=10}add(t,e){[t,e]=this.#u(t,e);const[n,i,a,l]=this.#t.subarray(2,6),c=t-a,h=e-l;return Math.hypot(this.#c*c,this.#d*h)<=2?null:(this.#r.push(t,e),isNaN(n)?(this.#t.set([a,l,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([n,i,a,l,t,e],0),this.#e.push(...Dt.createBezierPoints(n,i,a,l,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const n=this.add(t,e);return n||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,i,a){this.#c=n,this.#d=i,this.#i=a,[t,e]=this.#u(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e];const c=this.#n.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#n.push({line:l,points:this.#r}),this.#t.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#r=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#l.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#l.removeLastElement();this.#n.pop(),this.#a="";for(let t=0,e=this.#n.length;t<e;t++){const{line:n,points:i}=this.#n[t];this.#e=n,this.#r=i,this.#o=0,this.toSVGPath()}return{path:{d:this.#a}}}toSVGPath(){const t=Dt.svgRound(this.#e[4]),e=Dt.svgRound(this.#e[5]);if(this.#r.length===2)return this.#a=`${this.#a} M ${t} ${e} Z`,this.#a;if(this.#r.length<=6){const i=this.#a.lastIndexOf("M");this.#a=`${this.#a.slice(0,i)} M ${t} ${e}`,this.#o=6}if(this.#r.length===4){const i=Dt.svgRound(this.#e[10]),a=Dt.svgRound(this.#e[11]);return this.#a=`${this.#a} L ${i} ${a}`,this.#o=12,this.#a}const n=[];this.#o===0&&(n.push(`M ${t} ${e}`),this.#o=6);for(let i=this.#o,a=this.#e.length;i<a;i+=6){const[l,c,h,d,p,m]=this.#e.slice(i,i+6).map(Dt.svgRound);n.push(`C${l} ${c} ${h} ${d} ${p} ${m}`)}return this.#a+=n.join(" "),this.#o=this.#e.length,this.#a}getOutlines(t,e,n,i){const a=this.#n.at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),this.#l.build(this.#n,t,e,n,this.#i,this.#s,i),this.#t=null,this.#e=null,this.#n=null,this.#a=null,this.#l}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class vh extends Dt{#t;#e=0;#n;#i;#s;#r;#a;#o;#l;build(t,e,n,i,a,l,c){this.#s=e,this.#r=n,this.#a=i,this.#o=a,this.#l=l,this.#n=c??0,this.#i=t,this.#u()}get thickness(){return this.#l}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#i){if(t.push(`M${Dt.svgRound(e[4])} ${Dt.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${Dt.svgRound(e[10])} ${Dt.svgRound(e[11])}`);continue}for(let n=6,i=e.length;n<i;n+=6){const[a,l,c,h,d,p]=e.subarray(n,n+6).map(Dt.svgRound);t.push(`C${a} ${l} ${c} ${h} ${d} ${p}`)}}return t.join("")}serialize([t,e,n,i],a){const l=[],c=[],[h,d,p,m]=this.#d();let v,E,b,T,S,C,D,O,F;switch(this.#o){case 0:F=Dt._rescale,v=t,E=e+i,b=n,T=-i,S=t+h*n,C=e+(1-d-m)*i,D=t+(h+p)*n,O=e+(1-d)*i;break;case 90:F=Dt._rescaleAndSwap,v=t,E=e,b=n,T=i,S=t+d*n,C=e+h*i,D=t+(d+m)*n,O=e+(h+p)*i;break;case 180:F=Dt._rescale,v=t+n,E=e,b=-n,T=i,S=t+(1-h-p)*n,C=e+d*i,D=t+(1-h)*n,O=e+(d+m)*i;break;case 270:F=Dt._rescaleAndSwap,v=t+n,E=e+i,b=-n,T=-i,S=t+(1-d-m)*n,C=e+(1-h-p)*i,D=t+(1-d)*n,O=e+(1-h)*i;break}for(const{line:k,points:z}of this.#i)l.push(F(k,v,E,b,T,a?new Array(k.length):null)),c.push(F(z,v,E,b,T,a?new Array(z.length):null));return{lines:l,points:c,rect:[S,C,D,O]}}static deserialize(t,e,n,i,a,{paths:{lines:l,points:c},rotation:h,thickness:d}){const p=[];let m,v,E,b,T;switch(h){case 0:T=Dt._rescale,m=-t/n,v=e/i+1,E=1/n,b=-1/i;break;case 90:T=Dt._rescaleAndSwap,m=-e/i,v=-t/n,E=1/i,b=1/n;break;case 180:T=Dt._rescale,m=t/n+1,v=-e/i,E=-1/n,b=1/i;break;case 270:T=Dt._rescaleAndSwap,m=e/i+1,v=t/n+1,E=-1/i,b=-1/n;break}if(!l){l=[];for(const C of c){const D=C.length;if(D===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,C[0],C[1]]));continue}if(D===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,C[0],C[1],NaN,NaN,NaN,NaN,C[2],C[3]]));continue}const O=new Float32Array(3*(D-2));l.push(O);let[F,k,z,P]=C.subarray(0,4);O.set([NaN,NaN,NaN,NaN,F,k],0);for(let N=4;N<D;N+=2){const M=C[N],V=C[N+1];O.set(Dt.createBezierPoints(F,k,z,P,M,V),(N-2)*3),[F,k,z,P]=[z,P,M,V]}}}for(let C=0,D=l.length;C<D;C++)p.push({line:T(l[C].map(O=>O??NaN),m,v,E,b),points:T(c[C].map(O=>O??NaN),m,v,E,b)});const S=new this.prototype.constructor;return S.build(p,n,i,1,h,d,a),S}#c(t=this.#l){const e=this.#n+t/2*this.#a;return this.#o%180===0?[e/this.#s,e/this.#r]:[e/this.#r,e/this.#s]}#d(){const[t,e,n,i]=this.#t,[a,l]=this.#c(0);return[t+a,e+l,n-2*a,i-2*l]}#u(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:i}of this.#i){if(i.length<=12){for(let c=4,h=i.length;c<h;c+=6)Nt.pointBoundingBox(i[c],i[c+1],t);continue}let a=i[4],l=i[5];for(let c=6,h=i.length;c<h;c+=6){const[d,p,m,v,E,b]=i.subarray(c,c+6);Nt.bezierBoundingBox(a,l,d,p,m,v,E,b,t),a=E,l=b}}const[e,n]=this.#c();t[0]=ti(t[0]-e,0,1),t[1]=ti(t[1]-n,0,1),t[2]=ti(t[2]+e,0,1),t[3]=ti(t[3]+n,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,n]=this.#c();this.#l=t;const[i,a]=this.#c(),[l,c]=[i-e,a-n],h=this.#t;return h[0]-=l,h[1]-=c,h[2]+=2*l,h[3]+=2*c,h}updateParentDimensions([t,e],n){const[i,a]=this.#c();this.#s=t,this.#r=e,this.#a=n;const[l,c]=this.#c(),h=l-i,d=c-a,p=this.#t;return p[0]-=h,p[1]-=d,p[2]+=2*h,p[3]+=2*d,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(Dt.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Dt.svgRound(t)} ${Dt.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let n=0,i=0,a=0,l=0,c=0,h=0;switch(this.#e){case 90:i=e/t,a=-t/e,c=t;break;case 180:n=-1,l=-1,c=t,h=e;break;case 270:i=-e/t,a=t/e,h=e;break;default:return""}return`matrix(${n} ${i} ${a} ${l} ${Dt.svgRound(c)} ${Dt.svgRound(h)})`}getPathResizingSVGProperties([t,e,n,i]){const[a,l]=this.#c(),[c,h,d,p]=this.#t;if(Math.abs(d-a)<=Dt.PRECISION||Math.abs(p-l)<=Dt.PRECISION){const T=t+n/2-(c+d/2),S=e+i/2-(h+p/2);return{path:{"transform-origin":`${Dt.svgRound(t)} ${Dt.svgRound(e)}`,transform:`${this.rotationTransform} translate(${T} ${S})`}}}const m=(n-2*a)/(d-2*a),v=(i-2*l)/(p-2*l),E=d/n,b=p/i;return{path:{"transform-origin":`${Dt.svgRound(c)} ${Dt.svgRound(h)}`,transform:`${this.rotationTransform} scale(${E} ${b}) translate(${Dt.svgRound(a)} ${Dt.svgRound(l)}) scale(${m} ${v}) translate(${Dt.svgRound(-a)} ${Dt.svgRound(-l)})`}}}getPathResizedSVGProperties([t,e,n,i]){const[a,l]=this.#c(),c=this.#t,[h,d,p,m]=c;if(c[0]=t,c[1]=e,c[2]=n,c[3]=i,Math.abs(p-a)<=Dt.PRECISION||Math.abs(m-l)<=Dt.PRECISION){const S=t+n/2-(h+p/2),C=e+i/2-(d+m/2);for(const{line:D,points:O}of this.#i)Dt._translate(D,S,C,D),Dt._translate(O,S,C,O);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Dt.svgRound(t)} ${Dt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(n-2*a)/(p-2*a),E=(i-2*l)/(m-2*l),b=-v*(h+a)+t+a,T=-E*(d+l)+e+l;if(v!==1||E!==1||b!==0||T!==0)for(const{line:S,points:C}of this.#i)Dt._rescale(S,b,T,v,E,S),Dt._rescale(C,b,T,v,E,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Dt.svgRound(t)} ${Dt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],n){const[i,a]=n,l=this.#t,c=t-l[0],h=e-l[1];if(this.#s===i&&this.#r===a)for(const{line:d,points:p}of this.#i)Dt._translate(d,c,h,d),Dt._translate(p,c,h,p);else{const d=this.#s/i,p=this.#r/a;this.#s=i,this.#r=a;for(const{line:m,points:v}of this.#i)Dt._rescale(m,c,h,d,p,m),Dt._rescale(v,c,h,d,p,v);l[2]*=d,l[3]*=p}return l[0]=t,l[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Dt.svgRound(t)} ${Dt.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Dt.svgRound(t[0])} ${Dt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class wp extends jR{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Lt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new wp(this._viewParameters);return t.updateAll(this),t}}class u0 extends Ut{static _type="ink";static _editorType=$t.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Lt.initialize(t,e),this._defaultDrawingOptions=new wp(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return ee(this,"typesMap",new Map([[le.INK_THICKNESS,"stroke-width"],[le.INK_COLOR,"stroke"],[le.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,n,i,a){return new rF(t,e,n,i,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,n,i,a,l){return vh.deserialize(t,e,n,i,a,l)}static async deserialize(t,e,n){let i=null;if(t instanceof l0){const{data:{inkLists:l,rect:c,rotation:h,id:d,color:p,opacity:m,borderStyle:{rawWidth:v},popupRef:E,contentsObj:b},parent:{page:{pageNumber:T}}}=t;i=t={annotationType:$t.INK,color:Array.from(p),thickness:v,opacity:m,paths:{points:l},boxes:null,pageIndex:T-1,rect:c.slice(0),rotation:h,annotationElementId:d,id:d,deleted:!1,popupRef:E,comment:b?.str||null}}const a=await super.deserialize(t,e,n);return a._initialData=i,t.comment&&a.setCommentData(t.comment),a}get toolbarButtons(){return this._colorPicker||=new qu(this),[["colorPicker",this._colorPicker]]}get colorType(){return le.INK_COLOR}get colorValue(){return this._drawingOptions.stroke}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:n}=this;e.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:n}){this._drawingOptions=u0.getDefaultDrawingOptions({stroke:Nt.makeHexColor(...t),"stroke-width":e,"stroke-opacity":n})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:n,rect:i}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":l,"stroke-width":c}}=this,h={annotationType:$t.INK,color:Lt._colorManager.convert(a),opacity:l,thickness:c,paths:{lines:e,points:n},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(h),t?(h.isCopy=!0,h):this.annotationElementId&&!this.#t(h)?null:(h.id=this.annotationElementId,h)}#t(t){const{color:e,thickness:n,opacity:i,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,c)=>l!==e[c])||t.thickness!==n||t.opacity!==i||t.pageIndex!==a}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:n}=this.serializeDraw(!1),i={rect:n,thickness:this._drawingOptions["stroke-width"],points:e};return this.hasEditedComment&&(i.popup=this.comment),t.updateEdited(i),null}}class jy extends vh{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const af=8,du=3;class xl{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,n,i){return n-=t,i-=e,n===0?i>0?0:4:n===1?i+6:2-i}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,e,n,i,a,l,c){const h=this.#e(n,i,a,l);for(let d=0;d<8;d++){const p=(-d+h-c+16)%8,m=this.#n[2*p],v=this.#n[2*p+1];if(t[(n+m)*e+(i+v)]!==0)return p}return-1}static#s(t,e,n,i,a,l,c){const h=this.#e(n,i,a,l);for(let d=0;d<8;d++){const p=(d+h+c+16)%8,m=this.#n[2*p],v=this.#n[2*p+1];if(t[(n+m)*e+(i+v)]!==0)return p}return-1}static#r(t,e,n,i){const a=t.length,l=new Int32Array(a);for(let p=0;p<a;p++)l[p]=t[p]<=i?1:0;for(let p=1;p<n-1;p++)l[p*e]=l[p*e+e-1]=0;for(let p=0;p<e;p++)l[p]=l[e*n-1-p]=0;let c=1,h;const d=[];for(let p=1;p<n-1;p++){h=1;for(let m=1;m<e-1;m++){const v=p*e+m,E=l[v];if(E===0)continue;let b=p,T=m;if(E===1&&l[v-1]===0)c+=1,T-=1;else if(E>=1&&l[v+1]===0)c+=1,T+=1,E>1&&(h=E);else{E!==1&&(h=Math.abs(E));continue}const S=[m,p],C=T===m+1,D={isHole:C,points:S,id:c,parent:0};d.push(D);let O;for(const H of d)if(H.id===h){O=H;break}O?O.isHole?D.parent=C?O.parent:h:D.parent=C?h:O.parent:D.parent=C?h:0;const F=this.#i(l,e,p,m,b,T,0);if(F===-1){l[v]=-c,l[v]!==1&&(h=Math.abs(l[v]));continue}let k=this.#n[2*F],z=this.#n[2*F+1];const P=p+k,N=m+z;b=P,T=N;let M=p,V=m;for(;;){const H=this.#s(l,e,M,V,b,T,1);k=this.#n[2*H],z=this.#n[2*H+1];const $=M+k,j=V+z;S.push(j,$);const Tt=M*e+V;if(l[Tt+1]===0?l[Tt]=-c:l[Tt]===1&&(l[Tt]=c),$===p&&j===m&&M===P&&V===N){l[v]!==1&&(h=Math.abs(l[v]));break}else b=M,T=V,M=$,V=j}}}return d}static#a(t,e,n,i){if(n-e<=4){for(let P=e;P<n-2;P+=2)i.push(t[P],t[P+1]);return}const a=t[e],l=t[e+1],c=t[n-4]-a,h=t[n-3]-l,d=Math.hypot(c,h),p=c/d,m=h/d,v=p*l-m*a,E=h/c,b=1/d,T=Math.atan(E),S=Math.cos(T),C=Math.sin(T),D=b*(Math.abs(S)+Math.abs(C)),O=b*(1-D+D**2),F=Math.max(Math.atan(Math.abs(C+S)*O),Math.atan(Math.abs(C-S)*O));let k=0,z=e;for(let P=e+2;P<n-2;P+=2){const N=Math.abs(v-p*t[P+1]+m*t[P]);N>k&&(z=P,k=N)}k>(d*F)**2?(this.#a(t,e,z+2,i),this.#a(t,z,n,i)):i.push(a,l)}static#o(t){const e=[],n=t.length;return this.#a(t,0,n,e),e.push(t[n-2],t[n-1]),e.length<=4?null:e}static#l(t,e,n,i,a,l){const c=new Float32Array(l**2),h=-2*i**2,d=l>>1;for(let T=0;T<l;T++){const S=(T-d)**2;for(let C=0;C<l;C++)c[T*l+C]=Math.exp((S+(C-d)**2)/h)}const p=new Float32Array(256),m=-2*a**2;for(let T=0;T<256;T++)p[T]=Math.exp(T**2/m);const v=t.length,E=new Uint8Array(v),b=new Uint32Array(256);for(let T=0;T<n;T++)for(let S=0;S<e;S++){const C=T*e+S,D=t[C];let O=0,F=0;for(let z=0;z<l;z++){const P=T+z-d;if(!(P<0||P>=n))for(let N=0;N<l;N++){const M=S+N-d;if(M<0||M>=e)continue;const V=t[P*e+M],H=c[z*l+N]*p[Math.abs(V-D)];O+=V*H,F+=H}}const k=E[C]=Math.round(O/F);b[k]++}return[E,b]}static#c(t){const e=new Uint32Array(256);for(const n of t)e[n]++;return e}static#d(t){const e=t.length,n=new Uint8ClampedArray(e>>2);let i=-1/0,a=1/0;for(let c=0,h=n.length;c<h;c++){const d=n[c]=t[c<<2];i=Math.max(i,d),a=Math.min(a,d)}const l=255/(i-a);for(let c=0,h=n.length;c<h;c++)n[c]=(n[c]-a)*l;return n}static#u(t){let e,n=-1/0,i=-1/0;const a=t.findIndex(h=>h!==0);let l=a,c=a;for(e=a;e<256;e++){const h=t[e];h>n&&(e-l>i&&(i=e-l,c=e-1),n=h,l=e)}for(e=c-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:n,height:i}=t,{maxDim:a}=this.#t;let l=n,c=i;if(n>a||i>a){let v=n,E=i,b=Math.log2(Math.max(n,i)/a);const T=Math.floor(b);b=b===T?T-1:T;for(let C=0;C<b;C++){l=Math.ceil(v/2),c=Math.ceil(E/2);const D=new OffscreenCanvas(l,c);D.getContext("2d").drawImage(t,0,0,v,E,0,0,l,c),v=l,E=c,t!==e&&t.close(),t=D.transferToImageBitmap()}const S=Math.min(a/l,a/c);l=Math.round(l*S),c=Math.round(c*S)}const d=new OffscreenCanvas(l,c).getContext("2d",{willReadFrequently:!0});d.fillStyle="white",d.fillRect(0,0,l,c),d.filter="grayscale(1)",d.drawImage(t,0,0,t.width,t.height,0,0,l,c);const p=d.getImageData(0,0,l,c).data;return[this.#d(p),l,c]}static extractContoursFromText(t,{fontFamily:e,fontStyle:n,fontWeight:i},a,l,c,h){let d=new OffscreenCanvas(1,1),p=d.getContext("2d",{alpha:!1});const m=200,v=p.font=`${n} ${i} ${m}px ${e}`,{actualBoundingBoxLeft:E,actualBoundingBoxRight:b,actualBoundingBoxAscent:T,actualBoundingBoxDescent:S,fontBoundingBoxAscent:C,fontBoundingBoxDescent:D,width:O}=p.measureText(t),F=1.5,k=Math.ceil(Math.max(Math.abs(E)+Math.abs(b)||0,O)*F),z=Math.ceil(Math.max(Math.abs(T)+Math.abs(S)||m,Math.abs(C)+Math.abs(D)||m)*F);d=new OffscreenCanvas(k,z),p=d.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=v,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,k,z),p.fillStyle="black",p.fillText(t,k*(F-1)/2,z*(3-F)/2);const P=this.#d(p.getImageData(0,0,k,z).data),N=this.#c(P),M=this.#u(N),V=this.#r(P,k,z,M);return this.processDrawnLines({lines:{curves:V,width:k,height:z},pageWidth:a,pageHeight:l,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,e,n,i,a){const[l,c,h]=this.#f(t),[d,p]=this.#l(l,c,h,Math.hypot(c,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),m=this.#u(p),v=this.#r(d,c,h,m);return this.processDrawnLines({lines:{curves:v,width:c,height:h},pageWidth:e,pageHeight:n,rotation:i,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:i,innerMargin:a,mustSmooth:l,areContours:c}){i%180!==0&&([e,n]=[n,e]);const{curves:h,width:d,height:p}=t,m=t.thickness??0,v=[],E=Math.min(e/d,n/p),b=E/e,T=E/n,S=[];for(const{points:D}of h){const O=l?this.#o(D):D;if(!O)continue;S.push(O);const F=O.length,k=new Float32Array(F),z=new Float32Array(3*(F===2?2:F-2));if(v.push({line:z,points:k}),F===2){k[0]=O[0]*b,k[1]=O[1]*T,z.set([NaN,NaN,NaN,NaN,k[0],k[1]],0);continue}let[P,N,M,V]=O;P*=b,N*=T,M*=b,V*=T,k.set([P,N,M,V],0),z.set([NaN,NaN,NaN,NaN,P,N],0);for(let H=4;H<F;H+=2){const $=k[H]=O[H]*b,j=k[H+1]=O[H+1]*T;z.set(Dt.createBezierPoints(P,N,M,V,$,j),(H-2)*3),[P,N,M,V]=[M,V,$,j]}}if(v.length===0)return null;const C=c?new jy:new vh;return C.build(v,e,n,1,i,c?0:m,a),{outline:C,newCurves:S,areContours:c,thickness:m,width:d,height:p}}static async compressSignature({outlines:t,areContours:e,thickness:n,width:i,height:a}){let l=1/0,c=-1/0,h=0;for(const O of t){h+=O.length;for(let F=2,k=O.length;F<k;F++){const z=O[F]-O[F-2];l=Math.min(l,z),c=Math.max(c,z)}}let d;l>=-128&&c<=127?d=Int8Array:l>=-32768&&c<=32767?d=Int16Array:d=Int32Array;const p=t.length,m=af+du*p,v=new Uint32Array(m);let E=0;v[E++]=m*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*d.BYTES_PER_ELEMENT,v[E++]=0,v[E++]=i,v[E++]=a,v[E++]=e?0:1,v[E++]=Math.max(0,Math.floor(n??0)),v[E++]=p,v[E++]=d.BYTES_PER_ELEMENT;for(const O of t)v[E++]=O.length-2,v[E++]=O[0],v[E++]=O[1];const b=new CompressionStream("deflate-raw"),T=b.writable.getWriter();await T.ready,T.write(v);const S=d.prototype.constructor;for(const O of t){const F=new S(O.length-2);for(let k=2,z=O.length;k<z;k++)F[k-2]=O[k]-O[k-2];T.write(F)}T.close();const C=await new Response(b.readable).arrayBuffer(),D=new Uint8Array(C);return pR(D)}static async decompressSignature(t){try{const e=R6(t),{readable:n,writable:i}=new DecompressionStream("deflate-raw"),a=i.getWriter();await a.ready,a.write(e).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let l=null,c=0;for await(const O of n)l||=new Uint8Array(new Uint32Array(O.buffer,0,4)[0]),l.set(O,c),c+=O.length;const h=new Uint32Array(l.buffer,0,l.length>>2),d=h[1];if(d!==0)throw new Error(`Invalid version: ${d}`);const p=h[2],m=h[3],v=h[4]===0,E=h[5],b=h[6],T=h[7],S=[],C=(af+du*b)*Uint32Array.BYTES_PER_ELEMENT;let D;switch(T){case Int8Array.BYTES_PER_ELEMENT:D=new Int8Array(l.buffer,C);break;case Int16Array.BYTES_PER_ELEMENT:D=new Int16Array(l.buffer,C);break;case Int32Array.BYTES_PER_ELEMENT:D=new Int32Array(l.buffer,C);break}c=0;for(let O=0;O<b;O++){const F=h[du*O+af],k=new Float32Array(F+2);S.push(k);for(let z=0;z<du-1;z++)k[z]=h[du*O+af+z+1];for(let z=0;z<F;z++)k[z+2]=k[z]+D[c++]}return{areContours:v,thickness:E,outlines:S,width:p,height:m}}catch(e){return Gt(`decompressSignature: ${e}`),null}}}class h0 extends jR{constructor(){super(),super.updateProperties({fill:Lt._defaultLineColor,"stroke-width":0})}clone(){const t=new h0;return t.updateAll(this),t}}class d0 extends wp{constructor(t){super(t),super.updateProperties({stroke:Lt._defaultLineColor,"stroke-width":1})}clone(){const t=new d0(this._viewParameters);return t.updateAll(this),t}}class Sr extends Ut{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=$t.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Lt.initialize(t,e),this._defaultDrawingOptions=new h0,this._defaultDrawnSignatureOptions=new d0(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return ee(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:i,mustSmooth:a,areContours:l,description:c,uuid:h,heightInPage:d}=this.#n,{rawDims:{pageWidth:p,pageHeight:m},rotation:v}=this.parent.viewport,E=xl.processDrawnLines({lines:i,pageWidth:p,pageHeight:m,rotation:v,innerMargin:Sr._INNER_MARGIN,mustSmooth:a,areContours:l});this.addSignature(E,d,c,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:n,width:i,height:a}=this.#n,l=Math.max(i,a),c=xl.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:n,width:i,height:a},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,n,i){const{x:a,y:l}=this,{outline:c}=this.#n=t;this.#t=c instanceof jy,this.description=n;let h;this.#t?h=Sr.getDefaultDrawingOptions():(h=Sr._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:h});const[d,p]=this.parentDimensions,[,m]=this.pageDimensions;let v=e/m;v=v>=1?.5:v,this.width*=v/this.height,this.width>=1&&(v*=.9/this.width,this.width=.9),this.height=v,this.setDims(d*this.width,p*this.height),this.x=a,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:i}=this.parent.viewport;return xl.process(t,e,n,i,Sr._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:n,pageHeight:i},rotation:a}=this.parent.viewport;return xl.extractContoursFromText(t,e,n,i,a,Sr._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:i}=this.parent.viewport;return xl.processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:i,innerMargin:Sr._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Sr.getDefaultDrawingOptions():(this._drawingOptions=Sr._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:n,rect:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,l={annotationType:$t.SIGNATURE,isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:a,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(l),t?(l.paths={lines:e,points:n},l.uuid=this.#i,l.isCopy=!0):l.lines=e,this.#e&&(l.accessibilityData={type:"Figure",alt:this.#e}),l}static deserializeDraw(t,e,n,i,a,l){return l.areContours?jy.deserialize(t,e,n,i,a,l):vh.deserialize(t,e,n,i,a,l)}static async deserialize(t,e,n){const i=await super.deserialize(t,e,n);return i.#t=t.areContours,i.description=t.accessibilityData?.alt||"",i.#i=t.uuid,i}}class sF extends Lt{#t=null;#e=null;#n=null;#i=null;#s=null;#r="";#a=null;#o=!1;#l=null;#c=!1;#d=!1;static _type="stamp";static _editorType=$t.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#s=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Lt.initialize(t,e)}static isHandlingMimeForPasting(t){return My.includes(t)}static paste(t,e){e.pasteEditor({mode:$t.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#u(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#c=t.isSvg),t.file&&(this.#r=t.file.name),this.#p()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#a){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:a,height:l}=t||this.copyCanvas(null,null,!0).imageData,c=await n.guess({name:"altText",request:{data:i,width:a,height:l,channels:i.length/(a*l)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),e&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#g(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(n=>this.#u(n,!0)).finally(()=>this.#f());return}if(this.#i){const n=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(n).then(i=>this.#u(i)).finally(()=>this.#f());return}if(this.#s){const n=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(n).then(i=>this.#u(i)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=My.join(",");const e=this._uiManager._signal;this.#n=new Promise(n=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(i)}n()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),n()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#l&&(clearTimeout(this.#l),this.#l=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#g();return}super.rebuild(),this.div!==null&&(this.#e&&this.#a===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#s||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#p():this.#g()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:n,bitmap:i}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#e=n,i&&(this.#t=i),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#l!==null&&clearTimeout(this.#l);const t=200;this.#l=setTimeout(()=>{this.#l=null,this.#m()},t)}#p(){const{div:t}=this;let{width:e,height:n}=this.#t;const[i,a]=this.pageDimensions,l=.75;if(this.width)e=this.width*i,n=this.height*a;else if(e>l*i||n>l*a){const p=Math.min(l*i/e,l*a/n);e*=p,n*=p}const[c,h]=this.parentDimensions;this.setDims(e*c/i,n*h/a),this._uiManager.enableWaiting(!1);const d=this.#a=document.createElement("canvas");d.setAttribute("role","img"),this.addContainer(d),this.width=e/i,this.height=n/a,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,n=!1){t||(t=224);const{width:i,height:a}=this.#t,l=new Br;let c=this.#t,h=i,d=a,p=null;if(e){if(i>e||a>e){const z=Math.min(e/i,e/a);h=Math.floor(i*z),d=Math.floor(a*z)}p=document.createElement("canvas");const v=p.width=Math.ceil(h*l.sx),E=p.height=Math.ceil(d*l.sy);this.#c||(c=this.#h(v,E));const b=p.getContext("2d");b.filter=this._uiManager.hcmFilter;let T="white",S="#cfcfd8";this._uiManager.hcmFilter!=="none"?S="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(T="#8f8f9d",S="#42414d");const C=15,D=C*l.sx,O=C*l.sy,F=new OffscreenCanvas(D*2,O*2),k=F.getContext("2d");k.fillStyle=T,k.fillRect(0,0,D*2,O*2),k.fillStyle=S,k.fillRect(0,0,D,O),k.fillRect(D,O,D,O),b.fillStyle=b.createPattern(F,"repeat"),b.fillRect(0,0,v,E),b.drawImage(c,0,0,c.width,c.height,0,0,v,E)}let m=null;if(n){let v,E;if(l.symmetric&&c.width<t&&c.height<t)v=c.width,E=c.height;else if(c=this.#t,i>t||a>t){const S=Math.min(t/i,t/a);v=Math.floor(i*S),E=Math.floor(a*S),this.#c||(c=this.#h(v,E))}const T=new OffscreenCanvas(v,E).getContext("2d",{willReadFrequently:!0});T.drawImage(c,0,0,c.width,c.height,0,0,v,E),m={width:v,height:E,data:T.getImageData(0,0,v,E).data}}return{canvas:p,width:h,height:d,imageData:m}}#h(t,e){const{width:n,height:i}=this.#t;let a=n,l=i,c=this.#t;for(;a>2*t||l>2*e;){const h=a,d=l;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const p=new OffscreenCanvas(a,l);p.getContext("2d").drawImage(c,0,0,h,d,0,0,a,l),c=p.transferToImageBitmap()}return c}#m(){const[t,e]=this.parentDimensions,{width:n,height:i}=this,a=new Br,l=Math.ceil(n*t*a.sx),c=Math.ceil(i*e*a.sy),h=this.#a;if(!h||h.width===l&&h.height===c)return;h.width=l,h.height=c;const d=this.#c?this.#t:this.#h(l,c),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(d,0,0,d.width,d.height,0,0,l,c)}#E(t){if(t){if(this.#c){const i=this._uiManager.imageManager.getSvgUrl(this.#e);if(i)return i}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#c){const[e,n]=this.pageDimensions,i=Math.round(this.width*e*$l.PDF_TO_CSS_UNITS),a=Math.round(this.height*n*$l.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(i,a);return l.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,i,a),l.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,n){let i=null,a=!1;if(t instanceof UR){const{data:{rect:T,rotation:S,id:C,structParent:D,popupRef:O,contentsObj:F},container:k,parent:{page:{pageNumber:z}},canvas:P}=t;let N,M;P?(delete t.canvas,{id:N,bitmap:M}=n.imageManager.getFromCanvas(k.id,P),P.remove()):(a=!0,t._hasNoCanvas=!0);const V=(await e._structTree.getAriaAttributes(`${Qv}${C}`))?.get("aria-label")||"";i=t={annotationType:$t.STAMP,bitmapId:N,bitmap:M,pageIndex:z-1,rect:T.slice(0),rotation:S,annotationElementId:C,id:C,deleted:!1,accessibilityData:{decorative:!1,altText:V},isSvg:!1,structParent:D,popupRef:O,comment:F?.str||null}}const l=await super.deserialize(t,e,n),{rect:c,bitmap:h,bitmapUrl:d,bitmapId:p,isSvg:m,accessibilityData:v}=t;a?(n.addMissingCanvas(t.id,l),l.#o=!0):p&&n.imageManager.isValidId(p)?(l.#e=p,h&&(l.#t=h)):l.#i=d,l.#c=m;const[E,b]=l.pageDimensions;return l.width=(c[2]-c[0])/E,l.height=(c[3]-c[1])/b,v&&(l.altTextData=v),l._initialData=i,t.comment&&l.setCommentData(t.comment),l.#d=!!i,l}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:$t.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(this.addComment(n),t)return n.bitmapUrl=this.#E(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:i,altText:a}=this.serializeAltText(!1);if(!i&&a&&(n.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=this.#y(n);if(c.isSame)return null;c.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,e===null)return n;e.stamps||=new Map;const l=this.#c?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:l,serialized:n}),n.bitmap=this.#E(!1);else if(this.#c){const c=e.stamps.get(this.#e);l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=this.#E(!1))}return n}#y(t){const{pageIndex:e,accessibilityData:{altText:n}}=this._initialData,i=t.pageIndex===e,a=(t.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&i&&a,isSameAltText:a}}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const e={rect:this.getPDFRect()};return this.hasEditedComment&&(e.popup=this.comment),t.updateEdited(e),null}}class fs{#t;#e=!1;#n=null;#i=null;#s=null;#r=new Map;#a=!1;#o=!1;#l=!1;#c=null;#d=null;#u=null;#f=null;#g=null;#p=-1;#h;static _initialized=!1;static#m=new Map([wn,u0,sF,Qe,Sr].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:i,accessibilityManager:a,annotationLayer:l,drawLayer:c,textLayer:h,viewport:d,l10n:p}){const m=[...fs.#m.values()];if(!fs._initialized){fs._initialized=!0;for(const v of m)v.initialize(p,t)}t.registerEditorTypes(m),this.#h=t,this.pageIndex=e,this.div=n,this.#t=a,this.#n=l,this.viewport=d,this.#u=h,this.drawLayer=c,this._structTree=i,this.#h.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#h.getMode()===$t.NONE}updateToolbar(t){this.#h.updateToolbar(t)}updateMode(t=this.#h.getMode()){switch(this.#v(),t){case $t.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case $t.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case $t.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of fs.#m.values())e.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#u?.div}setEditingState(t){this.#h.setEditingState(t)}addCommands(t){this.#h.addCommands(t)}cleanUndoStack(t){this.#h.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}async enable(){this.#l=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.#g?.abort(),this.#g=null;const t=new Set;for(const n of this.#r.values())n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#h.removeChangedExistingAnnotation(n),t.add(n.annotationElementId));if(!this.#n){this.#l=!1;return}const e=this.#n.getEditableAnnotations();for(const n of e){if(n.hide(),this.#h.isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const i=await this.deserialize(n);i&&(this.addOrRebuild(i),i.enableEditing())}this.#l=!1}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.#u&&!this.#g){this.#g=new AbortController;const i=this.#h.combinedSignal(this.#g);this.#u.div.addEventListener("pointerdown",a=>{const{clientX:c,clientY:h,timeStamp:d}=a,p=this.#p;if(d-p>500){this.#p=d;return}this.#p=-1;const{classList:m}=this.div;m.toggle("getElements",!0);const v=document.elementsFromPoint(c,h);if(m.toggle("getElements",!1),!this.div.contains(v[0]))return;let E;const b=new RegExp(`^${cR}[0-9]+$`);for(const S of v)if(b.test(S.id)){E=S.id;break}if(!E)return;const T=this.#r.get(E);T?.annotationElementId===null&&(a.stopPropagation(),a.preventDefault(),T.dblclick())},{signal:i,capture:!0})}const t=new Map,e=new Map;for(const i of this.#r.values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){t.set(i.annotationElementId,i);continue}else e.set(i.annotationElementId,i);this.getEditableAnnotation(i.annotationElementId)?.show(),i.remove()}if(this.#n){const i=this.#n.getEditableAnnotations();for(const a of i){const{id:l}=a.data;if(this.#h.isDeletedAnnotationElement(l)){a.updateEdited({deleted:!0});continue}let c=e.get(l);if(c){c.resetAnnotationElement(a),c.show(!1),a.show();continue}c=t.get(l),c&&(this.#h.addChangedExistingAnnotation(c),c.renderAnnotationElement(a)&&c.show(!1)),a.show()}}this.#v(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const i of fs.#m.values())n.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#h.getActive()!==t&&this.#h.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#f){this.#f=new AbortController;const t=this.#h.combinedSignal(this.#f);this.#u.div.addEventListener("pointerdown",this.#E.bind(this),{signal:t}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#u.div.classList.remove("highlighting"))}#E(t){this.#h.unselectAll();const{target:e}=t;if(e===this.#u.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#u.div.contains(e)){const{isMac:n}=Bn.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#h.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),Qe.startHighlighting(this,this.#h.direction==="ltr",{target:this.#u.div,x:t.x,y:t.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#h._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#h.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#r.set(t.id,t);const{annotationElementId:e}=t;e&&this.#h.isDeletedAnnotationElement(e)&&this.#h.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#h.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#h.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#h.addDeletedAnnotationElement(t.annotationElementId),Lt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#h.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#l),this.#h.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#s&&(t._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#h._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getNextId(){return this.#h.getId()}get#y(){return fs.#m.get(this.#h.getMode())}combinedSignal(t){return this.#h.combinedSignal(t)}#b(t){const e=this.#y;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#h.updateMode(t.mode);const{offsetX:n,offsetY:i}=this.#T(),a=this.getNextId(),l=this.#b({parent:this,id:a,x:n,y:i,uiManager:this.#h,isCentered:!0,...e});l&&this.add(l)}async deserialize(t){return await fs.#m.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#h)||null}createAndAddNewEditor(t,e,n={}){const i=this.getNextId(),a=this.#b({parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:this.#h,isCentered:e,...n});return a&&this.add(a),a}#T(){const{x:t,y:e,width:n,height:i}=this.div.getBoundingClientRect(),a=Math.max(0,t),l=Math.max(0,e),c=Math.min(window.innerWidth,t+n),h=Math.min(window.innerHeight,e+i),d=(a+c)/2-t,p=(l+h)/2-e,[m,v]=this.viewport.rotation%180===0?[d,p]:[p,d];return{offsetX:m,offsetY:v}}addNewEditor(t={}){this.createAndAddNewEditor(this.#T(),!0,t)}setSelected(t){this.#h.setSelected(t)}toggleSelected(t){this.#h.toggleSelected(t)}unselect(t){this.#h.unselect(t)}pointerup(t){const{isMac:e}=Bn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#a||(this.#a=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const n=this.#h.getMode();if(n===$t.STAMP||n===$t.SIGNATURE){this.#h.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#h.getMode()===$t.HIGHLIGHT&&this.enableTextSelection(),this.#a){this.#a=!1;return}const{isMac:e}=Bn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#a=!0,this.#y?.isDrawer){this.startDrawingSession(t);return}const n=this.#h.getActive();this.#e=!n||n.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#c){this.#y.startDrawing(this,this.#h,!1,t);return}this.#h.setCurrentDrawingSession(this),this.#c=new AbortController;const e=this.#h.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#y.startDrawing(this,this.#h,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#c?(this.#h.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#d=null,this.#y.endDrawing(t)):null}findNewParent(t,e,n){const i=this.#h.findParent(e,n);return i===null||i===this?!1:(i.changeParent(t),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#h.getActive()?.parent===this&&(this.#h.commitOrRemove(),this.#h.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#h.removeLayer(this)}#v(){for(const t of this.#r.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,bo(this.div,t);for(const e of this.#h.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#h.commitOrRemove(),this.#v();const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,bo(this.div,{rotation:n}),e!==n)for(const i of this.#r.values())i.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#h.viewParameters.realScale}}class Pn{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return ee(this,"_svgFactory",new Kf)}static#s(t,[e,n,i,a]){const{style:l}=t;l.top=`${100*n}%`,l.left=`${100*e}%`,l.width=`${100*i}%`,l.height=`${100*a}%`}#r(){const t=Pn._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#a(t,e){const n=Pn._svgFactory.createElement("clipPath");t.append(n);const i=`clip_${e}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const a=Pn._svgFactory.createElement("use");return n.append(a),a.setAttribute("href",`#${e}`),a.classList.add("clip"),i}#o(t,e){for(const[n,i]of Object.entries(e))i===null?t.removeAttribute(n):t.setAttribute(n,i)}draw(t,e=!1,n=!1){const i=Pn.#i++,a=this.#r(),l=Pn._svgFactory.createElement("defs");a.append(l);const c=Pn._svgFactory.createElement("path");l.append(c);const h=`path_p${this.pageIndex}_${i}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#n.set(i,c);const d=n?this.#a(l,h):null,p=Pn._svgFactory.createElement("use");return a.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(a,t),this.#e.set(i,a),{id:i,clipPathId:`url(#${d})`}}drawOutline(t,e){const n=Pn.#i++,i=this.#r(),a=Pn._svgFactory.createElement("defs");i.append(a);const l=Pn._svgFactory.createElement("path");a.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const m=Pn._svgFactory.createElement("mask");a.append(m),h=`mask_p${this.pageIndex}_${n}`,m.setAttribute("id",h),m.setAttribute("maskUnits","objectBoundingBox");const v=Pn._svgFactory.createElement("rect");m.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const E=Pn._svgFactory.createElement("use");m.append(E),E.setAttribute("href",`#${c}`),E.setAttribute("stroke","none"),E.setAttribute("fill","black"),E.setAttribute("fill-rule","nonzero"),E.classList.add("mask")}const d=Pn._svgFactory.createElement("use");i.append(d),d.setAttribute("href",`#${c}`),h&&d.setAttribute("mask",`url(#${h})`);const p=d.cloneNode();return i.append(p),d.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(i,t),this.#e.set(n,i),n}finalizeDraw(t,e){this.#n.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:n,bbox:i,rootClass:a,path:l}=e,c=typeof t=="number"?this.#e.get(t):t;if(c){if(n&&this.#o(c,n),i&&Pn.#s(c,i),a){const{classList:h}=c;for(const[d,p]of Object.entries(a))h.toggle(d,p)}if(l){const d=c.firstChild.firstChild;this.#o(d,l)}}}updateParent(t,e){if(e===this)return;const n=this.#e.get(t);n&&(e.#t.append(n),this.#e.delete(t),e.#e.set(t,n))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Uy};globalThis.pdfjsLib={AbortException:wa,AnnotationEditorLayer:fs,AnnotationEditorParamsType:le,AnnotationEditorType:$t,AnnotationEditorUIManager:Sa,AnnotationLayer:c0,AnnotationMode:ca,AnnotationType:on,build:kB,ColorPicker:Vi,createValidAbsoluteUrl:uR,DOMSVGFactory:Kf,DrawLayer:Pn,FeatureTest:Bn,fetchData:ph,getDocument:DR,getFilenameFromUrl:C6,getPdfFilenameFromUrl:I6,getRGB:bp,getUuid:fR,getXfaPageViewport:D6,GlobalWorkerOptions:fo,ImageKind:Af,InvalidPDFException:Ny,isDataScheme:Ap,isPdfFile:Zv,isValidExplicitDest:j6,MathClamp:ti,noContextMenu:$i,normalizeUnicode:w6,OPS:Wu,OutputScale:Br,PasswordResponses:g6,PDFDataRangeTransport:OR,PDFDateString:Py,PDFWorker:Xu,PermissionFlag:p6,PixelsPerInch:$l,RenderingCancelledException:Jv,ResponseException:Yf,setLayerDimensions:bo,shadow:ee,SignatureExtractor:xl,stopEvent:cn,SupportedImageMimeTypes:My,TextLayer:Jn,TouchManager:Tp,updateUrlHash:hR,Util:Nt,VerbosityLevel:yp,version:LB,XfaLayer:MR};var G_;(function(r){r.STRING="string",r.NUMBER="number",r.INTEGER="integer",r.BOOLEAN="boolean",r.ARRAY="array",r.OBJECT="object"})(G_||(G_={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $_;(function(r){r.LANGUAGE_UNSPECIFIED="language_unspecified",r.PYTHON="python"})($_||($_={}));var Y_;(function(r){r.OUTCOME_UNSPECIFIED="outcome_unspecified",r.OUTCOME_OK="outcome_ok",r.OUTCOME_FAILED="outcome_failed",r.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(Y_||(Y_={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W_=["user","model","function","system"];var K_;(function(r){r.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",r.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",r.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",r.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",r.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",r.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(K_||(K_={}));var X_;(function(r){r.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",r.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",r.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",r.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",r.BLOCK_NONE="BLOCK_NONE"})(X_||(X_={}));var q_;(function(r){r.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",r.NEGLIGIBLE="NEGLIGIBLE",r.LOW="LOW",r.MEDIUM="MEDIUM",r.HIGH="HIGH"})(q_||(q_={}));var Q_;(function(r){r.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",r.SAFETY="SAFETY",r.OTHER="OTHER"})(Q_||(Q_={}));var Mu;(function(r){r.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",r.STOP="STOP",r.MAX_TOKENS="MAX_TOKENS",r.SAFETY="SAFETY",r.RECITATION="RECITATION",r.LANGUAGE="LANGUAGE",r.BLOCKLIST="BLOCKLIST",r.PROHIBITED_CONTENT="PROHIBITED_CONTENT",r.SPII="SPII",r.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",r.OTHER="OTHER"})(Mu||(Mu={}));var J_;(function(r){r.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",r.RETRIEVAL_QUERY="RETRIEVAL_QUERY",r.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",r.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",r.CLASSIFICATION="CLASSIFICATION",r.CLUSTERING="CLUSTERING"})(J_||(J_={}));var Z_;(function(r){r.MODE_UNSPECIFIED="MODE_UNSPECIFIED",r.AUTO="AUTO",r.ANY="ANY",r.NONE="NONE"})(Z_||(Z_={}));var tw;(function(r){r.MODE_UNSPECIFIED="MODE_UNSPECIFIED",r.MODE_DYNAMIC="MODE_DYNAMIC"})(tw||(tw={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n extends Error{constructor(t){super(`[GoogleGenerativeAI Error]: ${t}`)}}class bl extends $n{constructor(t,e){super(t),this.response=e}}class HR extends $n{constructor(t,e,n,i){super(t),this.status=e,this.statusText=n,this.errorDetails=i}}class ma extends $n{}class zR extends $n{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aF="https://generativelanguage.googleapis.com",oF="v1beta",lF="0.24.1",cF="genai-js";var _o;(function(r){r.GENERATE_CONTENT="generateContent",r.STREAM_GENERATE_CONTENT="streamGenerateContent",r.COUNT_TOKENS="countTokens",r.EMBED_CONTENT="embedContent",r.BATCH_EMBED_CONTENTS="batchEmbedContents"})(_o||(_o={}));class uF{constructor(t,e,n,i,a){this.model=t,this.task=e,this.apiKey=n,this.stream=i,this.requestOptions=a}toString(){var t,e;const n=((t=this.requestOptions)===null||t===void 0?void 0:t.apiVersion)||oF;let a=`${((e=this.requestOptions)===null||e===void 0?void 0:e.baseUrl)||aF}/${n}/${this.model}:${this.task}`;return this.stream&&(a+="?alt=sse"),a}}function hF(r){const t=[];return r?.apiClient&&t.push(r.apiClient),t.push(`${cF}/${lF}`),t.join(" ")}async function dF(r){var t;const e=new Headers;e.append("Content-Type","application/json"),e.append("x-goog-api-client",hF(r.requestOptions)),e.append("x-goog-api-key",r.apiKey);let n=(t=r.requestOptions)===null||t===void 0?void 0:t.customHeaders;if(n){if(!(n instanceof Headers))try{n=new Headers(n)}catch(i){throw new ma(`unable to convert customHeaders value ${JSON.stringify(n)} to Headers: ${i.message}`)}for(const[i,a]of n.entries()){if(i==="x-goog-api-key")throw new ma(`Cannot set reserved header name ${i}`);if(i==="x-goog-api-client")throw new ma(`Header name ${i} can only be set using the apiClient field`);e.append(i,a)}}return e}async function fF(r,t,e,n,i,a){const l=new uF(r,t,e,n,a);return{url:l.toString(),fetchOptions:Object.assign(Object.assign({},yF(a)),{method:"POST",headers:await dF(l),body:i})}}async function Eh(r,t,e,n,i,a={},l=fetch){const{url:c,fetchOptions:h}=await fF(r,t,e,n,i,a);return pF(c,h,l)}async function pF(r,t,e=fetch){let n;try{n=await e(r,t)}catch(i){gF(i,r)}return n.ok||await mF(n,r),n}function gF(r,t){let e=r;throw e.name==="AbortError"?(e=new zR(`Request aborted when fetching ${t.toString()}: ${r.message}`),e.stack=r.stack):r instanceof HR||r instanceof ma||(e=new $n(`Error fetching from ${t.toString()}: ${r.message}`),e.stack=r.stack),e}async function mF(r,t){let e="",n;try{const i=await r.json();e=i.error.message,i.error.details&&(e+=` ${JSON.stringify(i.error.details)}`,n=i.error.details)}catch{}throw new HR(`Error fetching from ${t.toString()}: [${r.status} ${r.statusText}] ${e}`,r.status,r.statusText,n)}function yF(r){const t={};if(r?.signal!==void 0||r?.timeout>=0){const e=new AbortController;r?.timeout>=0&&setTimeout(()=>e.abort(),r.timeout),r?.signal&&r.signal.addEventListener("abort",()=>{e.abort()}),t.signal=e.signal}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f0(r){return r.text=()=>{if(r.candidates&&r.candidates.length>0){if(r.candidates.length>1&&console.warn(`This response had ${r.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),_f(r.candidates[0]))throw new bl(`${ra(r)}`,r);return vF(r)}else if(r.promptFeedback)throw new bl(`Text not available. ${ra(r)}`,r);return""},r.functionCall=()=>{if(r.candidates&&r.candidates.length>0){if(r.candidates.length>1&&console.warn(`This response had ${r.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),_f(r.candidates[0]))throw new bl(`${ra(r)}`,r);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),ew(r)[0]}else if(r.promptFeedback)throw new bl(`Function call not available. ${ra(r)}`,r)},r.functionCalls=()=>{if(r.candidates&&r.candidates.length>0){if(r.candidates.length>1&&console.warn(`This response had ${r.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),_f(r.candidates[0]))throw new bl(`${ra(r)}`,r);return ew(r)}else if(r.promptFeedback)throw new bl(`Function call not available. ${ra(r)}`,r)},r}function vF(r){var t,e,n,i;const a=[];if(!((e=(t=r.candidates)===null||t===void 0?void 0:t[0].content)===null||e===void 0)&&e.parts)for(const l of(i=(n=r.candidates)===null||n===void 0?void 0:n[0].content)===null||i===void 0?void 0:i.parts)l.text&&a.push(l.text),l.executableCode&&a.push("\n```"+l.executableCode.language+`
`+l.executableCode.code+"\n```\n"),l.codeExecutionResult&&a.push("\n```\n"+l.codeExecutionResult.output+"\n```\n");return a.length>0?a.join(""):""}function ew(r){var t,e,n,i;const a=[];if(!((e=(t=r.candidates)===null||t===void 0?void 0:t[0].content)===null||e===void 0)&&e.parts)for(const l of(i=(n=r.candidates)===null||n===void 0?void 0:n[0].content)===null||i===void 0?void 0:i.parts)l.functionCall&&a.push(l.functionCall);if(a.length>0)return a}const EF=[Mu.RECITATION,Mu.SAFETY,Mu.LANGUAGE];function _f(r){return!!r.finishReason&&EF.includes(r.finishReason)}function ra(r){var t,e,n;let i="";if((!r.candidates||r.candidates.length===0)&&r.promptFeedback)i+="Response was blocked",!((t=r.promptFeedback)===null||t===void 0)&&t.blockReason&&(i+=` due to ${r.promptFeedback.blockReason}`),!((e=r.promptFeedback)===null||e===void 0)&&e.blockReasonMessage&&(i+=`: ${r.promptFeedback.blockReasonMessage}`);else if(!((n=r.candidates)===null||n===void 0)&&n[0]){const a=r.candidates[0];_f(a)&&(i+=`Candidate was blocked due to ${a.finishReason}`,a.finishMessage&&(i+=`: ${a.finishMessage}`))}return i}function Qu(r){return this instanceof Qu?(this.v=r,this):new Qu(r)}function AF(r,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(r,t||[]),i,a=[];return i={},l("next"),l("throw"),l("return"),i[Symbol.asyncIterator]=function(){return this},i;function l(v){n[v]&&(i[v]=function(E){return new Promise(function(b,T){a.push([v,E,b,T])>1||c(v,E)})})}function c(v,E){try{h(n[v](E))}catch(b){m(a[0][3],b)}}function h(v){v.value instanceof Qu?Promise.resolve(v.value.v).then(d,p):m(a[0][2],v)}function d(v){c("next",v)}function p(v){c("throw",v)}function m(v,E){v(E),a.shift(),a.length&&c(a[0][0],a[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nw=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function bF(r){const t=r.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),e=wF(t),[n,i]=e.tee();return{stream:_F(n),response:TF(i)}}async function TF(r){const t=[],e=r.getReader();for(;;){const{done:n,value:i}=await e.read();if(n)return f0(SF(t));t.push(i)}}function _F(r){return AF(this,arguments,function*(){const e=r.getReader();for(;;){const{value:n,done:i}=yield Qu(e.read());if(i)break;yield yield Qu(f0(n))}})}function wF(r){const t=r.getReader();return new ReadableStream({start(n){let i="";return a();function a(){return t.read().then(({value:l,done:c})=>{if(c){if(i.trim()){n.error(new $n("Failed to parse stream"));return}n.close();return}i+=l;let h=i.match(nw),d;for(;h;){try{d=JSON.parse(h[1])}catch{n.error(new $n(`Error parsing JSON response: "${h[1]}"`));return}n.enqueue(d),i=i.substring(h[0].length),h=i.match(nw)}return a()}).catch(l=>{let c=l;throw c.stack=l.stack,c.name==="AbortError"?c=new zR("Request aborted when reading from the stream"):c=new $n("Error reading from the stream"),c})}}})}function SF(r){const t=r[r.length-1],e={promptFeedback:t?.promptFeedback};for(const n of r){if(n.candidates){let i=0;for(const a of n.candidates)if(e.candidates||(e.candidates=[]),e.candidates[i]||(e.candidates[i]={index:i}),e.candidates[i].citationMetadata=a.citationMetadata,e.candidates[i].groundingMetadata=a.groundingMetadata,e.candidates[i].finishReason=a.finishReason,e.candidates[i].finishMessage=a.finishMessage,e.candidates[i].safetyRatings=a.safetyRatings,a.content&&a.content.parts){e.candidates[i].content||(e.candidates[i].content={role:a.content.role||"user",parts:[]});const l={};for(const c of a.content.parts)c.text&&(l.text=c.text),c.functionCall&&(l.functionCall=c.functionCall),c.executableCode&&(l.executableCode=c.executableCode),c.codeExecutionResult&&(l.codeExecutionResult=c.codeExecutionResult),Object.keys(l).length===0&&(l.text=""),e.candidates[i].content.parts.push(l)}i++}n.usageMetadata&&(e.usageMetadata=n.usageMetadata)}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GR(r,t,e,n){const i=await Eh(t,_o.STREAM_GENERATE_CONTENT,r,!0,JSON.stringify(e),n);return bF(i)}async function $R(r,t,e,n){const a=await(await Eh(t,_o.GENERATE_CONTENT,r,!1,JSON.stringify(e),n)).json();return{response:f0(a)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YR(r){if(r!=null){if(typeof r=="string")return{role:"system",parts:[{text:r}]};if(r.text)return{role:"system",parts:[r]};if(r.parts)return r.role?r:{role:"system",parts:r.parts}}}function Ju(r){let t=[];if(typeof r=="string")t=[{text:r}];else for(const e of r)typeof e=="string"?t.push({text:e}):t.push(e);return RF(t)}function RF(r){const t={role:"user",parts:[]},e={role:"function",parts:[]};let n=!1,i=!1;for(const a of r)"functionResponse"in a?(e.parts.push(a),i=!0):(t.parts.push(a),n=!0);if(n&&i)throw new $n("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!n&&!i)throw new $n("No content is provided for sending chat message.");return n?t:e}function CF(r,t){var e;let n={model:t?.model,generationConfig:t?.generationConfig,safetySettings:t?.safetySettings,tools:t?.tools,toolConfig:t?.toolConfig,systemInstruction:t?.systemInstruction,cachedContent:(e=t?.cachedContent)===null||e===void 0?void 0:e.name,contents:[]};const i=r.generateContentRequest!=null;if(r.contents){if(i)throw new ma("CountTokensRequest must have one of contents or generateContentRequest, not both.");n.contents=r.contents}else if(i)n=Object.assign(Object.assign({},n),r.generateContentRequest);else{const a=Ju(r);n.contents=[a]}return{generateContentRequest:n}}function iw(r){let t;return r.contents?t=r:t={contents:[Ju(r)]},r.systemInstruction&&(t.systemInstruction=YR(r.systemInstruction)),t}function IF(r){return typeof r=="string"||Array.isArray(r)?{content:Ju(r)}:r}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rw=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],xF={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function DF(r){let t=!1;for(const e of r){const{role:n,parts:i}=e;if(!t&&n!=="user")throw new $n(`First content should be with role 'user', got ${n}`);if(!W_.includes(n))throw new $n(`Each item should include role field. Got ${n} but valid roles are: ${JSON.stringify(W_)}`);if(!Array.isArray(i))throw new $n("Content should have 'parts' property with an array of Parts");if(i.length===0)throw new $n("Each Content should have at least one part");const a={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const c of i)for(const h of rw)h in c&&(a[h]+=1);const l=xF[n];for(const c of rw)if(!l.includes(c)&&a[c]>0)throw new $n(`Content with role '${n}' can't contain '${c}' part`);t=!0}}function sw(r){var t;if(r.candidates===void 0||r.candidates.length===0)return!1;const e=(t=r.candidates[0])===null||t===void 0?void 0:t.content;if(e===void 0||e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aw="SILENT_ERROR";class OF{constructor(t,e,n,i={}){this.model=e,this.params=n,this._requestOptions=i,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=t,n?.history&&(DF(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(t,e={}){var n,i,a,l,c,h;await this._sendPromise;const d=Ju(t),p={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(a=this.params)===null||a===void 0?void 0:a.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(h=this.params)===null||h===void 0?void 0:h.cachedContent,contents:[...this._history,d]},m=Object.assign(Object.assign({},this._requestOptions),e);let v;return this._sendPromise=this._sendPromise.then(()=>$R(this._apiKey,this.model,p,m)).then(E=>{var b;if(sw(E.response)){this._history.push(d);const T=Object.assign({parts:[],role:"model"},(b=E.response.candidates)===null||b===void 0?void 0:b[0].content);this._history.push(T)}else{const T=ra(E.response);T&&console.warn(`sendMessage() was unsuccessful. ${T}. Inspect response object for details.`)}v=E}).catch(E=>{throw this._sendPromise=Promise.resolve(),E}),await this._sendPromise,v}async sendMessageStream(t,e={}){var n,i,a,l,c,h;await this._sendPromise;const d=Ju(t),p={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(a=this.params)===null||a===void 0?void 0:a.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(h=this.params)===null||h===void 0?void 0:h.cachedContent,contents:[...this._history,d]},m=Object.assign(Object.assign({},this._requestOptions),e),v=GR(this._apiKey,this.model,p,m);return this._sendPromise=this._sendPromise.then(()=>v).catch(E=>{throw new Error(aw)}).then(E=>E.response).then(E=>{if(sw(E)){this._history.push(d);const b=Object.assign({},E.candidates[0].content);b.role||(b.role="model"),this._history.push(b)}else{const b=ra(E);b&&console.warn(`sendMessageStream() was unsuccessful. ${b}. Inspect response object for details.`)}}).catch(E=>{E.message!==aw&&console.error(E)}),v}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NF(r,t,e,n){return(await Eh(t,_o.COUNT_TOKENS,r,!1,JSON.stringify(e),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PF(r,t,e,n){return(await Eh(t,_o.EMBED_CONTENT,r,!1,JSON.stringify(e),n)).json()}async function MF(r,t,e,n){const i=e.requests.map(l=>Object.assign(Object.assign({},l),{model:t}));return(await Eh(t,_o.BATCH_EMBED_CONTENTS,r,!1,JSON.stringify({requests:i}),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{constructor(t,e,n={}){this.apiKey=t,this._requestOptions=n,e.model.includes("/")?this.model=e.model:this.model=`models/${e.model}`,this.generationConfig=e.generationConfig||{},this.safetySettings=e.safetySettings||[],this.tools=e.tools,this.toolConfig=e.toolConfig,this.systemInstruction=YR(e.systemInstruction),this.cachedContent=e.cachedContent}async generateContent(t,e={}){var n;const i=iw(t),a=Object.assign(Object.assign({},this._requestOptions),e);return $R(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},i),a)}async generateContentStream(t,e={}){var n;const i=iw(t),a=Object.assign(Object.assign({},this._requestOptions),e);return GR(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},i),a)}startChat(t){var e;return new OF(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(e=this.cachedContent)===null||e===void 0?void 0:e.name},t),this._requestOptions)}async countTokens(t,e={}){const n=CF(t,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),i=Object.assign(Object.assign({},this._requestOptions),e);return NF(this.apiKey,this.model,n,i)}async embedContent(t,e={}){const n=IF(t),i=Object.assign(Object.assign({},this._requestOptions),e);return PF(this.apiKey,this.model,n,i)}async batchEmbedContents(t,e={}){const n=Object.assign(Object.assign({},this._requestOptions),e);return MF(this.apiKey,this.model,t,n)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LF{constructor(t){this.apiKey=t}getGenerativeModel(t,e){if(!t.model)throw new $n("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new ow(this.apiKey,t,e)}getGenerativeModelFromCachedContent(t,e,n){if(!t.name)throw new ma("Cached content must contain a `name` field.");if(!t.model)throw new ma("Cached content must contain a `model` field.");const i=["model","systemInstruction"];for(const l of i)if(e?.[l]&&t[l]&&e?.[l]!==t[l]){if(l==="model"){const c=e.model.startsWith("models/")?e.model.replace("models/",""):e.model,h=t.model.startsWith("models/")?t.model.replace("models/",""):t.model;if(c===h)continue}throw new ma(`Different value for "${l}" specified in modelParams (${e[l]}) and cachedContent (${t[l]})`)}const a=Object.assign(Object.assign({},e),{model:t.model,tools:t.tools,toolConfig:t.toolConfig,systemInstruction:t.systemInstruction,cachedContent:t});return new ow(this.apiKey,a,n)}}var Zm={},fu={},lw;function kF(){if(lw)return fu;lw=1,fu.byteLength=c,fu.toByteArray=d,fu.fromByteArray=v;for(var r=[],t=[],e=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,a=n.length;i<a;++i)r[i]=n[i],t[n.charCodeAt(i)]=i;t[45]=62,t[95]=63;function l(E){var b=E.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var T=E.indexOf("=");T===-1&&(T=b);var S=T===b?0:4-T%4;return[T,S]}function c(E){var b=l(E),T=b[0],S=b[1];return(T+S)*3/4-S}function h(E,b,T){return(b+T)*3/4-T}function d(E){var b,T=l(E),S=T[0],C=T[1],D=new e(h(E,S,C)),O=0,F=C>0?S-4:S,k;for(k=0;k<F;k+=4)b=t[E.charCodeAt(k)]<<18|t[E.charCodeAt(k+1)]<<12|t[E.charCodeAt(k+2)]<<6|t[E.charCodeAt(k+3)],D[O++]=b>>16&255,D[O++]=b>>8&255,D[O++]=b&255;return C===2&&(b=t[E.charCodeAt(k)]<<2|t[E.charCodeAt(k+1)]>>4,D[O++]=b&255),C===1&&(b=t[E.charCodeAt(k)]<<10|t[E.charCodeAt(k+1)]<<4|t[E.charCodeAt(k+2)]>>2,D[O++]=b>>8&255,D[O++]=b&255),D}function p(E){return r[E>>18&63]+r[E>>12&63]+r[E>>6&63]+r[E&63]}function m(E,b,T){for(var S,C=[],D=b;D<T;D+=3)S=(E[D]<<16&16711680)+(E[D+1]<<8&65280)+(E[D+2]&255),C.push(p(S));return C.join("")}function v(E){for(var b,T=E.length,S=T%3,C=[],D=16383,O=0,F=T-S;O<F;O+=D)C.push(m(E,O,O+D>F?F:O+D));return S===1?(b=E[T-1],C.push(r[b>>2]+r[b<<4&63]+"==")):S===2&&(b=(E[T-2]<<8)+E[T-1],C.push(r[b>>10]+r[b>>4&63]+r[b<<2&63]+"=")),C.join("")}return fu}var of={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var cw;function BF(){return cw||(cw=1,of.read=function(r,t,e,n,i){var a,l,c=i*8-n-1,h=(1<<c)-1,d=h>>1,p=-7,m=e?i-1:0,v=e?-1:1,E=r[t+m];for(m+=v,a=E&(1<<-p)-1,E>>=-p,p+=c;p>0;a=a*256+r[t+m],m+=v,p-=8);for(l=a&(1<<-p)-1,a>>=-p,p+=n;p>0;l=l*256+r[t+m],m+=v,p-=8);if(a===0)a=1-d;else{if(a===h)return l?NaN:(E?-1:1)*(1/0);l=l+Math.pow(2,n),a=a-d}return(E?-1:1)*l*Math.pow(2,a-n)},of.write=function(r,t,e,n,i,a){var l,c,h,d=a*8-i-1,p=(1<<d)-1,m=p>>1,v=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=n?0:a-1,b=n?1:-1,T=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(c=isNaN(t)?1:0,l=p):(l=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-l))<1&&(l--,h*=2),l+m>=1?t+=v/h:t+=v*Math.pow(2,1-m),t*h>=2&&(l++,h/=2),l+m>=p?(c=0,l=p):l+m>=1?(c=(t*h-1)*Math.pow(2,i),l=l+m):(c=t*Math.pow(2,m-1)*Math.pow(2,i),l=0));i>=8;r[e+E]=c&255,E+=b,c/=256,i-=8);for(l=l<<i|c,d+=i;d>0;r[e+E]=l&255,E+=b,l/=256,d-=8);r[e+E-b]|=T*128}),of}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var uw;function FF(){return uw||(uw=1,(function(r){const t=kF(),e=BF(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=c,r.SlowBuffer=D,r.INSPECT_MAX_BYTES=50;const i=2147483647;r.kMaxLength=i,c.TYPED_ARRAY_SUPPORT=a(),!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const L=new Uint8Array(1),w={foo:function(){return 42}};return Object.setPrototypeOf(w,Uint8Array.prototype),Object.setPrototypeOf(L,w),L.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}});function l(L){if(L>i)throw new RangeError('The value "'+L+'" is invalid for option "size"');const w=new Uint8Array(L);return Object.setPrototypeOf(w,c.prototype),w}function c(L,w,R){if(typeof L=="number"){if(typeof w=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(L)}return h(L,w,R)}c.poolSize=8192;function h(L,w,R){if(typeof L=="string")return v(L,w);if(ArrayBuffer.isView(L))return b(L);if(L==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L);if(Un(L,ArrayBuffer)||L&&Un(L.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Un(L,SharedArrayBuffer)||L&&Un(L.buffer,SharedArrayBuffer)))return T(L,w,R);if(typeof L=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const G=L.valueOf&&L.valueOf();if(G!=null&&G!==L)return c.from(G,w,R);const J=S(L);if(J)return J;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof L[Symbol.toPrimitive]=="function")return c.from(L[Symbol.toPrimitive]("string"),w,R);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L)}c.from=function(L,w,R){return h(L,w,R)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array);function d(L){if(typeof L!="number")throw new TypeError('"size" argument must be of type number');if(L<0)throw new RangeError('The value "'+L+'" is invalid for option "size"')}function p(L,w,R){return d(L),L<=0?l(L):w!==void 0?typeof R=="string"?l(L).fill(w,R):l(L).fill(w):l(L)}c.alloc=function(L,w,R){return p(L,w,R)};function m(L){return d(L),l(L<0?0:C(L)|0)}c.allocUnsafe=function(L){return m(L)},c.allocUnsafeSlow=function(L){return m(L)};function v(L,w){if((typeof w!="string"||w==="")&&(w="utf8"),!c.isEncoding(w))throw new TypeError("Unknown encoding: "+w);const R=O(L,w)|0;let G=l(R);const J=G.write(L,w);return J!==R&&(G=G.slice(0,J)),G}function E(L){const w=L.length<0?0:C(L.length)|0,R=l(w);for(let G=0;G<w;G+=1)R[G]=L[G]&255;return R}function b(L){if(Un(L,Uint8Array)){const w=new Uint8Array(L);return T(w.buffer,w.byteOffset,w.byteLength)}return E(L)}function T(L,w,R){if(w<0||L.byteLength<w)throw new RangeError('"offset" is outside of buffer bounds');if(L.byteLength<w+(R||0))throw new RangeError('"length" is outside of buffer bounds');let G;return w===void 0&&R===void 0?G=new Uint8Array(L):R===void 0?G=new Uint8Array(L,w):G=new Uint8Array(L,w,R),Object.setPrototypeOf(G,c.prototype),G}function S(L){if(c.isBuffer(L)){const w=C(L.length)|0,R=l(w);return R.length===0||L.copy(R,0,0,w),R}if(L.length!==void 0)return typeof L.length!="number"||Si(L.length)?l(0):E(L);if(L.type==="Buffer"&&Array.isArray(L.data))return E(L.data)}function C(L){if(L>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return L|0}function D(L){return+L!=L&&(L=0),c.alloc(+L)}c.isBuffer=function(w){return w!=null&&w._isBuffer===!0&&w!==c.prototype},c.compare=function(w,R){if(Un(w,Uint8Array)&&(w=c.from(w,w.offset,w.byteLength)),Un(R,Uint8Array)&&(R=c.from(R,R.offset,R.byteLength)),!c.isBuffer(w)||!c.isBuffer(R))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(w===R)return 0;let G=w.length,J=R.length;for(let ot=0,mt=Math.min(G,J);ot<mt;++ot)if(w[ot]!==R[ot]){G=w[ot],J=R[ot];break}return G<J?-1:J<G?1:0},c.isEncoding=function(w){switch(String(w).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(w,R){if(!Array.isArray(w))throw new TypeError('"list" argument must be an Array of Buffers');if(w.length===0)return c.alloc(0);let G;if(R===void 0)for(R=0,G=0;G<w.length;++G)R+=w[G].length;const J=c.allocUnsafe(R);let ot=0;for(G=0;G<w.length;++G){let mt=w[G];if(Un(mt,Uint8Array))ot+mt.length>J.length?(c.isBuffer(mt)||(mt=c.from(mt)),mt.copy(J,ot)):Uint8Array.prototype.set.call(J,mt,ot);else if(c.isBuffer(mt))mt.copy(J,ot);else throw new TypeError('"list" argument must be an Array of Buffers');ot+=mt.length}return J};function O(L,w){if(c.isBuffer(L))return L.length;if(ArrayBuffer.isView(L)||Un(L,ArrayBuffer))return L.byteLength;if(typeof L!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof L);const R=L.length,G=arguments.length>2&&arguments[2]===!0;if(!G&&R===0)return 0;let J=!1;for(;;)switch(w){case"ascii":case"latin1":case"binary":return R;case"utf8":case"utf-8":return _e(L).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R*2;case"hex":return R>>>1;case"base64":return Wi(L).length;default:if(J)return G?-1:_e(L).length;w=(""+w).toLowerCase(),J=!0}}c.byteLength=O;function F(L,w,R){let G=!1;if((w===void 0||w<0)&&(w=0),w>this.length||((R===void 0||R>this.length)&&(R=this.length),R<=0)||(R>>>=0,w>>>=0,R<=w))return"";for(L||(L="utf8");;)switch(L){case"hex":return Rt(this,w,R);case"utf8":case"utf-8":return Tt(this,w,R);case"ascii":return Z(this,w,R);case"latin1":case"binary":return ht(this,w,R);case"base64":return j(this,w,R);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,w,R);default:if(G)throw new TypeError("Unknown encoding: "+L);L=(L+"").toLowerCase(),G=!0}}c.prototype._isBuffer=!0;function k(L,w,R){const G=L[w];L[w]=L[R],L[R]=G}c.prototype.swap16=function(){const w=this.length;if(w%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let R=0;R<w;R+=2)k(this,R,R+1);return this},c.prototype.swap32=function(){const w=this.length;if(w%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let R=0;R<w;R+=4)k(this,R,R+3),k(this,R+1,R+2);return this},c.prototype.swap64=function(){const w=this.length;if(w%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let R=0;R<w;R+=8)k(this,R,R+7),k(this,R+1,R+6),k(this,R+2,R+5),k(this,R+3,R+4);return this},c.prototype.toString=function(){const w=this.length;return w===0?"":arguments.length===0?Tt(this,0,w):F.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(w){if(!c.isBuffer(w))throw new TypeError("Argument must be a Buffer");return this===w?!0:c.compare(this,w)===0},c.prototype.inspect=function(){let w="";const R=r.INSPECT_MAX_BYTES;return w=this.toString("hex",0,R).replace(/(.{2})/g,"$1 ").trim(),this.length>R&&(w+=" ... "),"<Buffer "+w+">"},n&&(c.prototype[n]=c.prototype.inspect),c.prototype.compare=function(w,R,G,J,ot){if(Un(w,Uint8Array)&&(w=c.from(w,w.offset,w.byteLength)),!c.isBuffer(w))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof w);if(R===void 0&&(R=0),G===void 0&&(G=w?w.length:0),J===void 0&&(J=0),ot===void 0&&(ot=this.length),R<0||G>w.length||J<0||ot>this.length)throw new RangeError("out of range index");if(J>=ot&&R>=G)return 0;if(J>=ot)return-1;if(R>=G)return 1;if(R>>>=0,G>>>=0,J>>>=0,ot>>>=0,this===w)return 0;let mt=ot-J,Yt=G-R;const ce=Math.min(mt,Yt),ye=this.slice(J,ot),Ee=w.slice(R,G);for(let pe=0;pe<ce;++pe)if(ye[pe]!==Ee[pe]){mt=ye[pe],Yt=Ee[pe];break}return mt<Yt?-1:Yt<mt?1:0};function z(L,w,R,G,J){if(L.length===0)return-1;if(typeof R=="string"?(G=R,R=0):R>2147483647?R=2147483647:R<-2147483648&&(R=-2147483648),R=+R,Si(R)&&(R=J?0:L.length-1),R<0&&(R=L.length+R),R>=L.length){if(J)return-1;R=L.length-1}else if(R<0)if(J)R=0;else return-1;if(typeof w=="string"&&(w=c.from(w,G)),c.isBuffer(w))return w.length===0?-1:P(L,w,R,G,J);if(typeof w=="number")return w=w&255,typeof Uint8Array.prototype.indexOf=="function"?J?Uint8Array.prototype.indexOf.call(L,w,R):Uint8Array.prototype.lastIndexOf.call(L,w,R):P(L,[w],R,G,J);throw new TypeError("val must be string, number or Buffer")}function P(L,w,R,G,J){let ot=1,mt=L.length,Yt=w.length;if(G!==void 0&&(G=String(G).toLowerCase(),G==="ucs2"||G==="ucs-2"||G==="utf16le"||G==="utf-16le")){if(L.length<2||w.length<2)return-1;ot=2,mt/=2,Yt/=2,R/=2}function ce(Ee,pe){return ot===1?Ee[pe]:Ee.readUInt16BE(pe*ot)}let ye;if(J){let Ee=-1;for(ye=R;ye<mt;ye++)if(ce(L,ye)===ce(w,Ee===-1?0:ye-Ee)){if(Ee===-1&&(Ee=ye),ye-Ee+1===Yt)return Ee*ot}else Ee!==-1&&(ye-=ye-Ee),Ee=-1}else for(R+Yt>mt&&(R=mt-Yt),ye=R;ye>=0;ye--){let Ee=!0;for(let pe=0;pe<Yt;pe++)if(ce(L,ye+pe)!==ce(w,pe)){Ee=!1;break}if(Ee)return ye}return-1}c.prototype.includes=function(w,R,G){return this.indexOf(w,R,G)!==-1},c.prototype.indexOf=function(w,R,G){return z(this,w,R,G,!0)},c.prototype.lastIndexOf=function(w,R,G){return z(this,w,R,G,!1)};function N(L,w,R,G){R=Number(R)||0;const J=L.length-R;G?(G=Number(G),G>J&&(G=J)):G=J;const ot=w.length;G>ot/2&&(G=ot/2);let mt;for(mt=0;mt<G;++mt){const Yt=parseInt(w.substr(mt*2,2),16);if(Si(Yt))return mt;L[R+mt]=Yt}return mt}function M(L,w,R,G){return ri(_e(w,L.length-R),L,R,G)}function V(L,w,R,G){return ri(Yi(w),L,R,G)}function H(L,w,R,G){return ri(Wi(w),L,R,G)}function $(L,w,R,G){return ri(ii(w,L.length-R),L,R,G)}c.prototype.write=function(w,R,G,J){if(R===void 0)J="utf8",G=this.length,R=0;else if(G===void 0&&typeof R=="string")J=R,G=this.length,R=0;else if(isFinite(R))R=R>>>0,isFinite(G)?(G=G>>>0,J===void 0&&(J="utf8")):(J=G,G=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ot=this.length-R;if((G===void 0||G>ot)&&(G=ot),w.length>0&&(G<0||R<0)||R>this.length)throw new RangeError("Attempt to write outside buffer bounds");J||(J="utf8");let mt=!1;for(;;)switch(J){case"hex":return N(this,w,R,G);case"utf8":case"utf-8":return M(this,w,R,G);case"ascii":case"latin1":case"binary":return V(this,w,R,G);case"base64":return H(this,w,R,G);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $(this,w,R,G);default:if(mt)throw new TypeError("Unknown encoding: "+J);J=(""+J).toLowerCase(),mt=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function j(L,w,R){return w===0&&R===L.length?t.fromByteArray(L):t.fromByteArray(L.slice(w,R))}function Tt(L,w,R){R=Math.min(L.length,R);const G=[];let J=w;for(;J<R;){const ot=L[J];let mt=null,Yt=ot>239?4:ot>223?3:ot>191?2:1;if(J+Yt<=R){let ce,ye,Ee,pe;switch(Yt){case 1:ot<128&&(mt=ot);break;case 2:ce=L[J+1],(ce&192)===128&&(pe=(ot&31)<<6|ce&63,pe>127&&(mt=pe));break;case 3:ce=L[J+1],ye=L[J+2],(ce&192)===128&&(ye&192)===128&&(pe=(ot&15)<<12|(ce&63)<<6|ye&63,pe>2047&&(pe<55296||pe>57343)&&(mt=pe));break;case 4:ce=L[J+1],ye=L[J+2],Ee=L[J+3],(ce&192)===128&&(ye&192)===128&&(Ee&192)===128&&(pe=(ot&15)<<18|(ce&63)<<12|(ye&63)<<6|Ee&63,pe>65535&&pe<1114112&&(mt=pe))}}mt===null?(mt=65533,Yt=1):mt>65535&&(mt-=65536,G.push(mt>>>10&1023|55296),mt=56320|mt&1023),G.push(mt),J+=Yt}return X(G)}const St=4096;function X(L){const w=L.length;if(w<=St)return String.fromCharCode.apply(String,L);let R="",G=0;for(;G<w;)R+=String.fromCharCode.apply(String,L.slice(G,G+=St));return R}function Z(L,w,R){let G="";R=Math.min(L.length,R);for(let J=w;J<R;++J)G+=String.fromCharCode(L[J]&127);return G}function ht(L,w,R){let G="";R=Math.min(L.length,R);for(let J=w;J<R;++J)G+=String.fromCharCode(L[J]);return G}function Rt(L,w,R){const G=L.length;(!w||w<0)&&(w=0),(!R||R<0||R>G)&&(R=G);let J="";for(let ot=w;ot<R;++ot)J+=Vr[L[ot]];return J}function W(L,w,R){const G=L.slice(w,R);let J="";for(let ot=0;ot<G.length-1;ot+=2)J+=String.fromCharCode(G[ot]+G[ot+1]*256);return J}c.prototype.slice=function(w,R){const G=this.length;w=~~w,R=R===void 0?G:~~R,w<0?(w+=G,w<0&&(w=0)):w>G&&(w=G),R<0?(R+=G,R<0&&(R=0)):R>G&&(R=G),R<w&&(R=w);const J=this.subarray(w,R);return Object.setPrototypeOf(J,c.prototype),J};function lt(L,w,R){if(L%1!==0||L<0)throw new RangeError("offset is not uint");if(L+w>R)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(w,R,G){w=w>>>0,R=R>>>0,G||lt(w,R,this.length);let J=this[w],ot=1,mt=0;for(;++mt<R&&(ot*=256);)J+=this[w+mt]*ot;return J},c.prototype.readUintBE=c.prototype.readUIntBE=function(w,R,G){w=w>>>0,R=R>>>0,G||lt(w,R,this.length);let J=this[w+--R],ot=1;for(;R>0&&(ot*=256);)J+=this[w+--R]*ot;return J},c.prototype.readUint8=c.prototype.readUInt8=function(w,R){return w=w>>>0,R||lt(w,1,this.length),this[w]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(w,R){return w=w>>>0,R||lt(w,2,this.length),this[w]|this[w+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(w,R){return w=w>>>0,R||lt(w,2,this.length),this[w]<<8|this[w+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(w,R){return w=w>>>0,R||lt(w,4,this.length),(this[w]|this[w+1]<<8|this[w+2]<<16)+this[w+3]*16777216},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(w,R){return w=w>>>0,R||lt(w,4,this.length),this[w]*16777216+(this[w+1]<<16|this[w+2]<<8|this[w+3])},c.prototype.readBigUInt64LE=fi(function(w){w=w>>>0,Xt(w,"offset");const R=this[w],G=this[w+7];(R===void 0||G===void 0)&&ne(w,this.length-8);const J=R+this[++w]*2**8+this[++w]*2**16+this[++w]*2**24,ot=this[++w]+this[++w]*2**8+this[++w]*2**16+G*2**24;return BigInt(J)+(BigInt(ot)<<BigInt(32))}),c.prototype.readBigUInt64BE=fi(function(w){w=w>>>0,Xt(w,"offset");const R=this[w],G=this[w+7];(R===void 0||G===void 0)&&ne(w,this.length-8);const J=R*2**24+this[++w]*2**16+this[++w]*2**8+this[++w],ot=this[++w]*2**24+this[++w]*2**16+this[++w]*2**8+G;return(BigInt(J)<<BigInt(32))+BigInt(ot)}),c.prototype.readIntLE=function(w,R,G){w=w>>>0,R=R>>>0,G||lt(w,R,this.length);let J=this[w],ot=1,mt=0;for(;++mt<R&&(ot*=256);)J+=this[w+mt]*ot;return ot*=128,J>=ot&&(J-=Math.pow(2,8*R)),J},c.prototype.readIntBE=function(w,R,G){w=w>>>0,R=R>>>0,G||lt(w,R,this.length);let J=R,ot=1,mt=this[w+--J];for(;J>0&&(ot*=256);)mt+=this[w+--J]*ot;return ot*=128,mt>=ot&&(mt-=Math.pow(2,8*R)),mt},c.prototype.readInt8=function(w,R){return w=w>>>0,R||lt(w,1,this.length),this[w]&128?(255-this[w]+1)*-1:this[w]},c.prototype.readInt16LE=function(w,R){w=w>>>0,R||lt(w,2,this.length);const G=this[w]|this[w+1]<<8;return G&32768?G|4294901760:G},c.prototype.readInt16BE=function(w,R){w=w>>>0,R||lt(w,2,this.length);const G=this[w+1]|this[w]<<8;return G&32768?G|4294901760:G},c.prototype.readInt32LE=function(w,R){return w=w>>>0,R||lt(w,4,this.length),this[w]|this[w+1]<<8|this[w+2]<<16|this[w+3]<<24},c.prototype.readInt32BE=function(w,R){return w=w>>>0,R||lt(w,4,this.length),this[w]<<24|this[w+1]<<16|this[w+2]<<8|this[w+3]},c.prototype.readBigInt64LE=fi(function(w){w=w>>>0,Xt(w,"offset");const R=this[w],G=this[w+7];(R===void 0||G===void 0)&&ne(w,this.length-8);const J=this[w+4]+this[w+5]*2**8+this[w+6]*2**16+(G<<24);return(BigInt(J)<<BigInt(32))+BigInt(R+this[++w]*2**8+this[++w]*2**16+this[++w]*2**24)}),c.prototype.readBigInt64BE=fi(function(w){w=w>>>0,Xt(w,"offset");const R=this[w],G=this[w+7];(R===void 0||G===void 0)&&ne(w,this.length-8);const J=(R<<24)+this[++w]*2**16+this[++w]*2**8+this[++w];return(BigInt(J)<<BigInt(32))+BigInt(this[++w]*2**24+this[++w]*2**16+this[++w]*2**8+G)}),c.prototype.readFloatLE=function(w,R){return w=w>>>0,R||lt(w,4,this.length),e.read(this,w,!0,23,4)},c.prototype.readFloatBE=function(w,R){return w=w>>>0,R||lt(w,4,this.length),e.read(this,w,!1,23,4)},c.prototype.readDoubleLE=function(w,R){return w=w>>>0,R||lt(w,8,this.length),e.read(this,w,!0,52,8)},c.prototype.readDoubleBE=function(w,R){return w=w>>>0,R||lt(w,8,this.length),e.read(this,w,!1,52,8)};function q(L,w,R,G,J,ot){if(!c.isBuffer(L))throw new TypeError('"buffer" argument must be a Buffer instance');if(w>J||w<ot)throw new RangeError('"value" argument is out of bounds');if(R+G>L.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(w,R,G,J){if(w=+w,R=R>>>0,G=G>>>0,!J){const Yt=Math.pow(2,8*G)-1;q(this,w,R,G,Yt,0)}let ot=1,mt=0;for(this[R]=w&255;++mt<G&&(ot*=256);)this[R+mt]=w/ot&255;return R+G},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(w,R,G,J){if(w=+w,R=R>>>0,G=G>>>0,!J){const Yt=Math.pow(2,8*G)-1;q(this,w,R,G,Yt,0)}let ot=G-1,mt=1;for(this[R+ot]=w&255;--ot>=0&&(mt*=256);)this[R+ot]=w/mt&255;return R+G},c.prototype.writeUint8=c.prototype.writeUInt8=function(w,R,G){return w=+w,R=R>>>0,G||q(this,w,R,1,255,0),this[R]=w&255,R+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(w,R,G){return w=+w,R=R>>>0,G||q(this,w,R,2,65535,0),this[R]=w&255,this[R+1]=w>>>8,R+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(w,R,G){return w=+w,R=R>>>0,G||q(this,w,R,2,65535,0),this[R]=w>>>8,this[R+1]=w&255,R+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(w,R,G){return w=+w,R=R>>>0,G||q(this,w,R,4,4294967295,0),this[R+3]=w>>>24,this[R+2]=w>>>16,this[R+1]=w>>>8,this[R]=w&255,R+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(w,R,G){return w=+w,R=R>>>0,G||q(this,w,R,4,4294967295,0),this[R]=w>>>24,this[R+1]=w>>>16,this[R+2]=w>>>8,this[R+3]=w&255,R+4};function it(L,w,R,G,J){qt(w,G,J,L,R,7);let ot=Number(w&BigInt(4294967295));L[R++]=ot,ot=ot>>8,L[R++]=ot,ot=ot>>8,L[R++]=ot,ot=ot>>8,L[R++]=ot;let mt=Number(w>>BigInt(32)&BigInt(4294967295));return L[R++]=mt,mt=mt>>8,L[R++]=mt,mt=mt>>8,L[R++]=mt,mt=mt>>8,L[R++]=mt,R}function yt(L,w,R,G,J){qt(w,G,J,L,R,7);let ot=Number(w&BigInt(4294967295));L[R+7]=ot,ot=ot>>8,L[R+6]=ot,ot=ot>>8,L[R+5]=ot,ot=ot>>8,L[R+4]=ot;let mt=Number(w>>BigInt(32)&BigInt(4294967295));return L[R+3]=mt,mt=mt>>8,L[R+2]=mt,mt=mt>>8,L[R+1]=mt,mt=mt>>8,L[R]=mt,R+8}c.prototype.writeBigUInt64LE=fi(function(w,R=0){return it(this,w,R,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=fi(function(w,R=0){return yt(this,w,R,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(w,R,G,J){if(w=+w,R=R>>>0,!J){const ce=Math.pow(2,8*G-1);q(this,w,R,G,ce-1,-ce)}let ot=0,mt=1,Yt=0;for(this[R]=w&255;++ot<G&&(mt*=256);)w<0&&Yt===0&&this[R+ot-1]!==0&&(Yt=1),this[R+ot]=(w/mt>>0)-Yt&255;return R+G},c.prototype.writeIntBE=function(w,R,G,J){if(w=+w,R=R>>>0,!J){const ce=Math.pow(2,8*G-1);q(this,w,R,G,ce-1,-ce)}let ot=G-1,mt=1,Yt=0;for(this[R+ot]=w&255;--ot>=0&&(mt*=256);)w<0&&Yt===0&&this[R+ot+1]!==0&&(Yt=1),this[R+ot]=(w/mt>>0)-Yt&255;return R+G},c.prototype.writeInt8=function(w,R,G){return w=+w,R=R>>>0,G||q(this,w,R,1,127,-128),w<0&&(w=255+w+1),this[R]=w&255,R+1},c.prototype.writeInt16LE=function(w,R,G){return w=+w,R=R>>>0,G||q(this,w,R,2,32767,-32768),this[R]=w&255,this[R+1]=w>>>8,R+2},c.prototype.writeInt16BE=function(w,R,G){return w=+w,R=R>>>0,G||q(this,w,R,2,32767,-32768),this[R]=w>>>8,this[R+1]=w&255,R+2},c.prototype.writeInt32LE=function(w,R,G){return w=+w,R=R>>>0,G||q(this,w,R,4,2147483647,-2147483648),this[R]=w&255,this[R+1]=w>>>8,this[R+2]=w>>>16,this[R+3]=w>>>24,R+4},c.prototype.writeInt32BE=function(w,R,G){return w=+w,R=R>>>0,G||q(this,w,R,4,2147483647,-2147483648),w<0&&(w=4294967295+w+1),this[R]=w>>>24,this[R+1]=w>>>16,this[R+2]=w>>>8,this[R+3]=w&255,R+4},c.prototype.writeBigInt64LE=fi(function(w,R=0){return it(this,w,R,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=fi(function(w,R=0){return yt(this,w,R,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function _t(L,w,R,G,J,ot){if(R+G>L.length)throw new RangeError("Index out of range");if(R<0)throw new RangeError("Index out of range")}function ut(L,w,R,G,J){return w=+w,R=R>>>0,J||_t(L,w,R,4),e.write(L,w,R,G,23,4),R+4}c.prototype.writeFloatLE=function(w,R,G){return ut(this,w,R,!0,G)},c.prototype.writeFloatBE=function(w,R,G){return ut(this,w,R,!1,G)};function ft(L,w,R,G,J){return w=+w,R=R>>>0,J||_t(L,w,R,8),e.write(L,w,R,G,52,8),R+8}c.prototype.writeDoubleLE=function(w,R,G){return ft(this,w,R,!0,G)},c.prototype.writeDoubleBE=function(w,R,G){return ft(this,w,R,!1,G)},c.prototype.copy=function(w,R,G,J){if(!c.isBuffer(w))throw new TypeError("argument should be a Buffer");if(G||(G=0),!J&&J!==0&&(J=this.length),R>=w.length&&(R=w.length),R||(R=0),J>0&&J<G&&(J=G),J===G||w.length===0||this.length===0)return 0;if(R<0)throw new RangeError("targetStart out of bounds");if(G<0||G>=this.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("sourceEnd out of bounds");J>this.length&&(J=this.length),w.length-R<J-G&&(J=w.length-R+G);const ot=J-G;return this===w&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(R,G,J):Uint8Array.prototype.set.call(w,this.subarray(G,J),R),ot},c.prototype.fill=function(w,R,G,J){if(typeof w=="string"){if(typeof R=="string"?(J=R,R=0,G=this.length):typeof G=="string"&&(J=G,G=this.length),J!==void 0&&typeof J!="string")throw new TypeError("encoding must be a string");if(typeof J=="string"&&!c.isEncoding(J))throw new TypeError("Unknown encoding: "+J);if(w.length===1){const mt=w.charCodeAt(0);(J==="utf8"&&mt<128||J==="latin1")&&(w=mt)}}else typeof w=="number"?w=w&255:typeof w=="boolean"&&(w=Number(w));if(R<0||this.length<R||this.length<G)throw new RangeError("Out of range index");if(G<=R)return this;R=R>>>0,G=G===void 0?this.length:G>>>0,w||(w=0);let ot;if(typeof w=="number")for(ot=R;ot<G;++ot)this[ot]=w;else{const mt=c.isBuffer(w)?w:c.from(w,J),Yt=mt.length;if(Yt===0)throw new TypeError('The value "'+w+'" is invalid for argument "value"');for(ot=0;ot<G-R;++ot)this[ot+R]=mt[ot%Yt]}return this};const pt={};function Ct(L,w,R){pt[L]=class extends R{constructor(){super(),Object.defineProperty(this,"message",{value:w.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${L}]`,this.stack,delete this.name}get code(){return L}set code(J){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:J,writable:!0})}toString(){return`${this.name} [${L}]: ${this.message}`}}}Ct("ERR_BUFFER_OUT_OF_BOUNDS",function(L){return L?`${L} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ct("ERR_INVALID_ARG_TYPE",function(L,w){return`The "${L}" argument must be of type number. Received type ${typeof w}`},TypeError),Ct("ERR_OUT_OF_RANGE",function(L,w,R){let G=`The value of "${L}" is out of range.`,J=R;return Number.isInteger(R)&&Math.abs(R)>2**32?J=Vt(String(R)):typeof R=="bigint"&&(J=String(R),(R>BigInt(2)**BigInt(32)||R<-(BigInt(2)**BigInt(32)))&&(J=Vt(J)),J+="n"),G+=` It must be ${w}. Received ${J}`,G},RangeError);function Vt(L){let w="",R=L.length;const G=L[0]==="-"?1:0;for(;R>=G+4;R-=3)w=`_${L.slice(R-3,R)}${w}`;return`${L.slice(0,R)}${w}`}function It(L,w,R){Xt(w,"offset"),(L[w]===void 0||L[w+R]===void 0)&&ne(w,L.length-(R+1))}function qt(L,w,R,G,J,ot){if(L>R||L<w){const mt=typeof w=="bigint"?"n":"";let Yt;throw w===0||w===BigInt(0)?Yt=`>= 0${mt} and < 2${mt} ** ${(ot+1)*8}${mt}`:Yt=`>= -(2${mt} ** ${(ot+1)*8-1}${mt}) and < 2 ** ${(ot+1)*8-1}${mt}`,new pt.ERR_OUT_OF_RANGE("value",Yt,L)}It(G,J,ot)}function Xt(L,w){if(typeof L!="number")throw new pt.ERR_INVALID_ARG_TYPE(w,"number",L)}function ne(L,w,R){throw Math.floor(L)!==L?(Xt(L,R),new pt.ERR_OUT_OF_RANGE("offset","an integer",L)):w<0?new pt.ERR_BUFFER_OUT_OF_BOUNDS:new pt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${w}`,L)}const Te=/[^+/0-9A-Za-z-_]/g;function me(L){if(L=L.split("=")[0],L=L.trim().replace(Te,""),L.length<2)return"";for(;L.length%4!==0;)L=L+"=";return L}function _e(L,w){w=w||1/0;let R;const G=L.length;let J=null;const ot=[];for(let mt=0;mt<G;++mt){if(R=L.charCodeAt(mt),R>55295&&R<57344){if(!J){if(R>56319){(w-=3)>-1&&ot.push(239,191,189);continue}else if(mt+1===G){(w-=3)>-1&&ot.push(239,191,189);continue}J=R;continue}if(R<56320){(w-=3)>-1&&ot.push(239,191,189),J=R;continue}R=(J-55296<<10|R-56320)+65536}else J&&(w-=3)>-1&&ot.push(239,191,189);if(J=null,R<128){if((w-=1)<0)break;ot.push(R)}else if(R<2048){if((w-=2)<0)break;ot.push(R>>6|192,R&63|128)}else if(R<65536){if((w-=3)<0)break;ot.push(R>>12|224,R>>6&63|128,R&63|128)}else if(R<1114112){if((w-=4)<0)break;ot.push(R>>18|240,R>>12&63|128,R>>6&63|128,R&63|128)}else throw new Error("Invalid code point")}return ot}function Yi(L){const w=[];for(let R=0;R<L.length;++R)w.push(L.charCodeAt(R)&255);return w}function ii(L,w){let R,G,J;const ot=[];for(let mt=0;mt<L.length&&!((w-=2)<0);++mt)R=L.charCodeAt(mt),G=R>>8,J=R%256,ot.push(J),ot.push(G);return ot}function Wi(L){return t.toByteArray(me(L))}function ri(L,w,R,G){let J;for(J=0;J<G&&!(J+R>=w.length||J>=L.length);++J)w[J+R]=L[J];return J}function Un(L,w){return L instanceof w||L!=null&&L.constructor!=null&&L.constructor.name!=null&&L.constructor.name===w.name}function Si(L){return L!==L}const Vr=(function(){const L="0123456789abcdef",w=new Array(256);for(let R=0;R<16;++R){const G=R*16;for(let J=0;J<16;++J)w[G+J]=L[R]+L[J]}return w})();function fi(L){return typeof BigInt>"u"?Me:L}function Me(){throw new Error("BigInt not supported")}})(Zm)),Zm}var UF=FF();fo.workerSrc=fo.workerSrc="https://git229kev.github.io/pdf.worker.min.mjs";const VF="AIzaSyDQzh6Fj-vVi6_4IS5i3yV0lh4HhrEgMPQ",jF=new LF(VF),HF=jF.getGenerativeModel({model:"gemini-2.0-flash"}),zF=()=>{const[r,t]=at.useState(null),[e,n]=at.useState(null),[i,a]=at.useState(null),[l,c]=at.useState(null),[h,d]=at.useState(!1),[p,m]=at.useState(""),[v,E]=at.useState(""),[b,T]=at.useState([]),[S,C]=at.useState(null),[D,O]=at.useState(null),F=Xl(),[k,z]=qv(_i),[P,N]=at.useState({sales:{cost:"",saleDate:"",ownerName:"",salespersonName:"",location:""},gift:{giftDate:"",giverName:"",receiverName:"",location:"",giftType:""},rental:{rentAmount:"",startDate:"",endDate:"",tenantName:"",landlordName:"",propertyLocation:""},authority:{grantorName:"",granteeName:"",authorityType:"",validity:"",location:""}}),M=q=>q?String(q).trim().toLowerCase().replace(/[\s,-.]+/g,""):"",V=(q,it)=>{if(!q||!it)return!1;const yt=["mr","mrs","ms","dr","prof","miss"],_t=Ct=>Ct.trim().toLowerCase().replace(/[.,]/g,""),ut=Ct=>_t(Ct).split(/\s+/).filter(Vt=>Vt&&!yt.includes(Vt)),ft=ut(q),pt=ut(it);return ft.every(Ct=>pt.includes(Ct))},H=q=>{switch(q){case"sales":return{fields:[{key:"cost",label:"Cost"},{key:"saleDate",label:"Sale Date"},{key:"ownerName",label:"Owner Name"},{key:"salespersonName",label:"Salesperson Name"},{key:"location",label:"Location"}],prompt:"From the attached sales document PDF, extract the following information and return it as a JSON object: cost, sale date (format YYYY-MM-DD), owner name, salesperson name, and location. Also, provide a brief summary for each page of the document. If a value is not found, return null for that key.",schemaProperties:{cost:{type:"string"},saleDate:{type:"string"},ownerName:{type:"string"},salespersonName:{type:"string"},location:{type:"string"}},required:["cost","saleDate","ownerName","salespersonName","location"]};case"gift":return{fields:[{key:"giftDate",label:"Gift Date"},{key:"giverName",label:"Giver Name"},{key:"receiverName",label:"Receiver Name"},{key:"location",label:"Enter Location where gift is received"},{key:"giftType",label:"Gift Type"}],prompt:"From the attached gift giving document PDF, extract the following information and return it as a JSON object: gift date (format YYYY-MM-DD), giver name (donor name, which may be in any format), receiver name (donee name, which may be in any format), location (the address following the phrase 'Location of where the gift deed is received/ registered - '), and gift type. If the document contains keywords such as 'apartment' or 'car parking', set gift type to 'Immovable property'. Also, provide a brief summary for each page of the document. If a value is not found, return null for that key.",schemaProperties:{giftDate:{type:"string"},giverName:{type:"string"},receiverName:{type:"string"},location:{type:"string"},giftType:{type:"string"}},required:["giftDate","giverName","receiverName","location","giftType"]};case"rental":return{fields:[{key:"rentAmount",label:"Rent Amount"},{key:"startDate",label:"Start Date"},{key:"endDate",label:"End Date"},{key:"tenantName",label:"Tenant Name"},{key:"landlordName",label:"Landlord Name"},{key:"propertyLocation",label:"Property Location"}],prompt:"From the attached rental agreement PDF, extract the following information and return it as a JSON object: rent amount, start date (format YYYY-MM-DD), end date (format YYYY-MM-DD), tenant name, landlord name, and property location. Also, provide a brief summary for each page of the document. If a value is not found, return null for that key.",schemaProperties:{rentAmount:{type:"string"},startDate:{type:"string"},endDate:{type:"string"},tenantName:{type:"string"},landlordName:{type:"string"},propertyLocation:{type:"string"}},required:["rentAmount","startDate","endDate","tenantName","landlordName","propertyLocation"]};case"authority":return{fields:[{key:"grantorName",label:"Grantor Name"},{key:"granteeName",label:"Grantee Name"},{key:"authorityType",label:"Authority Type"},{key:"validity",label:"Validity"},{key:"location",label:"Location"}],prompt:"From the attached power of authority document PDF, extract the following information and return it as a JSON object: grantor name, grantee name, authority type, validity date (format YYYY-MM-DD), and location. Also, provide a brief summary for each page of the document. If a value is not found, return null for that key.",schemaProperties:{grantorName:{type:"string"},granteeName:{type:"string"},authorityType:{type:"string"},validity:{type:"string"},location:{type:"string"}},required:["grantorName","granteeName","authorityType","validity","location"]};default:throw new Error(`Unsupported document type: ${q}`)}},$=async q=>{try{const it=await DR({data:q}).promise,yt=it.numPages,_t=[];for(let ut=1;ut<=yt;ut++){const ft=await it.getPage(ut),pt=ft.getViewport({scale:2}),Ct=document.createElement("canvas"),Vt=Ct.getContext("2d");Ct.height=pt.height,Ct.width=pt.width,await ft.render({canvasContext:Vt,viewport:pt}).promise;const It=Ct.toDataURL("image/png").split(",")[1];_t.push(It)}return _t}catch(it){return console.error("PDF to image conversion error:",it.message),m(`PDF to image conversion failed: ${it.message}`),[]}},j=async(q,it,yt)=>{const _t=H(yt),ut={type:"object",properties:{..._t.schemaProperties,pageSummaries:{type:"array",items:{type:"string",description:"A brief summary of the content on a single page."},description:"An array of strings, where each string is a summary of the corresponding page in the document."}},required:[..._t.required,"pageSummaries"]},ft=[{inlineData:{mimeType:"application/pdf",data:q}},{text:_t.prompt}],pt={responseMimeType:"application/json",responseSchema:ut};try{const Vt=(await HF.generateContent({contents:[{role:"user",parts:ft}],generationConfig:pt})).response.candidates[0]?.content?.parts[0]?.text;if(!Vt)throw new Error("No valid response text received from Gemini API");let It;try{It=JSON.parse(Vt.trim())||{}}catch(ne){throw console.error("Failed to parse Gemini response as JSON:",ne.message),new Error("Invalid JSON response from Gemini API")}const qt=_t.fields.map(ne=>{const Te=it[ne.key]||"",me=It[ne.key]||"Not Found";let _e;return ne.key==="giverName"||ne.key==="receiverName"?_e=V(Te,me)?" Match":" Mismatch":_e=M(Te)===M(me)?" Match":" Mismatch",{field:ne.label,userData:Te,dataFromDocument:me,status:_e}});return{status:qt.every(ne=>ne.status===" Match")?"Original":"Fake",details:qt,pageSummaries:It.pageSummaries||[]}}catch(Ct){return console.error("Gemini API error:",Ct.message),m(`Failed to extract details using Gemini API: ${Ct.message}`),{status:"Error",details:[],pageSummaries:[]}}},Tt=(q,it)=>{const yt=_t=>it.find(ut=>ut.field===_t)?.dataFromDocument||"[not found]";switch(q){case"sales":const _t=yt("Cost"),ut=yt("Sale Date"),ft=yt("Owner Name"),pt=yt("Salesperson Name"),Ct=yt("Location");return`This appears to be a sales document for a transaction costing ${_t} on ${ut}, involving owner ${ft} and salesperson ${pt} at location ${Ct}.`;case"gift":const Vt=yt("Gift Date"),It=yt("Giver Name"),qt=yt("Receiver Name"),Xt=yt("Enter Location where gift is received");return`This appears to be a gift giving document for a ${yt("Gift Type")}, given on ${Vt} from ${It} to ${qt} at location ${Xt}.`;case"rental":const Te=yt("Landlord Name"),me=yt("Tenant Name"),_e=yt("Rent Amount"),Yi=yt("Start Date"),ii=yt("Property Location");return`This appears to be a rental agreement between the landlord, ${Te}, and the tenant, ${me}. The agreement, starting on ${Yi}, is for the property located at ${ii}. The specified monthly rent is ${_e}.`;case"authority":const Wi=yt("Grantor Name"),ri=yt("Grantee Name"),Un=yt("Authority Type"),Si=yt("Validity"),Vr=yt("Location");return`This appears to be a power of authority document granting ${Un} from ${Wi} to ${ri}, valid until ${Si}, at location ${Vr}.`;default:return"Analysis for this document type has not been implemented."}},St=async()=>{if(!k||!ji){m("Authentication or storage not initialized.");return}try{const q=$f(ji,`uploads/${k.uid}/`),yt=(await aR(q)).items.map(_t=>_t.name);T(yt)}catch(q){m(`Failed to list files. [${q.message}]`)}};at.useEffect(()=>{k&&!z&&ji&&St()},[k,z,ji]);const X=async q=>{if(!k){m("No authenticated user found.");return}d(!0),m(""),E("");try{const it=k.uid||"test-user",yt=$f(ji,`uploads/${it}/${Date.now()}_${q.name}`),_t=await D4(yt,q),ut=await O4(_t.ref);C(ut),n(_t.ref.fullPath),a(q.name),E(" File uploaded successfully!"),setTimeout(St,1e3)}catch(it){m(`Failed to upload. [${it.message}]`)}finally{d(!1)}},Z=q=>{const it=q.target.files[0];it&&(t(it),n(it.name),a(it.name),X(it))},ht=(q,it,yt)=>{N(_t=>({..._t,[q]:{..._t[q],[it]:yt}}))},Rt=q=>{switch(q){case"Sales Document":return"sales";case"Gift Giving Document":return"gift";case"Rental Document":return"rental";case"Power of Authority":return"authority";default:return null}},W=async q=>{if(q.preventDefault(),!r||!l){m("Please upload or select a document and select its type first.");return}const it=Rt(l);if(!it){m("Invalid document type selected.");return}d(!0),m(""),E("");try{const yt=await r.arrayBuffer(),_t=UF.Buffer.from(yt),ut=_t.toString("base64"),ft=await $(_t),pt=await j(ut,P[it],it),Ct={status:pt.status,details:pt.details,verificationId:crypto.randomUUID(),images:ft,pageSummaries:pt.pageSummaries,analysis:Tt(it,pt.details),docType:it};F("/results",{state:{result:Ct}})}catch(yt){console.error("Verification failed:",yt.message),m(`Verification failed: ${yt.message}`)}finally{d(!1)}},lt=["Rental Document","Gift Giving Document","Sales Document","Power of Authority"];return z?Y.jsx("div",{children:"Loading authentication state..."}):k?Y.jsxs("form",{className:"upload-container",onSubmit:W,children:[Y.jsx("div",{className:"upload-box",children:Y.jsxs("label",{className:"upload-label",children:[Y.jsx("input",{type:"file",onChange:Z,className:"file-input",accept:"application/pdf"}),Y.jsx(d6,{size:40,className:"upload-icon"}),Y.jsx("p",{className:"upload-text",children:i||"Click or Drag & Drop your document here"})]})}),Y.jsx("div",{className:"options-row",children:lt.map((q,it)=>Y.jsx("button",{type:"button",className:`option-btn ${l===q?"active":""}`,onClick:()=>c(q),children:q},it))}),p&&Y.jsx("div",{className:"error-message",children:p}),v&&Y.jsx("div",{className:"success-message",children:v}),l&&Y.jsxs("div",{className:"input-section",children:[Y.jsx("h3",{className:"form-title",children:"Enter Document Details"}),l==="Sales Document"&&Y.jsxs(Y.Fragment,{children:[Y.jsx("input",{type:"text",placeholder:"Enter Cost",value:P.sales.cost,onChange:q=>ht("sales","cost",q.target.value)}),Y.jsx("input",{type:"date",value:P.sales.saleDate,onChange:q=>ht("sales","saleDate",q.target.value)}),Y.jsx("input",{type:"text",placeholder:"Enter Owner Name",value:P.sales.ownerName,onChange:q=>ht("sales","ownerName",q.target.value)}),Y.jsx("input",{type:"text",placeholder:"Enter Salesperson Name",value:P.sales.salespersonName,onChange:q=>ht("sales","salespersonName",q.target.value)}),Y.jsx("input",{type:"text",placeholder:"Enter Location",value:P.sales.location,onChange:q=>ht("sales","location",q.target.value)})]}),l==="Gift Giving Document"&&Y.jsxs(Y.Fragment,{children:[Y.jsx("input",{type:"date",value:P.gift.giftDate,onChange:q=>ht("gift","giftDate",q.target.value)}),Y.jsx("input",{type:"text",placeholder:"Enter Donor's Name",value:P.gift.giverName,onChange:q=>ht("gift","giverName",q.target.value)}),Y.jsx("input",{type:"text",placeholder:"Enter Donee's Name",value:P.gift.receiverName,onChange:q=>ht("gift","receiverName",q.target.value)}),Y.jsx("input",{type:"text",placeholder:"Enter Location",value:P.gift.location,onChange:q=>ht("gift","location",q.target.value)}),Y.jsx("input",{type:"text",placeholder:"Type of Gift",value:P.gift.giftType,onChange:q=>ht("gift","giftType",q.target.value)})]}),l==="Rental Document"&&Y.jsxs(Y.Fragment,{children:[Y.jsx("input",{type:"text",placeholder:"Rent Amount",value:P.rental.rentAmount,onChange:q=>ht("rental","rentAmount",q.target.value)}),Y.jsx("input",{type:"date",value:P.rental.startDate,onChange:q=>ht("rental","startDate",q.target.value)}),Y.jsx("input",{type:"date",value:P.rental.endDate,onChange:q=>ht("rental","endDate",q.target.value)}),Y.jsx("input",{type:"text",placeholder:"Tenant Name",value:P.rental.tenantName,onChange:q=>ht("rental","tenantName",q.target.value)}),Y.jsx("input",{type:"text",placeholder:"Landlord Name",value:P.rental.landlordName,onChange:q=>ht("rental","landlordName",q.target.value)}),Y.jsx("input",{type:"text",placeholder:"Property Location",value:P.rental.propertyLocation,onChange:q=>ht("rental","propertyLocation",q.target.value)})]}),l==="Power of Authority"&&Y.jsxs(Y.Fragment,{children:[Y.jsx("input",{type:"text",placeholder:"Grantor Name",value:P.authority.grantorName,onChange:q=>ht("authority","grantorName",q.target.value)}),Y.jsx("input",{type:"text",placeholder:"Grantee Name",value:P.authority.granteeName,onChange:q=>ht("authority","granteeName",q.target.value)}),Y.jsx("input",{type:"text",placeholder:"Authority Type",value:P.authority.authorityType,onChange:q=>ht("authority","authorityType",q.target.value)}),Y.jsx("input",{type:"date",value:P.authority.validity,onChange:q=>ht("authority","validity",q.target.value)}),Y.jsx("input",{type:"text",placeholder:"Location",value:P.authority.location,onChange:q=>ht("authority","location",q.target.value)})]}),Y.jsx("button",{type:"submit",className:"submit-btn",disabled:h,children:h?"Verifying...":"Submit"})]})]}):Y.jsxs("div",{className:"upload-component",children:[Y.jsx("p",{children:"Please login to upload documents."}),Y.jsx("button",{onClick:()=>_i.signInWithPopup(Dy),children:"Sign in with Google"})]})},WR=()=>(at.useEffect(()=>{const r=document.createElement("script");return r.src="https://cdn.voiceflow.com/widget-next/bundle.mjs",r.type="text/javascript",r.onload=()=>{window.voiceflow.chat.load({verify:{projectID:"68b71538a629cab2e98a6cfd"},url:"https://general-runtime.voiceflow.com",versionID:"production",voice:{url:"https://runtime-api.voiceflow.com"}})},document.body.appendChild(r),()=>{document.body.removeChild(r)}},[]),Y.jsx(_w,{children:Y.jsxs("div",{className:"App",children:[Y.jsx(H4,{}),Y.jsxs(vx,{children:[Y.jsx(Tl,{path:"/auth",element:Y.jsx(z4,{})}),Y.jsx(Tl,{path:"/results",element:Y.jsx(G4,{})}),Y.jsx(Tl,{path:"/",element:Y.jsxs(Y.Fragment,{children:[Y.jsx(W4,{}),Y.jsxs("main",{className:"container",children:[Y.jsx(A_,{subTitle:"Our Services",title:"Types of Documents"}),Y.jsx(n6,{}),Y.jsx(r6,{}),Y.jsx(A_,{subTitle:"Try now!!!!",title:"Upload your Document Here"}),Y.jsx(zF,{})]})]})}),Y.jsx(Tl,{path:"/profile",element:Y.jsx(Y4,{})}),Y.jsx(Tl,{path:"*",element:Y.jsx(mx,{to:"/",replace:!0})})]})]})}));CI.createRoot(document.getElementById("root")).render(Y.jsx(at.StrictMode,{children:Y.jsx(WR,{})}));ReactDOM.createRoot(document.getElementById("root")).render(Y.jsx(React.StrictMode,{children:Y.jsx(_w,{children:Y.jsx(WR,{})})}));
