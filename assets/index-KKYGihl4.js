var wE=s=>{throw TypeError(s)};var Em=(s,t,e)=>t.has(s)||wE("Cannot "+e);var xe=(s,t,e)=>(Em(s,t,"read from private field"),e?e.call(s):t.get(s)),_s=(s,t,e)=>t.has(s)?wE("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,e),si=(s,t,e,n)=>(Em(s,t,"write to private field"),n?n.call(s,e):t.set(s,e),e),vs=(s,t,e)=>(Em(s,t,"access private method"),e);var TE=(s,t,e,n)=>({set _(i){si(s,t,i,e)},get _(){return xe(s,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=e(i);fetch(i.href,a)}})();var Am={exports:{}},su={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SE;function gI(){if(SE)return su;SE=1;var s=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,i,a){var l=null;if(a!==void 0&&(l=""+a),i.key!==void 0&&(l=""+i.key),"key"in i){a={};for(var u in i)u!=="key"&&(a[u]=i[u])}else a=i;return i=a.ref,{$$typeof:s,type:n,key:l,ref:i!==void 0?i:null,props:a}}return su.Fragment=t,su.jsx=e,su.jsxs=e,su}var CE;function mI(){return CE||(CE=1,Am.exports=gI()),Am.exports}var z=mI(),wm={exports:{}},$t={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RE;function yI(){if(RE)return $t;RE=1;var s=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.iterator;function v($){return $===null||typeof $!="object"?null:($=y&&$[y]||$["@@iterator"],typeof $=="function"?$:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,S={};function I($,ut,Q){this.props=$,this.context=ut,this.refs=S,this.updater=Q||b}I.prototype.isReactComponent={},I.prototype.setState=function($,ut){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,ut,"setState")},I.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function x(){}x.prototype=I.prototype;function k($,ut,Q){this.props=$,this.context=ut,this.refs=S,this.updater=Q||b}var O=k.prototype=new x;O.constructor=k,T(O,I.prototype),O.isPureReactComponent=!0;var G=Array.isArray,H={H:null,A:null,T:null,S:null,V:null},K=Object.prototype.hasOwnProperty;function P($,ut,Q,at,yt,bt){return Q=bt.ref,{$$typeof:s,type:$,key:ut,ref:Q!==void 0?Q:null,props:bt}}function N($,ut){return P($.type,ut,void 0,void 0,void 0,$.props)}function B($){return typeof $=="object"&&$!==null&&$.$$typeof===s}function j($){var ut={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(Q){return ut[Q]})}var V=/\/+/g;function Y($,ut){return typeof $=="object"&&$!==null&&$.key!=null?j(""+$.key):ut.toString(36)}function U(){}function Nt($){switch($.status){case"fulfilled":return $.value;case"rejected":throw $.reason;default:switch(typeof $.status=="string"?$.then(U,U):($.status="pending",$.then(function(ut){$.status==="pending"&&($.status="fulfilled",$.value=ut)},function(ut){$.status==="pending"&&($.status="rejected",$.reason=ut)})),$.status){case"fulfilled":return $.value;case"rejected":throw $.reason}}throw $}function Dt($,ut,Q,at,yt){var bt=typeof $;(bt==="undefined"||bt==="boolean")&&($=null);var Et=!1;if($===null)Et=!0;else switch(bt){case"bigint":case"string":case"number":Et=!0;break;case"object":switch($.$$typeof){case s:case t:Et=!0;break;case p:return Et=$._init,Dt(Et($._payload),ut,Q,at,yt)}}if(Et)return yt=yt($),Et=at===""?"."+Y($,0):at,G(yt)?(Q="",Et!=null&&(Q=Et.replace(V,"$&/")+"/"),Dt(yt,ut,Q,"",function(ee){return ee})):yt!=null&&(B(yt)&&(yt=N(yt,Q+(yt.key==null||$&&$.key===yt.key?"":(""+yt.key).replace(V,"$&/")+"/")+Et)),ut.push(yt)),1;Et=0;var It=at===""?".":at+":";if(G($))for(var xt=0;xt<$.length;xt++)at=$[xt],bt=It+Y(at,xt),Et+=Dt(at,ut,Q,bt,yt);else if(xt=v($),typeof xt=="function")for($=xt.call($),xt=0;!(at=$.next()).done;)at=at.value,bt=It+Y(at,xt++),Et+=Dt(at,ut,Q,bt,yt);else if(bt==="object"){if(typeof $.then=="function")return Dt(Nt($),ut,Q,at,yt);throw ut=String($),Error("Objects are not valid as a React child (found: "+(ut==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":ut)+"). If you meant to render a collection of children, use an array instead.")}return Et}function J($,ut,Q){if($==null)return $;var at=[],yt=0;return Dt($,at,"","",function(bt){return ut.call(Q,bt,yt++)}),at}function ct($){if($._status===-1){var ut=$._result;ut=ut(),ut.then(function(Q){($._status===0||$._status===-1)&&($._status=1,$._result=Q)},function(Q){($._status===0||$._status===-1)&&($._status=2,$._result=Q)}),$._status===-1&&($._status=0,$._result=ut)}if($._status===1)return $._result.default;throw $._result}var mt=typeof reportError=="function"?reportError:function($){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ut=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof $=="object"&&$!==null&&typeof $.message=="string"?String($.message):String($),error:$});if(!window.dispatchEvent(ut))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",$);return}console.error($)};function Mt(){}return $t.Children={map:J,forEach:function($,ut,Q){J($,function(){ut.apply(this,arguments)},Q)},count:function($){var ut=0;return J($,function(){ut++}),ut},toArray:function($){return J($,function(ut){return ut})||[]},only:function($){if(!B($))throw Error("React.Children.only expected to receive a single React element child.");return $}},$t.Component=I,$t.Fragment=e,$t.Profiler=i,$t.PureComponent=k,$t.StrictMode=n,$t.Suspense=h,$t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=H,$t.__COMPILER_RUNTIME={__proto__:null,c:function($){return H.H.useMemoCache($)}},$t.cache=function($){return function(){return $.apply(null,arguments)}},$t.cloneElement=function($,ut,Q){if($==null)throw Error("The argument must be a React element, but you passed "+$+".");var at=T({},$.props),yt=$.key,bt=void 0;if(ut!=null)for(Et in ut.ref!==void 0&&(bt=void 0),ut.key!==void 0&&(yt=""+ut.key),ut)!K.call(ut,Et)||Et==="key"||Et==="__self"||Et==="__source"||Et==="ref"&&ut.ref===void 0||(at[Et]=ut[Et]);var Et=arguments.length-2;if(Et===1)at.children=Q;else if(1<Et){for(var It=Array(Et),xt=0;xt<Et;xt++)It[xt]=arguments[xt+2];at.children=It}return P($.type,yt,void 0,void 0,bt,at)},$t.createContext=function($){return $={$$typeof:l,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null},$.Provider=$,$.Consumer={$$typeof:a,_context:$},$},$t.createElement=function($,ut,Q){var at,yt={},bt=null;if(ut!=null)for(at in ut.key!==void 0&&(bt=""+ut.key),ut)K.call(ut,at)&&at!=="key"&&at!=="__self"&&at!=="__source"&&(yt[at]=ut[at]);var Et=arguments.length-2;if(Et===1)yt.children=Q;else if(1<Et){for(var It=Array(Et),xt=0;xt<Et;xt++)It[xt]=arguments[xt+2];yt.children=It}if($&&$.defaultProps)for(at in Et=$.defaultProps,Et)yt[at]===void 0&&(yt[at]=Et[at]);return P($,bt,void 0,void 0,null,yt)},$t.createRef=function(){return{current:null}},$t.forwardRef=function($){return{$$typeof:u,render:$}},$t.isValidElement=B,$t.lazy=function($){return{$$typeof:p,_payload:{_status:-1,_result:$},_init:ct}},$t.memo=function($,ut){return{$$typeof:f,type:$,compare:ut===void 0?null:ut}},$t.startTransition=function($){var ut=H.T,Q={};H.T=Q;try{var at=$(),yt=H.S;yt!==null&&yt(Q,at),typeof at=="object"&&at!==null&&typeof at.then=="function"&&at.then(Mt,mt)}catch(bt){mt(bt)}finally{H.T=ut}},$t.unstable_useCacheRefresh=function(){return H.H.useCacheRefresh()},$t.use=function($){return H.H.use($)},$t.useActionState=function($,ut,Q){return H.H.useActionState($,ut,Q)},$t.useCallback=function($,ut){return H.H.useCallback($,ut)},$t.useContext=function($){return H.H.useContext($)},$t.useDebugValue=function(){},$t.useDeferredValue=function($,ut){return H.H.useDeferredValue($,ut)},$t.useEffect=function($,ut,Q){var at=H.H;if(typeof Q=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return at.useEffect($,ut)},$t.useId=function(){return H.H.useId()},$t.useImperativeHandle=function($,ut,Q){return H.H.useImperativeHandle($,ut,Q)},$t.useInsertionEffect=function($,ut){return H.H.useInsertionEffect($,ut)},$t.useLayoutEffect=function($,ut){return H.H.useLayoutEffect($,ut)},$t.useMemo=function($,ut){return H.H.useMemo($,ut)},$t.useOptimistic=function($,ut){return H.H.useOptimistic($,ut)},$t.useReducer=function($,ut,Q){return H.H.useReducer($,ut,Q)},$t.useRef=function($){return H.H.useRef($)},$t.useState=function($){return H.H.useState($)},$t.useSyncExternalStore=function($,ut,Q){return H.H.useSyncExternalStore($,ut,Q)},$t.useTransition=function(){return H.H.useTransition()},$t.version="19.1.1",$t}var IE;function jy(){return IE||(IE=1,wm.exports=yI()),wm.exports}var st=jy(),Tm={exports:{}},ru={},Sm={exports:{}},Cm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xE;function _I(){return xE||(xE=1,(function(s){function t(J,ct){var mt=J.length;J.push(ct);t:for(;0<mt;){var Mt=mt-1>>>1,$=J[Mt];if(0<i($,ct))J[Mt]=ct,J[mt]=$,mt=Mt;else break t}}function e(J){return J.length===0?null:J[0]}function n(J){if(J.length===0)return null;var ct=J[0],mt=J.pop();if(mt!==ct){J[0]=mt;t:for(var Mt=0,$=J.length,ut=$>>>1;Mt<ut;){var Q=2*(Mt+1)-1,at=J[Q],yt=Q+1,bt=J[yt];if(0>i(at,mt))yt<$&&0>i(bt,at)?(J[Mt]=bt,J[yt]=mt,Mt=yt):(J[Mt]=at,J[Q]=mt,Mt=Q);else if(yt<$&&0>i(bt,mt))J[Mt]=bt,J[yt]=mt,Mt=yt;else break t}}return ct}function i(J,ct){var mt=J.sortIndex-ct.sortIndex;return mt!==0?mt:J.id-ct.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;s.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();s.unstable_now=function(){return l.now()-u}}var h=[],f=[],p=1,y=null,v=3,b=!1,T=!1,S=!1,I=!1,x=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function G(J){for(var ct=e(f);ct!==null;){if(ct.callback===null)n(f);else if(ct.startTime<=J)n(f),ct.sortIndex=ct.expirationTime,t(h,ct);else break;ct=e(f)}}function H(J){if(S=!1,G(J),!T)if(e(h)!==null)T=!0,K||(K=!0,Y());else{var ct=e(f);ct!==null&&Dt(H,ct.startTime-J)}}var K=!1,P=-1,N=5,B=-1;function j(){return I?!0:!(s.unstable_now()-B<N)}function V(){if(I=!1,K){var J=s.unstable_now();B=J;var ct=!0;try{t:{T=!1,S&&(S=!1,k(P),P=-1),b=!0;var mt=v;try{e:{for(G(J),y=e(h);y!==null&&!(y.expirationTime>J&&j());){var Mt=y.callback;if(typeof Mt=="function"){y.callback=null,v=y.priorityLevel;var $=Mt(y.expirationTime<=J);if(J=s.unstable_now(),typeof $=="function"){y.callback=$,G(J),ct=!0;break e}y===e(h)&&n(h),G(J)}else n(h);y=e(h)}if(y!==null)ct=!0;else{var ut=e(f);ut!==null&&Dt(H,ut.startTime-J),ct=!1}}break t}finally{y=null,v=mt,b=!1}ct=void 0}}finally{ct?Y():K=!1}}}var Y;if(typeof O=="function")Y=function(){O(V)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,Nt=U.port2;U.port1.onmessage=V,Y=function(){Nt.postMessage(null)}}else Y=function(){x(V,0)};function Dt(J,ct){P=x(function(){J(s.unstable_now())},ct)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(J){J.callback=null},s.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<J?Math.floor(1e3/J):5},s.unstable_getCurrentPriorityLevel=function(){return v},s.unstable_next=function(J){switch(v){case 1:case 2:case 3:var ct=3;break;default:ct=v}var mt=v;v=ct;try{return J()}finally{v=mt}},s.unstable_requestPaint=function(){I=!0},s.unstable_runWithPriority=function(J,ct){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var mt=v;v=J;try{return ct()}finally{v=mt}},s.unstable_scheduleCallback=function(J,ct,mt){var Mt=s.unstable_now();switch(typeof mt=="object"&&mt!==null?(mt=mt.delay,mt=typeof mt=="number"&&0<mt?Mt+mt:Mt):mt=Mt,J){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=mt+$,J={id:p++,callback:ct,priorityLevel:J,startTime:mt,expirationTime:$,sortIndex:-1},mt>Mt?(J.sortIndex=mt,t(f,J),e(h)===null&&J===e(f)&&(S?(k(P),P=-1):S=!0,Dt(H,mt-Mt))):(J.sortIndex=$,t(h,J),T||b||(T=!0,K||(K=!0,Y()))),J},s.unstable_shouldYield=j,s.unstable_wrapCallback=function(J){var ct=v;return function(){var mt=v;v=ct;try{return J.apply(this,arguments)}finally{v=mt}}}})(Cm)),Cm}var DE;function vI(){return DE||(DE=1,Sm.exports=_I()),Sm.exports}var Rm={exports:{}},Fn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NE;function bI(){if(NE)return Fn;NE=1;var s=jy();function t(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(h,f,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:y==null?null:""+y,children:h,containerInfo:f,implementation:p}}var l=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Fn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Fn.createPortal=function(h,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return a(h,f,null,p)},Fn.flushSync=function(h){var f=l.T,p=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=f,n.p=p,n.d.f()}},Fn.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(h,f))},Fn.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Fn.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin),v=typeof f.integrity=="string"?f.integrity:void 0,b=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?n.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:v,fetchPriority:b}):p==="script"&&n.d.X(h,{crossOrigin:y,integrity:v,fetchPriority:b,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Fn.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=u(f.as,f.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(h)},Fn.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin);n.d.L(h,p,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Fn.preloadModule=function(h,f){if(typeof h=="string")if(f){var p=u(f.as,f.crossOrigin);n.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(h)},Fn.requestFormReset=function(h){n.d.r(h)},Fn.unstable_batchedUpdates=function(h,f){return h(f)},Fn.useFormState=function(h,f,p){return l.H.useFormState(h,f,p)},Fn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Fn.version="19.1.1",Fn}var ME;function EI(){if(ME)return Rm.exports;ME=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),Rm.exports=bI(),Rm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kE;function AI(){if(kE)return ru;kE=1;var s=vI(),t=jy(),e=EI();function n(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var o=r,c=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(c=o.return),r=o.return;while(r)}return o.tag===3?c:null}function l(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function u(r){if(a(r)!==r)throw Error(n(188))}function h(r){var o=r.alternate;if(!o){if(o=a(r),o===null)throw Error(n(188));return o!==r?null:r}for(var c=r,d=o;;){var m=c.return;if(m===null)break;var _=m.alternate;if(_===null){if(d=m.return,d!==null){c=d;continue}break}if(m.child===_.child){for(_=m.child;_;){if(_===c)return u(m),r;if(_===d)return u(m),o;_=_.sibling}throw Error(n(188))}if(c.return!==d.return)c=m,d=_;else{for(var R=!1,M=m.child;M;){if(M===c){R=!0,c=m,d=_;break}if(M===d){R=!0,d=m,c=_;break}M=M.sibling}if(!R){for(M=_.child;M;){if(M===c){R=!0,c=_,d=m;break}if(M===d){R=!0,d=_,c=m;break}M=M.sibling}if(!R)throw Error(n(189))}}if(c.alternate!==d)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?r:o}function f(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=f(r),o!==null)return o;r=r.sibling}return null}var p=Object.assign,y=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),k=Symbol.for("react.consumer"),O=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),j=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function Y(r){return r===null||typeof r!="object"?null:(r=V&&r[V]||r["@@iterator"],typeof r=="function"?r:null)}var U=Symbol.for("react.client.reference");function Nt(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===U?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case T:return"Fragment";case I:return"Profiler";case S:return"StrictMode";case H:return"Suspense";case K:return"SuspenseList";case B:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case b:return"Portal";case O:return(r.displayName||"Context")+".Provider";case k:return(r._context.displayName||"Context")+".Consumer";case G:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case P:return o=r.displayName||null,o!==null?o:Nt(r.type)||"Memo";case N:o=r._payload,r=r._init;try{return Nt(r(o))}catch{}}return null}var Dt=Array.isArray,J=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ct=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,mt={pending:!1,data:null,method:null,action:null},Mt=[],$=-1;function ut(r){return{current:r}}function Q(r){0>$||(r.current=Mt[$],Mt[$]=null,$--)}function at(r,o){$++,Mt[$]=r.current,r.current=o}var yt=ut(null),bt=ut(null),Et=ut(null),It=ut(null);function xt(r,o){switch(at(Et,o),at(bt,r),at(yt,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?Qb(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=Qb(o),r=Jb(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}Q(yt),at(yt,r)}function ee(){Q(yt),Q(bt),Q(Et)}function Me(r){r.memoizedState!==null&&at(It,r);var o=yt.current,c=Jb(o,r.type);o!==c&&(at(bt,r),at(yt,c))}function ke(r){bt.current===r&&(Q(yt),Q(bt)),It.current===r&&(Q(It),Zc._currentValue=mt)}var ln=Object.prototype.hasOwnProperty,We=s.unstable_scheduleCallback,we=s.unstable_cancelCallback,ci=s.unstable_shouldYield,Ai=s.unstable_requestPaint,Fe=s.unstable_now,Ca=s.unstable_getCurrentPriorityLevel,Bs=s.unstable_ImmediatePriority,Gi=s.unstable_UserBlockingPriority,ti=s.unstable_NormalPriority,Ln=s.unstable_LowPriority,wi=s.unstable_IdlePriority,Fs=s.log,ui=s.unstable_setDisableYieldValue,Ce=null,D=null;function A(r){if(typeof Fs=="function"&&ui(r),D&&typeof D.setStrictMode=="function")try{D.setStrictMode(Ce,r)}catch{}}var w=Math.clz32?Math.clz32:rt,F=Math.log,W=Math.LN2;function rt(r){return r>>>=0,r===0?32:31-(F(r)/W|0)|0}var dt=256,Ht=4194304;function ie(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function ue(r,o,c){var d=r.pendingLanes;if(d===0)return 0;var m=0,_=r.suspendedLanes,R=r.pingedLanes;r=r.warmLanes;var M=d&134217727;return M!==0?(d=M&~_,d!==0?m=ie(d):(R&=M,R!==0?m=ie(R):c||(c=M&~r,c!==0&&(m=ie(c))))):(M=d&~_,M!==0?m=ie(M):R!==0?m=ie(R):c||(c=d&~r,c!==0&&(m=ie(c)))),m===0?0:o!==0&&o!==m&&(o&_)===0&&(_=m&-m,c=o&-o,_>=c||_===32&&(c&4194048)!==0)?o:m}function de(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function le(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tc(){var r=dt;return dt<<=1,(dt&4194048)===0&&(dt=256),r}function ec(){var r=Ht;return Ht<<=1,(Ht&62914560)===0&&(Ht=4194304),r}function Us(r){for(var o=[],c=0;31>c;c++)o.push(r);return o}function Vs(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function nc(r,o,c,d,m,_){var R=r.pendingLanes;r.pendingLanes=c,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=c,r.entangledLanes&=c,r.errorRecoveryDisabledLanes&=c,r.shellSuspendCounter=0;var M=r.entanglements,q=r.expirationTimes,nt=r.hiddenUpdates;for(c=R&~c;0<c;){var ht=31-w(c),pt=1<<ht;M[ht]=0,q[ht]=-1;var it=nt[ht];if(it!==null)for(nt[ht]=null,ht=0;ht<it.length;ht++){var ot=it[ht];ot!==null&&(ot.lane&=-536870913)}c&=~pt}d!==0&&ns(r,d,0),_!==0&&m===0&&r.tag!==0&&(r.suspendedLanes|=_&~(R&~o))}function ns(r,o,c){r.pendingLanes|=o,r.suspendedLanes&=~o;var d=31-w(o);r.entangledLanes|=o,r.entanglements[d]=r.entanglements[d]|1073741824|c&4194090}function ic(r,o){var c=r.entangledLanes|=o;for(r=r.entanglements;c;){var d=31-w(c),m=1<<d;m&o|r[d]&o&&(r[d]|=o),c&=~m}}function Rr(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function xo(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Ir(){var r=ct.p;return r!==0?r:(r=window.event,r===void 0?32:yE(r.type))}function vh(r,o){var c=ct.p;try{return ct.p=r,o()}finally{ct.p=c}}var Re=Math.random().toString(36).slice(2),cn="__reactFiber$"+Re,Qe="__reactProps$"+Re,Ti="__reactContainer$"+Re,sc="__reactEvents$"+Re,Tp="__reactListeners$"+Re,xr="__reactHandles$"+Re,bh="__reactResources$"+Re,Ra="__reactMarker$"+Re;function Dr(r){delete r[cn],delete r[Qe],delete r[sc],delete r[Tp],delete r[xr]}function js(r){var o=r[cn];if(o)return o;for(var c=r.parentNode;c;){if(o=c[Ti]||c[cn]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(r=nE(r);r!==null;){if(c=r[cn])return c;r=nE(r)}return o}r=c,c=r.parentNode}return null}function is(r){if(r=r[cn]||r[Ti]){var o=r.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return r}return null}function ss(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(n(33))}function Gn(r){var o=r[bh];return o||(o=r[bh]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function ze(r){r[Ra]=!0}var rc=new Set,Do={};function qi(r,o){Hs(r,o),Hs(r+"Capture",o)}function Hs(r,o){for(Do[r]=o,r=0;r<o.length;r++)rc.add(o[r])}var Eh=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ah={},Ia={};function wh(r){return ln.call(Ia,r)?!0:ln.call(Ah,r)?!1:Eh.test(r)?Ia[r]=!0:(Ah[r]=!0,!1)}function Nr(r,o,c){if(wh(o))if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var d=o.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+c)}}function rs(r,o,c){if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+c)}}function Tn(r,o,c,d){if(d===null)r.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(c);return}r.setAttributeNS(o,c,""+d)}}var xa,Th;function zs(r){if(xa===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);xa=o&&o[1]||"",Th=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xa+r+Th}var No=!1;function Mo(r,o){if(!r||No)return"";No=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(o){var pt=function(){throw Error()};if(Object.defineProperty(pt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pt,[])}catch(ot){var it=ot}Reflect.construct(r,[],pt)}else{try{pt.call()}catch(ot){it=ot}r.call(pt.prototype)}}else{try{throw Error()}catch(ot){it=ot}(pt=r())&&typeof pt.catch=="function"&&pt.catch(function(){})}}catch(ot){if(ot&&it&&typeof ot.stack=="string")return[ot.stack,it.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=d.DetermineComponentFrameRoot(),R=_[0],M=_[1];if(R&&M){var q=R.split(`
`),nt=M.split(`
`);for(m=d=0;d<q.length&&!q[d].includes("DetermineComponentFrameRoot");)d++;for(;m<nt.length&&!nt[m].includes("DetermineComponentFrameRoot");)m++;if(d===q.length||m===nt.length)for(d=q.length-1,m=nt.length-1;1<=d&&0<=m&&q[d]!==nt[m];)m--;for(;1<=d&&0<=m;d--,m--)if(q[d]!==nt[m]){if(d!==1||m!==1)do if(d--,m--,0>m||q[d]!==nt[m]){var ht=`
`+q[d].replace(" at new "," at ");return r.displayName&&ht.includes("<anonymous>")&&(ht=ht.replace("<anonymous>",r.displayName)),ht}while(1<=d&&0<=m);break}}}finally{No=!1,Error.prepareStackTrace=c}return(c=r?r.displayName||r.name:"")?zs(c):""}function ac(r){switch(r.tag){case 26:case 27:case 5:return zs(r.type);case 16:return zs("Lazy");case 13:return zs("Suspense");case 19:return zs("SuspenseList");case 0:case 15:return Mo(r.type,!1);case 11:return Mo(r.type.render,!1);case 1:return Mo(r.type,!0);case 31:return zs("Activity");default:return""}}function ko(r){try{var o="";do o+=ac(r),r=r.return;while(r);return o}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function qn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function oc(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Sp(r){var o=oc(r)?"checked":"value",c=Object.getOwnPropertyDescriptor(r.constructor.prototype,o),d=""+r[o];if(!r.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,_=c.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return m.call(this)},set:function(R){d=""+R,_.call(this,R)}}),Object.defineProperty(r,o,{enumerable:c.enumerable}),{getValue:function(){return d},setValue:function(R){d=""+R},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function Po(r){r._valueTracker||(r._valueTracker=Sp(r))}function lc(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var c=o.getValue(),d="";return r&&(d=oc(r)?r.checked?"true":"false":r.value),r=d,r!==c?(o.setValue(r),!0):!1}function Da(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Cp=/[\n"\\]/g;function Je(r){return r.replace(Cp,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function hi(r,o,c,d,m,_,R,M){r.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?r.type=R:r.removeAttribute("type"),o!=null?R==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+qn(o)):r.value!==""+qn(o)&&(r.value=""+qn(o)):R!=="submit"&&R!=="reset"||r.removeAttribute("value"),o!=null?Mr(r,R,qn(o)):c!=null?Mr(r,R,qn(c)):d!=null&&r.removeAttribute("value"),m==null&&_!=null&&(r.defaultChecked=!!_),m!=null&&(r.checked=m&&typeof m!="function"&&typeof m!="symbol"),M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?r.name=""+qn(M):r.removeAttribute("name")}function Na(r,o,c,d,m,_,R,M){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(r.type=_),o!=null||c!=null){if(!(_!=="submit"&&_!=="reset"||o!=null))return;c=c!=null?""+qn(c):"",o=o!=null?""+qn(o):c,M||o===r.value||(r.value=o),r.defaultValue=o}d=d??m,d=typeof d!="function"&&typeof d!="symbol"&&!!d,r.checked=M?r.checked:!!d,r.defaultChecked=!!d,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(r.name=R)}function Mr(r,o,c){o==="number"&&Da(r.ownerDocument)===r||r.defaultValue===""+c||(r.defaultValue=""+c)}function Gs(r,o,c,d){if(r=r.options,o){o={};for(var m=0;m<c.length;m++)o["$"+c[m]]=!0;for(c=0;c<r.length;c++)m=o.hasOwnProperty("$"+r[c].value),r[c].selected!==m&&(r[c].selected=m),m&&d&&(r[c].defaultSelected=!0)}else{for(c=""+qn(c),o=null,m=0;m<r.length;m++){if(r[m].value===c){r[m].selected=!0,d&&(r[m].defaultSelected=!0);return}o!==null||r[m].disabled||(o=r[m])}o!==null&&(o.selected=!0)}}function ye(r,o,c){if(o!=null&&(o=""+qn(o),o!==r.value&&(r.value=o),c==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=c!=null?""+qn(c):""}function Ma(r,o,c,d){if(o==null){if(d!=null){if(c!=null)throw Error(n(92));if(Dt(d)){if(1<d.length)throw Error(n(93));d=d[0]}c=d}c==null&&(c=""),o=c}c=qn(o),r.defaultValue=c,d=r.textContent,d===c&&d!==""&&d!==null&&(r.value=d)}function Si(r,o){if(o){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=o;return}}r.textContent=o}var ka=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Sh(r,o,c){var d=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":d?r.setProperty(o,c):typeof c!="number"||c===0||ka.has(o)?o==="float"?r.cssFloat=c:r[o]=(""+c).trim():r[o]=c+"px"}function cc(r,o,c){if(o!=null&&typeof o!="object")throw Error(n(62));if(r=r.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||o!=null&&o.hasOwnProperty(d)||(d.indexOf("--")===0?r.setProperty(d,""):d==="float"?r.cssFloat="":r[d]="");for(var m in o)d=o[m],o.hasOwnProperty(m)&&c[m]!==d&&Sh(r,m,d)}else for(var _ in o)o.hasOwnProperty(_)&&Sh(r,_,o[_])}function uc(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rp=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ip=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Oo(r){return Ip.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var qs=null;function Ci(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var $s=null,Ys=null;function hc(r){var o=is(r);if(o&&(r=o.stateNode)){var c=r[Qe]||null;t:switch(r=o.stateNode,o.type){case"input":if(hi(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Je(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var d=c[o];if(d!==r&&d.form===r.form){var m=d[Qe]||null;if(!m)throw Error(n(90));hi(d,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(o=0;o<c.length;o++)d=c[o],d.form===r.form&&lc(d)}break t;case"textarea":ye(r,c.value,c.defaultValue);break t;case"select":o=c.value,o!=null&&Gs(r,!!c.multiple,o,!1)}}}var as=!1;function Ch(r,o,c){if(as)return r(o,c);as=!0;try{var d=r(o);return d}finally{if(as=!1,($s!==null||Ys!==null)&&(vd(),$s&&(o=$s,r=Ys,Ys=$s=null,hc(o),r)))for(o=0;o<r.length;o++)hc(r[o])}}function Pa(r,o){var c=r.stateNode;if(c===null)return null;var d=c[Qe]||null;if(d===null)return null;c=d[o];t:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break t;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(n(231,o,typeof c));return c}var $i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ri=!1;if($i)try{var Oa={};Object.defineProperty(Oa,"passive",{get:function(){Ri=!0}}),window.addEventListener("test",Oa,Oa),window.removeEventListener("test",Oa,Oa)}catch{Ri=!1}var os=null,kr=null,Xs=null;function dc(){if(Xs)return Xs;var r,o=kr,c=o.length,d,m="value"in os?os.value:os.textContent,_=m.length;for(r=0;r<c&&o[r]===m[r];r++);var R=c-r;for(d=1;d<=R&&o[c-d]===m[_-d];d++);return Xs=m.slice(r,1<d?1-d:void 0)}function ls(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function cs(){return!0}function fc(){return!1}function mn(r){function o(c,d,m,_,R){this._reactName=c,this._targetInst=m,this.type=d,this.nativeEvent=_,this.target=R,this.currentTarget=null;for(var M in r)r.hasOwnProperty(M)&&(c=r[M],this[M]=c?c(_):_[M]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?cs:fc,this.isPropagationStopped=fc,this}return p(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=cs)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=cs)},persist:function(){},isPersistent:cs}),o}var fe={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lo=mn(fe),La=p({},fe,{view:0,detail:0}),Rh=mn(La),Bo,Fo,us,Ba=p({},La,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Va,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==us&&(us&&r.type==="mousemove"?(Bo=r.screenX-us.screenX,Fo=r.screenY-us.screenY):Fo=Bo=0,us=r),Bo)},movementY:function(r){return"movementY"in r?r.movementY:Fo}}),Ii=mn(Ba),Ih=p({},Ba,{dataTransfer:0}),xp=mn(Ih),Fa=p({},La,{relatedTarget:0}),Uo=mn(Fa),pc=p({},fe,{animationName:0,elapsedTime:0,pseudoElement:0}),Vo=mn(pc),xh=p({},fe,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),jo=mn(xh),Dp=p({},fe,{data:0}),gc=mn(Dp),Ua={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Dh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mc(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=Nh[r])?!!o[r]:!1}function Va(){return mc}var Mh=p({},La,{key:function(r){if(r.key){var o=Ua[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=ls(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Dh[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Va,charCode:function(r){return r.type==="keypress"?ls(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ls(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Ho=mn(Mh),kh=p({},Ba,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yc=mn(kh),Ks=p({},La,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Va}),Ph=mn(Ks),Oh=p({},fe,{propertyName:0,elapsedTime:0,pseudoElement:0}),Lh=mn(Oh),Bh=p({},Ba,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),zo=mn(Bh),$n=p({},fe,{newState:0,oldState:0}),Fh=mn($n),Uh=[9,13,27,32],hs=$i&&"CompositionEvent"in window,g=null;$i&&"documentMode"in document&&(g=document.documentMode);var E=$i&&"TextEvent"in window&&!g,C=$i&&(!hs||g&&8<g&&11>=g),L=" ",tt=!1;function lt(r,o){switch(r){case"keyup":return Uh.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vt(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var se=!1;function un(r,o){switch(r){case"compositionend":return vt(o);case"keypress":return o.which!==32?null:(tt=!0,L);case"textInput":return r=o.data,r===L&&tt?null:r;default:return null}}function re(r,o){if(se)return r==="compositionend"||!hs&&lt(r,o)?(r=dc(),Xs=kr=os=null,se=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return C&&o.locale!=="ko"?null:o.data;default:return null}}var yn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hn(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!yn[r.type]:o==="textarea"}function Ws(r,o,c,d){$s?Ys?Ys.push(d):Ys=[d]:$s=d,o=Sd(o,"onChange"),0<o.length&&(c=new Lo("onChange","change",null,c,d),r.push({event:c,listeners:o}))}var Sn=null,ds=null;function _c(r){$b(r,0)}function Vh(r){var o=ss(r);if(lc(o))return r}function fv(r,o){if(r==="change")return o}var pv=!1;if($i){var Np;if($i){var Mp="oninput"in document;if(!Mp){var gv=document.createElement("div");gv.setAttribute("oninput","return;"),Mp=typeof gv.oninput=="function"}Np=Mp}else Np=!1;pv=Np&&(!document.documentMode||9<document.documentMode)}function mv(){Sn&&(Sn.detachEvent("onpropertychange",yv),ds=Sn=null)}function yv(r){if(r.propertyName==="value"&&Vh(ds)){var o=[];Ws(o,ds,r,Ci(r)),Ch(_c,o)}}function qC(r,o,c){r==="focusin"?(mv(),Sn=o,ds=c,Sn.attachEvent("onpropertychange",yv)):r==="focusout"&&mv()}function $C(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Vh(ds)}function YC(r,o){if(r==="click")return Vh(o)}function XC(r,o){if(r==="input"||r==="change")return Vh(o)}function KC(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var di=typeof Object.is=="function"?Object.is:KC;function vc(r,o){if(di(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var c=Object.keys(r),d=Object.keys(o);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var m=c[d];if(!ln.call(o,m)||!di(r[m],o[m]))return!1}return!0}function _v(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function vv(r,o){var c=_v(r);r=0;for(var d;c;){if(c.nodeType===3){if(d=r+c.textContent.length,r<=o&&d>=o)return{node:c,offset:o-r};r=d}t:{for(;c;){if(c.nextSibling){c=c.nextSibling;break t}c=c.parentNode}c=void 0}c=_v(c)}}function bv(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?bv(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function Ev(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=Da(r.document);o instanceof r.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)r=o.contentWindow;else break;o=Da(r.document)}return o}function kp(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var WC=$i&&"documentMode"in document&&11>=document.documentMode,Go=null,Pp=null,bc=null,Op=!1;function Av(r,o,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Op||Go==null||Go!==Da(d)||(d=Go,"selectionStart"in d&&kp(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),bc&&vc(bc,d)||(bc=d,d=Sd(Pp,"onSelect"),0<d.length&&(o=new Lo("onSelect","select",null,o,c),r.push({event:o,listeners:d}),o.target=Go)))}function ja(r,o){var c={};return c[r.toLowerCase()]=o.toLowerCase(),c["Webkit"+r]="webkit"+o,c["Moz"+r]="moz"+o,c}var qo={animationend:ja("Animation","AnimationEnd"),animationiteration:ja("Animation","AnimationIteration"),animationstart:ja("Animation","AnimationStart"),transitionrun:ja("Transition","TransitionRun"),transitionstart:ja("Transition","TransitionStart"),transitioncancel:ja("Transition","TransitionCancel"),transitionend:ja("Transition","TransitionEnd")},Lp={},wv={};$i&&(wv=document.createElement("div").style,"AnimationEvent"in window||(delete qo.animationend.animation,delete qo.animationiteration.animation,delete qo.animationstart.animation),"TransitionEvent"in window||delete qo.transitionend.transition);function Ha(r){if(Lp[r])return Lp[r];if(!qo[r])return r;var o=qo[r],c;for(c in o)if(o.hasOwnProperty(c)&&c in wv)return Lp[r]=o[c];return r}var Tv=Ha("animationend"),Sv=Ha("animationiteration"),Cv=Ha("animationstart"),QC=Ha("transitionrun"),JC=Ha("transitionstart"),ZC=Ha("transitioncancel"),Rv=Ha("transitionend"),Iv=new Map,Bp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Bp.push("scrollEnd");function Yi(r,o){Iv.set(r,o),qi(o,[r])}var xv=new WeakMap;function xi(r,o){if(typeof r=="object"&&r!==null){var c=xv.get(r);return c!==void 0?c:(o={value:r,source:o,stack:ko(o)},xv.set(r,o),o)}return{value:r,source:o,stack:ko(o)}}var Di=[],$o=0,Fp=0;function jh(){for(var r=$o,o=Fp=$o=0;o<r;){var c=Di[o];Di[o++]=null;var d=Di[o];Di[o++]=null;var m=Di[o];Di[o++]=null;var _=Di[o];if(Di[o++]=null,d!==null&&m!==null){var R=d.pending;R===null?m.next=m:(m.next=R.next,R.next=m),d.pending=m}_!==0&&Dv(c,m,_)}}function Hh(r,o,c,d){Di[$o++]=r,Di[$o++]=o,Di[$o++]=c,Di[$o++]=d,Fp|=d,r.lanes|=d,r=r.alternate,r!==null&&(r.lanes|=d)}function Up(r,o,c,d){return Hh(r,o,c,d),zh(r)}function Yo(r,o){return Hh(r,null,null,o),zh(r)}function Dv(r,o,c){r.lanes|=c;var d=r.alternate;d!==null&&(d.lanes|=c);for(var m=!1,_=r.return;_!==null;)_.childLanes|=c,d=_.alternate,d!==null&&(d.childLanes|=c),_.tag===22&&(r=_.stateNode,r===null||r._visibility&1||(m=!0)),r=_,_=_.return;return r.tag===3?(_=r.stateNode,m&&o!==null&&(m=31-w(c),r=_.hiddenUpdates,d=r[m],d===null?r[m]=[o]:d.push(o),o.lane=c|536870912),_):null}function zh(r){if(50<qc)throw qc=0,qg=null,Error(n(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var Xo={};function tR(r,o,c,d){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(r,o,c,d){return new tR(r,o,c,d)}function Vp(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Qs(r,o){var c=r.alternate;return c===null?(c=fi(r.tag,o,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=o,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&65011712,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,o=r.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c.refCleanup=r.refCleanup,c}function Nv(r,o){r.flags&=65011714;var c=r.alternate;return c===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=c.childLanes,r.lanes=c.lanes,r.child=c.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=c.memoizedProps,r.memoizedState=c.memoizedState,r.updateQueue=c.updateQueue,r.type=c.type,o=c.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function Gh(r,o,c,d,m,_){var R=0;if(d=r,typeof r=="function")Vp(r)&&(R=1);else if(typeof r=="string")R=nI(r,c,yt.current)?26:r==="html"||r==="head"||r==="body"?27:5;else t:switch(r){case B:return r=fi(31,c,o,m),r.elementType=B,r.lanes=_,r;case T:return za(c.children,m,_,o);case S:R=8,m|=24;break;case I:return r=fi(12,c,o,m|2),r.elementType=I,r.lanes=_,r;case H:return r=fi(13,c,o,m),r.elementType=H,r.lanes=_,r;case K:return r=fi(19,c,o,m),r.elementType=K,r.lanes=_,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case x:case O:R=10;break t;case k:R=9;break t;case G:R=11;break t;case P:R=14;break t;case N:R=16,d=null;break t}R=29,c=Error(n(130,r===null?"null":typeof r,"")),d=null}return o=fi(R,c,o,m),o.elementType=r,o.type=d,o.lanes=_,o}function za(r,o,c,d){return r=fi(7,r,d,o),r.lanes=c,r}function jp(r,o,c){return r=fi(6,r,null,o),r.lanes=c,r}function Hp(r,o,c){return o=fi(4,r.children!==null?r.children:[],r.key,o),o.lanes=c,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var Ko=[],Wo=0,qh=null,$h=0,Ni=[],Mi=0,Ga=null,Js=1,Zs="";function qa(r,o){Ko[Wo++]=$h,Ko[Wo++]=qh,qh=r,$h=o}function Mv(r,o,c){Ni[Mi++]=Js,Ni[Mi++]=Zs,Ni[Mi++]=Ga,Ga=r;var d=Js;r=Zs;var m=32-w(d)-1;d&=~(1<<m),c+=1;var _=32-w(o)+m;if(30<_){var R=m-m%5;_=(d&(1<<R)-1).toString(32),d>>=R,m-=R,Js=1<<32-w(o)+m|c<<m|d,Zs=_+r}else Js=1<<_|c<<m|d,Zs=r}function zp(r){r.return!==null&&(qa(r,1),Mv(r,1,0))}function Gp(r){for(;r===qh;)qh=Ko[--Wo],Ko[Wo]=null,$h=Ko[--Wo],Ko[Wo]=null;for(;r===Ga;)Ga=Ni[--Mi],Ni[Mi]=null,Zs=Ni[--Mi],Ni[Mi]=null,Js=Ni[--Mi],Ni[Mi]=null}var Yn=null,Ue=null,he=!1,$a=null,fs=!1,qp=Error(n(519));function Ya(r){var o=Error(n(418,""));throw wc(xi(o,r)),qp}function kv(r){var o=r.stateNode,c=r.type,d=r.memoizedProps;switch(o[cn]=r,o[Qe]=d,c){case"dialog":Qt("cancel",o),Qt("close",o);break;case"iframe":case"object":case"embed":Qt("load",o);break;case"video":case"audio":for(c=0;c<Yc.length;c++)Qt(Yc[c],o);break;case"source":Qt("error",o);break;case"img":case"image":case"link":Qt("error",o),Qt("load",o);break;case"details":Qt("toggle",o);break;case"input":Qt("invalid",o),Na(o,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),Po(o);break;case"select":Qt("invalid",o);break;case"textarea":Qt("invalid",o),Ma(o,d.value,d.defaultValue,d.children),Po(o)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||d.suppressHydrationWarning===!0||Wb(o.textContent,c)?(d.popover!=null&&(Qt("beforetoggle",o),Qt("toggle",o)),d.onScroll!=null&&Qt("scroll",o),d.onScrollEnd!=null&&Qt("scrollend",o),d.onClick!=null&&(o.onclick=Cd),o=!0):o=!1,o||Ya(r)}function Pv(r){for(Yn=r.return;Yn;)switch(Yn.tag){case 5:case 13:fs=!1;return;case 27:case 3:fs=!0;return;default:Yn=Yn.return}}function Ec(r){if(r!==Yn)return!1;if(!he)return Pv(r),he=!0,!1;var o=r.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=r.type,c=!(c!=="form"&&c!=="button")||om(r.type,r.memoizedProps)),c=!c),c&&Ue&&Ya(r),Pv(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));t:{for(r=r.nextSibling,o=0;r;){if(r.nodeType===8)if(c=r.data,c==="/$"){if(o===0){Ue=Ki(r.nextSibling);break t}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++;r=r.nextSibling}Ue=null}}else o===27?(o=Ue,Kr(r.type)?(r=hm,hm=null,Ue=r):Ue=o):Ue=Yn?Ki(r.stateNode.nextSibling):null;return!0}function Ac(){Ue=Yn=null,he=!1}function Ov(){var r=$a;return r!==null&&(ii===null?ii=r:ii.push.apply(ii,r),$a=null),r}function wc(r){$a===null?$a=[r]:$a.push(r)}var $p=ut(null),Xa=null,tr=null;function Pr(r,o,c){at($p,o._currentValue),o._currentValue=c}function er(r){r._currentValue=$p.current,Q($p)}function Yp(r,o,c){for(;r!==null;){var d=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,d!==null&&(d.childLanes|=o)):d!==null&&(d.childLanes&o)!==o&&(d.childLanes|=o),r===c)break;r=r.return}}function Xp(r,o,c,d){var m=r.child;for(m!==null&&(m.return=r);m!==null;){var _=m.dependencies;if(_!==null){var R=m.child;_=_.firstContext;t:for(;_!==null;){var M=_;_=m;for(var q=0;q<o.length;q++)if(M.context===o[q]){_.lanes|=c,M=_.alternate,M!==null&&(M.lanes|=c),Yp(_.return,c,r),d||(R=null);break t}_=M.next}}else if(m.tag===18){if(R=m.return,R===null)throw Error(n(341));R.lanes|=c,_=R.alternate,_!==null&&(_.lanes|=c),Yp(R,c,r),R=null}else R=m.child;if(R!==null)R.return=m;else for(R=m;R!==null;){if(R===r){R=null;break}if(m=R.sibling,m!==null){m.return=R.return,R=m;break}R=R.return}m=R}}function Tc(r,o,c,d){r=null;for(var m=o,_=!1;m!==null;){if(!_){if((m.flags&524288)!==0)_=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var R=m.alternate;if(R===null)throw Error(n(387));if(R=R.memoizedProps,R!==null){var M=m.type;di(m.pendingProps.value,R.value)||(r!==null?r.push(M):r=[M])}}else if(m===It.current){if(R=m.alternate,R===null)throw Error(n(387));R.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(r!==null?r.push(Zc):r=[Zc])}m=m.return}r!==null&&Xp(o,r,c,d),o.flags|=262144}function Yh(r){for(r=r.firstContext;r!==null;){if(!di(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ka(r){Xa=r,tr=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Bn(r){return Lv(Xa,r)}function Xh(r,o){return Xa===null&&Ka(r),Lv(r,o)}function Lv(r,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},tr===null){if(r===null)throw Error(n(308));tr=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else tr=tr.next=o;return c}var eR=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(c,d){r.push(d)}};this.abort=function(){o.aborted=!0,r.forEach(function(c){return c()})}},nR=s.unstable_scheduleCallback,iR=s.unstable_NormalPriority,dn={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Kp(){return{controller:new eR,data:new Map,refCount:0}}function Sc(r){r.refCount--,r.refCount===0&&nR(iR,function(){r.controller.abort()})}var Cc=null,Wp=0,Qo=0,Jo=null;function sR(r,o){if(Cc===null){var c=Cc=[];Wp=0,Qo=Jg(),Jo={status:"pending",value:void 0,then:function(d){c.push(d)}}}return Wp++,o.then(Bv,Bv),o}function Bv(){if(--Wp===0&&Cc!==null){Jo!==null&&(Jo.status="fulfilled");var r=Cc;Cc=null,Qo=0,Jo=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function rR(r,o){var c=[],d={status:"pending",value:null,reason:null,then:function(m){c.push(m)}};return r.then(function(){d.status="fulfilled",d.value=o;for(var m=0;m<c.length;m++)(0,c[m])(o)},function(m){for(d.status="rejected",d.reason=m,m=0;m<c.length;m++)(0,c[m])(void 0)}),d}var Fv=J.S;J.S=function(r,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&sR(r,o),Fv!==null&&Fv(r,o)};var Wa=ut(null);function Qp(){var r=Wa.current;return r!==null?r:Te.pooledCache}function Kh(r,o){o===null?at(Wa,Wa.current):at(Wa,o.pool)}function Uv(){var r=Qp();return r===null?null:{parent:dn._currentValue,pool:r}}var Rc=Error(n(460)),Vv=Error(n(474)),Wh=Error(n(542)),Jp={then:function(){}};function jv(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Qh(){}function Hv(r,o,c){switch(c=r[c],c===void 0?r.push(o):c!==o&&(o.then(Qh,Qh),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,Gv(r),r;default:if(typeof o.status=="string")o.then(Qh,Qh);else{if(r=Te,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=o,r.status="pending",r.then(function(d){if(o.status==="pending"){var m=o;m.status="fulfilled",m.value=d}},function(d){if(o.status==="pending"){var m=o;m.status="rejected",m.reason=d}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,Gv(r),r}throw Ic=o,Rc}}var Ic=null;function zv(){if(Ic===null)throw Error(n(459));var r=Ic;return Ic=null,r}function Gv(r){if(r===Rc||r===Wh)throw Error(n(483))}var Or=!1;function Zp(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function tg(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Lr(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Br(r,o,c){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(ge&2)!==0){var m=d.pending;return m===null?o.next=o:(o.next=m.next,m.next=o),d.pending=o,o=zh(r),Dv(r,null,c),o}return Hh(r,d,o,c),zh(r)}function xc(r,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var d=o.lanes;d&=r.pendingLanes,c|=d,o.lanes=c,ic(r,c)}}function eg(r,o){var c=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var m=null,_=null;if(c=c.firstBaseUpdate,c!==null){do{var R={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};_===null?m=_=R:_=_.next=R,c=c.next}while(c!==null);_===null?m=_=o:_=_.next=o}else m=_=o;c={baseState:d.baseState,firstBaseUpdate:m,lastBaseUpdate:_,shared:d.shared,callbacks:d.callbacks},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=o:r.next=o,c.lastBaseUpdate=o}var ng=!1;function Dc(){if(ng){var r=Jo;if(r!==null)throw r}}function Nc(r,o,c,d){ng=!1;var m=r.updateQueue;Or=!1;var _=m.firstBaseUpdate,R=m.lastBaseUpdate,M=m.shared.pending;if(M!==null){m.shared.pending=null;var q=M,nt=q.next;q.next=null,R===null?_=nt:R.next=nt,R=q;var ht=r.alternate;ht!==null&&(ht=ht.updateQueue,M=ht.lastBaseUpdate,M!==R&&(M===null?ht.firstBaseUpdate=nt:M.next=nt,ht.lastBaseUpdate=q))}if(_!==null){var pt=m.baseState;R=0,ht=nt=q=null,M=_;do{var it=M.lane&-536870913,ot=it!==M.lane;if(ot?(ae&it)===it:(d&it)===it){it!==0&&it===Qo&&(ng=!0),ht!==null&&(ht=ht.next={lane:0,tag:M.tag,payload:M.payload,callback:null,next:null});t:{var Vt=r,Ot=M;it=o;var be=c;switch(Ot.tag){case 1:if(Vt=Ot.payload,typeof Vt=="function"){pt=Vt.call(be,pt,it);break t}pt=Vt;break t;case 3:Vt.flags=Vt.flags&-65537|128;case 0:if(Vt=Ot.payload,it=typeof Vt=="function"?Vt.call(be,pt,it):Vt,it==null)break t;pt=p({},pt,it);break t;case 2:Or=!0}}it=M.callback,it!==null&&(r.flags|=64,ot&&(r.flags|=8192),ot=m.callbacks,ot===null?m.callbacks=[it]:ot.push(it))}else ot={lane:it,tag:M.tag,payload:M.payload,callback:M.callback,next:null},ht===null?(nt=ht=ot,q=pt):ht=ht.next=ot,R|=it;if(M=M.next,M===null){if(M=m.shared.pending,M===null)break;ot=M,M=ot.next,ot.next=null,m.lastBaseUpdate=ot,m.shared.pending=null}}while(!0);ht===null&&(q=pt),m.baseState=q,m.firstBaseUpdate=nt,m.lastBaseUpdate=ht,_===null&&(m.shared.lanes=0),qr|=R,r.lanes=R,r.memoizedState=pt}}function qv(r,o){if(typeof r!="function")throw Error(n(191,r));r.call(o)}function $v(r,o){var c=r.callbacks;if(c!==null)for(r.callbacks=null,r=0;r<c.length;r++)qv(c[r],o)}var Zo=ut(null),Jh=ut(0);function Yv(r,o){r=lr,at(Jh,r),at(Zo,o),lr=r|o.baseLanes}function ig(){at(Jh,lr),at(Zo,Zo.current)}function sg(){lr=Jh.current,Q(Zo),Q(Jh)}var Fr=0,Yt=null,_e=null,Ze=null,Zh=!1,tl=!1,Qa=!1,td=0,Mc=0,el=null,aR=0;function Ge(){throw Error(n(321))}function rg(r,o){if(o===null)return!1;for(var c=0;c<o.length&&c<r.length;c++)if(!di(r[c],o[c]))return!1;return!0}function ag(r,o,c,d,m,_){return Fr=_,Yt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,J.H=r===null||r.memoizedState===null?D0:N0,Qa=!1,_=c(d,m),Qa=!1,tl&&(_=Kv(o,c,d,m)),Xv(r),_}function Xv(r){J.H=ad;var o=_e!==null&&_e.next!==null;if(Fr=0,Ze=_e=Yt=null,Zh=!1,Mc=0,el=null,o)throw Error(n(300));r===null||_n||(r=r.dependencies,r!==null&&Yh(r)&&(_n=!0))}function Kv(r,o,c,d){Yt=r;var m=0;do{if(tl&&(el=null),Mc=0,tl=!1,25<=m)throw Error(n(301));if(m+=1,Ze=_e=null,r.updateQueue!=null){var _=r.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}J.H=fR,_=o(c,d)}while(tl);return _}function oR(){var r=J.H,o=r.useState()[0];return o=typeof o.then=="function"?kc(o):o,r=r.useState()[0],(_e!==null?_e.memoizedState:null)!==r&&(Yt.flags|=1024),o}function og(){var r=td!==0;return td=0,r}function lg(r,o,c){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~c}function cg(r){if(Zh){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Zh=!1}Fr=0,Ze=_e=Yt=null,tl=!1,Mc=td=0,el=null}function ei(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ze===null?Yt.memoizedState=Ze=r:Ze=Ze.next=r,Ze}function tn(){if(_e===null){var r=Yt.alternate;r=r!==null?r.memoizedState:null}else r=_e.next;var o=Ze===null?Yt.memoizedState:Ze.next;if(o!==null)Ze=o,_e=r;else{if(r===null)throw Yt.alternate===null?Error(n(467)):Error(n(310));_e=r,r={memoizedState:_e.memoizedState,baseState:_e.baseState,baseQueue:_e.baseQueue,queue:_e.queue,next:null},Ze===null?Yt.memoizedState=Ze=r:Ze=Ze.next=r}return Ze}function ug(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function kc(r){var o=Mc;return Mc+=1,el===null&&(el=[]),r=Hv(el,r,o),o=Yt,(Ze===null?o.memoizedState:Ze.next)===null&&(o=o.alternate,J.H=o===null||o.memoizedState===null?D0:N0),r}function ed(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return kc(r);if(r.$$typeof===O)return Bn(r)}throw Error(n(438,String(r)))}function hg(r){var o=null,c=Yt.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var d=Yt.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(o={data:d.data.map(function(m){return m.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=ug(),Yt.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(r),d=0;d<r;d++)c[d]=j;return o.index++,c}function nr(r,o){return typeof o=="function"?o(r):o}function nd(r){var o=tn();return dg(o,_e,r)}function dg(r,o,c){var d=r.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=c;var m=r.baseQueue,_=d.pending;if(_!==null){if(m!==null){var R=m.next;m.next=_.next,_.next=R}o.baseQueue=m=_,d.pending=null}if(_=r.baseState,m===null)r.memoizedState=_;else{o=m.next;var M=R=null,q=null,nt=o,ht=!1;do{var pt=nt.lane&-536870913;if(pt!==nt.lane?(ae&pt)===pt:(Fr&pt)===pt){var it=nt.revertLane;if(it===0)q!==null&&(q=q.next={lane:0,revertLane:0,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null}),pt===Qo&&(ht=!0);else if((Fr&it)===it){nt=nt.next,it===Qo&&(ht=!0);continue}else pt={lane:0,revertLane:nt.revertLane,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null},q===null?(M=q=pt,R=_):q=q.next=pt,Yt.lanes|=it,qr|=it;pt=nt.action,Qa&&c(_,pt),_=nt.hasEagerState?nt.eagerState:c(_,pt)}else it={lane:pt,revertLane:nt.revertLane,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null},q===null?(M=q=it,R=_):q=q.next=it,Yt.lanes|=pt,qr|=pt;nt=nt.next}while(nt!==null&&nt!==o);if(q===null?R=_:q.next=M,!di(_,r.memoizedState)&&(_n=!0,ht&&(c=Jo,c!==null)))throw c;r.memoizedState=_,r.baseState=R,r.baseQueue=q,d.lastRenderedState=_}return m===null&&(d.lanes=0),[r.memoizedState,d.dispatch]}function fg(r){var o=tn(),c=o.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=r;var d=c.dispatch,m=c.pending,_=o.memoizedState;if(m!==null){c.pending=null;var R=m=m.next;do _=r(_,R.action),R=R.next;while(R!==m);di(_,o.memoizedState)||(_n=!0),o.memoizedState=_,o.baseQueue===null&&(o.baseState=_),c.lastRenderedState=_}return[_,d]}function Wv(r,o,c){var d=Yt,m=tn(),_=he;if(_){if(c===void 0)throw Error(n(407));c=c()}else c=o();var R=!di((_e||m).memoizedState,c);R&&(m.memoizedState=c,_n=!0),m=m.queue;var M=Zv.bind(null,d,m,r);if(Pc(2048,8,M,[r]),m.getSnapshot!==o||R||Ze!==null&&Ze.memoizedState.tag&1){if(d.flags|=2048,nl(9,id(),Jv.bind(null,d,m,c,o),null),Te===null)throw Error(n(349));_||(Fr&124)!==0||Qv(d,o,c)}return c}function Qv(r,o,c){r.flags|=16384,r={getSnapshot:o,value:c},o=Yt.updateQueue,o===null?(o=ug(),Yt.updateQueue=o,o.stores=[r]):(c=o.stores,c===null?o.stores=[r]:c.push(r))}function Jv(r,o,c,d){o.value=c,o.getSnapshot=d,t0(o)&&e0(r)}function Zv(r,o,c){return c(function(){t0(o)&&e0(r)})}function t0(r){var o=r.getSnapshot;r=r.value;try{var c=o();return!di(r,c)}catch{return!0}}function e0(r){var o=Yo(r,2);o!==null&&_i(o,r,2)}function pg(r){var o=ei();if(typeof r=="function"){var c=r;if(r=c(),Qa){A(!0);try{c()}finally{A(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:nr,lastRenderedState:r},o}function n0(r,o,c,d){return r.baseState=c,dg(r,_e,typeof d=="function"?d:nr)}function lR(r,o,c,d,m){if(rd(r))throw Error(n(485));if(r=o.action,r!==null){var _={payload:m,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){_.listeners.push(R)}};J.T!==null?c(!0):_.isTransition=!1,d(_),c=o.pending,c===null?(_.next=o.pending=_,i0(o,_)):(_.next=c.next,o.pending=c.next=_)}}function i0(r,o){var c=o.action,d=o.payload,m=r.state;if(o.isTransition){var _=J.T,R={};J.T=R;try{var M=c(m,d),q=J.S;q!==null&&q(R,M),s0(r,o,M)}catch(nt){gg(r,o,nt)}finally{J.T=_}}else try{_=c(m,d),s0(r,o,_)}catch(nt){gg(r,o,nt)}}function s0(r,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){r0(r,o,d)},function(d){return gg(r,o,d)}):r0(r,o,c)}function r0(r,o,c){o.status="fulfilled",o.value=c,a0(o),r.state=c,o=r.pending,o!==null&&(c=o.next,c===o?r.pending=null:(c=c.next,o.next=c,i0(r,c)))}function gg(r,o,c){var d=r.pending;if(r.pending=null,d!==null){d=d.next;do o.status="rejected",o.reason=c,a0(o),o=o.next;while(o!==d)}r.action=null}function a0(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function o0(r,o){return o}function l0(r,o){if(he){var c=Te.formState;if(c!==null){t:{var d=Yt;if(he){if(Ue){e:{for(var m=Ue,_=fs;m.nodeType!==8;){if(!_){m=null;break e}if(m=Ki(m.nextSibling),m===null){m=null;break e}}_=m.data,m=_==="F!"||_==="F"?m:null}if(m){Ue=Ki(m.nextSibling),d=m.data==="F!";break t}}Ya(d)}d=!1}d&&(o=c[0])}}return c=ei(),c.memoizedState=c.baseState=o,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o0,lastRenderedState:o},c.queue=d,c=R0.bind(null,Yt,d),d.dispatch=c,d=pg(!1),_=bg.bind(null,Yt,!1,d.queue),d=ei(),m={state:o,dispatch:null,action:r,pending:null},d.queue=m,c=lR.bind(null,Yt,m,_,c),m.dispatch=c,d.memoizedState=r,[o,c,!1]}function c0(r){var o=tn();return u0(o,_e,r)}function u0(r,o,c){if(o=dg(r,o,o0)[0],r=nd(nr)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var d=kc(o)}catch(R){throw R===Rc?Wh:R}else d=o;o=tn();var m=o.queue,_=m.dispatch;return c!==o.memoizedState&&(Yt.flags|=2048,nl(9,id(),cR.bind(null,m,c),null)),[d,_,r]}function cR(r,o){r.action=o}function h0(r){var o=tn(),c=_e;if(c!==null)return u0(o,c,r);tn(),o=o.memoizedState,c=tn();var d=c.queue.dispatch;return c.memoizedState=r,[o,d,!1]}function nl(r,o,c,d){return r={tag:r,create:c,deps:d,inst:o,next:null},o=Yt.updateQueue,o===null&&(o=ug(),Yt.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=r.next=r:(d=c.next,c.next=r,r.next=d,o.lastEffect=r),r}function id(){return{destroy:void 0,resource:void 0}}function d0(){return tn().memoizedState}function sd(r,o,c,d){var m=ei();d=d===void 0?null:d,Yt.flags|=r,m.memoizedState=nl(1|o,id(),c,d)}function Pc(r,o,c,d){var m=tn();d=d===void 0?null:d;var _=m.memoizedState.inst;_e!==null&&d!==null&&rg(d,_e.memoizedState.deps)?m.memoizedState=nl(o,_,c,d):(Yt.flags|=r,m.memoizedState=nl(1|o,_,c,d))}function f0(r,o){sd(8390656,8,r,o)}function p0(r,o){Pc(2048,8,r,o)}function g0(r,o){return Pc(4,2,r,o)}function m0(r,o){return Pc(4,4,r,o)}function y0(r,o){if(typeof o=="function"){r=r();var c=o(r);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function _0(r,o,c){c=c!=null?c.concat([r]):null,Pc(4,4,y0.bind(null,o,r),c)}function mg(){}function v0(r,o){var c=tn();o=o===void 0?null:o;var d=c.memoizedState;return o!==null&&rg(o,d[1])?d[0]:(c.memoizedState=[r,o],r)}function b0(r,o){var c=tn();o=o===void 0?null:o;var d=c.memoizedState;if(o!==null&&rg(o,d[1]))return d[0];if(d=r(),Qa){A(!0);try{r()}finally{A(!1)}}return c.memoizedState=[d,o],d}function yg(r,o,c){return c===void 0||(Fr&1073741824)!==0?r.memoizedState=o:(r.memoizedState=c,r=wb(),Yt.lanes|=r,qr|=r,c)}function E0(r,o,c,d){return di(c,o)?c:Zo.current!==null?(r=yg(r,c,d),di(r,o)||(_n=!0),r):(Fr&42)===0?(_n=!0,r.memoizedState=c):(r=wb(),Yt.lanes|=r,qr|=r,o)}function A0(r,o,c,d,m){var _=ct.p;ct.p=_!==0&&8>_?_:8;var R=J.T,M={};J.T=M,bg(r,!1,o,c);try{var q=m(),nt=J.S;if(nt!==null&&nt(M,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var ht=rR(q,d);Oc(r,o,ht,yi(r))}else Oc(r,o,d,yi(r))}catch(pt){Oc(r,o,{then:function(){},status:"rejected",reason:pt},yi())}finally{ct.p=_,J.T=R}}function uR(){}function _g(r,o,c,d){if(r.tag!==5)throw Error(n(476));var m=w0(r).queue;A0(r,m,o,mt,c===null?uR:function(){return T0(r),c(d)})}function w0(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:mt,baseState:mt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:nr,lastRenderedState:mt},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:nr,lastRenderedState:c},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function T0(r){var o=w0(r).next.queue;Oc(r,o,{},yi())}function vg(){return Bn(Zc)}function S0(){return tn().memoizedState}function C0(){return tn().memoizedState}function hR(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var c=yi();r=Lr(c);var d=Br(o,r,c);d!==null&&(_i(d,o,c),xc(d,o,c)),o={cache:Kp()},r.payload=o;return}o=o.return}}function dR(r,o,c){var d=yi();c={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},rd(r)?I0(o,c):(c=Up(r,o,c,d),c!==null&&(_i(c,r,d),x0(c,o,d)))}function R0(r,o,c){var d=yi();Oc(r,o,c,d)}function Oc(r,o,c,d){var m={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(rd(r))I0(o,m);else{var _=r.alternate;if(r.lanes===0&&(_===null||_.lanes===0)&&(_=o.lastRenderedReducer,_!==null))try{var R=o.lastRenderedState,M=_(R,c);if(m.hasEagerState=!0,m.eagerState=M,di(M,R))return Hh(r,o,m,0),Te===null&&jh(),!1}catch{}finally{}if(c=Up(r,o,m,d),c!==null)return _i(c,r,d),x0(c,o,d),!0}return!1}function bg(r,o,c,d){if(d={lane:2,revertLane:Jg(),action:d,hasEagerState:!1,eagerState:null,next:null},rd(r)){if(o)throw Error(n(479))}else o=Up(r,c,d,2),o!==null&&_i(o,r,2)}function rd(r){var o=r.alternate;return r===Yt||o!==null&&o===Yt}function I0(r,o){tl=Zh=!0;var c=r.pending;c===null?o.next=o:(o.next=c.next,c.next=o),r.pending=o}function x0(r,o,c){if((c&4194048)!==0){var d=o.lanes;d&=r.pendingLanes,c|=d,o.lanes=c,ic(r,c)}}var ad={readContext:Bn,use:ed,useCallback:Ge,useContext:Ge,useEffect:Ge,useImperativeHandle:Ge,useLayoutEffect:Ge,useInsertionEffect:Ge,useMemo:Ge,useReducer:Ge,useRef:Ge,useState:Ge,useDebugValue:Ge,useDeferredValue:Ge,useTransition:Ge,useSyncExternalStore:Ge,useId:Ge,useHostTransitionStatus:Ge,useFormState:Ge,useActionState:Ge,useOptimistic:Ge,useMemoCache:Ge,useCacheRefresh:Ge},D0={readContext:Bn,use:ed,useCallback:function(r,o){return ei().memoizedState=[r,o===void 0?null:o],r},useContext:Bn,useEffect:f0,useImperativeHandle:function(r,o,c){c=c!=null?c.concat([r]):null,sd(4194308,4,y0.bind(null,o,r),c)},useLayoutEffect:function(r,o){return sd(4194308,4,r,o)},useInsertionEffect:function(r,o){sd(4,2,r,o)},useMemo:function(r,o){var c=ei();o=o===void 0?null:o;var d=r();if(Qa){A(!0);try{r()}finally{A(!1)}}return c.memoizedState=[d,o],d},useReducer:function(r,o,c){var d=ei();if(c!==void 0){var m=c(o);if(Qa){A(!0);try{c(o)}finally{A(!1)}}}else m=o;return d.memoizedState=d.baseState=m,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:m},d.queue=r,r=r.dispatch=dR.bind(null,Yt,r),[d.memoizedState,r]},useRef:function(r){var o=ei();return r={current:r},o.memoizedState=r},useState:function(r){r=pg(r);var o=r.queue,c=R0.bind(null,Yt,o);return o.dispatch=c,[r.memoizedState,c]},useDebugValue:mg,useDeferredValue:function(r,o){var c=ei();return yg(c,r,o)},useTransition:function(){var r=pg(!1);return r=A0.bind(null,Yt,r.queue,!0,!1),ei().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,c){var d=Yt,m=ei();if(he){if(c===void 0)throw Error(n(407));c=c()}else{if(c=o(),Te===null)throw Error(n(349));(ae&124)!==0||Qv(d,o,c)}m.memoizedState=c;var _={value:c,getSnapshot:o};return m.queue=_,f0(Zv.bind(null,d,_,r),[r]),d.flags|=2048,nl(9,id(),Jv.bind(null,d,_,c,o),null),c},useId:function(){var r=ei(),o=Te.identifierPrefix;if(he){var c=Zs,d=Js;c=(d&~(1<<32-w(d)-1)).toString(32)+c,o="«"+o+"R"+c,c=td++,0<c&&(o+="H"+c.toString(32)),o+="»"}else c=aR++,o="«"+o+"r"+c.toString(32)+"»";return r.memoizedState=o},useHostTransitionStatus:vg,useFormState:l0,useActionState:l0,useOptimistic:function(r){var o=ei();o.memoizedState=o.baseState=r;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=bg.bind(null,Yt,!0,c),c.dispatch=o,[r,o]},useMemoCache:hg,useCacheRefresh:function(){return ei().memoizedState=hR.bind(null,Yt)}},N0={readContext:Bn,use:ed,useCallback:v0,useContext:Bn,useEffect:p0,useImperativeHandle:_0,useInsertionEffect:g0,useLayoutEffect:m0,useMemo:b0,useReducer:nd,useRef:d0,useState:function(){return nd(nr)},useDebugValue:mg,useDeferredValue:function(r,o){var c=tn();return E0(c,_e.memoizedState,r,o)},useTransition:function(){var r=nd(nr)[0],o=tn().memoizedState;return[typeof r=="boolean"?r:kc(r),o]},useSyncExternalStore:Wv,useId:S0,useHostTransitionStatus:vg,useFormState:c0,useActionState:c0,useOptimistic:function(r,o){var c=tn();return n0(c,_e,r,o)},useMemoCache:hg,useCacheRefresh:C0},fR={readContext:Bn,use:ed,useCallback:v0,useContext:Bn,useEffect:p0,useImperativeHandle:_0,useInsertionEffect:g0,useLayoutEffect:m0,useMemo:b0,useReducer:fg,useRef:d0,useState:function(){return fg(nr)},useDebugValue:mg,useDeferredValue:function(r,o){var c=tn();return _e===null?yg(c,r,o):E0(c,_e.memoizedState,r,o)},useTransition:function(){var r=fg(nr)[0],o=tn().memoizedState;return[typeof r=="boolean"?r:kc(r),o]},useSyncExternalStore:Wv,useId:S0,useHostTransitionStatus:vg,useFormState:h0,useActionState:h0,useOptimistic:function(r,o){var c=tn();return _e!==null?n0(c,_e,r,o):(c.baseState=r,[r,c.queue.dispatch])},useMemoCache:hg,useCacheRefresh:C0},il=null,Lc=0;function od(r){var o=Lc;return Lc+=1,il===null&&(il=[]),Hv(il,r,o)}function Bc(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function ld(r,o){throw o.$$typeof===y?Error(n(525)):(r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function M0(r){var o=r._init;return o(r._payload)}function k0(r){function o(Z,X){if(r){var et=Z.deletions;et===null?(Z.deletions=[X],Z.flags|=16):et.push(X)}}function c(Z,X){if(!r)return null;for(;X!==null;)o(Z,X),X=X.sibling;return null}function d(Z){for(var X=new Map;Z!==null;)Z.key!==null?X.set(Z.key,Z):X.set(Z.index,Z),Z=Z.sibling;return X}function m(Z,X){return Z=Qs(Z,X),Z.index=0,Z.sibling=null,Z}function _(Z,X,et){return Z.index=et,r?(et=Z.alternate,et!==null?(et=et.index,et<X?(Z.flags|=67108866,X):et):(Z.flags|=67108866,X)):(Z.flags|=1048576,X)}function R(Z){return r&&Z.alternate===null&&(Z.flags|=67108866),Z}function M(Z,X,et,ft){return X===null||X.tag!==6?(X=jp(et,Z.mode,ft),X.return=Z,X):(X=m(X,et),X.return=Z,X)}function q(Z,X,et,ft){var Tt=et.type;return Tt===T?ht(Z,X,et.props.children,ft,et.key):X!==null&&(X.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===N&&M0(Tt)===X.type)?(X=m(X,et.props),Bc(X,et),X.return=Z,X):(X=Gh(et.type,et.key,et.props,null,Z.mode,ft),Bc(X,et),X.return=Z,X)}function nt(Z,X,et,ft){return X===null||X.tag!==4||X.stateNode.containerInfo!==et.containerInfo||X.stateNode.implementation!==et.implementation?(X=Hp(et,Z.mode,ft),X.return=Z,X):(X=m(X,et.children||[]),X.return=Z,X)}function ht(Z,X,et,ft,Tt){return X===null||X.tag!==7?(X=za(et,Z.mode,ft,Tt),X.return=Z,X):(X=m(X,et),X.return=Z,X)}function pt(Z,X,et){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return X=jp(""+X,Z.mode,et),X.return=Z,X;if(typeof X=="object"&&X!==null){switch(X.$$typeof){case v:return et=Gh(X.type,X.key,X.props,null,Z.mode,et),Bc(et,X),et.return=Z,et;case b:return X=Hp(X,Z.mode,et),X.return=Z,X;case N:var ft=X._init;return X=ft(X._payload),pt(Z,X,et)}if(Dt(X)||Y(X))return X=za(X,Z.mode,et,null),X.return=Z,X;if(typeof X.then=="function")return pt(Z,od(X),et);if(X.$$typeof===O)return pt(Z,Xh(Z,X),et);ld(Z,X)}return null}function it(Z,X,et,ft){var Tt=X!==null?X.key:null;if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return Tt!==null?null:M(Z,X,""+et,ft);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case v:return et.key===Tt?q(Z,X,et,ft):null;case b:return et.key===Tt?nt(Z,X,et,ft):null;case N:return Tt=et._init,et=Tt(et._payload),it(Z,X,et,ft)}if(Dt(et)||Y(et))return Tt!==null?null:ht(Z,X,et,ft,null);if(typeof et.then=="function")return it(Z,X,od(et),ft);if(et.$$typeof===O)return it(Z,X,Xh(Z,et),ft);ld(Z,et)}return null}function ot(Z,X,et,ft,Tt){if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return Z=Z.get(et)||null,M(X,Z,""+ft,Tt);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case v:return Z=Z.get(ft.key===null?et:ft.key)||null,q(X,Z,ft,Tt);case b:return Z=Z.get(ft.key===null?et:ft.key)||null,nt(X,Z,ft,Tt);case N:var Xt=ft._init;return ft=Xt(ft._payload),ot(Z,X,et,ft,Tt)}if(Dt(ft)||Y(ft))return Z=Z.get(et)||null,ht(X,Z,ft,Tt,null);if(typeof ft.then=="function")return ot(Z,X,et,od(ft),Tt);if(ft.$$typeof===O)return ot(Z,X,et,Xh(X,ft),Tt);ld(X,ft)}return null}function Vt(Z,X,et,ft){for(var Tt=null,Xt=null,Ct=X,Lt=X=0,bn=null;Ct!==null&&Lt<et.length;Lt++){Ct.index>Lt?(bn=Ct,Ct=null):bn=Ct.sibling;var ce=it(Z,Ct,et[Lt],ft);if(ce===null){Ct===null&&(Ct=bn);break}r&&Ct&&ce.alternate===null&&o(Z,Ct),X=_(ce,X,Lt),Xt===null?Tt=ce:Xt.sibling=ce,Xt=ce,Ct=bn}if(Lt===et.length)return c(Z,Ct),he&&qa(Z,Lt),Tt;if(Ct===null){for(;Lt<et.length;Lt++)Ct=pt(Z,et[Lt],ft),Ct!==null&&(X=_(Ct,X,Lt),Xt===null?Tt=Ct:Xt.sibling=Ct,Xt=Ct);return he&&qa(Z,Lt),Tt}for(Ct=d(Ct);Lt<et.length;Lt++)bn=ot(Ct,Z,Lt,et[Lt],ft),bn!==null&&(r&&bn.alternate!==null&&Ct.delete(bn.key===null?Lt:bn.key),X=_(bn,X,Lt),Xt===null?Tt=bn:Xt.sibling=bn,Xt=bn);return r&&Ct.forEach(function(ta){return o(Z,ta)}),he&&qa(Z,Lt),Tt}function Ot(Z,X,et,ft){if(et==null)throw Error(n(151));for(var Tt=null,Xt=null,Ct=X,Lt=X=0,bn=null,ce=et.next();Ct!==null&&!ce.done;Lt++,ce=et.next()){Ct.index>Lt?(bn=Ct,Ct=null):bn=Ct.sibling;var ta=it(Z,Ct,ce.value,ft);if(ta===null){Ct===null&&(Ct=bn);break}r&&Ct&&ta.alternate===null&&o(Z,Ct),X=_(ta,X,Lt),Xt===null?Tt=ta:Xt.sibling=ta,Xt=ta,Ct=bn}if(ce.done)return c(Z,Ct),he&&qa(Z,Lt),Tt;if(Ct===null){for(;!ce.done;Lt++,ce=et.next())ce=pt(Z,ce.value,ft),ce!==null&&(X=_(ce,X,Lt),Xt===null?Tt=ce:Xt.sibling=ce,Xt=ce);return he&&qa(Z,Lt),Tt}for(Ct=d(Ct);!ce.done;Lt++,ce=et.next())ce=ot(Ct,Z,Lt,ce.value,ft),ce!==null&&(r&&ce.alternate!==null&&Ct.delete(ce.key===null?Lt:ce.key),X=_(ce,X,Lt),Xt===null?Tt=ce:Xt.sibling=ce,Xt=ce);return r&&Ct.forEach(function(pI){return o(Z,pI)}),he&&qa(Z,Lt),Tt}function be(Z,X,et,ft){if(typeof et=="object"&&et!==null&&et.type===T&&et.key===null&&(et=et.props.children),typeof et=="object"&&et!==null){switch(et.$$typeof){case v:t:{for(var Tt=et.key;X!==null;){if(X.key===Tt){if(Tt=et.type,Tt===T){if(X.tag===7){c(Z,X.sibling),ft=m(X,et.props.children),ft.return=Z,Z=ft;break t}}else if(X.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===N&&M0(Tt)===X.type){c(Z,X.sibling),ft=m(X,et.props),Bc(ft,et),ft.return=Z,Z=ft;break t}c(Z,X);break}else o(Z,X);X=X.sibling}et.type===T?(ft=za(et.props.children,Z.mode,ft,et.key),ft.return=Z,Z=ft):(ft=Gh(et.type,et.key,et.props,null,Z.mode,ft),Bc(ft,et),ft.return=Z,Z=ft)}return R(Z);case b:t:{for(Tt=et.key;X!==null;){if(X.key===Tt)if(X.tag===4&&X.stateNode.containerInfo===et.containerInfo&&X.stateNode.implementation===et.implementation){c(Z,X.sibling),ft=m(X,et.children||[]),ft.return=Z,Z=ft;break t}else{c(Z,X);break}else o(Z,X);X=X.sibling}ft=Hp(et,Z.mode,ft),ft.return=Z,Z=ft}return R(Z);case N:return Tt=et._init,et=Tt(et._payload),be(Z,X,et,ft)}if(Dt(et))return Vt(Z,X,et,ft);if(Y(et)){if(Tt=Y(et),typeof Tt!="function")throw Error(n(150));return et=Tt.call(et),Ot(Z,X,et,ft)}if(typeof et.then=="function")return be(Z,X,od(et),ft);if(et.$$typeof===O)return be(Z,X,Xh(Z,et),ft);ld(Z,et)}return typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint"?(et=""+et,X!==null&&X.tag===6?(c(Z,X.sibling),ft=m(X,et),ft.return=Z,Z=ft):(c(Z,X),ft=jp(et,Z.mode,ft),ft.return=Z,Z=ft),R(Z)):c(Z,X)}return function(Z,X,et,ft){try{Lc=0;var Tt=be(Z,X,et,ft);return il=null,Tt}catch(Ct){if(Ct===Rc||Ct===Wh)throw Ct;var Xt=fi(29,Ct,null,Z.mode);return Xt.lanes=ft,Xt.return=Z,Xt}finally{}}}var sl=k0(!0),P0=k0(!1),ki=ut(null),ps=null;function Ur(r){var o=r.alternate;at(fn,fn.current&1),at(ki,r),ps===null&&(o===null||Zo.current!==null||o.memoizedState!==null)&&(ps=r)}function O0(r){if(r.tag===22){if(at(fn,fn.current),at(ki,r),ps===null){var o=r.alternate;o!==null&&o.memoizedState!==null&&(ps=r)}}else Vr()}function Vr(){at(fn,fn.current),at(ki,ki.current)}function ir(r){Q(ki),ps===r&&(ps=null),Q(fn)}var fn=ut(0);function cd(r){for(var o=r;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||um(c)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function Eg(r,o,c,d){o=r.memoizedState,c=c(d,o),c=c==null?o:p({},o,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var Ag={enqueueSetState:function(r,o,c){r=r._reactInternals;var d=yi(),m=Lr(d);m.payload=o,c!=null&&(m.callback=c),o=Br(r,m,d),o!==null&&(_i(o,r,d),xc(o,r,d))},enqueueReplaceState:function(r,o,c){r=r._reactInternals;var d=yi(),m=Lr(d);m.tag=1,m.payload=o,c!=null&&(m.callback=c),o=Br(r,m,d),o!==null&&(_i(o,r,d),xc(o,r,d))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var c=yi(),d=Lr(c);d.tag=2,o!=null&&(d.callback=o),o=Br(r,d,c),o!==null&&(_i(o,r,c),xc(o,r,c))}};function L0(r,o,c,d,m,_,R){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,_,R):o.prototype&&o.prototype.isPureReactComponent?!vc(c,d)||!vc(m,_):!0}function B0(r,o,c,d){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,d),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,d),o.state!==r&&Ag.enqueueReplaceState(o,o.state,null)}function Ja(r,o){var c=o;if("ref"in o){c={};for(var d in o)d!=="ref"&&(c[d]=o[d])}if(r=r.defaultProps){c===o&&(c=p({},c));for(var m in r)c[m]===void 0&&(c[m]=r[m])}return c}var ud=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function F0(r){ud(r)}function U0(r){console.error(r)}function V0(r){ud(r)}function hd(r,o){try{var c=r.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(d){setTimeout(function(){throw d})}}function j0(r,o,c){try{var d=r.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function wg(r,o,c){return c=Lr(c),c.tag=3,c.payload={element:null},c.callback=function(){hd(r,o)},c}function H0(r){return r=Lr(r),r.tag=3,r}function z0(r,o,c,d){var m=c.type.getDerivedStateFromError;if(typeof m=="function"){var _=d.value;r.payload=function(){return m(_)},r.callback=function(){j0(o,c,d)}}var R=c.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(r.callback=function(){j0(o,c,d),typeof m!="function"&&($r===null?$r=new Set([this]):$r.add(this));var M=d.stack;this.componentDidCatch(d.value,{componentStack:M!==null?M:""})})}function pR(r,o,c,d,m){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(o=c.alternate,o!==null&&Tc(o,c,m,!0),c=ki.current,c!==null){switch(c.tag){case 13:return ps===null?Yg():c.alternate===null&&Ve===0&&(Ve=3),c.flags&=-257,c.flags|=65536,c.lanes=m,d===Jp?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([d]):o.add(d),Kg(r,d,m)),!1;case 22:return c.flags|=65536,d===Jp?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([d]):c.add(d)),Kg(r,d,m)),!1}throw Error(n(435,c.tag))}return Kg(r,d,m),Yg(),!1}if(he)return o=ki.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=m,d!==qp&&(r=Error(n(422),{cause:d}),wc(xi(r,c)))):(d!==qp&&(o=Error(n(423),{cause:d}),wc(xi(o,c))),r=r.current.alternate,r.flags|=65536,m&=-m,r.lanes|=m,d=xi(d,c),m=wg(r.stateNode,d,m),eg(r,m),Ve!==4&&(Ve=2)),!1;var _=Error(n(520),{cause:d});if(_=xi(_,c),Gc===null?Gc=[_]:Gc.push(_),Ve!==4&&(Ve=2),o===null)return!0;d=xi(d,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,r=m&-m,c.lanes|=r,r=wg(c.stateNode,d,r),eg(c,r),!1;case 1:if(o=c.type,_=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&($r===null||!$r.has(_))))return c.flags|=65536,m&=-m,c.lanes|=m,m=H0(m),z0(m,r,c,d),eg(c,m),!1}c=c.return}while(c!==null);return!1}var G0=Error(n(461)),_n=!1;function Cn(r,o,c,d){o.child=r===null?P0(o,null,c,d):sl(o,r.child,c,d)}function q0(r,o,c,d,m){c=c.render;var _=o.ref;if("ref"in d){var R={};for(var M in d)M!=="ref"&&(R[M]=d[M])}else R=d;return Ka(o),d=ag(r,o,c,R,_,m),M=og(),r!==null&&!_n?(lg(r,o,m),sr(r,o,m)):(he&&M&&zp(o),o.flags|=1,Cn(r,o,d,m),o.child)}function $0(r,o,c,d,m){if(r===null){var _=c.type;return typeof _=="function"&&!Vp(_)&&_.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=_,Y0(r,o,_,d,m)):(r=Gh(c.type,null,d,o,o.mode,m),r.ref=o.ref,r.return=o,o.child=r)}if(_=r.child,!Ng(r,m)){var R=_.memoizedProps;if(c=c.compare,c=c!==null?c:vc,c(R,d)&&r.ref===o.ref)return sr(r,o,m)}return o.flags|=1,r=Qs(_,d),r.ref=o.ref,r.return=o,o.child=r}function Y0(r,o,c,d,m){if(r!==null){var _=r.memoizedProps;if(vc(_,d)&&r.ref===o.ref)if(_n=!1,o.pendingProps=d=_,Ng(r,m))(r.flags&131072)!==0&&(_n=!0);else return o.lanes=r.lanes,sr(r,o,m)}return Tg(r,o,c,d,m)}function X0(r,o,c){var d=o.pendingProps,m=d.children,_=r!==null?r.memoizedState:null;if(d.mode==="hidden"){if((o.flags&128)!==0){if(d=_!==null?_.baseLanes|c:c,r!==null){for(m=o.child=r.child,_=0;m!==null;)_=_|m.lanes|m.childLanes,m=m.sibling;o.childLanes=_&~d}else o.childLanes=0,o.child=null;return K0(r,o,d,c)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&Kh(o,_!==null?_.cachePool:null),_!==null?Yv(o,_):ig(),O0(o);else return o.lanes=o.childLanes=536870912,K0(r,o,_!==null?_.baseLanes|c:c,c)}else _!==null?(Kh(o,_.cachePool),Yv(o,_),Vr(),o.memoizedState=null):(r!==null&&Kh(o,null),ig(),Vr());return Cn(r,o,m,c),o.child}function K0(r,o,c,d){var m=Qp();return m=m===null?null:{parent:dn._currentValue,pool:m},o.memoizedState={baseLanes:c,cachePool:m},r!==null&&Kh(o,null),ig(),O0(o),r!==null&&Tc(r,o,d,!0),null}function dd(r,o){var c=o.ref;if(c===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(r===null||r.ref!==c)&&(o.flags|=4194816)}}function Tg(r,o,c,d,m){return Ka(o),c=ag(r,o,c,d,void 0,m),d=og(),r!==null&&!_n?(lg(r,o,m),sr(r,o,m)):(he&&d&&zp(o),o.flags|=1,Cn(r,o,c,m),o.child)}function W0(r,o,c,d,m,_){return Ka(o),o.updateQueue=null,c=Kv(o,d,c,m),Xv(r),d=og(),r!==null&&!_n?(lg(r,o,_),sr(r,o,_)):(he&&d&&zp(o),o.flags|=1,Cn(r,o,c,_),o.child)}function Q0(r,o,c,d,m){if(Ka(o),o.stateNode===null){var _=Xo,R=c.contextType;typeof R=="object"&&R!==null&&(_=Bn(R)),_=new c(d,_),o.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Ag,o.stateNode=_,_._reactInternals=o,_=o.stateNode,_.props=d,_.state=o.memoizedState,_.refs={},Zp(o),R=c.contextType,_.context=typeof R=="object"&&R!==null?Bn(R):Xo,_.state=o.memoizedState,R=c.getDerivedStateFromProps,typeof R=="function"&&(Eg(o,c,R,d),_.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(R=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),R!==_.state&&Ag.enqueueReplaceState(_,_.state,null),Nc(o,d,_,m),Dc(),_.state=o.memoizedState),typeof _.componentDidMount=="function"&&(o.flags|=4194308),d=!0}else if(r===null){_=o.stateNode;var M=o.memoizedProps,q=Ja(c,M);_.props=q;var nt=_.context,ht=c.contextType;R=Xo,typeof ht=="object"&&ht!==null&&(R=Bn(ht));var pt=c.getDerivedStateFromProps;ht=typeof pt=="function"||typeof _.getSnapshotBeforeUpdate=="function",M=o.pendingProps!==M,ht||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(M||nt!==R)&&B0(o,_,d,R),Or=!1;var it=o.memoizedState;_.state=it,Nc(o,d,_,m),Dc(),nt=o.memoizedState,M||it!==nt||Or?(typeof pt=="function"&&(Eg(o,c,pt,d),nt=o.memoizedState),(q=Or||L0(o,c,q,d,it,nt,R))?(ht||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(o.flags|=4194308)):(typeof _.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=d,o.memoizedState=nt),_.props=d,_.state=nt,_.context=R,d=q):(typeof _.componentDidMount=="function"&&(o.flags|=4194308),d=!1)}else{_=o.stateNode,tg(r,o),R=o.memoizedProps,ht=Ja(c,R),_.props=ht,pt=o.pendingProps,it=_.context,nt=c.contextType,q=Xo,typeof nt=="object"&&nt!==null&&(q=Bn(nt)),M=c.getDerivedStateFromProps,(nt=typeof M=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(R!==pt||it!==q)&&B0(o,_,d,q),Or=!1,it=o.memoizedState,_.state=it,Nc(o,d,_,m),Dc();var ot=o.memoizedState;R!==pt||it!==ot||Or||r!==null&&r.dependencies!==null&&Yh(r.dependencies)?(typeof M=="function"&&(Eg(o,c,M,d),ot=o.memoizedState),(ht=Or||L0(o,c,ht,d,it,ot,q)||r!==null&&r.dependencies!==null&&Yh(r.dependencies))?(nt||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(d,ot,q),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(d,ot,q)),typeof _.componentDidUpdate=="function"&&(o.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof _.componentDidUpdate!="function"||R===r.memoizedProps&&it===r.memoizedState||(o.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||R===r.memoizedProps&&it===r.memoizedState||(o.flags|=1024),o.memoizedProps=d,o.memoizedState=ot),_.props=d,_.state=ot,_.context=q,d=ht):(typeof _.componentDidUpdate!="function"||R===r.memoizedProps&&it===r.memoizedState||(o.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||R===r.memoizedProps&&it===r.memoizedState||(o.flags|=1024),d=!1)}return _=d,dd(r,o),d=(o.flags&128)!==0,_||d?(_=o.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:_.render(),o.flags|=1,r!==null&&d?(o.child=sl(o,r.child,null,m),o.child=sl(o,null,c,m)):Cn(r,o,c,m),o.memoizedState=_.state,r=o.child):r=sr(r,o,m),r}function J0(r,o,c,d){return Ac(),o.flags|=256,Cn(r,o,c,d),o.child}var Sg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Cg(r){return{baseLanes:r,cachePool:Uv()}}function Rg(r,o,c){return r=r!==null?r.childLanes&~c:0,o&&(r|=Pi),r}function Z0(r,o,c){var d=o.pendingProps,m=!1,_=(o.flags&128)!==0,R;if((R=_)||(R=r!==null&&r.memoizedState===null?!1:(fn.current&2)!==0),R&&(m=!0,o.flags&=-129),R=(o.flags&32)!==0,o.flags&=-33,r===null){if(he){if(m?Ur(o):Vr(),he){var M=Ue,q;if(q=M){t:{for(q=M,M=fs;q.nodeType!==8;){if(!M){M=null;break t}if(q=Ki(q.nextSibling),q===null){M=null;break t}}M=q}M!==null?(o.memoizedState={dehydrated:M,treeContext:Ga!==null?{id:Js,overflow:Zs}:null,retryLane:536870912,hydrationErrors:null},q=fi(18,null,null,0),q.stateNode=M,q.return=o,o.child=q,Yn=o,Ue=null,q=!0):q=!1}q||Ya(o)}if(M=o.memoizedState,M!==null&&(M=M.dehydrated,M!==null))return um(M)?o.lanes=32:o.lanes=536870912,null;ir(o)}return M=d.children,d=d.fallback,m?(Vr(),m=o.mode,M=fd({mode:"hidden",children:M},m),d=za(d,m,c,null),M.return=o,d.return=o,M.sibling=d,o.child=M,m=o.child,m.memoizedState=Cg(c),m.childLanes=Rg(r,R,c),o.memoizedState=Sg,d):(Ur(o),Ig(o,M))}if(q=r.memoizedState,q!==null&&(M=q.dehydrated,M!==null)){if(_)o.flags&256?(Ur(o),o.flags&=-257,o=xg(r,o,c)):o.memoizedState!==null?(Vr(),o.child=r.child,o.flags|=128,o=null):(Vr(),m=d.fallback,M=o.mode,d=fd({mode:"visible",children:d.children},M),m=za(m,M,c,null),m.flags|=2,d.return=o,m.return=o,d.sibling=m,o.child=d,sl(o,r.child,null,c),d=o.child,d.memoizedState=Cg(c),d.childLanes=Rg(r,R,c),o.memoizedState=Sg,o=m);else if(Ur(o),um(M)){if(R=M.nextSibling&&M.nextSibling.dataset,R)var nt=R.dgst;R=nt,d=Error(n(419)),d.stack="",d.digest=R,wc({value:d,source:null,stack:null}),o=xg(r,o,c)}else if(_n||Tc(r,o,c,!1),R=(c&r.childLanes)!==0,_n||R){if(R=Te,R!==null&&(d=c&-c,d=(d&42)!==0?1:Rr(d),d=(d&(R.suspendedLanes|c))!==0?0:d,d!==0&&d!==q.retryLane))throw q.retryLane=d,Yo(r,d),_i(R,r,d),G0;M.data==="$?"||Yg(),o=xg(r,o,c)}else M.data==="$?"?(o.flags|=192,o.child=r.child,o=null):(r=q.treeContext,Ue=Ki(M.nextSibling),Yn=o,he=!0,$a=null,fs=!1,r!==null&&(Ni[Mi++]=Js,Ni[Mi++]=Zs,Ni[Mi++]=Ga,Js=r.id,Zs=r.overflow,Ga=o),o=Ig(o,d.children),o.flags|=4096);return o}return m?(Vr(),m=d.fallback,M=o.mode,q=r.child,nt=q.sibling,d=Qs(q,{mode:"hidden",children:d.children}),d.subtreeFlags=q.subtreeFlags&65011712,nt!==null?m=Qs(nt,m):(m=za(m,M,c,null),m.flags|=2),m.return=o,d.return=o,d.sibling=m,o.child=d,d=m,m=o.child,M=r.child.memoizedState,M===null?M=Cg(c):(q=M.cachePool,q!==null?(nt=dn._currentValue,q=q.parent!==nt?{parent:nt,pool:nt}:q):q=Uv(),M={baseLanes:M.baseLanes|c,cachePool:q}),m.memoizedState=M,m.childLanes=Rg(r,R,c),o.memoizedState=Sg,d):(Ur(o),c=r.child,r=c.sibling,c=Qs(c,{mode:"visible",children:d.children}),c.return=o,c.sibling=null,r!==null&&(R=o.deletions,R===null?(o.deletions=[r],o.flags|=16):R.push(r)),o.child=c,o.memoizedState=null,c)}function Ig(r,o){return o=fd({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function fd(r,o){return r=fi(22,r,null,o),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function xg(r,o,c){return sl(o,r.child,null,c),r=Ig(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function tb(r,o,c){r.lanes|=o;var d=r.alternate;d!==null&&(d.lanes|=o),Yp(r.return,o,c)}function Dg(r,o,c,d,m){var _=r.memoizedState;_===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:m}:(_.isBackwards=o,_.rendering=null,_.renderingStartTime=0,_.last=d,_.tail=c,_.tailMode=m)}function eb(r,o,c){var d=o.pendingProps,m=d.revealOrder,_=d.tail;if(Cn(r,o,d.children,c),d=fn.current,(d&2)!==0)d=d&1|2,o.flags|=128;else{if(r!==null&&(r.flags&128)!==0)t:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&tb(r,c,o);else if(r.tag===19)tb(r,c,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break t;for(;r.sibling===null;){if(r.return===null||r.return===o)break t;r=r.return}r.sibling.return=r.return,r=r.sibling}d&=1}switch(at(fn,d),m){case"forwards":for(c=o.child,m=null;c!==null;)r=c.alternate,r!==null&&cd(r)===null&&(m=c),c=c.sibling;c=m,c===null?(m=o.child,o.child=null):(m=c.sibling,c.sibling=null),Dg(o,!1,m,c,_);break;case"backwards":for(c=null,m=o.child,o.child=null;m!==null;){if(r=m.alternate,r!==null&&cd(r)===null){o.child=m;break}r=m.sibling,m.sibling=c,c=m,m=r}Dg(o,!0,c,null,_);break;case"together":Dg(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function sr(r,o,c){if(r!==null&&(o.dependencies=r.dependencies),qr|=o.lanes,(c&o.childLanes)===0)if(r!==null){if(Tc(r,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,c=Qs(r,r.pendingProps),o.child=c,c.return=o;r.sibling!==null;)r=r.sibling,c=c.sibling=Qs(r,r.pendingProps),c.return=o;c.sibling=null}return o.child}function Ng(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&Yh(r)))}function gR(r,o,c){switch(o.tag){case 3:xt(o,o.stateNode.containerInfo),Pr(o,dn,r.memoizedState.cache),Ac();break;case 27:case 5:Me(o);break;case 4:xt(o,o.stateNode.containerInfo);break;case 10:Pr(o,o.type,o.memoizedProps.value);break;case 13:var d=o.memoizedState;if(d!==null)return d.dehydrated!==null?(Ur(o),o.flags|=128,null):(c&o.child.childLanes)!==0?Z0(r,o,c):(Ur(o),r=sr(r,o,c),r!==null?r.sibling:null);Ur(o);break;case 19:var m=(r.flags&128)!==0;if(d=(c&o.childLanes)!==0,d||(Tc(r,o,c,!1),d=(c&o.childLanes)!==0),m){if(d)return eb(r,o,c);o.flags|=128}if(m=o.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),at(fn,fn.current),d)break;return null;case 22:case 23:return o.lanes=0,X0(r,o,c);case 24:Pr(o,dn,r.memoizedState.cache)}return sr(r,o,c)}function nb(r,o,c){if(r!==null)if(r.memoizedProps!==o.pendingProps)_n=!0;else{if(!Ng(r,c)&&(o.flags&128)===0)return _n=!1,gR(r,o,c);_n=(r.flags&131072)!==0}else _n=!1,he&&(o.flags&1048576)!==0&&Mv(o,$h,o.index);switch(o.lanes=0,o.tag){case 16:t:{r=o.pendingProps;var d=o.elementType,m=d._init;if(d=m(d._payload),o.type=d,typeof d=="function")Vp(d)?(r=Ja(d,r),o.tag=1,o=Q0(null,o,d,r,c)):(o.tag=0,o=Tg(null,o,d,r,c));else{if(d!=null){if(m=d.$$typeof,m===G){o.tag=11,o=q0(null,o,d,r,c);break t}else if(m===P){o.tag=14,o=$0(null,o,d,r,c);break t}}throw o=Nt(d)||d,Error(n(306,o,""))}}return o;case 0:return Tg(r,o,o.type,o.pendingProps,c);case 1:return d=o.type,m=Ja(d,o.pendingProps),Q0(r,o,d,m,c);case 3:t:{if(xt(o,o.stateNode.containerInfo),r===null)throw Error(n(387));d=o.pendingProps;var _=o.memoizedState;m=_.element,tg(r,o),Nc(o,d,null,c);var R=o.memoizedState;if(d=R.cache,Pr(o,dn,d),d!==_.cache&&Xp(o,[dn],c,!0),Dc(),d=R.element,_.isDehydrated)if(_={element:d,isDehydrated:!1,cache:R.cache},o.updateQueue.baseState=_,o.memoizedState=_,o.flags&256){o=J0(r,o,d,c);break t}else if(d!==m){m=xi(Error(n(424)),o),wc(m),o=J0(r,o,d,c);break t}else{switch(r=o.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Ue=Ki(r.firstChild),Yn=o,he=!0,$a=null,fs=!0,c=P0(o,null,d,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Ac(),d===m){o=sr(r,o,c);break t}Cn(r,o,d,c)}o=o.child}return o;case 26:return dd(r,o),r===null?(c=aE(o.type,null,o.pendingProps,null))?o.memoizedState=c:he||(c=o.type,r=o.pendingProps,d=Rd(Et.current).createElement(c),d[cn]=o,d[Qe]=r,In(d,c,r),ze(d),o.stateNode=d):o.memoizedState=aE(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Me(o),r===null&&he&&(d=o.stateNode=iE(o.type,o.pendingProps,Et.current),Yn=o,fs=!0,m=Ue,Kr(o.type)?(hm=m,Ue=Ki(d.firstChild)):Ue=m),Cn(r,o,o.pendingProps.children,c),dd(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&he&&((m=d=Ue)&&(d=zR(d,o.type,o.pendingProps,fs),d!==null?(o.stateNode=d,Yn=o,Ue=Ki(d.firstChild),fs=!1,m=!0):m=!1),m||Ya(o)),Me(o),m=o.type,_=o.pendingProps,R=r!==null?r.memoizedProps:null,d=_.children,om(m,_)?d=null:R!==null&&om(m,R)&&(o.flags|=32),o.memoizedState!==null&&(m=ag(r,o,oR,null,null,c),Zc._currentValue=m),dd(r,o),Cn(r,o,d,c),o.child;case 6:return r===null&&he&&((r=c=Ue)&&(c=GR(c,o.pendingProps,fs),c!==null?(o.stateNode=c,Yn=o,Ue=null,r=!0):r=!1),r||Ya(o)),null;case 13:return Z0(r,o,c);case 4:return xt(o,o.stateNode.containerInfo),d=o.pendingProps,r===null?o.child=sl(o,null,d,c):Cn(r,o,d,c),o.child;case 11:return q0(r,o,o.type,o.pendingProps,c);case 7:return Cn(r,o,o.pendingProps,c),o.child;case 8:return Cn(r,o,o.pendingProps.children,c),o.child;case 12:return Cn(r,o,o.pendingProps.children,c),o.child;case 10:return d=o.pendingProps,Pr(o,o.type,d.value),Cn(r,o,d.children,c),o.child;case 9:return m=o.type._context,d=o.pendingProps.children,Ka(o),m=Bn(m),d=d(m),o.flags|=1,Cn(r,o,d,c),o.child;case 14:return $0(r,o,o.type,o.pendingProps,c);case 15:return Y0(r,o,o.type,o.pendingProps,c);case 19:return eb(r,o,c);case 31:return d=o.pendingProps,c=o.mode,d={mode:d.mode,children:d.children},r===null?(c=fd(d,c),c.ref=o.ref,o.child=c,c.return=o,o=c):(c=Qs(r.child,d),c.ref=o.ref,o.child=c,c.return=o,o=c),o;case 22:return X0(r,o,c);case 24:return Ka(o),d=Bn(dn),r===null?(m=Qp(),m===null&&(m=Te,_=Kp(),m.pooledCache=_,_.refCount++,_!==null&&(m.pooledCacheLanes|=c),m=_),o.memoizedState={parent:d,cache:m},Zp(o),Pr(o,dn,m)):((r.lanes&c)!==0&&(tg(r,o),Nc(o,null,null,c),Dc()),m=r.memoizedState,_=o.memoizedState,m.parent!==d?(m={parent:d,cache:d},o.memoizedState=m,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=m),Pr(o,dn,d)):(d=_.cache,Pr(o,dn,d),d!==m.cache&&Xp(o,[dn],c,!0))),Cn(r,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function rr(r){r.flags|=4}function ib(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!hE(o)){if(o=ki.current,o!==null&&((ae&4194048)===ae?ps!==null:(ae&62914560)!==ae&&(ae&536870912)===0||o!==ps))throw Ic=Jp,Vv;r.flags|=8192}}function pd(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?ec():536870912,r.lanes|=o,ll|=o)}function Fc(r,o){if(!he)switch(r.tailMode){case"hidden":o=r.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function Pe(r){var o=r.alternate!==null&&r.alternate.child===r.child,c=0,d=0;if(o)for(var m=r.child;m!==null;)c|=m.lanes|m.childLanes,d|=m.subtreeFlags&65011712,d|=m.flags&65011712,m.return=r,m=m.sibling;else for(m=r.child;m!==null;)c|=m.lanes|m.childLanes,d|=m.subtreeFlags,d|=m.flags,m.return=r,m=m.sibling;return r.subtreeFlags|=d,r.childLanes=c,o}function mR(r,o,c){var d=o.pendingProps;switch(Gp(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pe(o),null;case 1:return Pe(o),null;case 3:return c=o.stateNode,d=null,r!==null&&(d=r.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),er(dn),ee(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(Ec(o)?rr(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Ov())),Pe(o),null;case 26:return c=o.memoizedState,r===null?(rr(o),c!==null?(Pe(o),ib(o,c)):(Pe(o),o.flags&=-16777217)):c?c!==r.memoizedState?(rr(o),Pe(o),ib(o,c)):(Pe(o),o.flags&=-16777217):(r.memoizedProps!==d&&rr(o),Pe(o),o.flags&=-16777217),null;case 27:ke(o),c=Et.current;var m=o.type;if(r!==null&&o.stateNode!=null)r.memoizedProps!==d&&rr(o);else{if(!d){if(o.stateNode===null)throw Error(n(166));return Pe(o),null}r=yt.current,Ec(o)?kv(o):(r=iE(m,d,c),o.stateNode=r,rr(o))}return Pe(o),null;case 5:if(ke(o),c=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==d&&rr(o);else{if(!d){if(o.stateNode===null)throw Error(n(166));return Pe(o),null}if(r=yt.current,Ec(o))kv(o);else{switch(m=Rd(Et.current),r){case 1:r=m.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:r=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":r=m.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":r=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":r=m.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof d.is=="string"?m.createElement("select",{is:d.is}):m.createElement("select"),d.multiple?r.multiple=!0:d.size&&(r.size=d.size);break;default:r=typeof d.is=="string"?m.createElement(c,{is:d.is}):m.createElement(c)}}r[cn]=o,r[Qe]=d;t:for(m=o.child;m!==null;){if(m.tag===5||m.tag===6)r.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===o)break t;for(;m.sibling===null;){if(m.return===null||m.return===o)break t;m=m.return}m.sibling.return=m.return,m=m.sibling}o.stateNode=r;t:switch(In(r,c,d),c){case"button":case"input":case"select":case"textarea":r=!!d.autoFocus;break t;case"img":r=!0;break t;default:r=!1}r&&rr(o)}}return Pe(o),o.flags&=-16777217,null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==d&&rr(o);else{if(typeof d!="string"&&o.stateNode===null)throw Error(n(166));if(r=Et.current,Ec(o)){if(r=o.stateNode,c=o.memoizedProps,d=null,m=Yn,m!==null)switch(m.tag){case 27:case 5:d=m.memoizedProps}r[cn]=o,r=!!(r.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||Wb(r.nodeValue,c)),r||Ya(o)}else r=Rd(r).createTextNode(d),r[cn]=o,o.stateNode=r}return Pe(o),null;case 13:if(d=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(m=Ec(o),d!==null&&d.dehydrated!==null){if(r===null){if(!m)throw Error(n(318));if(m=o.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(n(317));m[cn]=o}else Ac(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Pe(o),m=!1}else m=Ov(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=m),m=!0;if(!m)return o.flags&256?(ir(o),o):(ir(o),null)}if(ir(o),(o.flags&128)!==0)return o.lanes=c,o;if(c=d!==null,r=r!==null&&r.memoizedState!==null,c){d=o.child,m=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(m=d.alternate.memoizedState.cachePool.pool);var _=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(_=d.memoizedState.cachePool.pool),_!==m&&(d.flags|=2048)}return c!==r&&c&&(o.child.flags|=8192),pd(o,o.updateQueue),Pe(o),null;case 4:return ee(),r===null&&nm(o.stateNode.containerInfo),Pe(o),null;case 10:return er(o.type),Pe(o),null;case 19:if(Q(fn),m=o.memoizedState,m===null)return Pe(o),null;if(d=(o.flags&128)!==0,_=m.rendering,_===null)if(d)Fc(m,!1);else{if(Ve!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(_=cd(r),_!==null){for(o.flags|=128,Fc(m,!1),r=_.updateQueue,o.updateQueue=r,pd(o,r),o.subtreeFlags=0,r=c,c=o.child;c!==null;)Nv(c,r),c=c.sibling;return at(fn,fn.current&1|2),o.child}r=r.sibling}m.tail!==null&&Fe()>yd&&(o.flags|=128,d=!0,Fc(m,!1),o.lanes=4194304)}else{if(!d)if(r=cd(_),r!==null){if(o.flags|=128,d=!0,r=r.updateQueue,o.updateQueue=r,pd(o,r),Fc(m,!0),m.tail===null&&m.tailMode==="hidden"&&!_.alternate&&!he)return Pe(o),null}else 2*Fe()-m.renderingStartTime>yd&&c!==536870912&&(o.flags|=128,d=!0,Fc(m,!1),o.lanes=4194304);m.isBackwards?(_.sibling=o.child,o.child=_):(r=m.last,r!==null?r.sibling=_:o.child=_,m.last=_)}return m.tail!==null?(o=m.tail,m.rendering=o,m.tail=o.sibling,m.renderingStartTime=Fe(),o.sibling=null,r=fn.current,at(fn,d?r&1|2:r&1),o):(Pe(o),null);case 22:case 23:return ir(o),sg(),d=o.memoizedState!==null,r!==null?r.memoizedState!==null!==d&&(o.flags|=8192):d&&(o.flags|=8192),d?(c&536870912)!==0&&(o.flags&128)===0&&(Pe(o),o.subtreeFlags&6&&(o.flags|=8192)):Pe(o),c=o.updateQueue,c!==null&&pd(o,c.retryQueue),c=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),d=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(d=o.memoizedState.cachePool.pool),d!==c&&(o.flags|=2048),r!==null&&Q(Wa),null;case 24:return c=null,r!==null&&(c=r.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),er(dn),Pe(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function yR(r,o){switch(Gp(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return er(dn),ee(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return ke(o),null;case 13:if(ir(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Ac()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return Q(fn),null;case 4:return ee(),null;case 10:return er(o.type),null;case 22:case 23:return ir(o),sg(),r!==null&&Q(Wa),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return er(dn),null;case 25:return null;default:return null}}function sb(r,o){switch(Gp(o),o.tag){case 3:er(dn),ee();break;case 26:case 27:case 5:ke(o);break;case 4:ee();break;case 13:ir(o);break;case 19:Q(fn);break;case 10:er(o.type);break;case 22:case 23:ir(o),sg(),r!==null&&Q(Wa);break;case 24:er(dn)}}function Uc(r,o){try{var c=o.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var m=d.next;c=m;do{if((c.tag&r)===r){d=void 0;var _=c.create,R=c.inst;d=_(),R.destroy=d}c=c.next}while(c!==m)}}catch(M){Ae(o,o.return,M)}}function jr(r,o,c){try{var d=o.updateQueue,m=d!==null?d.lastEffect:null;if(m!==null){var _=m.next;d=_;do{if((d.tag&r)===r){var R=d.inst,M=R.destroy;if(M!==void 0){R.destroy=void 0,m=o;var q=c,nt=M;try{nt()}catch(ht){Ae(m,q,ht)}}}d=d.next}while(d!==_)}}catch(ht){Ae(o,o.return,ht)}}function rb(r){var o=r.updateQueue;if(o!==null){var c=r.stateNode;try{$v(o,c)}catch(d){Ae(r,r.return,d)}}}function ab(r,o,c){c.props=Ja(r.type,r.memoizedProps),c.state=r.memoizedState;try{c.componentWillUnmount()}catch(d){Ae(r,o,d)}}function Vc(r,o){try{var c=r.ref;if(c!==null){switch(r.tag){case 26:case 27:case 5:var d=r.stateNode;break;case 30:d=r.stateNode;break;default:d=r.stateNode}typeof c=="function"?r.refCleanup=c(d):c.current=d}}catch(m){Ae(r,o,m)}}function gs(r,o){var c=r.ref,d=r.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(m){Ae(r,o,m)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(m){Ae(r,o,m)}else c.current=null}function ob(r){var o=r.type,c=r.memoizedProps,d=r.stateNode;try{t:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break t;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(m){Ae(r,r.return,m)}}function Mg(r,o,c){try{var d=r.stateNode;FR(d,r.type,c,o),d[Qe]=o}catch(m){Ae(r,r.return,m)}}function lb(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Kr(r.type)||r.tag===4}function kg(r){t:for(;;){for(;r.sibling===null;){if(r.return===null||lb(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Kr(r.type)||r.flags&2||r.child===null||r.tag===4)continue t;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Pg(r,o,c){var d=r.tag;if(d===5||d===6)r=r.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(r,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(r),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=Cd));else if(d!==4&&(d===27&&Kr(r.type)&&(c=r.stateNode,o=null),r=r.child,r!==null))for(Pg(r,o,c),r=r.sibling;r!==null;)Pg(r,o,c),r=r.sibling}function gd(r,o,c){var d=r.tag;if(d===5||d===6)r=r.stateNode,o?c.insertBefore(r,o):c.appendChild(r);else if(d!==4&&(d===27&&Kr(r.type)&&(c=r.stateNode),r=r.child,r!==null))for(gd(r,o,c),r=r.sibling;r!==null;)gd(r,o,c),r=r.sibling}function cb(r){var o=r.stateNode,c=r.memoizedProps;try{for(var d=r.type,m=o.attributes;m.length;)o.removeAttributeNode(m[0]);In(o,d,c),o[cn]=r,o[Qe]=c}catch(_){Ae(r,r.return,_)}}var ar=!1,qe=!1,Og=!1,ub=typeof WeakSet=="function"?WeakSet:Set,vn=null;function _R(r,o){if(r=r.containerInfo,rm=kd,r=Ev(r),kp(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else t:{c=(c=r.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var m=d.anchorOffset,_=d.focusNode;d=d.focusOffset;try{c.nodeType,_.nodeType}catch{c=null;break t}var R=0,M=-1,q=-1,nt=0,ht=0,pt=r,it=null;e:for(;;){for(var ot;pt!==c||m!==0&&pt.nodeType!==3||(M=R+m),pt!==_||d!==0&&pt.nodeType!==3||(q=R+d),pt.nodeType===3&&(R+=pt.nodeValue.length),(ot=pt.firstChild)!==null;)it=pt,pt=ot;for(;;){if(pt===r)break e;if(it===c&&++nt===m&&(M=R),it===_&&++ht===d&&(q=R),(ot=pt.nextSibling)!==null)break;pt=it,it=pt.parentNode}pt=ot}c=M===-1||q===-1?null:{start:M,end:q}}else c=null}c=c||{start:0,end:0}}else c=null;for(am={focusedElem:r,selectionRange:c},kd=!1,vn=o;vn!==null;)if(o=vn,r=o.child,(o.subtreeFlags&1024)!==0&&r!==null)r.return=o,vn=r;else for(;vn!==null;){switch(o=vn,_=o.alternate,r=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&_!==null){r=void 0,c=o,m=_.memoizedProps,_=_.memoizedState,d=c.stateNode;try{var Vt=Ja(c.type,m,c.elementType===c.type);r=d.getSnapshotBeforeUpdate(Vt,_),d.__reactInternalSnapshotBeforeUpdate=r}catch(Ot){Ae(c,c.return,Ot)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,c=r.nodeType,c===9)cm(r);else if(c===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":cm(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=o.sibling,r!==null){r.return=o.return,vn=r;break}vn=o.return}}function hb(r,o,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:Hr(r,c),d&4&&Uc(5,c);break;case 1:if(Hr(r,c),d&4)if(r=c.stateNode,o===null)try{r.componentDidMount()}catch(R){Ae(c,c.return,R)}else{var m=Ja(c.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(m,o,r.__reactInternalSnapshotBeforeUpdate)}catch(R){Ae(c,c.return,R)}}d&64&&rb(c),d&512&&Vc(c,c.return);break;case 3:if(Hr(r,c),d&64&&(r=c.updateQueue,r!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{$v(r,o)}catch(R){Ae(c,c.return,R)}}break;case 27:o===null&&d&4&&cb(c);case 26:case 5:Hr(r,c),o===null&&d&4&&ob(c),d&512&&Vc(c,c.return);break;case 12:Hr(r,c);break;case 13:Hr(r,c),d&4&&pb(r,c),d&64&&(r=c.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(c=RR.bind(null,c),qR(r,c))));break;case 22:if(d=c.memoizedState!==null||ar,!d){o=o!==null&&o.memoizedState!==null||qe,m=ar;var _=qe;ar=d,(qe=o)&&!_?zr(r,c,(c.subtreeFlags&8772)!==0):Hr(r,c),ar=m,qe=_}break;case 30:break;default:Hr(r,c)}}function db(r){var o=r.alternate;o!==null&&(r.alternate=null,db(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&Dr(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Ie=null,ni=!1;function or(r,o,c){for(c=c.child;c!==null;)fb(r,o,c),c=c.sibling}function fb(r,o,c){if(D&&typeof D.onCommitFiberUnmount=="function")try{D.onCommitFiberUnmount(Ce,c)}catch{}switch(c.tag){case 26:qe||gs(c,o),or(r,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:qe||gs(c,o);var d=Ie,m=ni;Kr(c.type)&&(Ie=c.stateNode,ni=!1),or(r,o,c),Kc(c.stateNode),Ie=d,ni=m;break;case 5:qe||gs(c,o);case 6:if(d=Ie,m=ni,Ie=null,or(r,o,c),Ie=d,ni=m,Ie!==null)if(ni)try{(Ie.nodeType===9?Ie.body:Ie.nodeName==="HTML"?Ie.ownerDocument.body:Ie).removeChild(c.stateNode)}catch(_){Ae(c,o,_)}else try{Ie.removeChild(c.stateNode)}catch(_){Ae(c,o,_)}break;case 18:Ie!==null&&(ni?(r=Ie,eE(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,c.stateNode),iu(r)):eE(Ie,c.stateNode));break;case 4:d=Ie,m=ni,Ie=c.stateNode.containerInfo,ni=!0,or(r,o,c),Ie=d,ni=m;break;case 0:case 11:case 14:case 15:qe||jr(2,c,o),qe||jr(4,c,o),or(r,o,c);break;case 1:qe||(gs(c,o),d=c.stateNode,typeof d.componentWillUnmount=="function"&&ab(c,o,d)),or(r,o,c);break;case 21:or(r,o,c);break;case 22:qe=(d=qe)||c.memoizedState!==null,or(r,o,c),qe=d;break;default:or(r,o,c)}}function pb(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{iu(r)}catch(c){Ae(o,o.return,c)}}function vR(r){switch(r.tag){case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new ub),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new ub),o;default:throw Error(n(435,r.tag))}}function Lg(r,o){var c=vR(r);o.forEach(function(d){var m=IR.bind(null,r,d);c.has(d)||(c.add(d),d.then(m,m))})}function pi(r,o){var c=o.deletions;if(c!==null)for(var d=0;d<c.length;d++){var m=c[d],_=r,R=o,M=R;t:for(;M!==null;){switch(M.tag){case 27:if(Kr(M.type)){Ie=M.stateNode,ni=!1;break t}break;case 5:Ie=M.stateNode,ni=!1;break t;case 3:case 4:Ie=M.stateNode.containerInfo,ni=!0;break t}M=M.return}if(Ie===null)throw Error(n(160));fb(_,R,m),Ie=null,ni=!1,_=m.alternate,_!==null&&(_.return=null),m.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)gb(o,r),o=o.sibling}var Xi=null;function gb(r,o){var c=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:pi(o,r),gi(r),d&4&&(jr(3,r,r.return),Uc(3,r),jr(5,r,r.return));break;case 1:pi(o,r),gi(r),d&512&&(qe||c===null||gs(c,c.return)),d&64&&ar&&(r=r.updateQueue,r!==null&&(d=r.callbacks,d!==null&&(c=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var m=Xi;if(pi(o,r),gi(r),d&512&&(qe||c===null||gs(c,c.return)),d&4){var _=c!==null?c.memoizedState:null;if(d=r.memoizedState,c===null)if(d===null)if(r.stateNode===null){t:{d=r.type,c=r.memoizedProps,m=m.ownerDocument||m;e:switch(d){case"title":_=m.getElementsByTagName("title")[0],(!_||_[Ra]||_[cn]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=m.createElement(d),m.head.insertBefore(_,m.querySelector("head > title"))),In(_,d,c),_[cn]=r,ze(_),d=_;break t;case"link":var R=cE("link","href",m).get(d+(c.href||""));if(R){for(var M=0;M<R.length;M++)if(_=R[M],_.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&_.getAttribute("rel")===(c.rel==null?null:c.rel)&&_.getAttribute("title")===(c.title==null?null:c.title)&&_.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){R.splice(M,1);break e}}_=m.createElement(d),In(_,d,c),m.head.appendChild(_);break;case"meta":if(R=cE("meta","content",m).get(d+(c.content||""))){for(M=0;M<R.length;M++)if(_=R[M],_.getAttribute("content")===(c.content==null?null:""+c.content)&&_.getAttribute("name")===(c.name==null?null:c.name)&&_.getAttribute("property")===(c.property==null?null:c.property)&&_.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&_.getAttribute("charset")===(c.charSet==null?null:c.charSet)){R.splice(M,1);break e}}_=m.createElement(d),In(_,d,c),m.head.appendChild(_);break;default:throw Error(n(468,d))}_[cn]=r,ze(_),d=_}r.stateNode=d}else uE(m,r.type,r.stateNode);else r.stateNode=lE(m,d,r.memoizedProps);else _!==d?(_===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):_.count--,d===null?uE(m,r.type,r.stateNode):lE(m,d,r.memoizedProps)):d===null&&r.stateNode!==null&&Mg(r,r.memoizedProps,c.memoizedProps)}break;case 27:pi(o,r),gi(r),d&512&&(qe||c===null||gs(c,c.return)),c!==null&&d&4&&Mg(r,r.memoizedProps,c.memoizedProps);break;case 5:if(pi(o,r),gi(r),d&512&&(qe||c===null||gs(c,c.return)),r.flags&32){m=r.stateNode;try{Si(m,"")}catch(ot){Ae(r,r.return,ot)}}d&4&&r.stateNode!=null&&(m=r.memoizedProps,Mg(r,m,c!==null?c.memoizedProps:m)),d&1024&&(Og=!0);break;case 6:if(pi(o,r),gi(r),d&4){if(r.stateNode===null)throw Error(n(162));d=r.memoizedProps,c=r.stateNode;try{c.nodeValue=d}catch(ot){Ae(r,r.return,ot)}}break;case 3:if(Dd=null,m=Xi,Xi=Id(o.containerInfo),pi(o,r),Xi=m,gi(r),d&4&&c!==null&&c.memoizedState.isDehydrated)try{iu(o.containerInfo)}catch(ot){Ae(r,r.return,ot)}Og&&(Og=!1,mb(r));break;case 4:d=Xi,Xi=Id(r.stateNode.containerInfo),pi(o,r),gi(r),Xi=d;break;case 12:pi(o,r),gi(r);break;case 13:pi(o,r),gi(r),r.child.flags&8192&&r.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Hg=Fe()),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Lg(r,d)));break;case 22:m=r.memoizedState!==null;var q=c!==null&&c.memoizedState!==null,nt=ar,ht=qe;if(ar=nt||m,qe=ht||q,pi(o,r),qe=ht,ar=nt,gi(r),d&8192)t:for(o=r.stateNode,o._visibility=m?o._visibility&-2:o._visibility|1,m&&(c===null||q||ar||qe||Za(r)),c=null,o=r;;){if(o.tag===5||o.tag===26){if(c===null){q=c=o;try{if(_=q.stateNode,m)R=_.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{M=q.stateNode;var pt=q.memoizedProps.style,it=pt!=null&&pt.hasOwnProperty("display")?pt.display:null;M.style.display=it==null||typeof it=="boolean"?"":(""+it).trim()}}catch(ot){Ae(q,q.return,ot)}}}else if(o.tag===6){if(c===null){q=o;try{q.stateNode.nodeValue=m?"":q.memoizedProps}catch(ot){Ae(q,q.return,ot)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break t;for(;o.sibling===null;){if(o.return===null||o.return===r)break t;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}d&4&&(d=r.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,Lg(r,c))));break;case 19:pi(o,r),gi(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Lg(r,d)));break;case 30:break;case 21:break;default:pi(o,r),gi(r)}}function gi(r){var o=r.flags;if(o&2){try{for(var c,d=r.return;d!==null;){if(lb(d)){c=d;break}d=d.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var m=c.stateNode,_=kg(r);gd(r,_,m);break;case 5:var R=c.stateNode;c.flags&32&&(Si(R,""),c.flags&=-33);var M=kg(r);gd(r,M,R);break;case 3:case 4:var q=c.stateNode.containerInfo,nt=kg(r);Pg(r,nt,q);break;default:throw Error(n(161))}}catch(ht){Ae(r,r.return,ht)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function mb(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;mb(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function Hr(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)hb(r,o.alternate,o),o=o.sibling}function Za(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:jr(4,o,o.return),Za(o);break;case 1:gs(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&ab(o,o.return,c),Za(o);break;case 27:Kc(o.stateNode);case 26:case 5:gs(o,o.return),Za(o);break;case 22:o.memoizedState===null&&Za(o);break;case 30:Za(o);break;default:Za(o)}r=r.sibling}}function zr(r,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var d=o.alternate,m=r,_=o,R=_.flags;switch(_.tag){case 0:case 11:case 15:zr(m,_,c),Uc(4,_);break;case 1:if(zr(m,_,c),d=_,m=d.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(nt){Ae(d,d.return,nt)}if(d=_,m=d.updateQueue,m!==null){var M=d.stateNode;try{var q=m.shared.hiddenCallbacks;if(q!==null)for(m.shared.hiddenCallbacks=null,m=0;m<q.length;m++)qv(q[m],M)}catch(nt){Ae(d,d.return,nt)}}c&&R&64&&rb(_),Vc(_,_.return);break;case 27:cb(_);case 26:case 5:zr(m,_,c),c&&d===null&&R&4&&ob(_),Vc(_,_.return);break;case 12:zr(m,_,c);break;case 13:zr(m,_,c),c&&R&4&&pb(m,_);break;case 22:_.memoizedState===null&&zr(m,_,c),Vc(_,_.return);break;case 30:break;default:zr(m,_,c)}o=o.sibling}}function Bg(r,o){var c=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==c&&(r!=null&&r.refCount++,c!=null&&Sc(c))}function Fg(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Sc(r))}function ms(r,o,c,d){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)yb(r,o,c,d),o=o.sibling}function yb(r,o,c,d){var m=o.flags;switch(o.tag){case 0:case 11:case 15:ms(r,o,c,d),m&2048&&Uc(9,o);break;case 1:ms(r,o,c,d);break;case 3:ms(r,o,c,d),m&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Sc(r)));break;case 12:if(m&2048){ms(r,o,c,d),r=o.stateNode;try{var _=o.memoizedProps,R=_.id,M=_.onPostCommit;typeof M=="function"&&M(R,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(q){Ae(o,o.return,q)}}else ms(r,o,c,d);break;case 13:ms(r,o,c,d);break;case 23:break;case 22:_=o.stateNode,R=o.alternate,o.memoizedState!==null?_._visibility&2?ms(r,o,c,d):jc(r,o):_._visibility&2?ms(r,o,c,d):(_._visibility|=2,rl(r,o,c,d,(o.subtreeFlags&10256)!==0)),m&2048&&Bg(R,o);break;case 24:ms(r,o,c,d),m&2048&&Fg(o.alternate,o);break;default:ms(r,o,c,d)}}function rl(r,o,c,d,m){for(m=m&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var _=r,R=o,M=c,q=d,nt=R.flags;switch(R.tag){case 0:case 11:case 15:rl(_,R,M,q,m),Uc(8,R);break;case 23:break;case 22:var ht=R.stateNode;R.memoizedState!==null?ht._visibility&2?rl(_,R,M,q,m):jc(_,R):(ht._visibility|=2,rl(_,R,M,q,m)),m&&nt&2048&&Bg(R.alternate,R);break;case 24:rl(_,R,M,q,m),m&&nt&2048&&Fg(R.alternate,R);break;default:rl(_,R,M,q,m)}o=o.sibling}}function jc(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=r,d=o,m=d.flags;switch(d.tag){case 22:jc(c,d),m&2048&&Bg(d.alternate,d);break;case 24:jc(c,d),m&2048&&Fg(d.alternate,d);break;default:jc(c,d)}o=o.sibling}}var Hc=8192;function al(r){if(r.subtreeFlags&Hc)for(r=r.child;r!==null;)_b(r),r=r.sibling}function _b(r){switch(r.tag){case 26:al(r),r.flags&Hc&&r.memoizedState!==null&&sI(Xi,r.memoizedState,r.memoizedProps);break;case 5:al(r);break;case 3:case 4:var o=Xi;Xi=Id(r.stateNode.containerInfo),al(r),Xi=o;break;case 22:r.memoizedState===null&&(o=r.alternate,o!==null&&o.memoizedState!==null?(o=Hc,Hc=16777216,al(r),Hc=o):al(r));break;default:al(r)}}function vb(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function zc(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var d=o[c];vn=d,Eb(d,r)}vb(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)bb(r),r=r.sibling}function bb(r){switch(r.tag){case 0:case 11:case 15:zc(r),r.flags&2048&&jr(9,r,r.return);break;case 3:zc(r);break;case 12:zc(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,md(r)):zc(r);break;default:zc(r)}}function md(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var d=o[c];vn=d,Eb(d,r)}vb(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:jr(8,o,o.return),md(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,md(o));break;default:md(o)}r=r.sibling}}function Eb(r,o){for(;vn!==null;){var c=vn;switch(c.tag){case 0:case 11:case 15:jr(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Sc(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,vn=d;else t:for(c=r;vn!==null;){d=vn;var m=d.sibling,_=d.return;if(db(d),d===c){vn=null;break t}if(m!==null){m.return=_,vn=m;break t}vn=_}}}var bR={getCacheForType:function(r){var o=Bn(dn),c=o.data.get(r);return c===void 0&&(c=r(),o.data.set(r,c)),c}},ER=typeof WeakMap=="function"?WeakMap:Map,ge=0,Te=null,Wt=null,ae=0,me=0,mi=null,Gr=!1,ol=!1,Ug=!1,lr=0,Ve=0,qr=0,to=0,Vg=0,Pi=0,ll=0,Gc=null,ii=null,jg=!1,Hg=0,yd=1/0,_d=null,$r=null,Rn=0,Yr=null,cl=null,ul=0,zg=0,Gg=null,Ab=null,qc=0,qg=null;function yi(){if((ge&2)!==0&&ae!==0)return ae&-ae;if(J.T!==null){var r=Qo;return r!==0?r:Jg()}return Ir()}function wb(){Pi===0&&(Pi=(ae&536870912)===0||he?tc():536870912);var r=ki.current;return r!==null&&(r.flags|=32),Pi}function _i(r,o,c){(r===Te&&(me===2||me===9)||r.cancelPendingCommit!==null)&&(hl(r,0),Xr(r,ae,Pi,!1)),Vs(r,c),((ge&2)===0||r!==Te)&&(r===Te&&((ge&2)===0&&(to|=c),Ve===4&&Xr(r,ae,Pi,!1)),ys(r))}function Tb(r,o,c){if((ge&6)!==0)throw Error(n(327));var d=!c&&(o&124)===0&&(o&r.expiredLanes)===0||de(r,o),m=d?TR(r,o):Xg(r,o,!0),_=d;do{if(m===0){ol&&!d&&Xr(r,o,0,!1);break}else{if(c=r.current.alternate,_&&!AR(c)){m=Xg(r,o,!1),_=!1;continue}if(m===2){if(_=o,r.errorRecoveryDisabledLanes&_)var R=0;else R=r.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){o=R;t:{var M=r;m=Gc;var q=M.current.memoizedState.isDehydrated;if(q&&(hl(M,R).flags|=256),R=Xg(M,R,!1),R!==2){if(Ug&&!q){M.errorRecoveryDisabledLanes|=_,to|=_,m=4;break t}_=ii,ii=m,_!==null&&(ii===null?ii=_:ii.push.apply(ii,_))}m=R}if(_=!1,m!==2)continue}}if(m===1){hl(r,0),Xr(r,o,0,!0);break}t:{switch(d=r,_=m,_){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:Xr(d,o,Pi,!Gr);break t;case 2:ii=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(m=Hg+300-Fe(),10<m)){if(Xr(d,o,Pi,!Gr),ue(d,0,!0)!==0)break t;d.timeoutHandle=Zb(Sb.bind(null,d,c,ii,_d,jg,o,Pi,to,ll,Gr,_,2,-0,0),m);break t}Sb(d,c,ii,_d,jg,o,Pi,to,ll,Gr,_,0,-0,0)}}break}while(!0);ys(r)}function Sb(r,o,c,d,m,_,R,M,q,nt,ht,pt,it,ot){if(r.timeoutHandle=-1,pt=o.subtreeFlags,(pt&8192||(pt&16785408)===16785408)&&(Jc={stylesheets:null,count:0,unsuspend:iI},_b(o),pt=rI(),pt!==null)){r.cancelPendingCommit=pt(Mb.bind(null,r,o,_,c,d,m,R,M,q,ht,1,it,ot)),Xr(r,_,R,!nt);return}Mb(r,o,_,c,d,m,R,M,q)}function AR(r){for(var o=r;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var m=c[d],_=m.getSnapshot;m=m.value;try{if(!di(_(),m))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Xr(r,o,c,d){o&=~Vg,o&=~to,r.suspendedLanes|=o,r.pingedLanes&=~o,d&&(r.warmLanes|=o),d=r.expirationTimes;for(var m=o;0<m;){var _=31-w(m),R=1<<_;d[_]=-1,m&=~R}c!==0&&ns(r,c,o)}function vd(){return(ge&6)===0?($c(0),!1):!0}function $g(){if(Wt!==null){if(me===0)var r=Wt.return;else r=Wt,tr=Xa=null,cg(r),il=null,Lc=0,r=Wt;for(;r!==null;)sb(r.alternate,r),r=r.return;Wt=null}}function hl(r,o){var c=r.timeoutHandle;c!==-1&&(r.timeoutHandle=-1,VR(c)),c=r.cancelPendingCommit,c!==null&&(r.cancelPendingCommit=null,c()),$g(),Te=r,Wt=c=Qs(r.current,null),ae=o,me=0,mi=null,Gr=!1,ol=de(r,o),Ug=!1,ll=Pi=Vg=to=qr=Ve=0,ii=Gc=null,jg=!1,(o&8)!==0&&(o|=o&32);var d=r.entangledLanes;if(d!==0)for(r=r.entanglements,d&=o;0<d;){var m=31-w(d),_=1<<m;o|=r[m],d&=~_}return lr=o,jh(),c}function Cb(r,o){Yt=null,J.H=ad,o===Rc||o===Wh?(o=zv(),me=3):o===Vv?(o=zv(),me=4):me=o===G0?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,mi=o,Wt===null&&(Ve=1,hd(r,xi(o,r.current)))}function Rb(){var r=J.H;return J.H=ad,r===null?ad:r}function Ib(){var r=J.A;return J.A=bR,r}function Yg(){Ve=4,Gr||(ae&4194048)!==ae&&ki.current!==null||(ol=!0),(qr&134217727)===0&&(to&134217727)===0||Te===null||Xr(Te,ae,Pi,!1)}function Xg(r,o,c){var d=ge;ge|=2;var m=Rb(),_=Ib();(Te!==r||ae!==o)&&(_d=null,hl(r,o)),o=!1;var R=Ve;t:do try{if(me!==0&&Wt!==null){var M=Wt,q=mi;switch(me){case 8:$g(),R=6;break t;case 3:case 2:case 9:case 6:ki.current===null&&(o=!0);var nt=me;if(me=0,mi=null,dl(r,M,q,nt),c&&ol){R=0;break t}break;default:nt=me,me=0,mi=null,dl(r,M,q,nt)}}wR(),R=Ve;break}catch(ht){Cb(r,ht)}while(!0);return o&&r.shellSuspendCounter++,tr=Xa=null,ge=d,J.H=m,J.A=_,Wt===null&&(Te=null,ae=0,jh()),R}function wR(){for(;Wt!==null;)xb(Wt)}function TR(r,o){var c=ge;ge|=2;var d=Rb(),m=Ib();Te!==r||ae!==o?(_d=null,yd=Fe()+500,hl(r,o)):ol=de(r,o);t:do try{if(me!==0&&Wt!==null){o=Wt;var _=mi;e:switch(me){case 1:me=0,mi=null,dl(r,o,_,1);break;case 2:case 9:if(jv(_)){me=0,mi=null,Db(o);break}o=function(){me!==2&&me!==9||Te!==r||(me=7),ys(r)},_.then(o,o);break t;case 3:me=7;break t;case 4:me=5;break t;case 7:jv(_)?(me=0,mi=null,Db(o)):(me=0,mi=null,dl(r,o,_,7));break;case 5:var R=null;switch(Wt.tag){case 26:R=Wt.memoizedState;case 5:case 27:var M=Wt;if(!R||hE(R)){me=0,mi=null;var q=M.sibling;if(q!==null)Wt=q;else{var nt=M.return;nt!==null?(Wt=nt,bd(nt)):Wt=null}break e}}me=0,mi=null,dl(r,o,_,5);break;case 6:me=0,mi=null,dl(r,o,_,6);break;case 8:$g(),Ve=6;break t;default:throw Error(n(462))}}SR();break}catch(ht){Cb(r,ht)}while(!0);return tr=Xa=null,J.H=d,J.A=m,ge=c,Wt!==null?0:(Te=null,ae=0,jh(),Ve)}function SR(){for(;Wt!==null&&!ci();)xb(Wt)}function xb(r){var o=nb(r.alternate,r,lr);r.memoizedProps=r.pendingProps,o===null?bd(r):Wt=o}function Db(r){var o=r,c=o.alternate;switch(o.tag){case 15:case 0:o=W0(c,o,o.pendingProps,o.type,void 0,ae);break;case 11:o=W0(c,o,o.pendingProps,o.type.render,o.ref,ae);break;case 5:cg(o);default:sb(c,o),o=Wt=Nv(o,lr),o=nb(c,o,lr)}r.memoizedProps=r.pendingProps,o===null?bd(r):Wt=o}function dl(r,o,c,d){tr=Xa=null,cg(o),il=null,Lc=0;var m=o.return;try{if(pR(r,m,o,c,ae)){Ve=1,hd(r,xi(c,r.current)),Wt=null;return}}catch(_){if(m!==null)throw Wt=m,_;Ve=1,hd(r,xi(c,r.current)),Wt=null;return}o.flags&32768?(he||d===1?r=!0:ol||(ae&536870912)!==0?r=!1:(Gr=r=!0,(d===2||d===9||d===3||d===6)&&(d=ki.current,d!==null&&d.tag===13&&(d.flags|=16384))),Nb(o,r)):bd(o)}function bd(r){var o=r;do{if((o.flags&32768)!==0){Nb(o,Gr);return}r=o.return;var c=mR(o.alternate,o,lr);if(c!==null){Wt=c;return}if(o=o.sibling,o!==null){Wt=o;return}Wt=o=r}while(o!==null);Ve===0&&(Ve=5)}function Nb(r,o){do{var c=yR(r.alternate,r);if(c!==null){c.flags&=32767,Wt=c;return}if(c=r.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(r=r.sibling,r!==null)){Wt=r;return}Wt=r=c}while(r!==null);Ve=6,Wt=null}function Mb(r,o,c,d,m,_,R,M,q){r.cancelPendingCommit=null;do Ed();while(Rn!==0);if((ge&6)!==0)throw Error(n(327));if(o!==null){if(o===r.current)throw Error(n(177));if(_=o.lanes|o.childLanes,_|=Fp,nc(r,c,_,R,M,q),r===Te&&(Wt=Te=null,ae=0),cl=o,Yr=r,ul=c,zg=_,Gg=m,Ab=d,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,xR(ti,function(){return Bb(),null})):(r.callbackNode=null,r.callbackPriority=0),d=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||d){d=J.T,J.T=null,m=ct.p,ct.p=2,R=ge,ge|=4;try{_R(r,o,c)}finally{ge=R,ct.p=m,J.T=d}}Rn=1,kb(),Pb(),Ob()}}function kb(){if(Rn===1){Rn=0;var r=Yr,o=cl,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=J.T,J.T=null;var d=ct.p;ct.p=2;var m=ge;ge|=4;try{gb(o,r);var _=am,R=Ev(r.containerInfo),M=_.focusedElem,q=_.selectionRange;if(R!==M&&M&&M.ownerDocument&&bv(M.ownerDocument.documentElement,M)){if(q!==null&&kp(M)){var nt=q.start,ht=q.end;if(ht===void 0&&(ht=nt),"selectionStart"in M)M.selectionStart=nt,M.selectionEnd=Math.min(ht,M.value.length);else{var pt=M.ownerDocument||document,it=pt&&pt.defaultView||window;if(it.getSelection){var ot=it.getSelection(),Vt=M.textContent.length,Ot=Math.min(q.start,Vt),be=q.end===void 0?Ot:Math.min(q.end,Vt);!ot.extend&&Ot>be&&(R=be,be=Ot,Ot=R);var Z=vv(M,Ot),X=vv(M,be);if(Z&&X&&(ot.rangeCount!==1||ot.anchorNode!==Z.node||ot.anchorOffset!==Z.offset||ot.focusNode!==X.node||ot.focusOffset!==X.offset)){var et=pt.createRange();et.setStart(Z.node,Z.offset),ot.removeAllRanges(),Ot>be?(ot.addRange(et),ot.extend(X.node,X.offset)):(et.setEnd(X.node,X.offset),ot.addRange(et))}}}}for(pt=[],ot=M;ot=ot.parentNode;)ot.nodeType===1&&pt.push({element:ot,left:ot.scrollLeft,top:ot.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<pt.length;M++){var ft=pt[M];ft.element.scrollLeft=ft.left,ft.element.scrollTop=ft.top}}kd=!!rm,am=rm=null}finally{ge=m,ct.p=d,J.T=c}}r.current=o,Rn=2}}function Pb(){if(Rn===2){Rn=0;var r=Yr,o=cl,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=J.T,J.T=null;var d=ct.p;ct.p=2;var m=ge;ge|=4;try{hb(r,o.alternate,o)}finally{ge=m,ct.p=d,J.T=c}}Rn=3}}function Ob(){if(Rn===4||Rn===3){Rn=0,Ai();var r=Yr,o=cl,c=ul,d=Ab;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Rn=5:(Rn=0,cl=Yr=null,Lb(r,r.pendingLanes));var m=r.pendingLanes;if(m===0&&($r=null),xo(c),o=o.stateNode,D&&typeof D.onCommitFiberRoot=="function")try{D.onCommitFiberRoot(Ce,o,void 0,(o.current.flags&128)===128)}catch{}if(d!==null){o=J.T,m=ct.p,ct.p=2,J.T=null;try{for(var _=r.onRecoverableError,R=0;R<d.length;R++){var M=d[R];_(M.value,{componentStack:M.stack})}}finally{J.T=o,ct.p=m}}(ul&3)!==0&&Ed(),ys(r),m=r.pendingLanes,(c&4194090)!==0&&(m&42)!==0?r===qg?qc++:(qc=0,qg=r):qc=0,$c(0)}}function Lb(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,Sc(o)))}function Ed(r){return kb(),Pb(),Ob(),Bb()}function Bb(){if(Rn!==5)return!1;var r=Yr,o=zg;zg=0;var c=xo(ul),d=J.T,m=ct.p;try{ct.p=32>c?32:c,J.T=null,c=Gg,Gg=null;var _=Yr,R=ul;if(Rn=0,cl=Yr=null,ul=0,(ge&6)!==0)throw Error(n(331));var M=ge;if(ge|=4,bb(_.current),yb(_,_.current,R,c),ge=M,$c(0,!1),D&&typeof D.onPostCommitFiberRoot=="function")try{D.onPostCommitFiberRoot(Ce,_)}catch{}return!0}finally{ct.p=m,J.T=d,Lb(r,o)}}function Fb(r,o,c){o=xi(c,o),o=wg(r.stateNode,o,2),r=Br(r,o,2),r!==null&&(Vs(r,2),ys(r))}function Ae(r,o,c){if(r.tag===3)Fb(r,r,c);else for(;o!==null;){if(o.tag===3){Fb(o,r,c);break}else if(o.tag===1){var d=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&($r===null||!$r.has(d))){r=xi(c,r),c=H0(2),d=Br(o,c,2),d!==null&&(z0(c,d,o,r),Vs(d,2),ys(d));break}}o=o.return}}function Kg(r,o,c){var d=r.pingCache;if(d===null){d=r.pingCache=new ER;var m=new Set;d.set(o,m)}else m=d.get(o),m===void 0&&(m=new Set,d.set(o,m));m.has(c)||(Ug=!0,m.add(c),r=CR.bind(null,r,o,c),o.then(r,r))}function CR(r,o,c){var d=r.pingCache;d!==null&&d.delete(o),r.pingedLanes|=r.suspendedLanes&c,r.warmLanes&=~c,Te===r&&(ae&c)===c&&(Ve===4||Ve===3&&(ae&62914560)===ae&&300>Fe()-Hg?(ge&2)===0&&hl(r,0):Vg|=c,ll===ae&&(ll=0)),ys(r)}function Ub(r,o){o===0&&(o=ec()),r=Yo(r,o),r!==null&&(Vs(r,o),ys(r))}function RR(r){var o=r.memoizedState,c=0;o!==null&&(c=o.retryLane),Ub(r,c)}function IR(r,o){var c=0;switch(r.tag){case 13:var d=r.stateNode,m=r.memoizedState;m!==null&&(c=m.retryLane);break;case 19:d=r.stateNode;break;case 22:d=r.stateNode._retryCache;break;default:throw Error(n(314))}d!==null&&d.delete(o),Ub(r,c)}function xR(r,o){return We(r,o)}var Ad=null,fl=null,Wg=!1,wd=!1,Qg=!1,eo=0;function ys(r){r!==fl&&r.next===null&&(fl===null?Ad=fl=r:fl=fl.next=r),wd=!0,Wg||(Wg=!0,NR())}function $c(r,o){if(!Qg&&wd){Qg=!0;do for(var c=!1,d=Ad;d!==null;){if(r!==0){var m=d.pendingLanes;if(m===0)var _=0;else{var R=d.suspendedLanes,M=d.pingedLanes;_=(1<<31-w(42|r)+1)-1,_&=m&~(R&~M),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(c=!0,zb(d,_))}else _=ae,_=ue(d,d===Te?_:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(_&3)===0||de(d,_)||(c=!0,zb(d,_));d=d.next}while(c);Qg=!1}}function DR(){Vb()}function Vb(){wd=Wg=!1;var r=0;eo!==0&&(UR()&&(r=eo),eo=0);for(var o=Fe(),c=null,d=Ad;d!==null;){var m=d.next,_=jb(d,o);_===0?(d.next=null,c===null?Ad=m:c.next=m,m===null&&(fl=c)):(c=d,(r!==0||(_&3)!==0)&&(wd=!0)),d=m}$c(r)}function jb(r,o){for(var c=r.suspendedLanes,d=r.pingedLanes,m=r.expirationTimes,_=r.pendingLanes&-62914561;0<_;){var R=31-w(_),M=1<<R,q=m[R];q===-1?((M&c)===0||(M&d)!==0)&&(m[R]=le(M,o)):q<=o&&(r.expiredLanes|=M),_&=~M}if(o=Te,c=ae,c=ue(r,r===o?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d=r.callbackNode,c===0||r===o&&(me===2||me===9)||r.cancelPendingCommit!==null)return d!==null&&d!==null&&we(d),r.callbackNode=null,r.callbackPriority=0;if((c&3)===0||de(r,c)){if(o=c&-c,o===r.callbackPriority)return o;switch(d!==null&&we(d),xo(c)){case 2:case 8:c=Gi;break;case 32:c=ti;break;case 268435456:c=wi;break;default:c=ti}return d=Hb.bind(null,r),c=We(c,d),r.callbackPriority=o,r.callbackNode=c,o}return d!==null&&d!==null&&we(d),r.callbackPriority=2,r.callbackNode=null,2}function Hb(r,o){if(Rn!==0&&Rn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var c=r.callbackNode;if(Ed()&&r.callbackNode!==c)return null;var d=ae;return d=ue(r,r===Te?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d===0?null:(Tb(r,d,o),jb(r,Fe()),r.callbackNode!=null&&r.callbackNode===c?Hb.bind(null,r):null)}function zb(r,o){if(Ed())return null;Tb(r,o,!0)}function NR(){jR(function(){(ge&6)!==0?We(Bs,DR):Vb()})}function Jg(){return eo===0&&(eo=tc()),eo}function Gb(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Oo(""+r)}function qb(r,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,r.id&&c.setAttribute("form",r.id),o.parentNode.insertBefore(c,o),r=new FormData(r),c.parentNode.removeChild(c),r}function MR(r,o,c,d,m){if(o==="submit"&&c&&c.stateNode===m){var _=Gb((m[Qe]||null).action),R=d.submitter;R&&(o=(o=R[Qe]||null)?Gb(o.formAction):R.getAttribute("formAction"),o!==null&&(_=o,R=null));var M=new Lo("action","action",null,d,m);r.push({event:M,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(eo!==0){var q=R?qb(m,R):new FormData(m);_g(c,{pending:!0,data:q,method:m.method,action:_},null,q)}}else typeof _=="function"&&(M.preventDefault(),q=R?qb(m,R):new FormData(m),_g(c,{pending:!0,data:q,method:m.method,action:_},_,q))},currentTarget:m}]})}}for(var Zg=0;Zg<Bp.length;Zg++){var tm=Bp[Zg],kR=tm.toLowerCase(),PR=tm[0].toUpperCase()+tm.slice(1);Yi(kR,"on"+PR)}Yi(Tv,"onAnimationEnd"),Yi(Sv,"onAnimationIteration"),Yi(Cv,"onAnimationStart"),Yi("dblclick","onDoubleClick"),Yi("focusin","onFocus"),Yi("focusout","onBlur"),Yi(QC,"onTransitionRun"),Yi(JC,"onTransitionStart"),Yi(ZC,"onTransitionCancel"),Yi(Rv,"onTransitionEnd"),Hs("onMouseEnter",["mouseout","mouseover"]),Hs("onMouseLeave",["mouseout","mouseover"]),Hs("onPointerEnter",["pointerout","pointerover"]),Hs("onPointerLeave",["pointerout","pointerover"]),qi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),qi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),qi("onBeforeInput",["compositionend","keypress","textInput","paste"]),qi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),qi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),qi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),OR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yc));function $b(r,o){o=(o&4)!==0;for(var c=0;c<r.length;c++){var d=r[c],m=d.event;d=d.listeners;t:{var _=void 0;if(o)for(var R=d.length-1;0<=R;R--){var M=d[R],q=M.instance,nt=M.currentTarget;if(M=M.listener,q!==_&&m.isPropagationStopped())break t;_=M,m.currentTarget=nt;try{_(m)}catch(ht){ud(ht)}m.currentTarget=null,_=q}else for(R=0;R<d.length;R++){if(M=d[R],q=M.instance,nt=M.currentTarget,M=M.listener,q!==_&&m.isPropagationStopped())break t;_=M,m.currentTarget=nt;try{_(m)}catch(ht){ud(ht)}m.currentTarget=null,_=q}}}}function Qt(r,o){var c=o[sc];c===void 0&&(c=o[sc]=new Set);var d=r+"__bubble";c.has(d)||(Yb(o,r,2,!1),c.add(d))}function em(r,o,c){var d=0;o&&(d|=4),Yb(c,r,d,o)}var Td="_reactListening"+Math.random().toString(36).slice(2);function nm(r){if(!r[Td]){r[Td]=!0,rc.forEach(function(c){c!=="selectionchange"&&(OR.has(c)||em(c,!1,r),em(c,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[Td]||(o[Td]=!0,em("selectionchange",!1,o))}}function Yb(r,o,c,d){switch(yE(o)){case 2:var m=lI;break;case 8:m=cI;break;default:m=mm}c=m.bind(null,o,c,r),m=void 0,!Ri||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(m=!0),d?m!==void 0?r.addEventListener(o,c,{capture:!0,passive:m}):r.addEventListener(o,c,!0):m!==void 0?r.addEventListener(o,c,{passive:m}):r.addEventListener(o,c,!1)}function im(r,o,c,d,m){var _=d;if((o&1)===0&&(o&2)===0&&d!==null)t:for(;;){if(d===null)return;var R=d.tag;if(R===3||R===4){var M=d.stateNode.containerInfo;if(M===m)break;if(R===4)for(R=d.return;R!==null;){var q=R.tag;if((q===3||q===4)&&R.stateNode.containerInfo===m)return;R=R.return}for(;M!==null;){if(R=js(M),R===null)return;if(q=R.tag,q===5||q===6||q===26||q===27){d=_=R;continue t}M=M.parentNode}}d=d.return}Ch(function(){var nt=_,ht=Ci(c),pt=[];t:{var it=Iv.get(r);if(it!==void 0){var ot=Lo,Vt=r;switch(r){case"keypress":if(ls(c)===0)break t;case"keydown":case"keyup":ot=Ho;break;case"focusin":Vt="focus",ot=Uo;break;case"focusout":Vt="blur",ot=Uo;break;case"beforeblur":case"afterblur":ot=Uo;break;case"click":if(c.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ot=Ii;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ot=xp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ot=Ph;break;case Tv:case Sv:case Cv:ot=Vo;break;case Rv:ot=Lh;break;case"scroll":case"scrollend":ot=Rh;break;case"wheel":ot=zo;break;case"copy":case"cut":case"paste":ot=jo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ot=yc;break;case"toggle":case"beforetoggle":ot=Fh}var Ot=(o&4)!==0,be=!Ot&&(r==="scroll"||r==="scrollend"),Z=Ot?it!==null?it+"Capture":null:it;Ot=[];for(var X=nt,et;X!==null;){var ft=X;if(et=ft.stateNode,ft=ft.tag,ft!==5&&ft!==26&&ft!==27||et===null||Z===null||(ft=Pa(X,Z),ft!=null&&Ot.push(Xc(X,ft,et))),be)break;X=X.return}0<Ot.length&&(it=new ot(it,Vt,null,c,ht),pt.push({event:it,listeners:Ot}))}}if((o&7)===0){t:{if(it=r==="mouseover"||r==="pointerover",ot=r==="mouseout"||r==="pointerout",it&&c!==qs&&(Vt=c.relatedTarget||c.fromElement)&&(js(Vt)||Vt[Ti]))break t;if((ot||it)&&(it=ht.window===ht?ht:(it=ht.ownerDocument)?it.defaultView||it.parentWindow:window,ot?(Vt=c.relatedTarget||c.toElement,ot=nt,Vt=Vt?js(Vt):null,Vt!==null&&(be=a(Vt),Ot=Vt.tag,Vt!==be||Ot!==5&&Ot!==27&&Ot!==6)&&(Vt=null)):(ot=null,Vt=nt),ot!==Vt)){if(Ot=Ii,ft="onMouseLeave",Z="onMouseEnter",X="mouse",(r==="pointerout"||r==="pointerover")&&(Ot=yc,ft="onPointerLeave",Z="onPointerEnter",X="pointer"),be=ot==null?it:ss(ot),et=Vt==null?it:ss(Vt),it=new Ot(ft,X+"leave",ot,c,ht),it.target=be,it.relatedTarget=et,ft=null,js(ht)===nt&&(Ot=new Ot(Z,X+"enter",Vt,c,ht),Ot.target=et,Ot.relatedTarget=be,ft=Ot),be=ft,ot&&Vt)e:{for(Ot=ot,Z=Vt,X=0,et=Ot;et;et=pl(et))X++;for(et=0,ft=Z;ft;ft=pl(ft))et++;for(;0<X-et;)Ot=pl(Ot),X--;for(;0<et-X;)Z=pl(Z),et--;for(;X--;){if(Ot===Z||Z!==null&&Ot===Z.alternate)break e;Ot=pl(Ot),Z=pl(Z)}Ot=null}else Ot=null;ot!==null&&Xb(pt,it,ot,Ot,!1),Vt!==null&&be!==null&&Xb(pt,be,Vt,Ot,!0)}}t:{if(it=nt?ss(nt):window,ot=it.nodeName&&it.nodeName.toLowerCase(),ot==="select"||ot==="input"&&it.type==="file")var Tt=fv;else if(hn(it))if(pv)Tt=XC;else{Tt=$C;var Xt=qC}else ot=it.nodeName,!ot||ot.toLowerCase()!=="input"||it.type!=="checkbox"&&it.type!=="radio"?nt&&uc(nt.elementType)&&(Tt=fv):Tt=YC;if(Tt&&(Tt=Tt(r,nt))){Ws(pt,Tt,c,ht);break t}Xt&&Xt(r,it,nt),r==="focusout"&&nt&&it.type==="number"&&nt.memoizedProps.value!=null&&Mr(it,"number",it.value)}switch(Xt=nt?ss(nt):window,r){case"focusin":(hn(Xt)||Xt.contentEditable==="true")&&(Go=Xt,Pp=nt,bc=null);break;case"focusout":bc=Pp=Go=null;break;case"mousedown":Op=!0;break;case"contextmenu":case"mouseup":case"dragend":Op=!1,Av(pt,c,ht);break;case"selectionchange":if(WC)break;case"keydown":case"keyup":Av(pt,c,ht)}var Ct;if(hs)t:{switch(r){case"compositionstart":var Lt="onCompositionStart";break t;case"compositionend":Lt="onCompositionEnd";break t;case"compositionupdate":Lt="onCompositionUpdate";break t}Lt=void 0}else se?lt(r,c)&&(Lt="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(Lt="onCompositionStart");Lt&&(C&&c.locale!=="ko"&&(se||Lt!=="onCompositionStart"?Lt==="onCompositionEnd"&&se&&(Ct=dc()):(os=ht,kr="value"in os?os.value:os.textContent,se=!0)),Xt=Sd(nt,Lt),0<Xt.length&&(Lt=new gc(Lt,r,null,c,ht),pt.push({event:Lt,listeners:Xt}),Ct?Lt.data=Ct:(Ct=vt(c),Ct!==null&&(Lt.data=Ct)))),(Ct=E?un(r,c):re(r,c))&&(Lt=Sd(nt,"onBeforeInput"),0<Lt.length&&(Xt=new gc("onBeforeInput","beforeinput",null,c,ht),pt.push({event:Xt,listeners:Lt}),Xt.data=Ct)),MR(pt,r,nt,c,ht)}$b(pt,o)})}function Xc(r,o,c){return{instance:r,listener:o,currentTarget:c}}function Sd(r,o){for(var c=o+"Capture",d=[];r!==null;){var m=r,_=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||_===null||(m=Pa(r,c),m!=null&&d.unshift(Xc(r,m,_)),m=Pa(r,o),m!=null&&d.push(Xc(r,m,_))),r.tag===3)return d;r=r.return}return[]}function pl(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Xb(r,o,c,d,m){for(var _=o._reactName,R=[];c!==null&&c!==d;){var M=c,q=M.alternate,nt=M.stateNode;if(M=M.tag,q!==null&&q===d)break;M!==5&&M!==26&&M!==27||nt===null||(q=nt,m?(nt=Pa(c,_),nt!=null&&R.unshift(Xc(c,nt,q))):m||(nt=Pa(c,_),nt!=null&&R.push(Xc(c,nt,q)))),c=c.return}R.length!==0&&r.push({event:o,listeners:R})}var LR=/\r\n?/g,BR=/\u0000|\uFFFD/g;function Kb(r){return(typeof r=="string"?r:""+r).replace(LR,`
`).replace(BR,"")}function Wb(r,o){return o=Kb(o),Kb(r)===o}function Cd(){}function ve(r,o,c,d,m,_){switch(c){case"children":typeof d=="string"?o==="body"||o==="textarea"&&d===""||Si(r,d):(typeof d=="number"||typeof d=="bigint")&&o!=="body"&&Si(r,""+d);break;case"className":rs(r,"class",d);break;case"tabIndex":rs(r,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":rs(r,c,d);break;case"style":cc(r,d,_);break;case"data":if(o!=="object"){rs(r,"data",d);break}case"src":case"href":if(d===""&&(o!=="a"||c!=="href")){r.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(c);break}d=Oo(""+d),r.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){r.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(c==="formAction"?(o!=="input"&&ve(r,o,"name",m.name,m,null),ve(r,o,"formEncType",m.formEncType,m,null),ve(r,o,"formMethod",m.formMethod,m,null),ve(r,o,"formTarget",m.formTarget,m,null)):(ve(r,o,"encType",m.encType,m,null),ve(r,o,"method",m.method,m,null),ve(r,o,"target",m.target,m,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(c);break}d=Oo(""+d),r.setAttribute(c,d);break;case"onClick":d!=null&&(r.onclick=Cd);break;case"onScroll":d!=null&&Qt("scroll",r);break;case"onScrollEnd":d!=null&&Qt("scrollend",r);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(m.children!=null)throw Error(n(60));r.innerHTML=c}}break;case"multiple":r.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":r.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){r.removeAttribute("xlink:href");break}c=Oo(""+d),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,""+d):r.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,""):r.removeAttribute(c);break;case"capture":case"download":d===!0?r.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,d):r.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?r.setAttribute(c,d):r.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?r.removeAttribute(c):r.setAttribute(c,d);break;case"popover":Qt("beforetoggle",r),Qt("toggle",r),Nr(r,"popover",d);break;case"xlinkActuate":Tn(r,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":Tn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":Tn(r,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":Tn(r,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":Tn(r,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":Tn(r,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":Tn(r,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":Tn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":Tn(r,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Nr(r,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Rp.get(c)||c,Nr(r,c,d))}}function sm(r,o,c,d,m,_){switch(c){case"style":cc(r,d,_);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(m.children!=null)throw Error(n(60));r.innerHTML=c}}break;case"children":typeof d=="string"?Si(r,d):(typeof d=="number"||typeof d=="bigint")&&Si(r,""+d);break;case"onScroll":d!=null&&Qt("scroll",r);break;case"onScrollEnd":d!=null&&Qt("scrollend",r);break;case"onClick":d!=null&&(r.onclick=Cd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Do.hasOwnProperty(c))t:{if(c[0]==="o"&&c[1]==="n"&&(m=c.endsWith("Capture"),o=c.slice(2,m?c.length-7:void 0),_=r[Qe]||null,_=_!=null?_[c]:null,typeof _=="function"&&r.removeEventListener(o,_,m),typeof d=="function")){typeof _!="function"&&_!==null&&(c in r?r[c]=null:r.hasAttribute(c)&&r.removeAttribute(c)),r.addEventListener(o,d,m);break t}c in r?r[c]=d:d===!0?r.setAttribute(c,""):Nr(r,c,d)}}}function In(r,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qt("error",r),Qt("load",r);var d=!1,m=!1,_;for(_ in c)if(c.hasOwnProperty(_)){var R=c[_];if(R!=null)switch(_){case"src":d=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:ve(r,o,_,R,c,null)}}m&&ve(r,o,"srcSet",c.srcSet,c,null),d&&ve(r,o,"src",c.src,c,null);return;case"input":Qt("invalid",r);var M=_=R=m=null,q=null,nt=null;for(d in c)if(c.hasOwnProperty(d)){var ht=c[d];if(ht!=null)switch(d){case"name":m=ht;break;case"type":R=ht;break;case"checked":q=ht;break;case"defaultChecked":nt=ht;break;case"value":_=ht;break;case"defaultValue":M=ht;break;case"children":case"dangerouslySetInnerHTML":if(ht!=null)throw Error(n(137,o));break;default:ve(r,o,d,ht,c,null)}}Na(r,_,M,q,nt,R,m,!1),Po(r);return;case"select":Qt("invalid",r),d=R=_=null;for(m in c)if(c.hasOwnProperty(m)&&(M=c[m],M!=null))switch(m){case"value":_=M;break;case"defaultValue":R=M;break;case"multiple":d=M;default:ve(r,o,m,M,c,null)}o=_,c=R,r.multiple=!!d,o!=null?Gs(r,!!d,o,!1):c!=null&&Gs(r,!!d,c,!0);return;case"textarea":Qt("invalid",r),_=m=d=null;for(R in c)if(c.hasOwnProperty(R)&&(M=c[R],M!=null))switch(R){case"value":d=M;break;case"defaultValue":m=M;break;case"children":_=M;break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(n(91));break;default:ve(r,o,R,M,c,null)}Ma(r,d,m,_),Po(r);return;case"option":for(q in c)if(c.hasOwnProperty(q)&&(d=c[q],d!=null))switch(q){case"selected":r.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:ve(r,o,q,d,c,null)}return;case"dialog":Qt("beforetoggle",r),Qt("toggle",r),Qt("cancel",r),Qt("close",r);break;case"iframe":case"object":Qt("load",r);break;case"video":case"audio":for(d=0;d<Yc.length;d++)Qt(Yc[d],r);break;case"image":Qt("error",r),Qt("load",r);break;case"details":Qt("toggle",r);break;case"embed":case"source":case"link":Qt("error",r),Qt("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(nt in c)if(c.hasOwnProperty(nt)&&(d=c[nt],d!=null))switch(nt){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:ve(r,o,nt,d,c,null)}return;default:if(uc(o)){for(ht in c)c.hasOwnProperty(ht)&&(d=c[ht],d!==void 0&&sm(r,o,ht,d,c,void 0));return}}for(M in c)c.hasOwnProperty(M)&&(d=c[M],d!=null&&ve(r,o,M,d,c,null))}function FR(r,o,c,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,_=null,R=null,M=null,q=null,nt=null,ht=null;for(ot in c){var pt=c[ot];if(c.hasOwnProperty(ot)&&pt!=null)switch(ot){case"checked":break;case"value":break;case"defaultValue":q=pt;default:d.hasOwnProperty(ot)||ve(r,o,ot,null,d,pt)}}for(var it in d){var ot=d[it];if(pt=c[it],d.hasOwnProperty(it)&&(ot!=null||pt!=null))switch(it){case"type":_=ot;break;case"name":m=ot;break;case"checked":nt=ot;break;case"defaultChecked":ht=ot;break;case"value":R=ot;break;case"defaultValue":M=ot;break;case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(n(137,o));break;default:ot!==pt&&ve(r,o,it,ot,d,pt)}}hi(r,R,M,q,nt,ht,_,m);return;case"select":ot=R=M=it=null;for(_ in c)if(q=c[_],c.hasOwnProperty(_)&&q!=null)switch(_){case"value":break;case"multiple":ot=q;default:d.hasOwnProperty(_)||ve(r,o,_,null,d,q)}for(m in d)if(_=d[m],q=c[m],d.hasOwnProperty(m)&&(_!=null||q!=null))switch(m){case"value":it=_;break;case"defaultValue":M=_;break;case"multiple":R=_;default:_!==q&&ve(r,o,m,_,d,q)}o=M,c=R,d=ot,it!=null?Gs(r,!!c,it,!1):!!d!=!!c&&(o!=null?Gs(r,!!c,o,!0):Gs(r,!!c,c?[]:"",!1));return;case"textarea":ot=it=null;for(M in c)if(m=c[M],c.hasOwnProperty(M)&&m!=null&&!d.hasOwnProperty(M))switch(M){case"value":break;case"children":break;default:ve(r,o,M,null,d,m)}for(R in d)if(m=d[R],_=c[R],d.hasOwnProperty(R)&&(m!=null||_!=null))switch(R){case"value":it=m;break;case"defaultValue":ot=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(n(91));break;default:m!==_&&ve(r,o,R,m,d,_)}ye(r,it,ot);return;case"option":for(var Vt in c)if(it=c[Vt],c.hasOwnProperty(Vt)&&it!=null&&!d.hasOwnProperty(Vt))switch(Vt){case"selected":r.selected=!1;break;default:ve(r,o,Vt,null,d,it)}for(q in d)if(it=d[q],ot=c[q],d.hasOwnProperty(q)&&it!==ot&&(it!=null||ot!=null))switch(q){case"selected":r.selected=it&&typeof it!="function"&&typeof it!="symbol";break;default:ve(r,o,q,it,d,ot)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ot in c)it=c[Ot],c.hasOwnProperty(Ot)&&it!=null&&!d.hasOwnProperty(Ot)&&ve(r,o,Ot,null,d,it);for(nt in d)if(it=d[nt],ot=c[nt],d.hasOwnProperty(nt)&&it!==ot&&(it!=null||ot!=null))switch(nt){case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(n(137,o));break;default:ve(r,o,nt,it,d,ot)}return;default:if(uc(o)){for(var be in c)it=c[be],c.hasOwnProperty(be)&&it!==void 0&&!d.hasOwnProperty(be)&&sm(r,o,be,void 0,d,it);for(ht in d)it=d[ht],ot=c[ht],!d.hasOwnProperty(ht)||it===ot||it===void 0&&ot===void 0||sm(r,o,ht,it,d,ot);return}}for(var Z in c)it=c[Z],c.hasOwnProperty(Z)&&it!=null&&!d.hasOwnProperty(Z)&&ve(r,o,Z,null,d,it);for(pt in d)it=d[pt],ot=c[pt],!d.hasOwnProperty(pt)||it===ot||it==null&&ot==null||ve(r,o,pt,it,d,ot)}var rm=null,am=null;function Rd(r){return r.nodeType===9?r:r.ownerDocument}function Qb(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Jb(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function om(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var lm=null;function UR(){var r=window.event;return r&&r.type==="popstate"?r===lm?!1:(lm=r,!0):(lm=null,!1)}var Zb=typeof setTimeout=="function"?setTimeout:void 0,VR=typeof clearTimeout=="function"?clearTimeout:void 0,tE=typeof Promise=="function"?Promise:void 0,jR=typeof queueMicrotask=="function"?queueMicrotask:typeof tE<"u"?function(r){return tE.resolve(null).then(r).catch(HR)}:Zb;function HR(r){setTimeout(function(){throw r})}function Kr(r){return r==="head"}function eE(r,o){var c=o,d=0,m=0;do{var _=c.nextSibling;if(r.removeChild(c),_&&_.nodeType===8)if(c=_.data,c==="/$"){if(0<d&&8>d){c=d;var R=r.ownerDocument;if(c&1&&Kc(R.documentElement),c&2&&Kc(R.body),c&4)for(c=R.head,Kc(c),R=c.firstChild;R;){var M=R.nextSibling,q=R.nodeName;R[Ra]||q==="SCRIPT"||q==="STYLE"||q==="LINK"&&R.rel.toLowerCase()==="stylesheet"||c.removeChild(R),R=M}}if(m===0){r.removeChild(_),iu(o);return}m--}else c==="$"||c==="$?"||c==="$!"?m++:d=c.charCodeAt(0)-48;else d=0;c=_}while(c);iu(o)}function cm(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":cm(c),Dr(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}r.removeChild(c)}}function zR(r,o,c,d){for(;r.nodeType===1;){var m=c;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!d&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(d){if(!r[Ra])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(_=r.getAttribute("rel"),_==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(_!==m.rel||r.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||r.getAttribute("title")!==(m.title==null?null:m.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(_=r.getAttribute("src"),(_!==(m.src==null?null:m.src)||r.getAttribute("type")!==(m.type==null?null:m.type)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&_&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var _=m.name==null?null:""+m.name;if(m.type==="hidden"&&r.getAttribute("name")===_)return r}else return r;if(r=Ki(r.nextSibling),r===null)break}return null}function GR(r,o,c){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!c||(r=Ki(r.nextSibling),r===null))return null;return r}function um(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function qR(r,o){var c=r.ownerDocument;if(r.data!=="$?"||c.readyState==="complete")o();else{var d=function(){o(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),r._reactRetry=d}}function Ki(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return r}var hm=null;function nE(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return r;o--}else c==="/$"&&o++}r=r.previousSibling}return null}function iE(r,o,c){switch(o=Rd(c),r){case"html":if(r=o.documentElement,!r)throw Error(n(452));return r;case"head":if(r=o.head,!r)throw Error(n(453));return r;case"body":if(r=o.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function Kc(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);Dr(r)}var Oi=new Map,sE=new Set;function Id(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var cr=ct.d;ct.d={f:$R,r:YR,D:XR,C:KR,L:WR,m:QR,X:ZR,S:JR,M:tI};function $R(){var r=cr.f(),o=vd();return r||o}function YR(r){var o=is(r);o!==null&&o.tag===5&&o.type==="form"?T0(o):cr.r(r)}var gl=typeof document>"u"?null:document;function rE(r,o,c){var d=gl;if(d&&typeof o=="string"&&o){var m=Je(o);m='link[rel="'+r+'"][href="'+m+'"]',typeof c=="string"&&(m+='[crossorigin="'+c+'"]'),sE.has(m)||(sE.add(m),r={rel:r,crossOrigin:c,href:o},d.querySelector(m)===null&&(o=d.createElement("link"),In(o,"link",r),ze(o),d.head.appendChild(o)))}}function XR(r){cr.D(r),rE("dns-prefetch",r,null)}function KR(r,o){cr.C(r,o),rE("preconnect",r,o)}function WR(r,o,c){cr.L(r,o,c);var d=gl;if(d&&r&&o){var m='link[rel="preload"][as="'+Je(o)+'"]';o==="image"&&c&&c.imageSrcSet?(m+='[imagesrcset="'+Je(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(m+='[imagesizes="'+Je(c.imageSizes)+'"]')):m+='[href="'+Je(r)+'"]';var _=m;switch(o){case"style":_=ml(r);break;case"script":_=yl(r)}Oi.has(_)||(r=p({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:r,as:o},c),Oi.set(_,r),d.querySelector(m)!==null||o==="style"&&d.querySelector(Wc(_))||o==="script"&&d.querySelector(Qc(_))||(o=d.createElement("link"),In(o,"link",r),ze(o),d.head.appendChild(o)))}}function QR(r,o){cr.m(r,o);var c=gl;if(c&&r){var d=o&&typeof o.as=="string"?o.as:"script",m='link[rel="modulepreload"][as="'+Je(d)+'"][href="'+Je(r)+'"]',_=m;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=yl(r)}if(!Oi.has(_)&&(r=p({rel:"modulepreload",href:r},o),Oi.set(_,r),c.querySelector(m)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Qc(_)))return}d=c.createElement("link"),In(d,"link",r),ze(d),c.head.appendChild(d)}}}function JR(r,o,c){cr.S(r,o,c);var d=gl;if(d&&r){var m=Gn(d).hoistableStyles,_=ml(r);o=o||"default";var R=m.get(_);if(!R){var M={loading:0,preload:null};if(R=d.querySelector(Wc(_)))M.loading=5;else{r=p({rel:"stylesheet",href:r,"data-precedence":o},c),(c=Oi.get(_))&&dm(r,c);var q=R=d.createElement("link");ze(q),In(q,"link",r),q._p=new Promise(function(nt,ht){q.onload=nt,q.onerror=ht}),q.addEventListener("load",function(){M.loading|=1}),q.addEventListener("error",function(){M.loading|=2}),M.loading|=4,xd(R,o,d)}R={type:"stylesheet",instance:R,count:1,state:M},m.set(_,R)}}}function ZR(r,o){cr.X(r,o);var c=gl;if(c&&r){var d=Gn(c).hoistableScripts,m=yl(r),_=d.get(m);_||(_=c.querySelector(Qc(m)),_||(r=p({src:r,async:!0},o),(o=Oi.get(m))&&fm(r,o),_=c.createElement("script"),ze(_),In(_,"link",r),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},d.set(m,_))}}function tI(r,o){cr.M(r,o);var c=gl;if(c&&r){var d=Gn(c).hoistableScripts,m=yl(r),_=d.get(m);_||(_=c.querySelector(Qc(m)),_||(r=p({src:r,async:!0,type:"module"},o),(o=Oi.get(m))&&fm(r,o),_=c.createElement("script"),ze(_),In(_,"link",r),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},d.set(m,_))}}function aE(r,o,c,d){var m=(m=Et.current)?Id(m):null;if(!m)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=ml(c.href),c=Gn(m).hoistableStyles,d=c.get(o),d||(d={type:"style",instance:null,count:0,state:null},c.set(o,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){r=ml(c.href);var _=Gn(m).hoistableStyles,R=_.get(r);if(R||(m=m.ownerDocument||m,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(r,R),(_=m.querySelector(Wc(r)))&&!_._p&&(R.instance=_,R.state.loading=5),Oi.has(r)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Oi.set(r,c),_||eI(m,r,c,R.state))),o&&d===null)throw Error(n(528,""));return R}if(o&&d!==null)throw Error(n(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=yl(c),c=Gn(m).hoistableScripts,d=c.get(o),d||(d={type:"script",instance:null,count:0,state:null},c.set(o,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function ml(r){return'href="'+Je(r)+'"'}function Wc(r){return'link[rel="stylesheet"]['+r+"]"}function oE(r){return p({},r,{"data-precedence":r.precedence,precedence:null})}function eI(r,o,c,d){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?d.loading=1:(o=r.createElement("link"),d.preload=o,o.addEventListener("load",function(){return d.loading|=1}),o.addEventListener("error",function(){return d.loading|=2}),In(o,"link",c),ze(o),r.head.appendChild(o))}function yl(r){return'[src="'+Je(r)+'"]'}function Qc(r){return"script[async]"+r}function lE(r,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var d=r.querySelector('style[data-href~="'+Je(c.href)+'"]');if(d)return o.instance=d,ze(d),d;var m=p({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(r.ownerDocument||r).createElement("style"),ze(d),In(d,"style",m),xd(d,c.precedence,r),o.instance=d;case"stylesheet":m=ml(c.href);var _=r.querySelector(Wc(m));if(_)return o.state.loading|=4,o.instance=_,ze(_),_;d=oE(c),(m=Oi.get(m))&&dm(d,m),_=(r.ownerDocument||r).createElement("link"),ze(_);var R=_;return R._p=new Promise(function(M,q){R.onload=M,R.onerror=q}),In(_,"link",d),o.state.loading|=4,xd(_,c.precedence,r),o.instance=_;case"script":return _=yl(c.src),(m=r.querySelector(Qc(_)))?(o.instance=m,ze(m),m):(d=c,(m=Oi.get(_))&&(d=p({},c),fm(d,m)),r=r.ownerDocument||r,m=r.createElement("script"),ze(m),In(m,"link",d),r.head.appendChild(m),o.instance=m);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(d=o.instance,o.state.loading|=4,xd(d,c.precedence,r));return o.instance}function xd(r,o,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=d.length?d[d.length-1]:null,_=m,R=0;R<d.length;R++){var M=d[R];if(M.dataset.precedence===o)_=M;else if(_!==m)break}_?_.parentNode.insertBefore(r,_.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(r,o.firstChild))}function dm(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function fm(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var Dd=null;function cE(r,o,c){if(Dd===null){var d=new Map,m=Dd=new Map;m.set(c,d)}else m=Dd,d=m.get(c),d||(d=new Map,m.set(c,d));if(d.has(r))return d;for(d.set(r,null),c=c.getElementsByTagName(r),m=0;m<c.length;m++){var _=c[m];if(!(_[Ra]||_[cn]||r==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var R=_.getAttribute(o)||"";R=r+R;var M=d.get(R);M?M.push(_):d.set(R,[_])}}return d}function uE(r,o,c){r=r.ownerDocument||r,r.head.insertBefore(c,o==="title"?r.querySelector("head > title"):null)}function nI(r,o,c){if(c===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return r=o.disabled,typeof o.precedence=="string"&&r==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function hE(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var Jc=null;function iI(){}function sI(r,o,c){if(Jc===null)throw Error(n(475));var d=Jc;if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=ml(c.href),_=r.querySelector(Wc(m));if(_){r=_._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(d.count++,d=Nd.bind(d),r.then(d,d)),o.state.loading|=4,o.instance=_,ze(_);return}_=r.ownerDocument||r,c=oE(c),(m=Oi.get(m))&&dm(c,m),_=_.createElement("link"),ze(_);var R=_;R._p=new Promise(function(M,q){R.onload=M,R.onerror=q}),In(_,"link",c),o.instance=_}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(d.count++,o=Nd.bind(d),r.addEventListener("load",o),r.addEventListener("error",o))}}function rI(){if(Jc===null)throw Error(n(475));var r=Jc;return r.stylesheets&&r.count===0&&pm(r,r.stylesheets),0<r.count?function(o){var c=setTimeout(function(){if(r.stylesheets&&pm(r,r.stylesheets),r.unsuspend){var d=r.unsuspend;r.unsuspend=null,d()}},6e4);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(c)}}:null}function Nd(){if(this.count--,this.count===0){if(this.stylesheets)pm(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Md=null;function pm(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Md=new Map,o.forEach(aI,r),Md=null,Nd.call(r))}function aI(r,o){if(!(o.state.loading&4)){var c=Md.get(r);if(c)var d=c.get(null);else{c=new Map,Md.set(r,c);for(var m=r.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<m.length;_++){var R=m[_];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(c.set(R.dataset.precedence,R),d=R)}d&&c.set(null,d)}m=o.instance,R=m.getAttribute("data-precedence"),_=c.get(R)||d,_===d&&c.set(null,m),c.set(R,m),this.count++,d=Nd.bind(this),m.addEventListener("load",d),m.addEventListener("error",d),_?_.parentNode.insertBefore(m,_.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(m,r.firstChild)),o.state.loading|=4}}var Zc={$$typeof:O,Provider:null,Consumer:null,_currentValue:mt,_currentValue2:mt,_threadCount:0};function oI(r,o,c,d,m,_,R,M){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Us(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Us(0),this.hiddenUpdates=Us(null),this.identifierPrefix=d,this.onUncaughtError=m,this.onCaughtError=_,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=M,this.incompleteTransitions=new Map}function dE(r,o,c,d,m,_,R,M,q,nt,ht,pt){return r=new oI(r,o,c,R,M,q,nt,pt),o=1,_===!0&&(o|=24),_=fi(3,null,null,o),r.current=_,_.stateNode=r,o=Kp(),o.refCount++,r.pooledCache=o,o.refCount++,_.memoizedState={element:d,isDehydrated:c,cache:o},Zp(_),r}function fE(r){return r?(r=Xo,r):Xo}function pE(r,o,c,d,m,_){m=fE(m),d.context===null?d.context=m:d.pendingContext=m,d=Lr(o),d.payload={element:c},_=_===void 0?null:_,_!==null&&(d.callback=_),c=Br(r,d,o),c!==null&&(_i(c,r,o),xc(c,r,o))}function gE(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<o?c:o}}function gm(r,o){gE(r,o),(r=r.alternate)&&gE(r,o)}function mE(r){if(r.tag===13){var o=Yo(r,67108864);o!==null&&_i(o,r,67108864),gm(r,67108864)}}var kd=!0;function lI(r,o,c,d){var m=J.T;J.T=null;var _=ct.p;try{ct.p=2,mm(r,o,c,d)}finally{ct.p=_,J.T=m}}function cI(r,o,c,d){var m=J.T;J.T=null;var _=ct.p;try{ct.p=8,mm(r,o,c,d)}finally{ct.p=_,J.T=m}}function mm(r,o,c,d){if(kd){var m=ym(d);if(m===null)im(r,o,d,Pd,c),_E(r,d);else if(hI(m,r,o,c,d))d.stopPropagation();else if(_E(r,d),o&4&&-1<uI.indexOf(r)){for(;m!==null;){var _=is(m);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var R=ie(_.pendingLanes);if(R!==0){var M=_;for(M.pendingLanes|=2,M.entangledLanes|=2;R;){var q=1<<31-w(R);M.entanglements[1]|=q,R&=~q}ys(_),(ge&6)===0&&(yd=Fe()+500,$c(0))}}break;case 13:M=Yo(_,2),M!==null&&_i(M,_,2),vd(),gm(_,2)}if(_=ym(d),_===null&&im(r,o,d,Pd,c),_===m)break;m=_}m!==null&&d.stopPropagation()}else im(r,o,d,null,c)}}function ym(r){return r=Ci(r),_m(r)}var Pd=null;function _m(r){if(Pd=null,r=js(r),r!==null){var o=a(r);if(o===null)r=null;else{var c=o.tag;if(c===13){if(r=l(o),r!==null)return r;r=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return Pd=r,null}function yE(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ca()){case Bs:return 2;case Gi:return 8;case ti:case Ln:return 32;case wi:return 268435456;default:return 32}default:return 32}}var vm=!1,Wr=null,Qr=null,Jr=null,tu=new Map,eu=new Map,Zr=[],uI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function _E(r,o){switch(r){case"focusin":case"focusout":Wr=null;break;case"dragenter":case"dragleave":Qr=null;break;case"mouseover":case"mouseout":Jr=null;break;case"pointerover":case"pointerout":tu.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":eu.delete(o.pointerId)}}function nu(r,o,c,d,m,_){return r===null||r.nativeEvent!==_?(r={blockedOn:o,domEventName:c,eventSystemFlags:d,nativeEvent:_,targetContainers:[m]},o!==null&&(o=is(o),o!==null&&mE(o)),r):(r.eventSystemFlags|=d,o=r.targetContainers,m!==null&&o.indexOf(m)===-1&&o.push(m),r)}function hI(r,o,c,d,m){switch(o){case"focusin":return Wr=nu(Wr,r,o,c,d,m),!0;case"dragenter":return Qr=nu(Qr,r,o,c,d,m),!0;case"mouseover":return Jr=nu(Jr,r,o,c,d,m),!0;case"pointerover":var _=m.pointerId;return tu.set(_,nu(tu.get(_)||null,r,o,c,d,m)),!0;case"gotpointercapture":return _=m.pointerId,eu.set(_,nu(eu.get(_)||null,r,o,c,d,m)),!0}return!1}function vE(r){var o=js(r.target);if(o!==null){var c=a(o);if(c!==null){if(o=c.tag,o===13){if(o=l(c),o!==null){r.blockedOn=o,vh(r.priority,function(){if(c.tag===13){var d=yi();d=Rr(d);var m=Yo(c,d);m!==null&&_i(m,c,d),gm(c,d)}});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Od(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var c=ym(r.nativeEvent);if(c===null){c=r.nativeEvent;var d=new c.constructor(c.type,c);qs=d,c.target.dispatchEvent(d),qs=null}else return o=is(c),o!==null&&mE(o),r.blockedOn=c,!1;o.shift()}return!0}function bE(r,o,c){Od(r)&&c.delete(o)}function dI(){vm=!1,Wr!==null&&Od(Wr)&&(Wr=null),Qr!==null&&Od(Qr)&&(Qr=null),Jr!==null&&Od(Jr)&&(Jr=null),tu.forEach(bE),eu.forEach(bE)}function Ld(r,o){r.blockedOn===o&&(r.blockedOn=null,vm||(vm=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,dI)))}var Bd=null;function EE(r){Bd!==r&&(Bd=r,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Bd===r&&(Bd=null);for(var o=0;o<r.length;o+=3){var c=r[o],d=r[o+1],m=r[o+2];if(typeof d!="function"){if(_m(d||c)===null)continue;break}var _=is(c);_!==null&&(r.splice(o,3),o-=3,_g(_,{pending:!0,data:m,method:c.method,action:d},d,m))}}))}function iu(r){function o(q){return Ld(q,r)}Wr!==null&&Ld(Wr,r),Qr!==null&&Ld(Qr,r),Jr!==null&&Ld(Jr,r),tu.forEach(o),eu.forEach(o);for(var c=0;c<Zr.length;c++){var d=Zr[c];d.blockedOn===r&&(d.blockedOn=null)}for(;0<Zr.length&&(c=Zr[0],c.blockedOn===null);)vE(c),c.blockedOn===null&&Zr.shift();if(c=(r.ownerDocument||r).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var m=c[d],_=c[d+1],R=m[Qe]||null;if(typeof _=="function")R||EE(c);else if(R){var M=null;if(_&&_.hasAttribute("formAction")){if(m=_,R=_[Qe]||null)M=R.formAction;else if(_m(m)!==null)continue}else M=R.action;typeof M=="function"?c[d+1]=M:(c.splice(d,3),d-=3),EE(c)}}}function bm(r){this._internalRoot=r}Fd.prototype.render=bm.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));var c=o.current,d=yi();pE(c,d,r,o,null,null)},Fd.prototype.unmount=bm.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;pE(r.current,2,null,r,null,null),vd(),o[Ti]=null}};function Fd(r){this._internalRoot=r}Fd.prototype.unstable_scheduleHydration=function(r){if(r){var o=Ir();r={blockedOn:null,target:r,priority:o};for(var c=0;c<Zr.length&&o!==0&&o<Zr[c].priority;c++);Zr.splice(c,0,r),c===0&&vE(r)}};var AE=t.version;if(AE!=="19.1.1")throw Error(n(527,AE,"19.1.1"));ct.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=h(o),r=r!==null?f(r):null,r=r===null?null:r.stateNode,r};var fI={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ud=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ud.isDisabled&&Ud.supportsFiber)try{Ce=Ud.inject(fI),D=Ud}catch{}}return ru.createRoot=function(r,o){if(!i(r))throw Error(n(299));var c=!1,d="",m=F0,_=U0,R=V0,M=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(d=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(_=o.onCaughtError),o.onRecoverableError!==void 0&&(R=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(M=o.unstable_transitionCallbacks)),o=dE(r,1,!1,null,null,c,d,m,_,R,M,null),r[Ti]=o.current,nm(r),new bm(o)},ru.hydrateRoot=function(r,o,c){if(!i(r))throw Error(n(299));var d=!1,m="",_=F0,R=U0,M=V0,q=null,nt=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(_=c.onUncaughtError),c.onCaughtError!==void 0&&(R=c.onCaughtError),c.onRecoverableError!==void 0&&(M=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(q=c.unstable_transitionCallbacks),c.formState!==void 0&&(nt=c.formState)),o=dE(r,1,!0,o,c??null,d,m,_,R,M,q,nt),o.context=fE(null),c=o.current,d=yi(),d=Rr(d),m=Lr(d),m.callback=null,Br(c,m,d),c=d,o.current.lanes=c,Vs(o,c),ys(o),r[Ti]=o.current,nm(r),new Fd(o)},ru.version="19.1.1",ru}var PE;function wI(){if(PE)return Tm.exports;PE=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),Tm.exports=AI(),Tm.exports}var TI=wI();/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var OE="popstate";function SI(s={}){function t(n,i){let{pathname:a,search:l,hash:u}=n.location;return Zm("",{pathname:a,search:l,hash:u},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function e(n,i){return typeof i=="string"?i:Pu(i)}return RI(t,e,null,s)}function Ne(s,t){if(s===!1||s===null||typeof s>"u")throw new Error(t)}function ts(s,t){if(!s){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function CI(){return Math.random().toString(36).substring(2,10)}function LE(s,t){return{usr:s.state,key:s.key,idx:t}}function Zm(s,t,e=null,n){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof t=="string"?ql(t):t,state:e,key:t&&t.key||n||CI()}}function Pu({pathname:s="/",search:t="",hash:e=""}){return t&&t!=="?"&&(s+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(s+=e.charAt(0)==="#"?e:"#"+e),s}function ql(s){let t={};if(s){let e=s.indexOf("#");e>=0&&(t.hash=s.substring(e),s=s.substring(0,e));let n=s.indexOf("?");n>=0&&(t.search=s.substring(n),s=s.substring(0,n)),s&&(t.pathname=s)}return t}function RI(s,t,e,n={}){let{window:i=document.defaultView,v5Compat:a=!1}=n,l=i.history,u="POP",h=null,f=p();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function p(){return(l.state||{idx:null}).idx}function y(){u="POP";let I=p(),x=I==null?null:I-f;f=I,h&&h({action:u,location:S.location,delta:x})}function v(I,x){u="PUSH";let k=Zm(S.location,I,x);f=p()+1;let O=LE(k,f),G=S.createHref(k);try{l.pushState(O,"",G)}catch(H){if(H instanceof DOMException&&H.name==="DataCloneError")throw H;i.location.assign(G)}a&&h&&h({action:u,location:S.location,delta:1})}function b(I,x){u="REPLACE";let k=Zm(S.location,I,x);f=p();let O=LE(k,f),G=S.createHref(k);l.replaceState(O,"",G),a&&h&&h({action:u,location:S.location,delta:0})}function T(I){return II(I)}let S={get action(){return u},get location(){return s(i,l)},listen(I){if(h)throw new Error("A history only accepts one active listener");return i.addEventListener(OE,y),h=I,()=>{i.removeEventListener(OE,y),h=null}},createHref(I){return t(i,I)},createURL:T,encodeLocation(I){let x=T(I);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:v,replace:b,go(I){return l.go(I)}};return S}function II(s,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),Ne(e,"No window.location.(origin|href) available to create URL");let n=typeof s=="string"?s:Pu(s);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=e+n),new URL(n,e)}function cT(s,t,e="/"){return xI(s,t,e,!1)}function xI(s,t,e,n){let i=typeof t=="string"?ql(t):t,a=vr(i.pathname||"/",e);if(a==null)return null;let l=uT(s);DI(l);let u=null;for(let h=0;u==null&&h<l.length;++h){let f=jI(a);u=UI(l[h],f,n)}return u}function uT(s,t=[],e=[],n="",i=!1){let a=(l,u,h=i,f)=>{let p={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(n)&&h)return;Ne(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length)}let y=mr([n,p.relativePath]),v=e.concat(p);l.children&&l.children.length>0&&(Ne(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${y}".`),uT(l.children,t,v,y,h)),!(l.path==null&&!l.index)&&t.push({path:y,score:BI(y,l.index),routesMeta:v})};return s.forEach((l,u)=>{if(l.path===""||!l.path?.includes("?"))a(l,u);else for(let h of hT(l.path))a(l,u,!0,h)}),t}function hT(s){let t=s.split("/");if(t.length===0)return[];let[e,...n]=t,i=e.endsWith("?"),a=e.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let l=hT(n.join("/")),u=[];return u.push(...l.map(h=>h===""?a:[a,h].join("/"))),i&&u.push(...l),u.map(h=>s.startsWith("/")&&h===""?"/":h)}function DI(s){s.sort((t,e)=>t.score!==e.score?e.score-t.score:FI(t.routesMeta.map(n=>n.childrenIndex),e.routesMeta.map(n=>n.childrenIndex)))}var NI=/^:[\w-]+$/,MI=3,kI=2,PI=1,OI=10,LI=-2,BE=s=>s==="*";function BI(s,t){let e=s.split("/"),n=e.length;return e.some(BE)&&(n+=LI),t&&(n+=kI),e.filter(i=>!BE(i)).reduce((i,a)=>i+(NI.test(a)?MI:a===""?PI:OI),n)}function FI(s,t){return s.length===t.length&&s.slice(0,-1).every((n,i)=>n===t[i])?s[s.length-1]-t[t.length-1]:0}function UI(s,t,e=!1){let{routesMeta:n}=s,i={},a="/",l=[];for(let u=0;u<n.length;++u){let h=n[u],f=u===n.length-1,p=a==="/"?t:t.slice(a.length)||"/",y=wf({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},p),v=h.route;if(!y&&f&&e&&!n[n.length-1].route.index&&(y=wf({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!y)return null;Object.assign(i,y.params),l.push({params:i,pathname:mr([a,y.pathname]),pathnameBase:qI(mr([a,y.pathnameBase])),route:v}),y.pathnameBase!=="/"&&(a=mr([a,y.pathnameBase]))}return l}function wf(s,t){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[e,n]=VI(s.path,s.caseSensitive,s.end),i=t.match(e);if(!i)return null;let a=i[0],l=a.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:n.reduce((f,{paramName:p,isOptional:y},v)=>{if(p==="*"){let T=u[v]||"";l=a.slice(0,a.length-T.length).replace(/(.)\/+$/,"$1")}const b=u[v];return y&&!b?f[p]=void 0:f[p]=(b||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:l,pattern:s}}function VI(s,t=!1,e=!0){ts(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let n=[],i="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,h)=>(n.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(n.push({paramName:"*"}),i+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?i+="\\/*$":s!==""&&s!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function jI(s){try{return s.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ts(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),s}}function vr(s,t){if(t==="/")return s;if(!s.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,n=s.charAt(e);return n&&n!=="/"?null:s.slice(e)||"/"}function HI(s,t="/"){let{pathname:e,search:n="",hash:i=""}=typeof s=="string"?ql(s):s;return{pathname:e?e.startsWith("/")?e:zI(e,t):t,search:$I(n),hash:YI(i)}}function zI(s,t){let e=t.replace(/\/+$/,"").split("/");return s.split("/").forEach(i=>{i===".."?e.length>1&&e.pop():i!=="."&&e.push(i)}),e.length>1?e.join("/"):"/"}function Im(s,t,e,n){return`Cannot include a '${s}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function GI(s){return s.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function Hy(s){let t=GI(s);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function zy(s,t,e,n=!1){let i;typeof s=="string"?i=ql(s):(i={...s},Ne(!i.pathname||!i.pathname.includes("?"),Im("?","pathname","search",i)),Ne(!i.pathname||!i.pathname.includes("#"),Im("#","pathname","hash",i)),Ne(!i.search||!i.search.includes("#"),Im("#","search","hash",i)));let a=s===""||i.pathname==="",l=a?"/":i.pathname,u;if(l==null)u=e;else{let y=t.length-1;if(!n&&l.startsWith("..")){let v=l.split("/");for(;v[0]==="..";)v.shift(),y-=1;i.pathname=v.join("/")}u=y>=0?t[y]:"/"}let h=HI(i,u),f=l&&l!=="/"&&l.endsWith("/"),p=(a||l===".")&&e.endsWith("/");return!h.pathname.endsWith("/")&&(f||p)&&(h.pathname+="/"),h}var mr=s=>s.join("/").replace(/\/\/+/g,"/"),qI=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),$I=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,YI=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function XI(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}var dT=["POST","PUT","PATCH","DELETE"];new Set(dT);var KI=["GET",...dT];new Set(KI);var $l=st.createContext(null);$l.displayName="DataRouter";var Kf=st.createContext(null);Kf.displayName="DataRouterState";st.createContext(!1);var fT=st.createContext({isTransitioning:!1});fT.displayName="ViewTransition";var WI=st.createContext(new Map);WI.displayName="Fetchers";var QI=st.createContext(null);QI.displayName="Await";var es=st.createContext(null);es.displayName="Navigation";var Ju=st.createContext(null);Ju.displayName="Location";var Os=st.createContext({outlet:null,matches:[],isDataRoute:!1});Os.displayName="Route";var Gy=st.createContext(null);Gy.displayName="RouteError";function JI(s,{relative:t}={}){Ne(Yl(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:n}=st.useContext(es),{hash:i,pathname:a,search:l}=Zu(s,{relative:t}),u=a;return e!=="/"&&(u=a==="/"?e:mr([e,a])),n.createHref({pathname:u,search:l,hash:i})}function Yl(){return st.useContext(Ju)!=null}function Tr(){return Ne(Yl(),"useLocation() may be used only in the context of a <Router> component."),st.useContext(Ju).location}var pT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function gT(s){st.useContext(es).static||st.useLayoutEffect(s)}function Xl(){let{isDataRoute:s}=st.useContext(Os);return s?hx():ZI()}function ZI(){Ne(Yl(),"useNavigate() may be used only in the context of a <Router> component.");let s=st.useContext($l),{basename:t,navigator:e}=st.useContext(es),{matches:n}=st.useContext(Os),{pathname:i}=Tr(),a=JSON.stringify(Hy(n)),l=st.useRef(!1);return gT(()=>{l.current=!0}),st.useCallback((h,f={})=>{if(ts(l.current,pT),!l.current)return;if(typeof h=="number"){e.go(h);return}let p=zy(h,JSON.parse(a),i,f.relative==="path");s==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:mr([t,p.pathname])),(f.replace?e.replace:e.push)(p,f.state,f)},[t,e,a,i,s])}st.createContext(null);function Zu(s,{relative:t}={}){let{matches:e}=st.useContext(Os),{pathname:n}=Tr(),i=JSON.stringify(Hy(e));return st.useMemo(()=>zy(s,JSON.parse(i),n,t==="path"),[s,i,n,t])}function tx(s,t){return mT(s,t)}function mT(s,t,e,n,i){Ne(Yl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=st.useContext(es),{matches:l}=st.useContext(Os),u=l[l.length-1],h=u?u.params:{},f=u?u.pathname:"/",p=u?u.pathnameBase:"/",y=u&&u.route;{let k=y&&y.path||"";yT(f,!y||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let v=Tr(),b;if(t){let k=typeof t=="string"?ql(t):t;Ne(p==="/"||k.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${k.pathname}" was given in the \`location\` prop.`),b=k}else b=v;let T=b.pathname||"/",S=T;if(p!=="/"){let k=p.replace(/^\//,"").split("/");S="/"+T.replace(/^\//,"").split("/").slice(k.length).join("/")}let I=cT(s,{pathname:S});ts(y||I!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),ts(I==null||I[I.length-1].route.element!==void 0||I[I.length-1].route.Component!==void 0||I[I.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=rx(I&&I.map(k=>Object.assign({},k,{params:Object.assign({},h,k.params),pathname:mr([p,a.encodeLocation?a.encodeLocation(k.pathname).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?p:mr([p,a.encodeLocation?a.encodeLocation(k.pathnameBase).pathname:k.pathnameBase])})),l,e,n,i);return t&&x?st.createElement(Ju.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},x):x}function ex(){let s=ux(),t=XI(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),e=s instanceof Error?s.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",s),l=st.createElement(st.Fragment,null,st.createElement("p",null,"💿 Hey developer 👋"),st.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",st.createElement("code",{style:a},"ErrorBoundary")," or"," ",st.createElement("code",{style:a},"errorElement")," prop on your route.")),st.createElement(st.Fragment,null,st.createElement("h2",null,"Unexpected Application Error!"),st.createElement("h3",{style:{fontStyle:"italic"}},t),e?st.createElement("pre",{style:i},e):null,l)}var nx=st.createElement(ex,null),ix=class extends st.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,t){return t.location!==s.location||t.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:t.error,location:t.location,revalidation:s.revalidation||t.revalidation}}componentDidCatch(s,t){this.props.unstable_onError?this.props.unstable_onError(s,t):console.error("React Router caught the following error during render",s)}render(){return this.state.error!==void 0?st.createElement(Os.Provider,{value:this.props.routeContext},st.createElement(Gy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function sx({routeContext:s,match:t,children:e}){let n=st.useContext($l);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),st.createElement(Os.Provider,{value:s},e)}function rx(s,t=[],e=null,n=null,i=null){if(s==null){if(!e)return null;if(e.errors)s=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)s=e.matches;else return null}let a=s,l=e?.errors;if(l!=null){let f=a.findIndex(p=>p.route.id&&l?.[p.route.id]!==void 0);Ne(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let u=!1,h=-1;if(e)for(let f=0;f<a.length;f++){let p=a[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=f),p.route.id){let{loaderData:y,errors:v}=e,b=p.route.loader&&!y.hasOwnProperty(p.route.id)&&(!v||v[p.route.id]===void 0);if(p.route.lazy||b){u=!0,h>=0?a=a.slice(0,h+1):a=[a[0]];break}}}return a.reduceRight((f,p,y)=>{let v,b=!1,T=null,S=null;e&&(v=l&&p.route.id?l[p.route.id]:void 0,T=p.route.errorElement||nx,u&&(h<0&&y===0?(yT("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,S=null):h===y&&(b=!0,S=p.route.hydrateFallbackElement||null)));let I=t.concat(a.slice(0,y+1)),x=()=>{let k;return v?k=T:b?k=S:p.route.Component?k=st.createElement(p.route.Component,null):p.route.element?k=p.route.element:k=f,st.createElement(sx,{match:p,routeContext:{outlet:f,matches:I,isDataRoute:e!=null},children:k})};return e&&(p.route.ErrorBoundary||p.route.errorElement||y===0)?st.createElement(ix,{location:e.location,revalidation:e.revalidation,component:T,error:v,children:x(),routeContext:{outlet:null,matches:I,isDataRoute:!0},unstable_onError:n}):x()},null)}function qy(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ax(s){let t=st.useContext($l);return Ne(t,qy(s)),t}function ox(s){let t=st.useContext(Kf);return Ne(t,qy(s)),t}function lx(s){let t=st.useContext(Os);return Ne(t,qy(s)),t}function $y(s){let t=lx(s),e=t.matches[t.matches.length-1];return Ne(e.route.id,`${s} can only be used on routes that contain a unique "id"`),e.route.id}function cx(){return $y("useRouteId")}function ux(){let s=st.useContext(Gy),t=ox("useRouteError"),e=$y("useRouteError");return s!==void 0?s:t.errors?.[e]}function hx(){let{router:s}=ax("useNavigate"),t=$y("useNavigate"),e=st.useRef(!1);return gT(()=>{e.current=!0}),st.useCallback(async(i,a={})=>{ts(e.current,pT),e.current&&(typeof i=="number"?s.navigate(i):await s.navigate(i,{fromRouteId:t,...a}))},[s,t])}var FE={};function yT(s,t,e){!t&&!FE[s]&&(FE[s]=!0,ts(!1,e))}st.memo(dx);function dx({routes:s,future:t,state:e,unstable_onError:n}){return mT(s,void 0,e,n,t)}function fx({to:s,replace:t,state:e,relative:n}){Ne(Yl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=st.useContext(es);ts(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=st.useContext(Os),{pathname:l}=Tr(),u=Xl(),h=zy(s,Hy(a),l,n==="path"),f=JSON.stringify(h);return st.useEffect(()=>{u(JSON.parse(f),{replace:t,state:e,relative:n})},[u,f,n,t,e]),null}function bl(s){Ne(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function px({basename:s="/",children:t=null,location:e,navigationType:n="POP",navigator:i,static:a=!1}){Ne(!Yl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=s.replace(/^\/*/,"/"),u=st.useMemo(()=>({basename:l,navigator:i,static:a,future:{}}),[l,i,a]);typeof e=="string"&&(e=ql(e));let{pathname:h="/",search:f="",hash:p="",state:y=null,key:v="default"}=e,b=st.useMemo(()=>{let T=vr(h,l);return T==null?null:{location:{pathname:T,search:f,hash:p,state:y,key:v},navigationType:n}},[l,h,f,p,y,v,n]);return ts(b!=null,`<Router basename="${l}"> is not able to match the URL "${h}${f}${p}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:st.createElement(es.Provider,{value:u},st.createElement(Ju.Provider,{children:t,value:b}))}function gx({children:s,location:t}){return tx(ty(s),t)}function ty(s,t=[]){let e=[];return st.Children.forEach(s,(n,i)=>{if(!st.isValidElement(n))return;let a=[...t,i];if(n.type===st.Fragment){e.push.apply(e,ty(n.props.children,a));return}Ne(n.type===bl,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ne(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=ty(n.props.children,a)),e.push(l)}),e}var of="get",lf="application/x-www-form-urlencoded";function Wf(s){return s!=null&&typeof s.tagName=="string"}function mx(s){return Wf(s)&&s.tagName.toLowerCase()==="button"}function yx(s){return Wf(s)&&s.tagName.toLowerCase()==="form"}function _x(s){return Wf(s)&&s.tagName.toLowerCase()==="input"}function vx(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function bx(s,t){return s.button===0&&(!t||t==="_self")&&!vx(s)}var Vd=null;function Ex(){if(Vd===null)try{new FormData(document.createElement("form"),0),Vd=!1}catch{Vd=!0}return Vd}var Ax=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function xm(s){return s!=null&&!Ax.has(s)?(ts(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${lf}"`),null):s}function wx(s,t){let e,n,i,a,l;if(yx(s)){let u=s.getAttribute("action");n=u?vr(u,t):null,e=s.getAttribute("method")||of,i=xm(s.getAttribute("enctype"))||lf,a=new FormData(s)}else if(mx(s)||_x(s)&&(s.type==="submit"||s.type==="image")){let u=s.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=s.getAttribute("formaction")||u.getAttribute("action");if(n=h?vr(h,t):null,e=s.getAttribute("formmethod")||u.getAttribute("method")||of,i=xm(s.getAttribute("formenctype"))||xm(u.getAttribute("enctype"))||lf,a=new FormData(u,s),!Ex()){let{name:f,type:p,value:y}=s;if(p==="image"){let v=f?`${f}.`:"";a.append(`${v}x`,"0"),a.append(`${v}y`,"0")}else f&&a.append(f,y)}}else{if(Wf(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=of,n=null,i=lf,l=s}return a&&i==="text/plain"&&(l=a,a=void 0),{action:n,method:e.toLowerCase(),encType:i,formData:a,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Yy(s,t){if(s===!1||s===null||typeof s>"u")throw new Error(t)}function Tx(s,t,e){let n=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return n.pathname==="/"?n.pathname=`_root.${e}`:t&&vr(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${e}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${e}`,n}async function Sx(s,t){if(s.id in t)return t[s.id];try{let e=await import(s.module);return t[s.id]=e,e}catch(e){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Cx(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function Rx(s,t,e){let n=await Promise.all(s.map(async i=>{let a=t.routes[i.route.id];if(a){let l=await Sx(a,e);return l.links?l.links():[]}return[]}));return Nx(n.flat(1).filter(Cx).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function UE(s,t,e,n,i,a){let l=(h,f)=>e[f]?h.route.id!==e[f].route.id:!0,u=(h,f)=>e[f].pathname!==h.pathname||e[f].route.path?.endsWith("*")&&e[f].params["*"]!==h.params["*"];return a==="assets"?t.filter((h,f)=>l(h,f)||u(h,f)):a==="data"?t.filter((h,f)=>{let p=n.routes[h.route.id];if(!p||!p.hasLoader)return!1;if(l(h,f)||u(h,f))return!0;if(h.route.shouldRevalidate){let y=h.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function Ix(s,t,{includeHydrateFallback:e}={}){return xx(s.map(n=>{let i=t.routes[n.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),e&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function xx(s){return[...new Set(s)]}function Dx(s){let t={},e=Object.keys(s).sort();for(let n of e)t[n]=s[n];return t}function Nx(s,t){let e=new Set;return new Set(t),s.reduce((n,i)=>{let a=JSON.stringify(Dx(i));return e.has(a)||(e.add(a),n.push({key:a,link:i})),n},[])}function _T(){let s=st.useContext($l);return Yy(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function Mx(){let s=st.useContext(Kf);return Yy(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var Xy=st.createContext(void 0);Xy.displayName="FrameworkContext";function vT(){let s=st.useContext(Xy);return Yy(s,"You must render this element inside a <HydratedRouter> element"),s}function kx(s,t){let e=st.useContext(Xy),[n,i]=st.useState(!1),[a,l]=st.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:f,onMouseLeave:p,onTouchStart:y}=t,v=st.useRef(null);st.useEffect(()=>{if(s==="render"&&l(!0),s==="viewport"){let S=x=>{x.forEach(k=>{l(k.isIntersecting)})},I=new IntersectionObserver(S,{threshold:.5});return v.current&&I.observe(v.current),()=>{I.disconnect()}}},[s]),st.useEffect(()=>{if(n){let S=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(S)}}},[n]);let b=()=>{i(!0)},T=()=>{i(!1),l(!1)};return e?s!=="intent"?[a,v,{}]:[a,v,{onFocus:au(u,b),onBlur:au(h,T),onMouseEnter:au(f,b),onMouseLeave:au(p,T),onTouchStart:au(y,b)}]:[!1,v,{}]}function au(s,t){return e=>{s&&s(e),e.defaultPrevented||t(e)}}function Px({page:s,...t}){let{router:e}=_T(),n=st.useMemo(()=>cT(e.routes,s,e.basename),[e.routes,s,e.basename]);return n?st.createElement(Lx,{page:s,matches:n,...t}):null}function Ox(s){let{manifest:t,routeModules:e}=vT(),[n,i]=st.useState([]);return st.useEffect(()=>{let a=!1;return Rx(s,t,e).then(l=>{a||i(l)}),()=>{a=!0}},[s,t,e]),n}function Lx({page:s,matches:t,...e}){let n=Tr(),{manifest:i,routeModules:a}=vT(),{basename:l}=_T(),{loaderData:u,matches:h}=Mx(),f=st.useMemo(()=>UE(s,t,h,i,n,"data"),[s,t,h,i,n]),p=st.useMemo(()=>UE(s,t,h,i,n,"assets"),[s,t,h,i,n]),y=st.useMemo(()=>{if(s===n.pathname+n.search+n.hash)return[];let T=new Set,S=!1;if(t.forEach(x=>{let k=i.routes[x.route.id];!k||!k.hasLoader||(!f.some(O=>O.route.id===x.route.id)&&x.route.id in u&&a[x.route.id]?.shouldRevalidate||k.hasClientLoader?S=!0:T.add(x.route.id))}),T.size===0)return[];let I=Tx(s,l,"data");return S&&T.size>0&&I.searchParams.set("_routes",t.filter(x=>T.has(x.route.id)).map(x=>x.route.id).join(",")),[I.pathname+I.search]},[l,u,n,i,f,t,s,a]),v=st.useMemo(()=>Ix(p,i),[p,i]),b=Ox(p);return st.createElement(st.Fragment,null,y.map(T=>st.createElement("link",{key:T,rel:"prefetch",as:"fetch",href:T,...e})),v.map(T=>st.createElement("link",{key:T,rel:"modulepreload",href:T,...e})),b.map(({key:T,link:S})=>st.createElement("link",{key:T,nonce:e.nonce,...S})))}function Bx(...s){return t=>{s.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var bT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{bT&&(window.__reactRouterVersion="7.8.2")}catch{}function ET({basename:s,children:t,window:e}){let n=st.useRef();n.current==null&&(n.current=SI({window:e,v5Compat:!0}));let i=n.current,[a,l]=st.useState({action:i.action,location:i.location}),u=st.useCallback(h=>{st.startTransition(()=>l(h))},[l]);return st.useLayoutEffect(()=>i.listen(u),[i,u]),st.createElement(px,{basename:s,children:t,location:a.location,navigationType:a.action,navigator:i})}var AT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wu=st.forwardRef(function({onClick:t,discover:e="render",prefetch:n="none",relative:i,reloadDocument:a,replace:l,state:u,target:h,to:f,preventScrollReset:p,viewTransition:y,...v},b){let{basename:T}=st.useContext(es),S=typeof f=="string"&&AT.test(f),I,x=!1;if(typeof f=="string"&&S&&(I=f,bT))try{let B=new URL(window.location.href),j=f.startsWith("//")?new URL(B.protocol+f):new URL(f),V=vr(j.pathname,T);j.origin===B.origin&&V!=null?f=V+j.search+j.hash:x=!0}catch{ts(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let k=JI(f,{relative:i}),[O,G,H]=kx(n,v),K=jx(f,{replace:l,state:u,target:h,preventScrollReset:p,relative:i,viewTransition:y});function P(B){t&&t(B),B.defaultPrevented||K(B)}let N=st.createElement("a",{...v,...H,href:I||k,onClick:x||a?t:P,ref:Bx(b,G),target:h,"data-discover":!S&&e==="render"?"true":void 0});return O&&!S?st.createElement(st.Fragment,null,N,st.createElement(Px,{page:k})):N});wu.displayName="Link";var Fx=st.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:n="",end:i=!1,style:a,to:l,viewTransition:u,children:h,...f},p){let y=Zu(l,{relative:f.relative}),v=Tr(),b=st.useContext(Kf),{navigator:T,basename:S}=st.useContext(es),I=b!=null&&$x(y)&&u===!0,x=T.encodeLocation?T.encodeLocation(y).pathname:y.pathname,k=v.pathname,O=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;e||(k=k.toLowerCase(),O=O?O.toLowerCase():null,x=x.toLowerCase()),O&&S&&(O=vr(O,S)||O);const G=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let H=k===x||!i&&k.startsWith(x)&&k.charAt(G)==="/",K=O!=null&&(O===x||!i&&O.startsWith(x)&&O.charAt(x.length)==="/"),P={isActive:H,isPending:K,isTransitioning:I},N=H?t:void 0,B;typeof n=="function"?B=n(P):B=[n,H?"active":null,K?"pending":null,I?"transitioning":null].filter(Boolean).join(" ");let j=typeof a=="function"?a(P):a;return st.createElement(wu,{...f,"aria-current":N,className:B,ref:p,style:j,to:l,viewTransition:u},typeof h=="function"?h(P):h)});Fx.displayName="NavLink";var Ux=st.forwardRef(({discover:s="render",fetcherKey:t,navigate:e,reloadDocument:n,replace:i,state:a,method:l=of,action:u,onSubmit:h,relative:f,preventScrollReset:p,viewTransition:y,...v},b)=>{let T=Gx(),S=qx(u,{relative:f}),I=l.toLowerCase()==="get"?"get":"post",x=typeof u=="string"&&AT.test(u),k=O=>{if(h&&h(O),O.defaultPrevented)return;O.preventDefault();let G=O.nativeEvent.submitter,H=G?.getAttribute("formmethod")||l;T(G||O.currentTarget,{fetcherKey:t,method:H,navigate:e,replace:i,state:a,relative:f,preventScrollReset:p,viewTransition:y})};return st.createElement("form",{ref:b,method:I,action:S,onSubmit:n?h:k,...v,"data-discover":!x&&s==="render"?"true":void 0})});Ux.displayName="Form";function Vx(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function wT(s){let t=st.useContext($l);return Ne(t,Vx(s)),t}function jx(s,{target:t,replace:e,state:n,preventScrollReset:i,relative:a,viewTransition:l}={}){let u=Xl(),h=Tr(),f=Zu(s,{relative:a});return st.useCallback(p=>{if(bx(p,t)){p.preventDefault();let y=e!==void 0?e:Pu(h)===Pu(f);u(s,{replace:y,state:n,preventScrollReset:i,relative:a,viewTransition:l})}},[h,u,f,e,n,t,s,i,a,l])}var Hx=0,zx=()=>`__${String(++Hx)}__`;function Gx(){let{router:s}=wT("useSubmit"),{basename:t}=st.useContext(es),e=cx();return st.useCallback(async(n,i={})=>{let{action:a,method:l,encType:u,formData:h,body:f}=wx(n,t);if(i.navigate===!1){let p=i.fetcherKey||zx();await s.fetch(p,e,i.action||a,{preventScrollReset:i.preventScrollReset,formData:h,body:f,formMethod:i.method||l,formEncType:i.encType||u,flushSync:i.flushSync})}else await s.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:h,body:f,formMethod:i.method||l,formEncType:i.encType||u,replace:i.replace,state:i.state,fromRouteId:e,flushSync:i.flushSync,viewTransition:i.viewTransition})},[s,t,e])}function qx(s,{relative:t}={}){let{basename:e}=st.useContext(es),n=st.useContext(Os);Ne(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),a={...Zu(s||".",{relative:t})},l=Tr();if(s==null){a.search=l.search;let u=new URLSearchParams(a.search),h=u.getAll("index");if(h.some(p=>p==="")){u.delete("index"),h.filter(y=>y).forEach(y=>u.append("index",y));let p=u.toString();a.search=p?`?${p}`:""}}return(!s||s===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(a.pathname=a.pathname==="/"?e:mr([e,a.pathname])),Pu(a)}function $x(s,{relative:t}={}){let e=st.useContext(fT);Ne(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=wT("useViewTransitionState"),i=Zu(s,{relative:t});if(!e.isTransitioning)return!1;let a=vr(e.currentLocation.pathname,n)||e.currentLocation.pathname,l=vr(e.nextLocation.pathname,n)||e.nextLocation.pathname;return wf(i.pathname,l)!=null||wf(i.pathname,a)!=null}const Yx="/AuthentiDoc/assets/logo-BO3XLrPh.png",Xx=()=>{};var VE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TT=function(s){const t=[];let e=0;for(let n=0;n<s.length;n++){let i=s.charCodeAt(n);i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=i&63|128):(i&64512)===55296&&n+1<s.length&&(s.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(s.charCodeAt(++n)&1023),t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=i&63|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=i&63|128)}return t},Kx=function(s){const t=[];let e=0,n=0;for(;e<s.length;){const i=s[e++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=s[e++];t[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=s[e++],l=s[e++],u=s[e++],h=((i&7)<<18|(a&63)<<12|(l&63)<<6|u&63)-65536;t[n++]=String.fromCharCode(55296+(h>>10)),t[n++]=String.fromCharCode(56320+(h&1023))}else{const a=s[e++],l=s[e++];t[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|l&63)}}return t.join("")},ST={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,t){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<s.length;i+=3){const a=s[i],l=i+1<s.length,u=l?s[i+1]:0,h=i+2<s.length,f=h?s[i+2]:0,p=a>>2,y=(a&3)<<4|u>>4;let v=(u&15)<<2|f>>6,b=f&63;h||(b=64,l||(v=64)),n.push(e[p],e[y],e[v],e[b])}return n.join("")},encodeString(s,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(s):this.encodeByteArray(TT(s),t)},decodeString(s,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(s):Kx(this.decodeStringToByteArray(s,t))},decodeStringToByteArray(s,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<s.length;){const a=e[s.charAt(i++)],u=i<s.length?e[s.charAt(i)]:0;++i;const f=i<s.length?e[s.charAt(i)]:64;++i;const y=i<s.length?e[s.charAt(i)]:64;if(++i,a==null||u==null||f==null||y==null)throw new Wx;const v=a<<2|u>>4;if(n.push(v),f!==64){const b=u<<4&240|f>>2;if(n.push(b),y!==64){const T=f<<6&192|y;n.push(T)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class Wx extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Qx=function(s){const t=TT(s);return ST.encodeByteArray(t,!0)},Tf=function(s){return Qx(s).replace(/\./g,"")},CT=function(s){try{return ST.decodeString(s,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zx=()=>Jx().__FIREBASE_DEFAULTS__,tD=()=>{if(typeof process>"u"||typeof VE>"u")return;const s=VE.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},eD=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=s&&CT(s[1]);return t&&JSON.parse(t)},Qf=()=>{try{return Xx()||Zx()||tD()||eD()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},RT=s=>Qf()?.emulatorHosts?.[s],IT=s=>{const t=RT(s);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),n]:[t.substring(0,e),n]},xT=()=>Qf()?.config,DT=s=>Qf()?.[`_${s}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ta(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ky(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(s,t){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},n=t||"demo-project",i=s.iat||0,a=s.sub||s.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Tf(JSON.stringify(e)),Tf(JSON.stringify(l)),""].join(".")}const Tu={};function iD(){const s={prod:[],emulator:[]};for(const t of Object.keys(Tu))Tu[t]?s.emulator.push(t):s.prod.push(t);return s}function sD(s){let t=document.getElementById(s),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",s),e=!0),{created:e,element:t}}let jE=!1;function Wy(s,t){if(typeof window>"u"||typeof document>"u"||!Ta(window.location.host)||Tu[s]===t||Tu[s]||jE)return;Tu[s]=t;function e(v){return`__firebase__banner__${v}`}const n="__firebase__banner",a=iD().prod.length>0;function l(){const v=document.getElementById(n);v&&v.remove()}function u(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function h(v,b){v.setAttribute("width","24"),v.setAttribute("id",b),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function f(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{jE=!0,l()},v}function p(v,b){v.setAttribute("id",b),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function y(){const v=sD(n),b=e("text"),T=document.getElementById(b)||document.createElement("span"),S=e("learnmore"),I=document.getElementById(S)||document.createElement("a"),x=e("preprendIcon"),k=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const O=v.element;u(O),p(I,S);const G=f();h(k,x),O.append(k,T,I,G),document.body.appendChild(O)}a?(T.innerText="Preview backend disconnected.",k.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(k.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function rD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zn())}function aD(){const s=Qf()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function oD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function lD(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function cD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function uD(){const s=zn();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function hD(){return!aD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function dD(){try{return typeof indexedDB=="object"}catch{return!1}}function fD(){return new Promise((s,t)=>{try{let e=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(n),s(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pD="FirebaseError";class Ls extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name=pD,Object.setPrototypeOf(this,Ls.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,th.prototype.create)}}class th{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,a=this.errors[t],l=a?gD(a,n):"Error",u=`${this.serviceName}: ${l} (${i}).`;return new Ls(i,u,n)}}function gD(s,t){return s.replace(mD,(e,n)=>{const i=t[n];return i!=null?String(i):`<${n}?>`})}const mD=/\{\$([^}]+)}/g;function yD(s){for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t))return!1;return!0}function ho(s,t){if(s===t)return!0;const e=Object.keys(s),n=Object.keys(t);for(const i of e){if(!n.includes(i))return!1;const a=s[i],l=t[i];if(HE(a)&&HE(l)){if(!ho(a,l))return!1}else if(a!==l)return!1}for(const i of n)if(!e.includes(i))return!1;return!0}function HE(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(s){const t=[];for(const[e,n]of Object.entries(s))Array.isArray(n)?n.forEach(i=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function fu(s){const t={};return s.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");t[decodeURIComponent(i)]=decodeURIComponent(a)}}),t}function pu(s){const t=s.indexOf("?");if(!t)return"";const e=s.indexOf("#",t);return s.substring(t,e>0?e:void 0)}function _D(s,t){const e=new vD(s,t);return e.subscribe.bind(e)}class vD{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,n){let i;if(t===void 0&&e===void 0&&n===void 0)throw new Error("Missing Observer.");bD(t,["next","error","complete"])?i=t:i={next:t,error:e,complete:n},i.next===void 0&&(i.next=Dm),i.error===void 0&&(i.error=Dm),i.complete===void 0&&(i.complete=Dm);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function bD(s,t){if(typeof s!="object"||s===null)return!1;for(const e of t)if(e in s&&typeof s[e]=="function")return!0;return!1}function Dm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xe(s){return s&&s._delegate?s._delegate:s}class ga{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const no="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const n=new nD;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),n=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(wD(t))try{this.getOrInitializeService({instanceIdentifier:no})}catch{}for(const[e,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(t=no){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=no){return this.instances.has(t)}getOptions(t=no){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[a,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(a);n===u&&l.resolve(i)}return i}onInit(t,e){const n=this.normalizeInstanceIdentifier(e),i=this.onInitCallbacks.get(n)??new Set;i.add(t),this.onInitCallbacks.set(n,i);const a=this.instances.get(n);return a&&t(a,n),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:AD(t),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=no){return this.component?this.component.multipleInstances?t:no:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function AD(s){return s===no?void 0:s}function wD(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new ED(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jt;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Jt||(Jt={}));const SD={debug:Jt.DEBUG,verbose:Jt.VERBOSE,info:Jt.INFO,warn:Jt.WARN,error:Jt.ERROR,silent:Jt.SILENT},CD=Jt.INFO,RD={[Jt.DEBUG]:"log",[Jt.VERBOSE]:"log",[Jt.INFO]:"info",[Jt.WARN]:"warn",[Jt.ERROR]:"error"},ID=(s,t,...e)=>{if(t<s.logLevel)return;const n=new Date().toISOString(),i=RD[t];if(i)console[i](`[${n}]  ${s.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Qy{constructor(t){this.name=t,this._logLevel=CD,this._logHandler=ID,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Jt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?SD[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Jt.DEBUG,...t),this._logHandler(this,Jt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Jt.VERBOSE,...t),this._logHandler(this,Jt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Jt.INFO,...t),this._logHandler(this,Jt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Jt.WARN,...t),this._logHandler(this,Jt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Jt.ERROR,...t),this._logHandler(this,Jt.ERROR,...t)}}const xD=(s,t)=>t.some(e=>s instanceof e);let zE,GE;function DD(){return zE||(zE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ND(){return GE||(GE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const MT=new WeakMap,ey=new WeakMap,kT=new WeakMap,Nm=new WeakMap,Jy=new WeakMap;function MD(s){const t=new Promise((e,n)=>{const i=()=>{s.removeEventListener("success",a),s.removeEventListener("error",l)},a=()=>{e(ua(s.result)),i()},l=()=>{n(s.error),i()};s.addEventListener("success",a),s.addEventListener("error",l)});return t.then(e=>{e instanceof IDBCursor&&MT.set(e,s)}).catch(()=>{}),Jy.set(t,s),t}function kD(s){if(ey.has(s))return;const t=new Promise((e,n)=>{const i=()=>{s.removeEventListener("complete",a),s.removeEventListener("error",l),s.removeEventListener("abort",l)},a=()=>{e(),i()},l=()=>{n(s.error||new DOMException("AbortError","AbortError")),i()};s.addEventListener("complete",a),s.addEventListener("error",l),s.addEventListener("abort",l)});ey.set(s,t)}let ny={get(s,t,e){if(s instanceof IDBTransaction){if(t==="done")return ey.get(s);if(t==="objectStoreNames")return s.objectStoreNames||kT.get(s);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return ua(s[t])},set(s,t,e){return s[t]=e,!0},has(s,t){return s instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in s}};function PD(s){ny=s(ny)}function OD(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const n=s.call(Mm(this),t,...e);return kT.set(n,t.sort?t.sort():[t]),ua(n)}:ND().includes(s)?function(...t){return s.apply(Mm(this),t),ua(MT.get(this))}:function(...t){return ua(s.apply(Mm(this),t))}}function LD(s){return typeof s=="function"?OD(s):(s instanceof IDBTransaction&&kD(s),xD(s,DD())?new Proxy(s,ny):s)}function ua(s){if(s instanceof IDBRequest)return MD(s);if(Nm.has(s))return Nm.get(s);const t=LD(s);return t!==s&&(Nm.set(s,t),Jy.set(t,s)),t}const Mm=s=>Jy.get(s);function BD(s,t,{blocked:e,upgrade:n,blocking:i,terminated:a}={}){const l=indexedDB.open(s,t),u=ua(l);return n&&l.addEventListener("upgradeneeded",h=>{n(ua(l.result),h.oldVersion,h.newVersion,ua(l.transaction),h)}),e&&l.addEventListener("blocked",h=>e(h.oldVersion,h.newVersion,h)),u.then(h=>{a&&h.addEventListener("close",()=>a()),i&&h.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),u}const FD=["get","getKey","getAll","getAllKeys","count"],UD=["put","add","delete","clear"],km=new Map;function qE(s,t){if(!(s instanceof IDBDatabase&&!(t in s)&&typeof t=="string"))return;if(km.get(t))return km.get(t);const e=t.replace(/FromIndex$/,""),n=t!==e,i=UD.includes(e);if(!(e in(n?IDBIndex:IDBObjectStore).prototype)||!(i||FD.includes(e)))return;const a=async function(l,...u){const h=this.transaction(l,i?"readwrite":"readonly");let f=h.store;return n&&(f=f.index(u.shift())),(await Promise.all([f[e](...u),i&&h.done]))[0]};return km.set(t,a),a}PD(s=>({...s,get:(t,e,n)=>qE(t,e)||s.get(t,e,n),has:(t,e)=>!!qE(t,e)||s.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(jD(e)){const n=e.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(e=>e).join(" ")}}function jD(s){return s.getComponent()?.type==="VERSION"}const iy="@firebase/app",$E="0.14.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br=new Qy("@firebase/app"),HD="@firebase/app-compat",zD="@firebase/analytics-compat",GD="@firebase/analytics",qD="@firebase/app-check-compat",$D="@firebase/app-check",YD="@firebase/auth",XD="@firebase/auth-compat",KD="@firebase/database",WD="@firebase/data-connect",QD="@firebase/database-compat",JD="@firebase/functions",ZD="@firebase/functions-compat",tN="@firebase/installations",eN="@firebase/installations-compat",nN="@firebase/messaging",iN="@firebase/messaging-compat",sN="@firebase/performance",rN="@firebase/performance-compat",aN="@firebase/remote-config",oN="@firebase/remote-config-compat",lN="@firebase/storage",cN="@firebase/storage-compat",uN="@firebase/firestore",hN="@firebase/ai",dN="@firebase/firestore-compat",fN="firebase",pN="12.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sy="[DEFAULT]",gN={[iy]:"fire-core",[HD]:"fire-core-compat",[GD]:"fire-analytics",[zD]:"fire-analytics-compat",[$D]:"fire-app-check",[qD]:"fire-app-check-compat",[YD]:"fire-auth",[XD]:"fire-auth-compat",[KD]:"fire-rtdb",[WD]:"fire-data-connect",[QD]:"fire-rtdb-compat",[JD]:"fire-fn",[ZD]:"fire-fn-compat",[tN]:"fire-iid",[eN]:"fire-iid-compat",[nN]:"fire-fcm",[iN]:"fire-fcm-compat",[sN]:"fire-perf",[rN]:"fire-perf-compat",[aN]:"fire-rc",[oN]:"fire-rc-compat",[lN]:"fire-gcs",[cN]:"fire-gcs-compat",[uN]:"fire-fst",[dN]:"fire-fst-compat",[hN]:"fire-vertex","fire-js":"fire-js",[fN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sf=new Map,mN=new Map,ry=new Map;function YE(s,t){try{s.container.addComponent(t)}catch(e){br.debug(`Component ${t.name} failed to register with FirebaseApp ${s.name}`,e)}}function fo(s){const t=s.name;if(ry.has(t))return br.debug(`There were multiple attempts to register component ${t}.`),!1;ry.set(t,s);for(const e of Sf.values())YE(e,s);for(const e of mN.values())YE(e,s);return!0}function Jf(s,t){const e=s.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),s.container.getProvider(t)}function li(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ha=new th("app","Firebase",yN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(t,e,n){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ga("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ha.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao=pN;function PT(s,t={}){let e=s;typeof t!="object"&&(t={name:t});const n={name:sy,automaticDataCollectionEnabled:!0,...t},i=n.name;if(typeof i!="string"||!i)throw ha.create("bad-app-name",{appName:String(i)});if(e||(e=xT()),!e)throw ha.create("no-options");const a=Sf.get(i);if(a){if(ho(e,a.options)&&ho(n,a.config))return a;throw ha.create("duplicate-app",{appName:i})}const l=new TD(i);for(const h of ry.values())l.addComponent(h);const u=new _N(e,n,l);return Sf.set(i,u),u}function Zy(s=sy){const t=Sf.get(s);if(!t&&s===sy&&xT())return PT();if(!t)throw ha.create("no-app",{appName:s});return t}function Cs(s,t,e){let n=gN[s]??s;e&&(n+=`-${e}`);const i=n.match(/\s|\//),a=t.match(/\s|\//);if(i||a){const l=[`Unable to register library "${n}" with version "${t}":`];i&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),br.warn(l.join(" "));return}fo(new ga(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vN="firebase-heartbeat-database",bN=1,Ou="firebase-heartbeat-store";let Pm=null;function OT(){return Pm||(Pm=BD(vN,bN,{upgrade:(s,t)=>{switch(t){case 0:try{s.createObjectStore(Ou)}catch(e){console.warn(e)}}}}).catch(s=>{throw ha.create("idb-open",{originalErrorMessage:s.message})})),Pm}async function EN(s){try{const e=(await OT()).transaction(Ou),n=await e.objectStore(Ou).get(LT(s));return await e.done,n}catch(t){if(t instanceof Ls)br.warn(t.message);else{const e=ha.create("idb-get",{originalErrorMessage:t?.message});br.warn(e.message)}}}async function XE(s,t){try{const n=(await OT()).transaction(Ou,"readwrite");await n.objectStore(Ou).put(t,LT(s)),await n.done}catch(e){if(e instanceof Ls)br.warn(e.message);else{const n=ha.create("idb-set",{originalErrorMessage:e?.message});br.warn(n.message)}}}function LT(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN=1024,wN=30;class TN{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new CN(e),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=KE();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:e}),this._heartbeatsCache.heartbeats.length>wN){const i=RN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){br.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=KE(),{heartbeatsToSend:e,unsentEntries:n}=SN(this._heartbeatsCache.heartbeats),i=Tf(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return br.warn(t),""}}}function KE(){return new Date().toISOString().substring(0,10)}function SN(s,t=AN){const e=[];let n=s.slice();for(const i of s){const a=e.find(l=>l.agent===i.agent);if(a){if(a.dates.push(i.date),WE(e)>t){a.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),WE(e)>t){e.pop();break}n=n.slice(1)}return{heartbeatsToSend:e,unsentEntries:n}}class CN{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return dD()?fD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await EN(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return XE(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return XE(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}else return}}function WE(s){return Tf(JSON.stringify({version:2,heartbeats:s})).length}function RN(s){if(s.length===0)return-1;let t=0,e=s[0].date;for(let n=1;n<s.length;n++)s[n].date<e&&(e=s[n].date,t=n);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IN(s){fo(new ga("platform-logger",t=>new VD(t),"PRIVATE")),fo(new ga("heartbeat",t=>new TN(t),"PRIVATE")),Cs(iy,$E,s),Cs(iy,$E,"esm2020"),Cs("fire-js","")}IN("");var xN="firebase",DN="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cs(xN,DN,"app");function BT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const NN=BT,FT=new th("auth","Firebase",BT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf=new Qy("@firebase/auth");function MN(s,...t){Cf.logLevel<=Jt.WARN&&Cf.warn(`Auth (${Ao}): ${s}`,...t)}function cf(s,...t){Cf.logLevel<=Jt.ERROR&&Cf.error(`Auth (${Ao}): ${s}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hi(s,...t){throw e_(s,...t)}function Zi(s,...t){return e_(s,...t)}function t_(s,t,e){const n={...NN(),[t]:e};return new th("auth","Firebase",n).create(t,{appName:s.name})}function yr(s){return t_(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function kN(s,t,e){const n=e;if(!(t instanceof n))throw n.name!==t.constructor.name&&Hi(s,"argument-error"),t_(s,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function e_(s,...t){if(typeof s!="string"){const e=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=s.name),s._errorFactory.create(e,...n)}return FT.create(s,...t)}function Ft(s,t,...e){if(!s)throw e_(t,...e)}function pr(s){const t="INTERNAL ASSERTION FAILED: "+s;throw cf(t),new Error(t)}function Er(s,t){s||pr(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ay(){return typeof self<"u"&&self.location?.href||""}function PN(){return QE()==="http:"||QE()==="https:"}function QE(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ON(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(PN()||lD()||"connection"in navigator)?navigator.onLine:!0}function LN(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(t,e){this.shortDelay=t,this.longDelay=e,Er(e>t,"Short delay should be less than long delay!"),this.isMobile=rD()||cD()}get(){return ON()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n_(s,t){Er(s.emulator,"Emulator should always be set here");const{url:e}=s.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;pr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;pr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;pr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],UN=new nh(3e4,6e4);function Sr(s,t){return s.tenantId&&!t.tenantId?{...t,tenantId:s.tenantId}:t}async function Cr(s,t,e,n,i={}){return VT(s,i,async()=>{let a={},l={};n&&(t==="GET"?l=n:a={body:JSON.stringify(n)});const u=eh({key:s.config.apiKey,...l}).slice(1),h=await s._getAdditionalHeaders();h["Content-Type"]="application/json",s.languageCode&&(h["X-Firebase-Locale"]=s.languageCode);const f={method:t,headers:h,...a};return oD()||(f.referrerPolicy="no-referrer"),s.emulatorConfig&&Ta(s.emulatorConfig.host)&&(f.credentials="include"),UT.fetch()(await jT(s,s.config.apiHost,e,u),f)})}async function VT(s,t,e){s._canInitEmulator=!1;const n={...BN,...t};try{const i=new jN(s),a=await Promise.race([e(),i.promise]);i.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw jd(s,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const u=a.ok?l.errorMessage:l.error.message,[h,f]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw jd(s,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw jd(s,"email-already-in-use",l);if(h==="USER_DISABLED")throw jd(s,"user-disabled",l);const p=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw t_(s,p,f);Hi(s,p)}}catch(i){if(i instanceof Ls)throw i;Hi(s,"network-request-failed",{message:String(i)})}}async function ih(s,t,e,n,i={}){const a=await Cr(s,t,e,n,i);return"mfaPendingCredential"in a&&Hi(s,"multi-factor-auth-required",{_serverResponse:a}),a}async function jT(s,t,e,n){const i=`${t}${e}?${n}`,a=s,l=a.config.emulator?n_(s.config,i):`${s.config.apiScheme}://${i}`;return FN.includes(e)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function VN(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,n)=>{this.timer=setTimeout(()=>n(Zi(this.auth,"network-request-failed")),UN.get())})}}function jd(s,t,e){const n={appName:s.name};e.email&&(n.email=e.email),e.phoneNumber&&(n.phoneNumber=e.phoneNumber);const i=Zi(s,t,n);return i.customData._tokenResponse=e,i}function JE(s){return s!==void 0&&s.enterprise!==void 0}class HN{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return VN(e.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function zN(s,t){return Cr(s,"GET","/v2/recaptchaConfig",Sr(s,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GN(s,t){return Cr(s,"POST","/v1/accounts:delete",t)}async function Rf(s,t){return Cr(s,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Su(s){if(s)try{const t=new Date(Number(s));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function qN(s,t=!1){const e=Xe(s),n=await e.getIdToken(t),i=i_(n);Ft(i&&i.exp&&i.auth_time&&i.iat,e.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,l=a?.sign_in_provider;return{claims:i,token:n,authTime:Su(Om(i.auth_time)),issuedAtTime:Su(Om(i.iat)),expirationTime:Su(Om(i.exp)),signInProvider:l||null,signInSecondFactor:a?.sign_in_second_factor||null}}function Om(s){return Number(s)*1e3}function i_(s){const[t,e,n]=s.split(".");if(t===void 0||e===void 0||n===void 0)return cf("JWT malformed, contained fewer than 3 sections"),null;try{const i=CT(e);return i?JSON.parse(i):(cf("Failed to decode base64 JWT payload"),null)}catch(i){return cf("Caught error parsing JWT payload as JSON",i?.toString()),null}}function ZE(s){const t=i_(s);return Ft(t,"internal-error"),Ft(typeof t.exp<"u","internal-error"),Ft(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lu(s,t,e=!1){if(e)return t;try{return await t}catch(n){throw n instanceof Ls&&$N(n)&&s.auth.currentUser===s&&await s.auth.signOut(),n}}function $N({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Su(this.lastLoginAt),this.creationTime=Su(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function If(s){const t=s.auth,e=await s.getIdToken(),n=await Lu(s,Rf(t,{idToken:e}));Ft(n?.users.length,t,"internal-error");const i=n.users[0];s._notifyReloadListener(i);const a=i.providerUserInfo?.length?HT(i.providerUserInfo):[],l=KN(s.providerData,a),u=s.isAnonymous,h=!(s.email&&i.passwordHash)&&!l?.length,f=u?h:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new oy(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(s,p)}async function XN(s){const t=Xe(s);await If(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function KN(s,t){return[...s.filter(n=>!t.some(i=>i.providerId===n.providerId)),...t]}function HT(s){return s.map(({providerId:t,...e})=>({providerId:t,uid:e.rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WN(s,t){const e=await VT(s,{},async()=>{const n=eh({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:a}=s.config,l=await jT(s,i,"/v1/token",`key=${a}`),u=await s._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:n};return s.emulatorConfig&&Ta(s.emulatorConfig.host)&&(h.credentials="include"),UT.fetch()(l,h)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function QN(s,t){return Cr(s,"POST","/v2/accounts:revokeToken",Sr(s,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Ft(t.idToken,"internal-error"),Ft(typeof t.idToken<"u","internal-error"),Ft(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):ZE(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){Ft(t.length!==0,"internal-error");const e=ZE(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(Ft(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:a}=await WN(t,e);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:a}=e,l=new Nl;return n&&(Ft(typeof n=="string","internal-error",{appName:t}),l.refreshToken=n),i&&(Ft(typeof i=="string","internal-error",{appName:t}),l.accessToken=i),a&&(Ft(typeof a=="number","internal-error",{appName:t}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Nl,this.toJSON())}_performRefresh(){return pr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ea(s,t){Ft(typeof s=="string"||typeof s>"u","internal-error",{appName:t})}class Qi{constructor({uid:t,auth:e,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new YN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=e,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new oy(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(t){const e=await Lu(this,this.stsTokenManager.getToken(this.auth,t));return Ft(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return qN(this,t)}reload(){return XN(this)}_assign(t){this!==t&&(Ft(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>({...e})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new Qi({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return e.metadata._copy(this.metadata),e}_onReload(t){Ft(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await If(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(li(this.auth.app))return Promise.reject(yr(this.auth));const t=await this.getIdToken();return await Lu(this,GN(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){const n=e.displayName??void 0,i=e.email??void 0,a=e.phoneNumber??void 0,l=e.photoURL??void 0,u=e.tenantId??void 0,h=e._redirectEventId??void 0,f=e.createdAt??void 0,p=e.lastLoginAt??void 0,{uid:y,emailVerified:v,isAnonymous:b,providerData:T,stsTokenManager:S}=e;Ft(y&&S,t,"internal-error");const I=Nl.fromJSON(this.name,S);Ft(typeof y=="string",t,"internal-error"),ea(n,t.name),ea(i,t.name),Ft(typeof v=="boolean",t,"internal-error"),Ft(typeof b=="boolean",t,"internal-error"),ea(a,t.name),ea(l,t.name),ea(u,t.name),ea(h,t.name),ea(f,t.name),ea(p,t.name);const x=new Qi({uid:y,auth:t,email:i,emailVerified:v,displayName:n,isAnonymous:b,photoURL:l,phoneNumber:a,tenantId:u,stsTokenManager:I,createdAt:f,lastLoginAt:p});return T&&Array.isArray(T)&&(x.providerData=T.map(k=>({...k}))),h&&(x._redirectEventId=h),x}static async _fromIdTokenResponse(t,e,n=!1){const i=new Nl;i.updateFromServerResponse(e);const a=new Qi({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await If(a),a}static async _fromGetAccountInfoResponse(t,e,n){const i=e.users[0];Ft(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?HT(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!a?.length,u=new Nl;u.updateFromIdToken(n);const h=new Qi({uid:i.localId,auth:t,stsTokenManager:u,isAnonymous:l}),f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new oy(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(h,f),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tA=new Map;function gr(s){Er(s instanceof Function,"Expected a class definition");let t=tA.get(s);return t?(Er(t instanceof s,"Instance stored in cache mismatched with class"),t):(t=new s,tA.set(s,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}zT.type="NONE";const eA=zT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uf(s,t,e){return`firebase:${s}:${t}:${e}`}class Ml{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=uf(this.userKey,i.apiKey,a),this.fullPersistenceKey=uf("persistence",i.apiKey,a),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await Rf(this.auth,{idToken:t}).catch(()=>{});return e?Qi._fromGetAccountInfoResponse(this.auth,e,t):null}return Qi._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new Ml(gr(eA),t,n);const i=(await Promise.all(e.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let a=i[0]||gr(eA);const l=uf(n,t.config.apiKey,t.name);let u=null;for(const f of e)try{const p=await f._get(l);if(p){let y;if(typeof p=="string"){const v=await Rf(t,{idToken:p}).catch(()=>{});if(!v)break;y=await Qi._fromGetAccountInfoResponse(t,v,p)}else y=Qi._fromJSON(t,p);f!==a&&(u=y),a=f;break}}catch{}const h=i.filter(f=>f._shouldAllowMigration);return!a._shouldAllowMigration||!h.length?new Ml(a,t,n):(a=h[0],u&&await a._set(l,u.toJSON()),await Promise.all(e.map(async f=>{if(f!==a)try{await f._remove(l)}catch{}})),new Ml(a,t,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nA(s){const t=s.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(YT(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(GT(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(KT(t))return"Blackberry";if(WT(t))return"Webos";if(qT(t))return"Safari";if((t.includes("chrome/")||$T(t))&&!t.includes("edge/"))return"Chrome";if(XT(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=s.match(e);if(n?.length===2)return n[1]}return"Other"}function GT(s=zn()){return/firefox\//i.test(s)}function qT(s=zn()){const t=s.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function $T(s=zn()){return/crios\//i.test(s)}function YT(s=zn()){return/iemobile/i.test(s)}function XT(s=zn()){return/android/i.test(s)}function KT(s=zn()){return/blackberry/i.test(s)}function WT(s=zn()){return/webos/i.test(s)}function s_(s=zn()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function JN(s=zn()){return s_(s)&&!!window.navigator?.standalone}function ZN(){return uD()&&document.documentMode===10}function QT(s=zn()){return s_(s)||XT(s)||WT(s)||KT(s)||/windows phone/i.test(s)||YT(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JT(s,t=[]){let e;switch(s){case"Browser":e=nA(zn());break;case"Worker":e=`${nA(zn())}-${s}`;break;default:e=s}const n=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${Ao}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=a=>new Promise((l,u)=>{try{const h=t(a);l(h)}catch(h){u(h)}});n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(n){e.reverse();for(const i of e)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eM(s,t={}){return Cr(s,"GET","/v2/passwordPolicy",Sr(s,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nM=6;class iM{constructor(t){const e=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=e.minPasswordLength??nM,e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=e.maxPasswordLength),e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=e.containsLowercaseCharacter),e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=e.containsUppercaseCharacter),e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=e.containsNumericCharacter),e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=e.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=t.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const e={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,e),this.validatePasswordCharacterOptions(t,e),e.isValid&&(e.isValid=e.meetsMinPasswordLength??!0),e.isValid&&(e.isValid=e.meetsMaxPasswordLength??!0),e.isValid&&(e.isValid=e.containsLowercaseLetter??!0),e.isValid&&(e.isValid=e.containsUppercaseLetter??!0),e.isValid&&(e.isValid=e.containsNumericCharacter??!0),e.isValid&&(e.isValid=e.containsNonAlphanumericCharacter??!0),e}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let n;for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sM{constructor(t,e,n,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new iA(this),this.idTokenSubscription=new iA(this),this.beforeStateQueue=new tM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=FT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=gr(e)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ml.create(this,t),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await Rf(this,{idToken:t}),n=await Qi._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if(li(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let n=e,i=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,l=n?._redirectEventId,u=await this.tryRedirectSignIn(t);(!a||a===l)&&u?.user&&(n=u.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Ft(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await If(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=LN()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(li(this.app))return Promise.reject(yr(this));const e=t?Xe(t):null;return e&&Ft(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Ft(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return li(this.app)?Promise.reject(yr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return li(this.app)?Promise.reject(yr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(gr(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await eM(this),e=new iM(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new th("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(n.tenantId=this.tenantId),await QN(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return t===null?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&gr(t)||this._popupRedirectResolver;Ft(e,this,"argument-error"),this.redirectPersistenceManager=await Ml.create(this,[gr(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===t?this._currentUser:this.redirectUser?._redirectEventId===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=this.currentUser?.uid??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const a=typeof e=="function"?e:e.next.bind(e);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ft(u,this,"internal-error"),u.then(()=>{l||a(this.currentUser)}),typeof e=="function"){const h=t.addObserver(e,n,i);return()=>{l=!0,h()}}else{const h=t.addObserver(e);return()=>{l=!0,h()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Ft(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=JT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const e=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();e&&(t["X-Firebase-Client"]=e);const n=await this._getAppCheckToken();return n&&(t["X-Firebase-AppCheck"]=n),t}async _getAppCheckToken(){if(li(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&MN(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Sa(s){return Xe(s)}class iA{constructor(t){this.auth=t,this.observer=null,this.addObserver=_D(e=>this.observer=e)}get next(){return Ft(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function rM(s){Zf=s}function ZT(s){return Zf.loadJS(s)}function aM(){return Zf.recaptchaEnterpriseScript}function oM(){return Zf.gapiScript}function lM(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class cM{constructor(){this.enterprise=new uM}ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}class uM{ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}const hM="recaptcha-enterprise",tS="NO_RECAPTCHA";class dM{constructor(t){this.type=hM,this.auth=Sa(t)}async verify(t="verify",e=!1){async function n(a){if(!e){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,u)=>{zN(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const f=new HN(h);return a.tenantId==null?a._agentRecaptchaConfig=f:a._tenantRecaptchaConfigs[a.tenantId]=f,l(f.siteKey)}}).catch(h=>{u(h)})})}function i(a,l,u){const h=window.grecaptcha;JE(h)?h.enterprise.ready(()=>{h.enterprise.execute(a,{action:t}).then(f=>{l(f)}).catch(()=>{l(tS)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new cM().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{n(this.auth).then(u=>{if(!e&&JE(window.grecaptcha))i(u,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let h=aM();h.length!==0&&(h+=u),ZT(h).then(()=>{i(u,a,l)}).catch(f=>{l(f)})}}).catch(u=>{l(u)})})}}async function sA(s,t,e,n=!1,i=!1){const a=new dM(s);let l;if(i)l=tS;else try{l=await a.verify(e)}catch{l=await a.verify(e,!0)}const u={...t};if(e==="mfaSmsEnrollment"||e==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const h=u.phoneEnrollmentInfo.phoneNumber,f=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const h=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return n?Object.assign(u,{captchaResp:l}):Object.assign(u,{captchaResponse:l}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function ly(s,t,e,n,i){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await sA(s,t,e,e==="getOobCode");return n(s,a)}else return n(s,t).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${e} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await sA(s,t,e,e==="getOobCode");return n(s,l)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fM(s,t){const e=Jf(s,"auth");if(e.isInitialized()){const i=e.getImmediate(),a=e.getOptions();if(ho(a,t??{}))return i;Hi(i,"already-initialized")}return e.initialize({options:t})}function pM(s,t){const e=t?.persistence||[],n=(Array.isArray(e)?e:[e]).map(gr);t?.errorMap&&s._updateErrorMap(t.errorMap),s._initializeWithPersistence(n,t?.popupRedirectResolver)}function gM(s,t,e){const n=Sa(s);Ft(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const i=!1,a=eS(t),{host:l,port:u}=mM(t),h=u===null?"":`:${u}`,f={url:`${a}//${l}${h}/`},p=Object.freeze({host:l,port:u,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){Ft(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Ft(ho(f,n.config.emulator)&&ho(p,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=f,n.emulatorConfig=p,n.settings.appVerificationDisabledForTesting=!0,Ta(l)?(Ky(`${a}//${l}${h}`),Wy("Auth",!0)):yM()}function eS(s){const t=s.indexOf(":");return t<0?"":s.substr(0,t+1)}function mM(s){const t=eS(s),e=/(\/\/)?([^?#/]+)/.exec(s.substr(t.length));if(!e)return{host:"",port:null};const n=e[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:rA(n.substr(a.length+1))}}else{const[a,l]=n.split(":");return{host:a,port:rA(l)}}}function rA(s){if(!s)return null;const t=Number(s);return isNaN(t)?null:t}function yM(){function s(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return pr("not implemented")}_getIdTokenResponse(t){return pr("not implemented")}_linkToIdToken(t,e){return pr("not implemented")}_getReauthenticationResolver(t){return pr("not implemented")}}async function _M(s,t){return Cr(s,"POST","/v1/accounts:signUp",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vM(s,t){return ih(s,"POST","/v1/accounts:signInWithPassword",Sr(s,t))}async function bM(s,t){return Cr(s,"POST","/v1/accounts:sendOobCode",Sr(s,t))}async function EM(s,t){return bM(s,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AM(s,t){return ih(s,"POST","/v1/accounts:signInWithEmailLink",Sr(s,t))}async function wM(s,t){return ih(s,"POST","/v1/accounts:signInWithEmailLink",Sr(s,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu extends r_{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new Bu(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new Bu(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t;if(e?.email&&e?.password){if(e.signInMethod==="password")return this._fromEmailAndPassword(e.email,e.password);if(e.signInMethod==="emailLink")return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const e={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ly(t,e,"signInWithPassword",vM);case"emailLink":return AM(t,{email:this._email,oobCode:this._password});default:Hi(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":const n={idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ly(t,n,"signUpPassword",_M);case"emailLink":return wM(t,{idToken:e,email:this._email,oobCode:this._password});default:Hi(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kl(s,t){return ih(s,"POST","/v1/accounts:signInWithIdp",Sr(s,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TM="http://localhost";class po extends r_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new po(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Hi("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:n,signInMethod:i,...a}=e;if(!n||!i)return null;const l=new po(n,i);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(t){const e=this.buildRequest();return kl(t,e)}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,kl(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,kl(t,e)}buildRequest(){const t={requestUri:TM,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=eh(e)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SM(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function CM(s){const t=fu(pu(s)).link,e=t?fu(pu(t)).deep_link_id:null,n=fu(pu(s)).deep_link_id;return(n?fu(pu(n)).link:null)||n||e||t||s}class a_{constructor(t){const e=fu(pu(t)),n=e.apiKey??null,i=e.oobCode??null,a=SM(e.mode??null);Ft(n&&i&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=i,this.continueUrl=e.continueUrl??null,this.languageCode=e.lang??null,this.tenantId=e.tenantId??null}static parseLink(t){const e=CM(t);try{return new a_(e)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(){this.providerId=Kl.PROVIDER_ID}static credential(t,e){return Bu._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=a_.parseLink(e);return Ft(n,"argument-error"),Bu._fromEmailAndCode(t,n.code,n.tenantId)}}Kl.PROVIDER_ID="password";Kl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Kl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh extends o_{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia extends sh{constructor(){super("facebook.com")}static credential(t){return po._fromParams({providerId:ia.PROVIDER_ID,signInMethod:ia.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return ia.credentialFromTaggedObject(t)}static credentialFromError(t){return ia.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return ia.credential(t.oauthAccessToken)}catch{return null}}}ia.FACEBOOK_SIGN_IN_METHOD="facebook.com";ia.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr extends sh{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return po._fromParams({providerId:fr.PROVIDER_ID,signInMethod:fr.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return fr.credentialFromTaggedObject(t)}static credentialFromError(t){return fr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return fr.credential(e,n)}catch{return null}}}fr.GOOGLE_SIGN_IN_METHOD="google.com";fr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa extends sh{constructor(){super("github.com")}static credential(t){return po._fromParams({providerId:sa.PROVIDER_ID,signInMethod:sa.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return sa.credentialFromTaggedObject(t)}static credentialFromError(t){return sa.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return sa.credential(t.oauthAccessToken)}catch{return null}}}sa.GITHUB_SIGN_IN_METHOD="github.com";sa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra extends sh{constructor(){super("twitter.com")}static credential(t,e){return po._fromParams({providerId:ra.PROVIDER_ID,signInMethod:ra.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return ra.credentialFromTaggedObject(t)}static credentialFromError(t){return ra.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return ra.credential(e,n)}catch{return null}}}ra.TWITTER_SIGN_IN_METHOD="twitter.com";ra.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RM(s,t){return ih(s,"POST","/v1/accounts:signUp",Sr(s,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const a=await Qi._fromIdTokenResponse(t,n,i),l=aA(n);return new go({user:a,providerId:l,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=aA(n);return new go({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function aA(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf extends Ls{constructor(t,e,n,i){super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,xf.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new xf(t,e,n,i)}}function nS(s,t,e,n){return(t==="reauthenticate"?e._getReauthenticationResolver(s):e._getIdTokenResponse(s)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?xf._fromErrorAndOperation(s,a,t,n):a})}async function IM(s,t,e=!1){const n=await Lu(s,t._linkToIdToken(s.auth,await s.getIdToken()),e);return go._forOperation(s,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xM(s,t,e=!1){const{auth:n}=s;if(li(n.app))return Promise.reject(yr(n));const i="reauthenticate";try{const a=await Lu(s,nS(n,i,t,s),e);Ft(a.idToken,n,"internal-error");const l=i_(a.idToken);Ft(l,n,"internal-error");const{sub:u}=l;return Ft(s.uid===u,n,"user-mismatch"),go._forOperation(s,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&Hi(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iS(s,t,e=!1){if(li(s.app))return Promise.reject(yr(s));const n="signIn",i=await nS(s,n,t),a=await go._fromIdTokenResponse(s,n,i);return e||await s._updateCurrentUser(a.user),a}async function DM(s,t){return iS(Sa(s),t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sS(s){const t=Sa(s);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function NM(s,t,e){if(li(s.app))return Promise.reject(yr(s));const n=Sa(s),l=await ly(n,{returnSecureToken:!0,email:t,password:e,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",RM).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&sS(s),h}),u=await go._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(u.user),u}function MM(s,t,e){return li(s.app)?Promise.reject(yr(s)):DM(Xe(s),Kl.credential(t,e)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&sS(s),n})}async function kM(s,t){const e=Xe(s),i={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()},{email:a}=await EM(e.auth,i);a!==s.email&&await s.reload()}function PM(s,t,e,n){return Xe(s).onIdTokenChanged(t,e,n)}function OM(s,t,e){return Xe(s).beforeAuthStateChanged(t,e)}function rS(s,t,e,n){return Xe(s).onAuthStateChanged(t,e,n)}function cy(s){return Xe(s).signOut()}async function LM(s){return Xe(s).delete()}const Df="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(Df,"1"),this.storage.removeItem(Df),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BM=1e3,FM=10;class oS extends aS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=QT(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((l,u,h)=>{this.notifyListeners(l,h)});return}const n=t.key;e?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(n);!e&&this.localCache[n]===l||this.notifyListeners(n,l)},a=this.storage.getItem(n);ZN()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,FM):i()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)})},BM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}oS.type="LOCAL";const UM=oS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS extends aS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}lS.type="SESSION";const cS=lS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VM(s){return Promise.all(s.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(i=>i.isListeningto(t));if(e)return e;const n=new tp(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:a}=e.data,l=this.handlersMap[i];if(!l?.size)return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const u=Array.from(l).map(async f=>f(e.origin,a)),h=await VM(u);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:h})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}tp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l_(s="",t=10){let e="";for(let n=0;n<t;n++)e+=Math.floor(Math.random()*10);return s+e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,l;return new Promise((u,h)=>{const f=l_("",20);i.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},n);l={messageChannel:i,onMessage(y){const v=y;if(v.data.eventId===f)switch(v.data.status){case"ack":clearTimeout(p),a=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),u(v.data.response);break;default:clearTimeout(p),clearTimeout(a),h(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:t,eventId:f,data:e},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rs(){return window}function HM(s){Rs().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(){return typeof Rs().WorkerGlobalScope<"u"&&typeof Rs().importScripts=="function"}async function zM(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function GM(){return navigator?.serviceWorker?.controller||null}function qM(){return uS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hS="firebaseLocalStorageDb",$M=1,Nf="firebaseLocalStorage",dS="fbase_key";class rh{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function ep(s,t){return s.transaction([Nf],t?"readwrite":"readonly").objectStore(Nf)}function YM(){const s=indexedDB.deleteDatabase(hS);return new rh(s).toPromise()}function uy(){const s=indexedDB.open(hS,$M);return new Promise((t,e)=>{s.addEventListener("error",()=>{e(s.error)}),s.addEventListener("upgradeneeded",()=>{const n=s.result;try{n.createObjectStore(Nf,{keyPath:dS})}catch(i){e(i)}}),s.addEventListener("success",async()=>{const n=s.result;n.objectStoreNames.contains(Nf)?t(n):(n.close(),await YM(),t(await uy()))})})}async function oA(s,t,e){const n=ep(s,!0).put({[dS]:t,value:e});return new rh(n).toPromise()}async function XM(s,t){const e=ep(s,!1).get(t),n=await new rh(e).toPromise();return n===void 0?null:n.value}function lA(s,t){const e=ep(s,!0).delete(t);return new rh(e).toPromise()}const KM=800,WM=3;class fS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await uy(),this.db)}async _withRetries(t){let e=0;for(;;)try{const n=await this._openDb();return await t(n)}catch(n){if(e++>WM)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return uS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=tp._getInstance(qM()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await zM(),!this.activeServiceWorker)return;this.sender=new jM(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||GM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await uy();return await oA(t,Df,"1"),await lA(t,Df),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(n=>oA(n,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(n=>XM(n,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>lA(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(i=>{const a=ep(i,!1).getAll();return new rh(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],n=new Set;if(t.length!==0)for(const{fbase_key:i,value:a}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),e.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),e.push(i));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),KM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}fS.type="LOCAL";const QM=fS;new nh(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pS(s,t){return t?gr(t):(Ft(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_ extends r_{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return kl(t,this._buildIdpRequest())}_linkToIdToken(t,e){return kl(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return kl(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function JM(s){return iS(s.auth,new c_(s),s.bypassAuthState)}function ZM(s){const{auth:t,user:e}=s;return Ft(e,t,"internal-error"),xM(e,new c_(s),s.bypassAuthState)}async function tk(s){const{auth:t,user:e}=s;return Ft(e,t,"internal-error"),IM(e,new c_(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(t,e,n,i,a=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:a,error:l,type:u}=t;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:e,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(f){this.reject(f)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return JM;case"linkViaPopup":case"linkViaRedirect":return tk;case"reauthViaPopup":case"reauthViaRedirect":return ZM;default:Hi(this.auth,"internal-error")}}resolve(t){Er(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Er(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek=new nh(2e3,1e4);async function cA(s,t,e){if(li(s.app))return Promise.reject(Zi(s,"operation-not-supported-in-this-environment"));const n=Sa(s);kN(s,t,o_);const i=pS(n,e);return new io(n,"signInViaPopup",t,i).executeNotNull()}class io extends gS{constructor(t,e,n,i,a){super(t,e,i,a),this.provider=n,this.authWindow=null,this.pollId=null,io.currentPopupAction&&io.currentPopupAction.cancel(),io.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Ft(t,this.auth,"internal-error"),t}async onExecution(){Er(this.filter.length===1,"Popup operations only handle one event");const t=l_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Zi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Zi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,io.currentPopupAction=null}pollUserCancellation(){const t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Zi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,ek.get())};t()}}io.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nk="pendingRedirect",hf=new Map;class ik extends gS{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=hf.get(this.auth._key());if(!t){try{const n=await sk(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}hf.set(this.auth._key(),t)}return this.bypassAuthState||hf.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function sk(s,t){const e=ok(t),n=ak(s);if(!await n._isAvailable())return!1;const i=await n._get(e)==="true";return await n._remove(e),i}function rk(s,t){hf.set(s._key(),t)}function ak(s){return gr(s._redirectPersistence)}function ok(s){return uf(nk,s.config.apiKey,s.name)}async function lk(s,t,e=!1){if(li(s.app))return Promise.reject(yr(s));const n=Sa(s),i=pS(n,t),l=await new ik(n,i,e).execute();return l&&!e&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,t)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ck=600*1e3;class uk{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!hk(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!mS(t)){const n=t.error.code?.split("auth/")[1]||"internal-error";e.onError(Zi(this.auth,n))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=ck&&this.cachedEventUids.clear(),this.cachedEventUids.has(uA(t))}saveEventToCache(t){this.cachedEventUids.add(uA(t)),this.lastProcessedEventTime=Date.now()}}function uA(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(t=>t).join("-")}function mS({type:s,error:t}){return s==="unknown"&&t?.code==="auth/no-auth-event"}function hk(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return mS(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dk(s,t={}){return Cr(s,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,pk=/^https?/;async function gk(s){if(s.config.emulator)return;const{authorizedDomains:t}=await dk(s);for(const e of t)try{if(mk(e))return}catch{}Hi(s,"unauthorized-domain")}function mk(s){const t=ay(),{protocol:e,hostname:n}=new URL(t);if(s.startsWith("chrome-extension://")){const l=new URL(s);return l.hostname===""&&n===""?e==="chrome-extension:"&&s.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&l.hostname===n}if(!pk.test(e))return!1;if(fk.test(s))return n===s;const i=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yk=new nh(3e4,6e4);function hA(){const s=Rs().___jsl;if(s?.H){for(const t of Object.keys(s.H))if(s.H[t].r=s.H[t].r||[],s.H[t].L=s.H[t].L||[],s.H[t].r=[...s.H[t].L],s.CP)for(let e=0;e<s.CP.length;e++)s.CP[e]=null}}function _k(s){return new Promise((t,e)=>{function n(){hA(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{hA(),e(Zi(s,"network-request-failed"))},timeout:yk.get()})}if(Rs().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(Rs().gapi?.load)n();else{const i=lM("iframefcb");return Rs()[i]=()=>{gapi.load?n():e(Zi(s,"network-request-failed"))},ZT(`${oM()}?onload=${i}`).catch(a=>e(a))}}).catch(t=>{throw df=null,t})}let df=null;function vk(s){return df=df||_k(s),df}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bk=new nh(5e3,15e3),Ek="__/auth/iframe",Ak="emulator/auth/iframe",wk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Tk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Sk(s){const t=s.config;Ft(t.authDomain,s,"auth-domain-config-required");const e=t.emulator?n_(t,Ak):`https://${s.config.authDomain}/${Ek}`,n={apiKey:t.apiKey,appName:s.name,v:Ao},i=Tk.get(s.config.apiHost);i&&(n.eid=i);const a=s._getFrameworks();return a.length&&(n.fw=a.join(",")),`${e}?${eh(n).slice(1)}`}async function Ck(s){const t=await vk(s),e=Rs().gapi;return Ft(e,s,"internal-error"),t.open({where:document.body,url:Sk(s),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:wk,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const l=Zi(s,"network-request-failed"),u=Rs().setTimeout(()=>{a(l)},bk.get());function h(){Rs().clearTimeout(u),i(n)}n.ping(h).then(h,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Ik=500,xk=600,Dk="_blank",Nk="http://localhost";class dA{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Mk(s,t,e,n=Ik,i=xk){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const h={...Rk,width:n.toString(),height:i.toString(),top:a,left:l},f=zn().toLowerCase();e&&(u=$T(f)?Dk:e),GT(f)&&(t=t||Nk,h.scrollbars="yes");const p=Object.entries(h).reduce((v,[b,T])=>`${v}${b}=${T},`,"");if(JN(f)&&u!=="_self")return kk(t||"",u),new dA(null);const y=window.open(t||"",u,p);Ft(y,s,"popup-blocked");try{y.focus()}catch{}return new dA(y)}function kk(s,t){const e=document.createElement("a");e.href=s,e.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk="__/auth/handler",Ok="emulator/auth/handler",Lk=encodeURIComponent("fac");async function fA(s,t,e,n,i,a){Ft(s.config.authDomain,s,"auth-domain-config-required"),Ft(s.config.apiKey,s,"invalid-api-key");const l={apiKey:s.config.apiKey,appName:s.name,authType:e,redirectUrl:n,v:Ao,eventId:i};if(t instanceof o_){t.setDefaultLanguage(s.languageCode),l.providerId=t.providerId||"",yD(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[p,y]of Object.entries({}))l[p]=y}if(t instanceof sh){const p=t.getScopes().filter(y=>y!=="");p.length>0&&(l.scopes=p.join(","))}s.tenantId&&(l.tid=s.tenantId);const u=l;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const h=await s._getAppCheckToken(),f=h?`#${Lk}=${encodeURIComponent(h)}`:"";return`${Bk(s)}?${eh(u).slice(1)}${f}`}function Bk({config:s}){return s.emulator?n_(s,Ok):`https://${s.authDomain}/${Pk}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lm="webStorageSupport";class Fk{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=cS,this._completeRedirectFn=lk,this._overrideRedirectResult=rk}async _openPopup(t,e,n,i){Er(this.eventManagers[t._key()]?.manager,"_initialize() not called before _openPopup()");const a=await fA(t,e,n,ay(),i);return Mk(t,a,l_())}async _openRedirect(t,e,n,i){await this._originValidation(t);const a=await fA(t,e,n,ay(),i);return HM(a),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:i,promise:a}=this.eventManagers[e];return i?Promise.resolve(i):(Er(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch(()=>{delete this.eventManagers[e]}),n}async initAndGetManager(t){const e=await Ck(t),n=new uk(t);return e.register("authEvent",i=>(Ft(i?.authEvent,t,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Lm,{type:Lm},i=>{const a=i?.[0]?.[Lm];a!==void 0&&e(!!a),Hi(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=gk(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return QT()||qT()||s_()}}const Uk=Fk;var pA="@firebase/auth",gA="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(n=>{t(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Ft(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jk(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Hk(s){fo(new ga("auth",(t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),a=t.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=n.options;Ft(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:l,authDomain:u,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:JT(s)},f=new sM(n,i,a,h);return pM(f,e),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider("auth-internal").initialize()})),fo(new ga("auth-internal",t=>{const e=Sa(t.getProvider("auth").getImmediate());return(n=>new Vk(n))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),Cs(pA,gA,jk(s)),Cs(pA,gA,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk=300,Gk=DT("authIdTokenMaxAge")||zk;let mA=null;const qk=s=>async t=>{const e=t&&await t.getIdTokenResult(),n=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>Gk)return;const i=e?.token;mA!==i&&(mA=i,await fetch(s,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function $k(s=Zy()){const t=Jf(s,"auth");if(t.isInitialized())return t.getImmediate();const e=fM(s,{popupRedirectResolver:Uk,persistence:[QM,UM,cS]}),n=DT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const l=qk(a.toString());OM(e,l,()=>l(e.currentUser)),PM(e,u=>l(u))}}const i=RT("auth");return i&&gM(e,`http://${i}`),e}function Yk(){return document.getElementsByTagName("head")?.[0]??document}rM({loadJS(s){return new Promise((t,e)=>{const n=document.createElement("script");n.setAttribute("src",s),n.onload=t,n.onerror=i=>{const a=Zi("internal-error");a.customData=i,e(a)},n.type="text/javascript",n.charset="UTF-8",Yk().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Hk("Browser");var yA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var da,yS;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(P,N){function B(){}B.prototype=N.prototype,P.D=N.prototype,P.prototype=new B,P.prototype.constructor=P,P.C=function(j,V,Y){for(var U=Array(arguments.length-2),Nt=2;Nt<arguments.length;Nt++)U[Nt-2]=arguments[Nt];return N.prototype[V].apply(j,U)}}function e(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(n,e),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(P,N,B){B||(B=0);var j=Array(16);if(typeof N=="string")for(var V=0;16>V;++V)j[V]=N.charCodeAt(B++)|N.charCodeAt(B++)<<8|N.charCodeAt(B++)<<16|N.charCodeAt(B++)<<24;else for(V=0;16>V;++V)j[V]=N[B++]|N[B++]<<8|N[B++]<<16|N[B++]<<24;N=P.g[0],B=P.g[1],V=P.g[2];var Y=P.g[3],U=N+(Y^B&(V^Y))+j[0]+3614090360&4294967295;N=B+(U<<7&4294967295|U>>>25),U=Y+(V^N&(B^V))+j[1]+3905402710&4294967295,Y=N+(U<<12&4294967295|U>>>20),U=V+(B^Y&(N^B))+j[2]+606105819&4294967295,V=Y+(U<<17&4294967295|U>>>15),U=B+(N^V&(Y^N))+j[3]+3250441966&4294967295,B=V+(U<<22&4294967295|U>>>10),U=N+(Y^B&(V^Y))+j[4]+4118548399&4294967295,N=B+(U<<7&4294967295|U>>>25),U=Y+(V^N&(B^V))+j[5]+1200080426&4294967295,Y=N+(U<<12&4294967295|U>>>20),U=V+(B^Y&(N^B))+j[6]+2821735955&4294967295,V=Y+(U<<17&4294967295|U>>>15),U=B+(N^V&(Y^N))+j[7]+4249261313&4294967295,B=V+(U<<22&4294967295|U>>>10),U=N+(Y^B&(V^Y))+j[8]+1770035416&4294967295,N=B+(U<<7&4294967295|U>>>25),U=Y+(V^N&(B^V))+j[9]+2336552879&4294967295,Y=N+(U<<12&4294967295|U>>>20),U=V+(B^Y&(N^B))+j[10]+4294925233&4294967295,V=Y+(U<<17&4294967295|U>>>15),U=B+(N^V&(Y^N))+j[11]+2304563134&4294967295,B=V+(U<<22&4294967295|U>>>10),U=N+(Y^B&(V^Y))+j[12]+1804603682&4294967295,N=B+(U<<7&4294967295|U>>>25),U=Y+(V^N&(B^V))+j[13]+4254626195&4294967295,Y=N+(U<<12&4294967295|U>>>20),U=V+(B^Y&(N^B))+j[14]+2792965006&4294967295,V=Y+(U<<17&4294967295|U>>>15),U=B+(N^V&(Y^N))+j[15]+1236535329&4294967295,B=V+(U<<22&4294967295|U>>>10),U=N+(V^Y&(B^V))+j[1]+4129170786&4294967295,N=B+(U<<5&4294967295|U>>>27),U=Y+(B^V&(N^B))+j[6]+3225465664&4294967295,Y=N+(U<<9&4294967295|U>>>23),U=V+(N^B&(Y^N))+j[11]+643717713&4294967295,V=Y+(U<<14&4294967295|U>>>18),U=B+(Y^N&(V^Y))+j[0]+3921069994&4294967295,B=V+(U<<20&4294967295|U>>>12),U=N+(V^Y&(B^V))+j[5]+3593408605&4294967295,N=B+(U<<5&4294967295|U>>>27),U=Y+(B^V&(N^B))+j[10]+38016083&4294967295,Y=N+(U<<9&4294967295|U>>>23),U=V+(N^B&(Y^N))+j[15]+3634488961&4294967295,V=Y+(U<<14&4294967295|U>>>18),U=B+(Y^N&(V^Y))+j[4]+3889429448&4294967295,B=V+(U<<20&4294967295|U>>>12),U=N+(V^Y&(B^V))+j[9]+568446438&4294967295,N=B+(U<<5&4294967295|U>>>27),U=Y+(B^V&(N^B))+j[14]+3275163606&4294967295,Y=N+(U<<9&4294967295|U>>>23),U=V+(N^B&(Y^N))+j[3]+4107603335&4294967295,V=Y+(U<<14&4294967295|U>>>18),U=B+(Y^N&(V^Y))+j[8]+1163531501&4294967295,B=V+(U<<20&4294967295|U>>>12),U=N+(V^Y&(B^V))+j[13]+2850285829&4294967295,N=B+(U<<5&4294967295|U>>>27),U=Y+(B^V&(N^B))+j[2]+4243563512&4294967295,Y=N+(U<<9&4294967295|U>>>23),U=V+(N^B&(Y^N))+j[7]+1735328473&4294967295,V=Y+(U<<14&4294967295|U>>>18),U=B+(Y^N&(V^Y))+j[12]+2368359562&4294967295,B=V+(U<<20&4294967295|U>>>12),U=N+(B^V^Y)+j[5]+4294588738&4294967295,N=B+(U<<4&4294967295|U>>>28),U=Y+(N^B^V)+j[8]+2272392833&4294967295,Y=N+(U<<11&4294967295|U>>>21),U=V+(Y^N^B)+j[11]+1839030562&4294967295,V=Y+(U<<16&4294967295|U>>>16),U=B+(V^Y^N)+j[14]+4259657740&4294967295,B=V+(U<<23&4294967295|U>>>9),U=N+(B^V^Y)+j[1]+2763975236&4294967295,N=B+(U<<4&4294967295|U>>>28),U=Y+(N^B^V)+j[4]+1272893353&4294967295,Y=N+(U<<11&4294967295|U>>>21),U=V+(Y^N^B)+j[7]+4139469664&4294967295,V=Y+(U<<16&4294967295|U>>>16),U=B+(V^Y^N)+j[10]+3200236656&4294967295,B=V+(U<<23&4294967295|U>>>9),U=N+(B^V^Y)+j[13]+681279174&4294967295,N=B+(U<<4&4294967295|U>>>28),U=Y+(N^B^V)+j[0]+3936430074&4294967295,Y=N+(U<<11&4294967295|U>>>21),U=V+(Y^N^B)+j[3]+3572445317&4294967295,V=Y+(U<<16&4294967295|U>>>16),U=B+(V^Y^N)+j[6]+76029189&4294967295,B=V+(U<<23&4294967295|U>>>9),U=N+(B^V^Y)+j[9]+3654602809&4294967295,N=B+(U<<4&4294967295|U>>>28),U=Y+(N^B^V)+j[12]+3873151461&4294967295,Y=N+(U<<11&4294967295|U>>>21),U=V+(Y^N^B)+j[15]+530742520&4294967295,V=Y+(U<<16&4294967295|U>>>16),U=B+(V^Y^N)+j[2]+3299628645&4294967295,B=V+(U<<23&4294967295|U>>>9),U=N+(V^(B|~Y))+j[0]+4096336452&4294967295,N=B+(U<<6&4294967295|U>>>26),U=Y+(B^(N|~V))+j[7]+1126891415&4294967295,Y=N+(U<<10&4294967295|U>>>22),U=V+(N^(Y|~B))+j[14]+2878612391&4294967295,V=Y+(U<<15&4294967295|U>>>17),U=B+(Y^(V|~N))+j[5]+4237533241&4294967295,B=V+(U<<21&4294967295|U>>>11),U=N+(V^(B|~Y))+j[12]+1700485571&4294967295,N=B+(U<<6&4294967295|U>>>26),U=Y+(B^(N|~V))+j[3]+2399980690&4294967295,Y=N+(U<<10&4294967295|U>>>22),U=V+(N^(Y|~B))+j[10]+4293915773&4294967295,V=Y+(U<<15&4294967295|U>>>17),U=B+(Y^(V|~N))+j[1]+2240044497&4294967295,B=V+(U<<21&4294967295|U>>>11),U=N+(V^(B|~Y))+j[8]+1873313359&4294967295,N=B+(U<<6&4294967295|U>>>26),U=Y+(B^(N|~V))+j[15]+4264355552&4294967295,Y=N+(U<<10&4294967295|U>>>22),U=V+(N^(Y|~B))+j[6]+2734768916&4294967295,V=Y+(U<<15&4294967295|U>>>17),U=B+(Y^(V|~N))+j[13]+1309151649&4294967295,B=V+(U<<21&4294967295|U>>>11),U=N+(V^(B|~Y))+j[4]+4149444226&4294967295,N=B+(U<<6&4294967295|U>>>26),U=Y+(B^(N|~V))+j[11]+3174756917&4294967295,Y=N+(U<<10&4294967295|U>>>22),U=V+(N^(Y|~B))+j[2]+718787259&4294967295,V=Y+(U<<15&4294967295|U>>>17),U=B+(Y^(V|~N))+j[9]+3951481745&4294967295,P.g[0]=P.g[0]+N&4294967295,P.g[1]=P.g[1]+(V+(U<<21&4294967295|U>>>11))&4294967295,P.g[2]=P.g[2]+V&4294967295,P.g[3]=P.g[3]+Y&4294967295}n.prototype.u=function(P,N){N===void 0&&(N=P.length);for(var B=N-this.blockSize,j=this.B,V=this.h,Y=0;Y<N;){if(V==0)for(;Y<=B;)i(this,P,Y),Y+=this.blockSize;if(typeof P=="string"){for(;Y<N;)if(j[V++]=P.charCodeAt(Y++),V==this.blockSize){i(this,j),V=0;break}}else for(;Y<N;)if(j[V++]=P[Y++],V==this.blockSize){i(this,j),V=0;break}}this.h=V,this.o+=N},n.prototype.v=function(){var P=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);P[0]=128;for(var N=1;N<P.length-8;++N)P[N]=0;var B=8*this.o;for(N=P.length-8;N<P.length;++N)P[N]=B&255,B/=256;for(this.u(P),P=Array(16),N=B=0;4>N;++N)for(var j=0;32>j;j+=8)P[B++]=this.g[N]>>>j&255;return P};function a(P,N){var B=u;return Object.prototype.hasOwnProperty.call(B,P)?B[P]:B[P]=N(P)}function l(P,N){this.h=N;for(var B=[],j=!0,V=P.length-1;0<=V;V--){var Y=P[V]|0;j&&Y==N||(B[V]=Y,j=!1)}this.g=B}var u={};function h(P){return-128<=P&&128>P?a(P,function(N){return new l([N|0],0>N?-1:0)}):new l([P|0],0>P?-1:0)}function f(P){if(isNaN(P)||!isFinite(P))return y;if(0>P)return I(f(-P));for(var N=[],B=1,j=0;P>=B;j++)N[j]=P/B|0,B*=4294967296;return new l(N,0)}function p(P,N){if(P.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(P.charAt(0)=="-")return I(p(P.substring(1),N));if(0<=P.indexOf("-"))throw Error('number format error: interior "-" character');for(var B=f(Math.pow(N,8)),j=y,V=0;V<P.length;V+=8){var Y=Math.min(8,P.length-V),U=parseInt(P.substring(V,V+Y),N);8>Y?(Y=f(Math.pow(N,Y)),j=j.j(Y).add(f(U))):(j=j.j(B),j=j.add(f(U)))}return j}var y=h(0),v=h(1),b=h(16777216);s=l.prototype,s.m=function(){if(S(this))return-I(this).m();for(var P=0,N=1,B=0;B<this.g.length;B++){var j=this.i(B);P+=(0<=j?j:4294967296+j)*N,N*=4294967296}return P},s.toString=function(P){if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(T(this))return"0";if(S(this))return"-"+I(this).toString(P);for(var N=f(Math.pow(P,6)),B=this,j="";;){var V=G(B,N).g;B=x(B,V.j(N));var Y=((0<B.g.length?B.g[0]:B.h)>>>0).toString(P);if(B=V,T(B))return Y+j;for(;6>Y.length;)Y="0"+Y;j=Y+j}},s.i=function(P){return 0>P?0:P<this.g.length?this.g[P]:this.h};function T(P){if(P.h!=0)return!1;for(var N=0;N<P.g.length;N++)if(P.g[N]!=0)return!1;return!0}function S(P){return P.h==-1}s.l=function(P){return P=x(this,P),S(P)?-1:T(P)?0:1};function I(P){for(var N=P.g.length,B=[],j=0;j<N;j++)B[j]=~P.g[j];return new l(B,~P.h).add(v)}s.abs=function(){return S(this)?I(this):this},s.add=function(P){for(var N=Math.max(this.g.length,P.g.length),B=[],j=0,V=0;V<=N;V++){var Y=j+(this.i(V)&65535)+(P.i(V)&65535),U=(Y>>>16)+(this.i(V)>>>16)+(P.i(V)>>>16);j=U>>>16,Y&=65535,U&=65535,B[V]=U<<16|Y}return new l(B,B[B.length-1]&-2147483648?-1:0)};function x(P,N){return P.add(I(N))}s.j=function(P){if(T(this)||T(P))return y;if(S(this))return S(P)?I(this).j(I(P)):I(I(this).j(P));if(S(P))return I(this.j(I(P)));if(0>this.l(b)&&0>P.l(b))return f(this.m()*P.m());for(var N=this.g.length+P.g.length,B=[],j=0;j<2*N;j++)B[j]=0;for(j=0;j<this.g.length;j++)for(var V=0;V<P.g.length;V++){var Y=this.i(j)>>>16,U=this.i(j)&65535,Nt=P.i(V)>>>16,Dt=P.i(V)&65535;B[2*j+2*V]+=U*Dt,k(B,2*j+2*V),B[2*j+2*V+1]+=Y*Dt,k(B,2*j+2*V+1),B[2*j+2*V+1]+=U*Nt,k(B,2*j+2*V+1),B[2*j+2*V+2]+=Y*Nt,k(B,2*j+2*V+2)}for(j=0;j<N;j++)B[j]=B[2*j+1]<<16|B[2*j];for(j=N;j<2*N;j++)B[j]=0;return new l(B,0)};function k(P,N){for(;(P[N]&65535)!=P[N];)P[N+1]+=P[N]>>>16,P[N]&=65535,N++}function O(P,N){this.g=P,this.h=N}function G(P,N){if(T(N))throw Error("division by zero");if(T(P))return new O(y,y);if(S(P))return N=G(I(P),N),new O(I(N.g),I(N.h));if(S(N))return N=G(P,I(N)),new O(I(N.g),N.h);if(30<P.g.length){if(S(P)||S(N))throw Error("slowDivide_ only works with positive integers.");for(var B=v,j=N;0>=j.l(P);)B=H(B),j=H(j);var V=K(B,1),Y=K(j,1);for(j=K(j,2),B=K(B,2);!T(j);){var U=Y.add(j);0>=U.l(P)&&(V=V.add(B),Y=U),j=K(j,1),B=K(B,1)}return N=x(P,V.j(N)),new O(V,N)}for(V=y;0<=P.l(N);){for(B=Math.max(1,Math.floor(P.m()/N.m())),j=Math.ceil(Math.log(B)/Math.LN2),j=48>=j?1:Math.pow(2,j-48),Y=f(B),U=Y.j(N);S(U)||0<U.l(P);)B-=j,Y=f(B),U=Y.j(N);T(Y)&&(Y=v),V=V.add(Y),P=x(P,U)}return new O(V,P)}s.A=function(P){return G(this,P).h},s.and=function(P){for(var N=Math.max(this.g.length,P.g.length),B=[],j=0;j<N;j++)B[j]=this.i(j)&P.i(j);return new l(B,this.h&P.h)},s.or=function(P){for(var N=Math.max(this.g.length,P.g.length),B=[],j=0;j<N;j++)B[j]=this.i(j)|P.i(j);return new l(B,this.h|P.h)},s.xor=function(P){for(var N=Math.max(this.g.length,P.g.length),B=[],j=0;j<N;j++)B[j]=this.i(j)^P.i(j);return new l(B,this.h^P.h)};function H(P){for(var N=P.g.length+1,B=[],j=0;j<N;j++)B[j]=P.i(j)<<1|P.i(j-1)>>>31;return new l(B,P.h)}function K(P,N){var B=N>>5;N%=32;for(var j=P.g.length-B,V=[],Y=0;Y<j;Y++)V[Y]=0<N?P.i(Y+B)>>>N|P.i(Y+B+1)<<32-N:P.i(Y+B);return new l(V,P.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,yS=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=f,l.fromString=p,da=l}).apply(typeof yA<"u"?yA:typeof self<"u"?self:typeof window<"u"?window:{});var Hd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _S,gu,vS,ff,hy,bS,ES,AS;(function(){var s,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(g,E,C){return g==Array.prototype||g==Object.prototype||(g[E]=C.value),g};function e(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hd=="object"&&Hd];for(var E=0;E<g.length;++E){var C=g[E];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var n=e(this);function i(g,E){if(E)t:{var C=n;g=g.split(".");for(var L=0;L<g.length-1;L++){var tt=g[L];if(!(tt in C))break t;C=C[tt]}g=g[g.length-1],L=C[g],E=E(L),E!=L&&E!=null&&t(C,g,{configurable:!0,writable:!0,value:E})}}function a(g,E){g instanceof String&&(g+="");var C=0,L=!1,tt={next:function(){if(!L&&C<g.length){var lt=C++;return{value:E(lt,g[lt]),done:!1}}return L=!0,{done:!0,value:void 0}}};return tt[Symbol.iterator]=function(){return tt},tt}i("Array.prototype.values",function(g){return g||function(){return a(this,function(E,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},u=this||self;function h(g){var E=typeof g;return E=E!="object"?E:g?Array.isArray(g)?"array":E:"null",E=="array"||E=="object"&&typeof g.length=="number"}function f(g){var E=typeof g;return E=="object"&&g!=null||E=="function"}function p(g,E,C){return g.call.apply(g.bind,arguments)}function y(g,E,C){if(!g)throw Error();if(2<arguments.length){var L=Array.prototype.slice.call(arguments,2);return function(){var tt=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(tt,L),g.apply(E,tt)}}return function(){return g.apply(E,arguments)}}function v(g,E,C){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:y,v.apply(null,arguments)}function b(g,E){var C=Array.prototype.slice.call(arguments,1);return function(){var L=C.slice();return L.push.apply(L,arguments),g.apply(this,L)}}function T(g,E){function C(){}C.prototype=E.prototype,g.aa=E.prototype,g.prototype=new C,g.prototype.constructor=g,g.Qb=function(L,tt,lt){for(var vt=Array(arguments.length-2),se=2;se<arguments.length;se++)vt[se-2]=arguments[se];return E.prototype[tt].apply(L,vt)}}function S(g){const E=g.length;if(0<E){const C=Array(E);for(let L=0;L<E;L++)C[L]=g[L];return C}return[]}function I(g,E){for(let C=1;C<arguments.length;C++){const L=arguments[C];if(h(L)){const tt=g.length||0,lt=L.length||0;g.length=tt+lt;for(let vt=0;vt<lt;vt++)g[tt+vt]=L[vt]}else g.push(L)}}class x{constructor(E,C){this.i=E,this.j=C,this.h=0,this.g=null}get(){let E;return 0<this.h?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function k(g){return/^[\s\xa0]*$/.test(g)}function O(){var g=u.navigator;return g&&(g=g.userAgent)?g:""}function G(g){return G[" "](g),g}G[" "]=function(){};var H=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function K(g,E,C){for(const L in g)E.call(C,g[L],L,g)}function P(g,E){for(const C in g)E.call(void 0,g[C],C,g)}function N(g){const E={};for(const C in g)E[C]=g[C];return E}const B="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(g,E){let C,L;for(let tt=1;tt<arguments.length;tt++){L=arguments[tt];for(C in L)g[C]=L[C];for(let lt=0;lt<B.length;lt++)C=B[lt],Object.prototype.hasOwnProperty.call(L,C)&&(g[C]=L[C])}}function V(g){var E=1;g=g.split(":");const C=[];for(;0<E&&g.length;)C.push(g.shift()),E--;return g.length&&C.push(g.join(":")),C}function Y(g){u.setTimeout(()=>{throw g},0)}function U(){var g=Mt;let E=null;return g.g&&(E=g.g,g.g=g.g.next,g.g||(g.h=null),E.next=null),E}class Nt{constructor(){this.h=this.g=null}add(E,C){const L=Dt.get();L.set(E,C),this.h?this.h.next=L:this.g=L,this.h=L}}var Dt=new x(()=>new J,g=>g.reset());class J{constructor(){this.next=this.g=this.h=null}set(E,C){this.h=E,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let ct,mt=!1,Mt=new Nt,$=()=>{const g=u.Promise.resolve(void 0);ct=()=>{g.then(ut)}};var ut=()=>{for(var g;g=U();){try{g.h.call(g.g)}catch(C){Y(C)}var E=Dt;E.j(g),100>E.h&&(E.h++,g.next=E.g,E.g=g)}mt=!1};function Q(){this.s=this.s,this.C=this.C}Q.prototype.s=!1,Q.prototype.ma=function(){this.s||(this.s=!0,this.N())},Q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function at(g,E){this.type=g,this.g=this.target=E,this.defaultPrevented=!1}at.prototype.h=function(){this.defaultPrevented=!0};var yt=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var g=!1,E=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const C=()=>{};u.addEventListener("test",C,E),u.removeEventListener("test",C,E)}catch{}return g})();function bt(g,E){if(at.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g){var C=this.type=g.type,L=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;if(this.target=g.target||g.srcElement,this.g=E,E=g.relatedTarget){if(H){t:{try{G(E.nodeName);var tt=!0;break t}catch{}tt=!1}tt||(E=null)}}else C=="mouseover"?E=g.fromElement:C=="mouseout"&&(E=g.toElement);this.relatedTarget=E,L?(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=typeof g.pointerType=="string"?g.pointerType:Et[g.pointerType]||"",this.state=g.state,this.i=g,g.defaultPrevented&&bt.aa.h.call(this)}}T(bt,at);var Et={2:"touch",3:"pen",4:"mouse"};bt.prototype.h=function(){bt.aa.h.call(this);var g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var It="closure_listenable_"+(1e6*Math.random()|0),xt=0;function ee(g,E,C,L,tt){this.listener=g,this.proxy=null,this.src=E,this.type=C,this.capture=!!L,this.ha=tt,this.key=++xt,this.da=this.fa=!1}function Me(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function ke(g){this.src=g,this.g={},this.h=0}ke.prototype.add=function(g,E,C,L,tt){var lt=g.toString();g=this.g[lt],g||(g=this.g[lt]=[],this.h++);var vt=We(g,E,L,tt);return-1<vt?(E=g[vt],C||(E.fa=!1)):(E=new ee(E,this.src,lt,!!L,tt),E.fa=C,g.push(E)),E};function ln(g,E){var C=E.type;if(C in g.g){var L=g.g[C],tt=Array.prototype.indexOf.call(L,E,void 0),lt;(lt=0<=tt)&&Array.prototype.splice.call(L,tt,1),lt&&(Me(E),g.g[C].length==0&&(delete g.g[C],g.h--))}}function We(g,E,C,L){for(var tt=0;tt<g.length;++tt){var lt=g[tt];if(!lt.da&&lt.listener==E&&lt.capture==!!C&&lt.ha==L)return tt}return-1}var we="closure_lm_"+(1e6*Math.random()|0),ci={};function Ai(g,E,C,L,tt){if(Array.isArray(E)){for(var lt=0;lt<E.length;lt++)Ai(g,E[lt],C,L,tt);return null}return C=ui(C),g&&g[It]?g.K(E,C,f(L)?!!L.capture:!1,tt):Fe(g,E,C,!1,L,tt)}function Fe(g,E,C,L,tt,lt){if(!E)throw Error("Invalid event type");var vt=f(tt)?!!tt.capture:!!tt,se=wi(g);if(se||(g[we]=se=new ke(g)),C=se.add(E,C,L,vt,lt),C.proxy)return C;if(L=Ca(),C.proxy=L,L.src=g,L.listener=C,g.addEventListener)yt||(tt=vt),tt===void 0&&(tt=!1),g.addEventListener(E.toString(),L,tt);else if(g.attachEvent)g.attachEvent(ti(E.toString()),L);else if(g.addListener&&g.removeListener)g.addListener(L);else throw Error("addEventListener and attachEvent are unavailable.");return C}function Ca(){function g(C){return E.call(g.src,g.listener,C)}const E=Ln;return g}function Bs(g,E,C,L,tt){if(Array.isArray(E))for(var lt=0;lt<E.length;lt++)Bs(g,E[lt],C,L,tt);else L=f(L)?!!L.capture:!!L,C=ui(C),g&&g[It]?(g=g.i,E=String(E).toString(),E in g.g&&(lt=g.g[E],C=We(lt,C,L,tt),-1<C&&(Me(lt[C]),Array.prototype.splice.call(lt,C,1),lt.length==0&&(delete g.g[E],g.h--)))):g&&(g=wi(g))&&(E=g.g[E.toString()],g=-1,E&&(g=We(E,C,L,tt)),(C=-1<g?E[g]:null)&&Gi(C))}function Gi(g){if(typeof g!="number"&&g&&!g.da){var E=g.src;if(E&&E[It])ln(E.i,g);else{var C=g.type,L=g.proxy;E.removeEventListener?E.removeEventListener(C,L,g.capture):E.detachEvent?E.detachEvent(ti(C),L):E.addListener&&E.removeListener&&E.removeListener(L),(C=wi(E))?(ln(C,g),C.h==0&&(C.src=null,E[we]=null)):Me(g)}}}function ti(g){return g in ci?ci[g]:ci[g]="on"+g}function Ln(g,E){if(g.da)g=!0;else{E=new bt(E,this);var C=g.listener,L=g.ha||g.src;g.fa&&Gi(g),g=C.call(L,E)}return g}function wi(g){return g=g[we],g instanceof ke?g:null}var Fs="__closure_events_fn_"+(1e9*Math.random()>>>0);function ui(g){return typeof g=="function"?g:(g[Fs]||(g[Fs]=function(E){return g.handleEvent(E)}),g[Fs])}function Ce(){Q.call(this),this.i=new ke(this),this.M=this,this.F=null}T(Ce,Q),Ce.prototype[It]=!0,Ce.prototype.removeEventListener=function(g,E,C,L){Bs(this,g,E,C,L)};function D(g,E){var C,L=g.F;if(L)for(C=[];L;L=L.F)C.push(L);if(g=g.M,L=E.type||E,typeof E=="string")E=new at(E,g);else if(E instanceof at)E.target=E.target||g;else{var tt=E;E=new at(L,g),j(E,tt)}if(tt=!0,C)for(var lt=C.length-1;0<=lt;lt--){var vt=E.g=C[lt];tt=A(vt,L,!0,E)&&tt}if(vt=E.g=g,tt=A(vt,L,!0,E)&&tt,tt=A(vt,L,!1,E)&&tt,C)for(lt=0;lt<C.length;lt++)vt=E.g=C[lt],tt=A(vt,L,!1,E)&&tt}Ce.prototype.N=function(){if(Ce.aa.N.call(this),this.i){var g=this.i,E;for(E in g.g){for(var C=g.g[E],L=0;L<C.length;L++)Me(C[L]);delete g.g[E],g.h--}}this.F=null},Ce.prototype.K=function(g,E,C,L){return this.i.add(String(g),E,!1,C,L)},Ce.prototype.L=function(g,E,C,L){return this.i.add(String(g),E,!0,C,L)};function A(g,E,C,L){if(E=g.i.g[String(E)],!E)return!0;E=E.concat();for(var tt=!0,lt=0;lt<E.length;++lt){var vt=E[lt];if(vt&&!vt.da&&vt.capture==C){var se=vt.listener,un=vt.ha||vt.src;vt.fa&&ln(g.i,vt),tt=se.call(un,L)!==!1&&tt}}return tt&&!L.defaultPrevented}function w(g,E,C){if(typeof g=="function")C&&(g=v(g,C));else if(g&&typeof g.handleEvent=="function")g=v(g.handleEvent,g);else throw Error("Invalid listener argument");return 2147483647<Number(E)?-1:u.setTimeout(g,E||0)}function F(g){g.g=w(()=>{g.g=null,g.i&&(g.i=!1,F(g))},g.l);const E=g.h;g.h=null,g.m.apply(null,E)}class W extends Q{constructor(E,C){super(),this.m=E,this.l=C,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:F(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function rt(g){Q.call(this),this.h=g,this.g={}}T(rt,Q);var dt=[];function Ht(g){K(g.g,function(E,C){this.g.hasOwnProperty(C)&&Gi(E)},g),g.g={}}rt.prototype.N=function(){rt.aa.N.call(this),Ht(this)},rt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ie=u.JSON.stringify,ue=u.JSON.parse,de=class{stringify(g){return u.JSON.stringify(g,void 0)}parse(g){return u.JSON.parse(g,void 0)}};function le(){}le.prototype.h=null;function tc(g){return g.h||(g.h=g.i())}function ec(){}var Us={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Vs(){at.call(this,"d")}T(Vs,at);function nc(){at.call(this,"c")}T(nc,at);var ns={},ic=null;function Rr(){return ic=ic||new Ce}ns.La="serverreachability";function xo(g){at.call(this,ns.La,g)}T(xo,at);function Ir(g){const E=Rr();D(E,new xo(E))}ns.STAT_EVENT="statevent";function vh(g,E){at.call(this,ns.STAT_EVENT,g),this.stat=E}T(vh,at);function Re(g){const E=Rr();D(E,new vh(E,g))}ns.Ma="timingevent";function cn(g,E){at.call(this,ns.Ma,g),this.size=E}T(cn,at);function Qe(g,E){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){g()},E)}function Ti(){this.g=!0}Ti.prototype.xa=function(){this.g=!1};function sc(g,E,C,L,tt,lt){g.info(function(){if(g.g)if(lt)for(var vt="",se=lt.split("&"),un=0;un<se.length;un++){var re=se[un].split("=");if(1<re.length){var yn=re[0];re=re[1];var hn=yn.split("_");vt=2<=hn.length&&hn[1]=="type"?vt+(yn+"="+re+"&"):vt+(yn+"=redacted&")}}else vt=null;else vt=lt;return"XMLHTTP REQ ("+L+") [attempt "+tt+"]: "+E+`
`+C+`
`+vt})}function Tp(g,E,C,L,tt,lt,vt){g.info(function(){return"XMLHTTP RESP ("+L+") [ attempt "+tt+"]: "+E+`
`+C+`
`+lt+" "+vt})}function xr(g,E,C,L){g.info(function(){return"XMLHTTP TEXT ("+E+"): "+Ra(g,C)+(L?" "+L:"")})}function bh(g,E){g.info(function(){return"TIMEOUT: "+E})}Ti.prototype.info=function(){};function Ra(g,E){if(!g.g)return E;if(!E)return null;try{var C=JSON.parse(E);if(C){for(g=0;g<C.length;g++)if(Array.isArray(C[g])){var L=C[g];if(!(2>L.length)){var tt=L[1];if(Array.isArray(tt)&&!(1>tt.length)){var lt=tt[0];if(lt!="noop"&&lt!="stop"&&lt!="close")for(var vt=1;vt<tt.length;vt++)tt[vt]=""}}}}return ie(C)}catch{return E}}var Dr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},js={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},is;function ss(){}T(ss,le),ss.prototype.g=function(){return new XMLHttpRequest},ss.prototype.i=function(){return{}},is=new ss;function Gn(g,E,C,L){this.j=g,this.i=E,this.l=C,this.R=L||1,this.U=new rt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ze}function ze(){this.i=null,this.g="",this.h=!1}var rc={},Do={};function qi(g,E,C){g.L=1,g.v=Ma(hi(E)),g.m=C,g.P=!0,Hs(g,null)}function Hs(g,E){g.F=Date.now(),Ia(g),g.A=hi(g.v);var C=g.A,L=g.R;Array.isArray(L)||(L=[String(L)]),hc(C.i,"t",L),g.C=0,C=g.j.J,g.h=new ze,g.g=Lh(g.j,C?E:null,!g.m),0<g.O&&(g.M=new W(v(g.Y,g,g.g),g.O)),E=g.U,C=g.g,L=g.ca;var tt="readystatechange";Array.isArray(tt)||(tt&&(dt[0]=tt.toString()),tt=dt);for(var lt=0;lt<tt.length;lt++){var vt=Ai(C,tt[lt],L||E.handleEvent,!1,E.h||E);if(!vt)break;E.g[vt.key]=vt}E=g.H?N(g.H):{},g.m?(g.u||(g.u="POST"),E["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.A,g.u,g.m,E)):(g.u="GET",g.g.ea(g.A,g.u,null,E)),Ir(),sc(g.i,g.u,g.A,g.l,g.R,g.m)}Gn.prototype.ca=function(g){g=g.target;const E=this.M;E&&Ii(g)==3?E.j():this.Y(g)},Gn.prototype.Y=function(g){try{if(g==this.g)t:{const hn=Ii(this.g);var E=this.g.Ba();const Ws=this.g.Z();if(!(3>hn)&&(hn!=3||this.g&&(this.h.h||this.g.oa()||Ih(this.g)))){this.J||hn!=4||E==7||(E==8||0>=Ws?Ir(3):Ir(2)),Nr(this);var C=this.g.Z();this.X=C;e:if(Eh(this)){var L=Ih(this.g);g="";var tt=L.length,lt=Ii(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Tn(this),rs(this);var vt="";break e}this.h.i=new u.TextDecoder}for(E=0;E<tt;E++)this.h.h=!0,g+=this.h.i.decode(L[E],{stream:!(lt&&E==tt-1)});L.length=0,this.h.g+=g,this.C=0,vt=this.h.g}else vt=this.g.oa();if(this.o=C==200,Tp(this.i,this.u,this.A,this.l,this.R,hn,C),this.o){if(this.T&&!this.K){e:{if(this.g){var se,un=this.g;if((se=un.g?un.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(se)){var re=se;break e}}re=null}if(C=re)xr(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,xa(this,C);else{this.o=!1,this.s=3,Re(12),Tn(this),rs(this);break t}}if(this.P){C=!0;let Sn;for(;!this.J&&this.C<vt.length;)if(Sn=Ah(this,vt),Sn==Do){hn==4&&(this.s=4,Re(14),C=!1),xr(this.i,this.l,null,"[Incomplete Response]");break}else if(Sn==rc){this.s=4,Re(15),xr(this.i,this.l,vt,"[Invalid Chunk]"),C=!1;break}else xr(this.i,this.l,Sn,null),xa(this,Sn);if(Eh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),hn!=4||vt.length!=0||this.h.h||(this.s=1,Re(16),C=!1),this.o=this.o&&C,!C)xr(this.i,this.l,vt,"[Invalid Chunked Response]"),Tn(this),rs(this);else if(0<vt.length&&!this.W){this.W=!0;var yn=this.j;yn.g==this&&yn.ba&&!yn.M&&(yn.j.info("Great, no buffering proxy detected. Bytes received: "+vt.length),Va(yn),yn.M=!0,Re(11))}}else xr(this.i,this.l,vt,null),xa(this,vt);hn==4&&Tn(this),this.o&&!this.J&&(hn==4?kh(this.j,this):(this.o=!1,Ia(this)))}else xp(this.g),C==400&&0<vt.indexOf("Unknown SID")?(this.s=3,Re(12)):(this.s=0,Re(13)),Tn(this),rs(this)}}}catch{}finally{}};function Eh(g){return g.g?g.u=="GET"&&g.L!=2&&g.j.Ca:!1}function Ah(g,E){var C=g.C,L=E.indexOf(`
`,C);return L==-1?Do:(C=Number(E.substring(C,L)),isNaN(C)?rc:(L+=1,L+C>E.length?Do:(E=E.slice(L,L+C),g.C=L+C,E)))}Gn.prototype.cancel=function(){this.J=!0,Tn(this)};function Ia(g){g.S=Date.now()+g.I,wh(g,g.I)}function wh(g,E){if(g.B!=null)throw Error("WatchDog timer not null");g.B=Qe(v(g.ba,g),E)}function Nr(g){g.B&&(u.clearTimeout(g.B),g.B=null)}Gn.prototype.ba=function(){this.B=null;const g=Date.now();0<=g-this.S?(bh(this.i,this.A),this.L!=2&&(Ir(),Re(17)),Tn(this),this.s=2,rs(this)):wh(this,this.S-g)};function rs(g){g.j.G==0||g.J||kh(g.j,g)}function Tn(g){Nr(g);var E=g.M;E&&typeof E.ma=="function"&&E.ma(),g.M=null,Ht(g.U),g.g&&(E=g.g,g.g=null,E.abort(),E.ma())}function xa(g,E){try{var C=g.j;if(C.G!=0&&(C.g==g||ac(C.h,g))){if(!g.K&&ac(C.h,g)&&C.G==3){try{var L=C.Da.g.parse(E)}catch{L=null}if(Array.isArray(L)&&L.length==3){var tt=L;if(tt[0]==0){t:if(!C.u){if(C.g)if(C.g.F+3e3<g.F)Ho(C),Vo(C);else break t;mc(C),Re(18)}}else C.za=tt[1],0<C.za-C.T&&37500>tt[2]&&C.F&&C.v==0&&!C.C&&(C.C=Qe(v(C.Za,C),6e3));if(1>=Mo(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else Ks(C,11)}else if((g.K||C.g==g)&&Ho(C),!k(E))for(tt=C.Da.g.parse(E),E=0;E<tt.length;E++){let re=tt[E];if(C.T=re[0],re=re[1],C.G==2)if(re[0]=="c"){C.K=re[1],C.ia=re[2];const yn=re[3];yn!=null&&(C.la=yn,C.j.info("VER="+C.la));const hn=re[4];hn!=null&&(C.Aa=hn,C.j.info("SVER="+C.Aa));const Ws=re[5];Ws!=null&&typeof Ws=="number"&&0<Ws&&(L=1.5*Ws,C.L=L,C.j.info("backChannelRequestTimeoutMs_="+L)),L=C;const Sn=g.g;if(Sn){const ds=Sn.g?Sn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ds){var lt=L.h;lt.g||ds.indexOf("spdy")==-1&&ds.indexOf("quic")==-1&&ds.indexOf("h2")==-1||(lt.j=lt.l,lt.g=new Set,lt.h&&(ko(lt,lt.h),lt.h=null))}if(L.D){const _c=Sn.g?Sn.g.getResponseHeader("X-HTTP-Session-Id"):null;_c&&(L.ya=_c,ye(L.I,L.D,_c))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-g.F,C.j.info("Handshake RTT: "+C.R+"ms")),L=C;var vt=g;if(L.qa=Oh(L,L.J?L.ia:null,L.W),vt.K){qn(L.h,vt);var se=vt,un=L.L;un&&(se.I=un),se.B&&(Nr(se),Ia(se)),L.g=vt}else Nh(L);0<C.i.length&&jo(C)}else re[0]!="stop"&&re[0]!="close"||Ks(C,7);else C.G==3&&(re[0]=="stop"||re[0]=="close"?re[0]=="stop"?Ks(C,7):pc(C):re[0]!="noop"&&C.l&&C.l.ta(re),C.v=0)}}Ir(4)}catch{}}var Th=class{constructor(g,E){this.g=g,this.map=E}};function zs(g){this.l=g||10,u.PerformanceNavigationTiming?(g=u.performance.getEntriesByType("navigation"),g=0<g.length&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function No(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function Mo(g){return g.h?1:g.g?g.g.size:0}function ac(g,E){return g.h?g.h==E:g.g?g.g.has(E):!1}function ko(g,E){g.g?g.g.add(E):g.h=E}function qn(g,E){g.h&&g.h==E?g.h=null:g.g&&g.g.has(E)&&g.g.delete(E)}zs.prototype.cancel=function(){if(this.i=oc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function oc(g){if(g.h!=null)return g.i.concat(g.h.D);if(g.g!=null&&g.g.size!==0){let E=g.i;for(const C of g.g.values())E=E.concat(C.D);return E}return S(g.i)}function Sp(g){if(g.V&&typeof g.V=="function")return g.V();if(typeof Map<"u"&&g instanceof Map||typeof Set<"u"&&g instanceof Set)return Array.from(g.values());if(typeof g=="string")return g.split("");if(h(g)){for(var E=[],C=g.length,L=0;L<C;L++)E.push(g[L]);return E}E=[],C=0;for(L in g)E[C++]=g[L];return E}function Po(g){if(g.na&&typeof g.na=="function")return g.na();if(!g.V||typeof g.V!="function"){if(typeof Map<"u"&&g instanceof Map)return Array.from(g.keys());if(!(typeof Set<"u"&&g instanceof Set)){if(h(g)||typeof g=="string"){var E=[];g=g.length;for(var C=0;C<g;C++)E.push(C);return E}E=[],C=0;for(const L in g)E[C++]=L;return E}}}function lc(g,E){if(g.forEach&&typeof g.forEach=="function")g.forEach(E,void 0);else if(h(g)||typeof g=="string")Array.prototype.forEach.call(g,E,void 0);else for(var C=Po(g),L=Sp(g),tt=L.length,lt=0;lt<tt;lt++)E.call(void 0,L[lt],C&&C[lt],g)}var Da=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Cp(g,E){if(g){g=g.split("&");for(var C=0;C<g.length;C++){var L=g[C].indexOf("="),tt=null;if(0<=L){var lt=g[C].substring(0,L);tt=g[C].substring(L+1)}else lt=g[C];E(lt,tt?decodeURIComponent(tt.replace(/\+/g," ")):"")}}}function Je(g){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,g instanceof Je){this.h=g.h,Na(this,g.j),this.o=g.o,this.g=g.g,Mr(this,g.s),this.l=g.l;var E=g.i,C=new qs;C.i=E.i,E.g&&(C.g=new Map(E.g),C.h=E.h),Gs(this,C),this.m=g.m}else g&&(E=String(g).match(Da))?(this.h=!1,Na(this,E[1]||"",!0),this.o=Si(E[2]||""),this.g=Si(E[3]||"",!0),Mr(this,E[4]),this.l=Si(E[5]||"",!0),Gs(this,E[6]||"",!0),this.m=Si(E[7]||"")):(this.h=!1,this.i=new qs(null,this.h))}Je.prototype.toString=function(){var g=[],E=this.j;E&&g.push(ka(E,cc,!0),":");var C=this.g;return(C||E=="file")&&(g.push("//"),(E=this.o)&&g.push(ka(E,cc,!0),"@"),g.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&g.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&g.push("/"),g.push(ka(C,C.charAt(0)=="/"?Rp:uc,!0))),(C=this.i.toString())&&g.push("?",C),(C=this.m)&&g.push("#",ka(C,Oo)),g.join("")};function hi(g){return new Je(g)}function Na(g,E,C){g.j=C?Si(E,!0):E,g.j&&(g.j=g.j.replace(/:$/,""))}function Mr(g,E){if(E){if(E=Number(E),isNaN(E)||0>E)throw Error("Bad port number "+E);g.s=E}else g.s=null}function Gs(g,E,C){E instanceof qs?(g.i=E,Ch(g.i,g.h)):(C||(E=ka(E,Ip)),g.i=new qs(E,g.h))}function ye(g,E,C){g.i.set(E,C)}function Ma(g){return ye(g,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),g}function Si(g,E){return g?E?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function ka(g,E,C){return typeof g=="string"?(g=encodeURI(g).replace(E,Sh),C&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Sh(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var cc=/[#\/\?@]/g,uc=/[#\?:]/g,Rp=/[#\?]/g,Ip=/[#\?@]/g,Oo=/#/g;function qs(g,E){this.h=this.g=null,this.i=g||null,this.j=!!E}function Ci(g){g.g||(g.g=new Map,g.h=0,g.i&&Cp(g.i,function(E,C){g.add(decodeURIComponent(E.replace(/\+/g," ")),C)}))}s=qs.prototype,s.add=function(g,E){Ci(this),this.i=null,g=as(this,g);var C=this.g.get(g);return C||this.g.set(g,C=[]),C.push(E),this.h+=1,this};function $s(g,E){Ci(g),E=as(g,E),g.g.has(E)&&(g.i=null,g.h-=g.g.get(E).length,g.g.delete(E))}function Ys(g,E){return Ci(g),E=as(g,E),g.g.has(E)}s.forEach=function(g,E){Ci(this),this.g.forEach(function(C,L){C.forEach(function(tt){g.call(E,tt,L,this)},this)},this)},s.na=function(){Ci(this);const g=Array.from(this.g.values()),E=Array.from(this.g.keys()),C=[];for(let L=0;L<E.length;L++){const tt=g[L];for(let lt=0;lt<tt.length;lt++)C.push(E[L])}return C},s.V=function(g){Ci(this);let E=[];if(typeof g=="string")Ys(this,g)&&(E=E.concat(this.g.get(as(this,g))));else{g=Array.from(this.g.values());for(let C=0;C<g.length;C++)E=E.concat(g[C])}return E},s.set=function(g,E){return Ci(this),this.i=null,g=as(this,g),Ys(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[E]),this.h+=1,this},s.get=function(g,E){return g?(g=this.V(g),0<g.length?String(g[0]):E):E};function hc(g,E,C){$s(g,E),0<C.length&&(g.i=null,g.g.set(as(g,E),S(C)),g.h+=C.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],E=Array.from(this.g.keys());for(var C=0;C<E.length;C++){var L=E[C];const lt=encodeURIComponent(String(L)),vt=this.V(L);for(L=0;L<vt.length;L++){var tt=lt;vt[L]!==""&&(tt+="="+encodeURIComponent(String(vt[L]))),g.push(tt)}}return this.i=g.join("&")};function as(g,E){return E=String(E),g.j&&(E=E.toLowerCase()),E}function Ch(g,E){E&&!g.j&&(Ci(g),g.i=null,g.g.forEach(function(C,L){var tt=L.toLowerCase();L!=tt&&($s(this,L),hc(this,tt,C))},g)),g.j=E}function Pa(g,E){const C=new Ti;if(u.Image){const L=new Image;L.onload=b(Ri,C,"TestLoadImage: loaded",!0,E,L),L.onerror=b(Ri,C,"TestLoadImage: error",!1,E,L),L.onabort=b(Ri,C,"TestLoadImage: abort",!1,E,L),L.ontimeout=b(Ri,C,"TestLoadImage: timeout",!1,E,L),u.setTimeout(function(){L.ontimeout&&L.ontimeout()},1e4),L.src=g}else E(!1)}function $i(g,E){const C=new Ti,L=new AbortController,tt=setTimeout(()=>{L.abort(),Ri(C,"TestPingServer: timeout",!1,E)},1e4);fetch(g,{signal:L.signal}).then(lt=>{clearTimeout(tt),lt.ok?Ri(C,"TestPingServer: ok",!0,E):Ri(C,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(tt),Ri(C,"TestPingServer: error",!1,E)})}function Ri(g,E,C,L,tt){try{tt&&(tt.onload=null,tt.onerror=null,tt.onabort=null,tt.ontimeout=null),L(C)}catch{}}function Oa(){this.g=new de}function os(g,E,C){const L=C||"";try{lc(g,function(tt,lt){let vt=tt;f(tt)&&(vt=ie(tt)),E.push(L+lt+"="+encodeURIComponent(vt))})}catch(tt){throw E.push(L+"type="+encodeURIComponent("_badmap")),tt}}function kr(g){this.l=g.Ub||null,this.j=g.eb||!1}T(kr,le),kr.prototype.g=function(){return new Xs(this.l,this.j)},kr.prototype.i=(function(g){return function(){return g}})({});function Xs(g,E){Ce.call(this),this.D=g,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(Xs,Ce),s=Xs.prototype,s.open=function(g,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=g,this.A=E,this.readyState=1,cs(this)},s.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const E={headers:this.u,method:this.B,credentials:this.m,cache:void 0};g&&(E.body=g),(this.D||u).fetch(new Request(this.A,E)).then(this.Sa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ls(this)),this.readyState=0},s.Sa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,cs(this)),this.g&&(this.readyState=3,cs(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;dc(this)}else g.text().then(this.Ra.bind(this),this.ga.bind(this))};function dc(g){g.j.read().then(g.Pa.bind(g)).catch(g.ga.bind(g))}s.Pa=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var E=g.value?g.value:new Uint8Array(0);(E=this.v.decode(E,{stream:!g.done}))&&(this.response=this.responseText+=E)}g.done?ls(this):cs(this),this.readyState==3&&dc(this)}},s.Ra=function(g){this.g&&(this.response=this.responseText=g,ls(this))},s.Qa=function(g){this.g&&(this.response=g,ls(this))},s.ga=function(){this.g&&ls(this)};function ls(g){g.readyState=4,g.l=null,g.j=null,g.v=null,cs(g)}s.setRequestHeader=function(g,E){this.u.append(g,E)},s.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],E=this.h.entries();for(var C=E.next();!C.done;)C=C.value,g.push(C[0]+": "+C[1]),C=E.next();return g.join(`\r
`)};function cs(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(Xs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function fc(g){let E="";return K(g,function(C,L){E+=L,E+=":",E+=C,E+=`\r
`}),E}function mn(g,E,C){t:{for(L in C){var L=!1;break t}L=!0}L||(C=fc(C),typeof g=="string"?C!=null&&encodeURIComponent(String(C)):ye(g,E,C))}function fe(g){Ce.call(this),this.headers=new Map,this.o=g||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(fe,Ce);var Lo=/^https?$/i,La=["POST","PUT"];s=fe.prototype,s.Ha=function(g){this.J=g},s.ea=function(g,E,C,L){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);E=E?E.toUpperCase():"GET",this.D=g,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():is.g(),this.v=this.o?tc(this.o):tc(is),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(E,String(g),!0),this.B=!1}catch(lt){Rh(this,lt);return}if(g=C||"",C=new Map(this.headers),L)if(Object.getPrototypeOf(L)===Object.prototype)for(var tt in L)C.set(tt,L[tt]);else if(typeof L.keys=="function"&&typeof L.get=="function")for(const lt of L.keys())C.set(lt,L.get(lt));else throw Error("Unknown input type for opt_headers: "+String(L));L=Array.from(C.keys()).find(lt=>lt.toLowerCase()=="content-type"),tt=u.FormData&&g instanceof u.FormData,!(0<=Array.prototype.indexOf.call(La,E,void 0))||L||tt||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[lt,vt]of C)this.g.setRequestHeader(lt,vt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ba(this),this.u=!0,this.g.send(g),this.u=!1}catch(lt){Rh(this,lt)}};function Rh(g,E){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=E,g.m=5,Bo(g),us(g)}function Bo(g){g.A||(g.A=!0,D(g,"complete"),D(g,"error"))}s.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=g||7,D(this,"complete"),D(this,"abort"),us(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),us(this,!0)),fe.aa.N.call(this)},s.Ea=function(){this.s||(this.B||this.u||this.j?Fo(this):this.bb())},s.bb=function(){Fo(this)};function Fo(g){if(g.h&&typeof l<"u"&&(!g.v[1]||Ii(g)!=4||g.Z()!=2)){if(g.u&&Ii(g)==4)w(g.Ea,0,g);else if(D(g,"readystatechange"),Ii(g)==4){g.h=!1;try{const vt=g.Z();t:switch(vt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break t;default:E=!1}var C;if(!(C=E)){var L;if(L=vt===0){var tt=String(g.D).match(Da)[1]||null;!tt&&u.self&&u.self.location&&(tt=u.self.location.protocol.slice(0,-1)),L=!Lo.test(tt?tt.toLowerCase():"")}C=L}if(C)D(g,"complete"),D(g,"success");else{g.m=6;try{var lt=2<Ii(g)?g.g.statusText:""}catch{lt=""}g.l=lt+" ["+g.Z()+"]",Bo(g)}}finally{us(g)}}}}function us(g,E){if(g.g){Ba(g);const C=g.g,L=g.v[0]?()=>{}:null;g.g=null,g.v=null,E||D(g,"ready");try{C.onreadystatechange=L}catch{}}}function Ba(g){g.I&&(u.clearTimeout(g.I),g.I=null)}s.isActive=function(){return!!this.g};function Ii(g){return g.g?g.g.readyState:0}s.Z=function(){try{return 2<Ii(this)?this.g.status:-1}catch{return-1}},s.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.Oa=function(g){if(this.g){var E=this.g.responseText;return g&&E.indexOf(g)==0&&(E=E.substring(g.length)),ue(E)}};function Ih(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.H){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function xp(g){const E={};g=(g.g&&2<=Ii(g)&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let L=0;L<g.length;L++){if(k(g[L]))continue;var C=V(g[L]);const tt=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const lt=E[tt]||[];E[tt]=lt,lt.push(C)}P(E,function(L){return L.join(", ")})}s.Ba=function(){return this.m},s.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fa(g,E,C){return C&&C.internalChannelParams&&C.internalChannelParams[g]||E}function Uo(g){this.Aa=0,this.i=[],this.j=new Ti,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Fa("failFast",!1,g),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Fa("baseRetryDelayMs",5e3,g),this.cb=Fa("retryDelaySeedMs",1e4,g),this.Wa=Fa("forwardChannelMaxRetries",2,g),this.wa=Fa("forwardChannelRequestTimeoutMs",2e4,g),this.pa=g&&g.xmlHttpFactory||void 0,this.Xa=g&&g.Tb||void 0,this.Ca=g&&g.useFetchStreams||!1,this.L=void 0,this.J=g&&g.supportsCrossDomainXhr||!1,this.K="",this.h=new zs(g&&g.concurrentRequestLimit),this.Da=new Oa,this.P=g&&g.fastHandshake||!1,this.O=g&&g.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=g&&g.Rb||!1,g&&g.xa&&this.j.xa(),g&&g.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&g&&g.detectBufferingProxy||!1,this.ja=void 0,g&&g.longPollingTimeout&&0<g.longPollingTimeout&&(this.ja=g.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}s=Uo.prototype,s.la=8,s.G=1,s.connect=function(g,E,C,L){Re(0),this.W=g,this.H=E||{},C&&L!==void 0&&(this.H.OSID=C,this.H.OAID=L),this.F=this.X,this.I=Oh(this,null,this.W),jo(this)};function pc(g){if(xh(g),g.G==3){var E=g.U++,C=hi(g.I);if(ye(C,"SID",g.K),ye(C,"RID",E),ye(C,"TYPE","terminate"),Ua(g,C),E=new Gn(g,g.j,E),E.L=2,E.v=Ma(hi(C)),C=!1,u.navigator&&u.navigator.sendBeacon)try{C=u.navigator.sendBeacon(E.v.toString(),"")}catch{}!C&&u.Image&&(new Image().src=E.v,C=!0),C||(E.g=Lh(E.j,null),E.g.ea(E.v)),E.F=Date.now(),Ia(E)}Ph(g)}function Vo(g){g.g&&(Va(g),g.g.cancel(),g.g=null)}function xh(g){Vo(g),g.u&&(u.clearTimeout(g.u),g.u=null),Ho(g),g.h.cancel(),g.s&&(typeof g.s=="number"&&u.clearTimeout(g.s),g.s=null)}function jo(g){if(!No(g.h)&&!g.s){g.s=!0;var E=g.Ga;ct||$(),mt||(ct(),mt=!0),Mt.add(E,g),g.B=0}}function Dp(g,E){return Mo(g.h)>=g.h.j-(g.s?1:0)?!1:g.s?(g.i=E.D.concat(g.i),!0):g.G==1||g.G==2||g.B>=(g.Va?0:g.Wa)?!1:(g.s=Qe(v(g.Ga,g,E),yc(g,g.B)),g.B++,!0)}s.Ga=function(g){if(this.s)if(this.s=null,this.G==1){if(!g){this.U=Math.floor(1e5*Math.random()),g=this.U++;const tt=new Gn(this,this.j,g);let lt=this.o;if(this.S&&(lt?(lt=N(lt),j(lt,this.S)):lt=this.S),this.m!==null||this.O||(tt.H=lt,lt=null),this.P)t:{for(var E=0,C=0;C<this.i.length;C++){e:{var L=this.i[C];if("__data__"in L.map&&(L=L.map.__data__,typeof L=="string")){L=L.length;break e}L=void 0}if(L===void 0)break;if(E+=L,4096<E){E=C;break t}if(E===4096||C===this.i.length-1){E=C+1;break t}}E=1e3}else E=1e3;E=Dh(this,tt,E),C=hi(this.I),ye(C,"RID",g),ye(C,"CVER",22),this.D&&ye(C,"X-HTTP-Session-Id",this.D),Ua(this,C),lt&&(this.O?E="headers="+encodeURIComponent(String(fc(lt)))+"&"+E:this.m&&mn(C,this.m,lt)),ko(this.h,tt),this.Ua&&ye(C,"TYPE","init"),this.P?(ye(C,"$req",E),ye(C,"SID","null"),tt.T=!0,qi(tt,C,null)):qi(tt,C,E),this.G=2}}else this.G==3&&(g?gc(this,g):this.i.length==0||No(this.h)||gc(this))};function gc(g,E){var C;E?C=E.l:C=g.U++;const L=hi(g.I);ye(L,"SID",g.K),ye(L,"RID",C),ye(L,"AID",g.T),Ua(g,L),g.m&&g.o&&mn(L,g.m,g.o),C=new Gn(g,g.j,C,g.B+1),g.m===null&&(C.H=g.o),E&&(g.i=E.D.concat(g.i)),E=Dh(g,C,1e3),C.I=Math.round(.5*g.wa)+Math.round(.5*g.wa*Math.random()),ko(g.h,C),qi(C,L,E)}function Ua(g,E){g.H&&K(g.H,function(C,L){ye(E,L,C)}),g.l&&lc({},function(C,L){ye(E,L,C)})}function Dh(g,E,C){C=Math.min(g.i.length,C);var L=g.l?v(g.l.Na,g.l,g):null;t:{var tt=g.i;let lt=-1;for(;;){const vt=["count="+C];lt==-1?0<C?(lt=tt[0].g,vt.push("ofs="+lt)):lt=0:vt.push("ofs="+lt);let se=!0;for(let un=0;un<C;un++){let re=tt[un].g;const yn=tt[un].map;if(re-=lt,0>re)lt=Math.max(0,tt[un].g-100),se=!1;else try{os(yn,vt,"req"+re+"_")}catch{L&&L(yn)}}if(se){L=vt.join("&");break t}}}return g=g.i.splice(0,C),E.D=g,L}function Nh(g){if(!g.g&&!g.u){g.Y=1;var E=g.Fa;ct||$(),mt||(ct(),mt=!0),Mt.add(E,g),g.v=0}}function mc(g){return g.g||g.u||3<=g.v?!1:(g.Y++,g.u=Qe(v(g.Fa,g),yc(g,g.v)),g.v++,!0)}s.Fa=function(){if(this.u=null,Mh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var g=2*this.R;this.j.info("BP detection timer enabled: "+g),this.A=Qe(v(this.ab,this),g)}},s.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Re(10),Vo(this),Mh(this))};function Va(g){g.A!=null&&(u.clearTimeout(g.A),g.A=null)}function Mh(g){g.g=new Gn(g,g.j,"rpc",g.Y),g.m===null&&(g.g.H=g.o),g.g.O=0;var E=hi(g.qa);ye(E,"RID","rpc"),ye(E,"SID",g.K),ye(E,"AID",g.T),ye(E,"CI",g.F?"0":"1"),!g.F&&g.ja&&ye(E,"TO",g.ja),ye(E,"TYPE","xmlhttp"),Ua(g,E),g.m&&g.o&&mn(E,g.m,g.o),g.L&&(g.g.I=g.L);var C=g.g;g=g.ia,C.L=1,C.v=Ma(hi(E)),C.m=null,C.P=!0,Hs(C,g)}s.Za=function(){this.C!=null&&(this.C=null,Vo(this),mc(this),Re(19))};function Ho(g){g.C!=null&&(u.clearTimeout(g.C),g.C=null)}function kh(g,E){var C=null;if(g.g==E){Ho(g),Va(g),g.g=null;var L=2}else if(ac(g.h,E))C=E.D,qn(g.h,E),L=1;else return;if(g.G!=0){if(E.o)if(L==1){C=E.m?E.m.length:0,E=Date.now()-E.F;var tt=g.B;L=Rr(),D(L,new cn(L,C)),jo(g)}else Nh(g);else if(tt=E.s,tt==3||tt==0&&0<E.X||!(L==1&&Dp(g,E)||L==2&&mc(g)))switch(C&&0<C.length&&(E=g.h,E.i=E.i.concat(C)),tt){case 1:Ks(g,5);break;case 4:Ks(g,10);break;case 3:Ks(g,6);break;default:Ks(g,2)}}}function yc(g,E){let C=g.Ta+Math.floor(Math.random()*g.cb);return g.isActive()||(C*=2),C*E}function Ks(g,E){if(g.j.info("Error code "+E),E==2){var C=v(g.fb,g),L=g.Xa;const tt=!L;L=new Je(L||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Na(L,"https"),Ma(L),tt?Pa(L.toString(),C):$i(L.toString(),C)}else Re(2);g.G=0,g.l&&g.l.sa(E),Ph(g),xh(g)}s.fb=function(g){g?(this.j.info("Successfully pinged google.com"),Re(2)):(this.j.info("Failed to ping google.com"),Re(1))};function Ph(g){if(g.G=0,g.ka=[],g.l){const E=oc(g.h);(E.length!=0||g.i.length!=0)&&(I(g.ka,E),I(g.ka,g.i),g.h.i.length=0,S(g.i),g.i.length=0),g.l.ra()}}function Oh(g,E,C){var L=C instanceof Je?hi(C):new Je(C);if(L.g!="")E&&(L.g=E+"."+L.g),Mr(L,L.s);else{var tt=u.location;L=tt.protocol,E=E?E+"."+tt.hostname:tt.hostname,tt=+tt.port;var lt=new Je(null);L&&Na(lt,L),E&&(lt.g=E),tt&&Mr(lt,tt),C&&(lt.l=C),L=lt}return C=g.D,E=g.ya,C&&E&&ye(L,C,E),ye(L,"VER",g.la),Ua(g,L),L}function Lh(g,E,C){if(E&&!g.J)throw Error("Can't create secondary domain capable XhrIo object.");return E=g.Ca&&!g.pa?new fe(new kr({eb:C})):new fe(g.pa),E.Ha(g.J),E}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Bh(){}s=Bh.prototype,s.ua=function(){},s.ta=function(){},s.sa=function(){},s.ra=function(){},s.isActive=function(){return!0},s.Na=function(){};function zo(){}zo.prototype.g=function(g,E){return new $n(g,E)};function $n(g,E){Ce.call(this),this.g=new Uo(E),this.l=g,this.h=E&&E.messageUrlParams||null,g=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(g?g["X-WebChannel-Content-Type"]=E.messageContentType:g={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.va&&(g?g["X-WebChannel-Client-Profile"]=E.va:g={"X-WebChannel-Client-Profile":E.va}),this.g.S=g,(g=E&&E.Sb)&&!k(g)&&(this.g.m=g),this.v=E&&E.supportsCrossDomainXhr||!1,this.u=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!k(E)&&(this.g.D=E,g=this.h,g!==null&&E in g&&(g=this.h,E in g&&delete g[E])),this.j=new hs(this)}T($n,Ce),$n.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},$n.prototype.close=function(){pc(this.g)},$n.prototype.o=function(g){var E=this.g;if(typeof g=="string"){var C={};C.__data__=g,g=C}else this.u&&(C={},C.__data__=ie(g),g=C);E.i.push(new Th(E.Ya++,g)),E.G==3&&jo(E)},$n.prototype.N=function(){this.g.l=null,delete this.j,pc(this.g),delete this.g,$n.aa.N.call(this)};function Fh(g){Vs.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var E=g.__sm__;if(E){t:{for(const C in E){g=C;break t}g=void 0}(this.i=g)&&(g=this.i,E=E!==null&&g in E?E[g]:void 0),this.data=E}else this.data=g}T(Fh,Vs);function Uh(){nc.call(this),this.status=1}T(Uh,nc);function hs(g){this.g=g}T(hs,Bh),hs.prototype.ua=function(){D(this.g,"a")},hs.prototype.ta=function(g){D(this.g,new Fh(g))},hs.prototype.sa=function(g){D(this.g,new Uh)},hs.prototype.ra=function(){D(this.g,"b")},zo.prototype.createWebChannel=zo.prototype.g,$n.prototype.send=$n.prototype.o,$n.prototype.open=$n.prototype.m,$n.prototype.close=$n.prototype.close,AS=function(){return new zo},ES=function(){return Rr()},bS=ns,hy={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Dr.NO_ERROR=0,Dr.TIMEOUT=8,Dr.HTTP_ERROR=6,ff=Dr,js.COMPLETE="complete",vS=js,ec.EventType=Us,Us.OPEN="a",Us.CLOSE="b",Us.ERROR="c",Us.MESSAGE="d",Ce.prototype.listen=Ce.prototype.K,gu=ec,fe.prototype.listenOnce=fe.prototype.L,fe.prototype.getLastError=fe.prototype.Ka,fe.prototype.getLastErrorCode=fe.prototype.Ba,fe.prototype.getStatus=fe.prototype.Z,fe.prototype.getResponseJson=fe.prototype.Oa,fe.prototype.getResponseText=fe.prototype.oa,fe.prototype.send=fe.prototype.ea,fe.prototype.setWithCredentials=fe.prototype.Ha,_S=fe}).apply(typeof Hd<"u"?Hd:typeof self<"u"?self:typeof window<"u"?window:{});const _A="@firebase/firestore",vA="4.9.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Vn.UNAUTHENTICATED=new Vn(null),Vn.GOOGLE_CREDENTIALS=new Vn("google-credentials-uid"),Vn.FIRST_PARTY=new Vn("first-party-uid"),Vn.MOCK_USER=new Vn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wl="12.2.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo=new Qy("@firebase/firestore");function El(){return mo.logLevel}function At(s,...t){if(mo.logLevel<=Jt.DEBUG){const e=t.map(u_);mo.debug(`Firestore (${Wl}): ${s}`,...e)}}function Ar(s,...t){if(mo.logLevel<=Jt.ERROR){const e=t.map(u_);mo.error(`Firestore (${Wl}): ${s}`,...e)}}function Fl(s,...t){if(mo.logLevel<=Jt.WARN){const e=t.map(u_);mo.warn(`Firestore (${Wl}): ${s}`,...e)}}function u_(s){if(typeof s=="string")return s;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(e){return JSON.stringify(e)})(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ut(s,t,e){let n="Unexpected state";typeof t=="string"?n=t:e=t,wS(s,n,e)}function wS(s,t,e){let n=`FIRESTORE (${Wl}) INTERNAL ASSERTION FAILED: ${t} (ID: ${s.toString(16)})`;if(e!==void 0)try{n+=" CONTEXT: "+JSON.stringify(e)}catch{n+=" CONTEXT: "+e}throw Ar(n),new Error(n)}function pe(s,t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,s||wS(t,i,n)}function qt(s,t){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _t={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Rt extends Ls{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Xk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Vn.UNAUTHENTICATED)))}shutdown(){}}class Kk{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Wk{constructor(t){this.t=t,this.currentUser=Vn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){pe(this.o===void 0,42304);let n=this.i;const i=h=>this.i!==n?(n=this.i,e(h)):Promise.resolve();let a=new fa;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new fa,t.enqueueRetryable((()=>i(this.currentUser)))};const l=()=>{const h=a;t.enqueueRetryable((async()=>{await h.promise,await i(this.currentUser)}))},u=h=>{At("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((h=>u(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(At("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new fa)}}),0),l()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((n=>this.i!==t?(At("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(pe(typeof n.accessToken=="string",31837,{l:n}),new TS(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return pe(t===null||typeof t=="string",2055,{h:t}),new Vn(t)}}class Qk{constructor(t,e,n){this.P=t,this.T=e,this.I=n,this.type="FirstParty",this.user=Vn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Jk{constructor(t,e,n){this.P=t,this.T=e,this.I=n}getToken(){return Promise.resolve(new Qk(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(Vn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class bA{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Zk{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,li(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){pe(this.o===void 0,3512);const n=a=>{a.error!=null&&At("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,At("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?e(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable((()=>n(a)))};const i=a=>{At("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):At("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new bA(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(pe(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new bA(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t2(s){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(s);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let n=0;n<s;n++)e[n]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=t2(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<e&&(n+=t.charAt(i[a]%62))}return n}}function Zt(s,t){return s<t?-1:s>t?1:0}function dy(s,t){const e=Math.min(s.length,t.length);for(let n=0;n<e;n++){const i=s.charAt(n),a=t.charAt(n);if(i!==a)return Bm(i)===Bm(a)?Zt(i,a):Bm(i)?1:-1}return Zt(s.length,t.length)}const e2=55296,n2=57343;function Bm(s){const t=s.charCodeAt(0);return t>=e2&&t<=n2}function Ul(s,t,e){return s.length===t.length&&s.every(((n,i)=>e(n,t[i])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EA="__name__";class ws{constructor(t,e,n){e===void 0?e=0:e>t.length&&Ut(637,{offset:e,range:t.length}),n===void 0?n=t.length-e:n>t.length-e&&Ut(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return ws.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof ws?t.forEach((n=>{e.push(n)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const a=ws.compareSegments(t.get(i),e.get(i));if(a!==0)return a}return Zt(t.length,e.length)}static compareSegments(t,e){const n=ws.isNumericId(t),i=ws.isNumericId(e);return n&&!i?-1:!n&&i?1:n&&i?ws.extractNumericId(t).compare(ws.extractNumericId(e)):dy(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return da.fromString(t.substring(4,t.length-2))}}class Le extends ws{construct(t,e,n){return new Le(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Rt(_t.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((i=>i.length>0)))}return new Le(e)}static emptyPath(){return new Le([])}}const i2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kn extends ws{construct(t,e,n){return new kn(t,e,n)}static isValidIdentifier(t){return i2.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kn.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===EA}static keyField(){return new kn([EA])}static fromServerFormat(t){const e=[];let n="",i=0;const a=()=>{if(n.length===0)throw new Rt(_t.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let l=!1;for(;i<t.length;){const u=t[i];if(u==="\\"){if(i+1===t.length)throw new Rt(_t.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const h=t[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new Rt(_t.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=h,i+=2}else u==="`"?(l=!l,i++):u!=="."||l?(n+=u,i++):(a(),i++)}if(a(),l)throw new Rt(_t.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new kn(e)}static emptyPath(){return new kn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(t){this.path=t}static fromPath(t){return new Pt(Le.fromString(t))}static fromName(t){return new Pt(Le.fromString(t).popFirst(5))}static empty(){return new Pt(Le.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Le.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return Le.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Pt(new Le(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s2(s,t,e){if(!e)throw new Rt(_t.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${t}.`)}function r2(s,t,e,n){if(t===!0&&n===!0)throw new Rt(_t.INVALID_ARGUMENT,`${s} and ${e} cannot be used together.`)}function AA(s){if(!Pt.isDocumentKey(s))throw new Rt(_t.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function SS(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function d_(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const t=(function(n){return n.constructor?n.constructor.name:null})(s);return t?`a custom ${t} object`:"an object"}}return typeof s=="function"?"a function":Ut(12329,{type:typeof s})}function Fu(s,t){if("_delegate"in s&&(s=s._delegate),!(s instanceof t)){if(t.name===s.constructor.name)throw new Rt(_t.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=d_(s);throw new Rt(_t.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return s}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function on(s,t){const e={typeString:s};return t&&(e.value=t),e}function ah(s,t){if(!SS(s))throw new Rt(_t.INVALID_ARGUMENT,"JSON must be an object");let e;for(const n in t)if(t[n]){const i=t[n].typeString,a="value"in t[n]?{value:t[n].value}:void 0;if(!(n in s)){e=`JSON missing required field: '${n}'`;break}const l=s[n];if(i&&typeof l!==i){e=`JSON field '${n}' must be a ${i}.`;break}if(a!==void 0&&l!==a.value){e=`Expected '${n}' field to equal '${a.value}'`;break}}if(e)throw new Rt(_t.INVALID_ARGUMENT,e);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wA=-62135596800,TA=1e6;class Se{static now(){return Se.fromMillis(Date.now())}static fromDate(t){return Se.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*TA);return new Se(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Rt(_t.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Rt(_t.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<wA)throw new Rt(_t.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Rt(_t.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/TA}_compareTo(t){return this.seconds===t.seconds?Zt(this.nanoseconds,t.nanoseconds):Zt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Se._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(ah(t,Se._jsonSchema))return new Se(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-wA;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Se._jsonSchemaVersion="firestore/timestamp/1.0",Se._jsonSchema={type:on("string",Se._jsonSchemaVersion),seconds:on("number"),nanoseconds:on("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{static fromTimestamp(t){return new zt(t)}static min(){return new zt(new Se(0,0))}static max(){return new zt(new Se(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uu=-1;function a2(s,t){const e=s.toTimestamp().seconds,n=s.toTimestamp().nanoseconds+1,i=zt.fromTimestamp(n===1e9?new Se(e+1,0):new Se(e,n));return new ma(i,Pt.empty(),t)}function o2(s){return new ma(s.readTime,s.key,Uu)}class ma{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new ma(zt.min(),Pt.empty(),Uu)}static max(){return new ma(zt.max(),Pt.empty(),Uu)}}function l2(s,t){let e=s.readTime.compareTo(t.readTime);return e!==0?e:(e=Pt.comparator(s.documentKey,t.documentKey),e!==0?e:Zt(s.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class u2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ql(s){if(s.code!==_t.FAILED_PRECONDITION||s.message!==c2)throw s;At("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Ut(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new gt(((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(e,a).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof gt?e:gt.resolve(e)}catch(e){return gt.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):gt.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):gt.reject(e)}static resolve(t){return new gt(((e,n)=>{e(t)}))}static reject(t){return new gt(((e,n)=>{n(t)}))}static waitFor(t){return new gt(((e,n)=>{let i=0,a=0,l=!1;t.forEach((u=>{++i,u.next((()=>{++a,l&&a===i&&e()}),(h=>n(h)))})),l=!0,a===i&&e()}))}static or(t){let e=gt.resolve(!1);for(const n of t)e=e.next((i=>i?gt.resolve(i):n()));return e}static forEach(t,e){const n=[];return t.forEach(((i,a)=>{n.push(e.call(this,i,a))})),this.waitFor(n)}static mapArray(t,e){return new gt(((n,i)=>{const a=t.length,l=new Array(a);let u=0;for(let h=0;h<a;h++){const f=h;e(t[f]).next((p=>{l[f]=p,++u,u===a&&n(l)}),(p=>i(p)))}}))}static doWhile(t,e){return new gt(((n,i)=>{const a=()=>{t()===!0?e().next((()=>{a()}),i):n()};a()}))}}function h2(s){const t=s.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function Jl(s){return s.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>e.writeSequenceNumber(n))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}np.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f_=-1;function ip(s){return s==null}function Mf(s){return s===0&&1/s==-1/0}function d2(s){return typeof s=="number"&&Number.isInteger(s)&&!Mf(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CS="";function f2(s){let t="";for(let e=0;e<s.length;e++)t.length>0&&(t=SA(t)),t=p2(s.get(e),t);return SA(t)}function p2(s,t){let e=t;const n=s.length;for(let i=0;i<n;i++){const a=s.charAt(i);switch(a){case"\0":e+="";break;case CS:e+="";break;default:e+=a}}return e}function SA(s){return s+CS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CA(s){let t=0;for(const e in s)Object.prototype.hasOwnProperty.call(s,e)&&t++;return t}function wo(s,t){for(const e in s)Object.prototype.hasOwnProperty.call(s,e)&&t(e,s[e])}function RS(s){for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(t,e){this.comparator=t,this.root=e||Nn.EMPTY}insert(t,e){return new Be(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Nn.BLACK,null,null))}remove(t){return new Be(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Nn.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(n===0)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new zd(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new zd(this.root,t,this.comparator,!1)}getReverseIterator(){return new zd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new zd(this.root,t,this.comparator,!0)}}class zd{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=e?n(t.key,e):1,e&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(a===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Nn{constructor(t,e,n,i,a){this.key=t,this.value=e,this.color=n??Nn.RED,this.left=i??Nn.EMPTY,this.right=a??Nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,a){return new Nn(t??this.key,e??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const a=n(t,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(t,e,n),null):a===0?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Nn.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),e(t,i.key)===0){if(i.right.isEmpty())return Nn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ut(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ut(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw Ut(27949);return t+(this.isRed()?0:1)}}Nn.EMPTY=null,Nn.RED=!0,Nn.BLACK=!1;Nn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ut(57766)}get value(){throw Ut(16141)}get color(){throw Ut(16727)}get left(){throw Ut(29726)}get right(){throw Ut(36894)}copy(t,e,n,i,a){return this}insert(t,e,n){return new Nn(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(t){this.comparator=t,this.data=new Be(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new RA(this.data.getIterator())}getIteratorFrom(t){return new RA(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((n=>{e=e.add(n)})),e}isEqual(t){if(!(t instanceof gn)||this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const i=e.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new gn(this.comparator);return e.data=t,e}}class RA{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(t){this.fields=t,t.sort(kn.comparator)}static empty(){return new Ji([])}unionWith(t){let e=new gn(kn.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new Ji(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Ul(this.fields,t.fields,((e,n)=>e.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new IS("Invalid base64 string: "+a):a}})(t);return new On(e)}static fromUint8Array(t){const e=(function(i){let a="";for(let l=0;l<i.length;++l)a+=String.fromCharCode(i[l]);return a})(t);return new On(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Zt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}On.EMPTY_BYTE_STRING=new On("");const g2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ya(s){if(pe(!!s,39018),typeof s=="string"){let t=0;const e=g2.exec(s);if(pe(!!e,46558,{timestamp:s}),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}const n=new Date(s);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:Ye(s.seconds),nanos:Ye(s.nanos)}}function Ye(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function _a(s){return typeof s=="string"?On.fromBase64String(s):On.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xS="server_timestamp",DS="__type__",NS="__previous_value__",MS="__local_write_time__";function p_(s){return(s?.mapValue?.fields||{})[DS]?.stringValue===xS}function sp(s){const t=s.mapValue.fields[NS];return p_(t)?sp(t):t}function Vu(s){const t=ya(s.mapValue.fields[MS].timestampValue);return new Se(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(t,e,n,i,a,l,u,h,f,p){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=f,this.isUsingEmulator=p}}const kf="(default)";class ju{constructor(t,e){this.projectId=t,this.database=e||kf}static empty(){return new ju("","")}get isDefaultDatabase(){return this.database===kf}isEqual(t){return t instanceof ju&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kS="__type__",y2="__max__",Gd={mapValue:{}},PS="__vector__",Pf="value";function va(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?p_(s)?4:v2(s)?9007199254740991:_2(s)?10:11:Ut(28295,{value:s})}function Ms(s,t){if(s===t)return!0;const e=va(s);if(e!==va(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===t.booleanValue;case 4:return Vu(s).isEqual(Vu(t));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const l=ya(i.timestampValue),u=ya(a.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(s,t);case 5:return s.stringValue===t.stringValue;case 6:return(function(i,a){return _a(i.bytesValue).isEqual(_a(a.bytesValue))})(s,t);case 7:return s.referenceValue===t.referenceValue;case 8:return(function(i,a){return Ye(i.geoPointValue.latitude)===Ye(a.geoPointValue.latitude)&&Ye(i.geoPointValue.longitude)===Ye(a.geoPointValue.longitude)})(s,t);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return Ye(i.integerValue)===Ye(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const l=Ye(i.doubleValue),u=Ye(a.doubleValue);return l===u?Mf(l)===Mf(u):isNaN(l)&&isNaN(u)}return!1})(s,t);case 9:return Ul(s.arrayValue.values||[],t.arrayValue.values||[],Ms);case 10:case 11:return(function(i,a){const l=i.mapValue.fields||{},u=a.mapValue.fields||{};if(CA(l)!==CA(u))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(u[h]===void 0||!Ms(l[h],u[h])))return!1;return!0})(s,t);default:return Ut(52216,{left:s})}}function Hu(s,t){return(s.values||[]).find((e=>Ms(e,t)))!==void 0}function Vl(s,t){if(s===t)return 0;const e=va(s),n=va(t);if(e!==n)return Zt(e,n);switch(e){case 0:case 9007199254740991:return 0;case 1:return Zt(s.booleanValue,t.booleanValue);case 2:return(function(a,l){const u=Ye(a.integerValue||a.doubleValue),h=Ye(l.integerValue||l.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(s,t);case 3:return IA(s.timestampValue,t.timestampValue);case 4:return IA(Vu(s),Vu(t));case 5:return dy(s.stringValue,t.stringValue);case 6:return(function(a,l){const u=_a(a),h=_a(l);return u.compareTo(h)})(s.bytesValue,t.bytesValue);case 7:return(function(a,l){const u=a.split("/"),h=l.split("/");for(let f=0;f<u.length&&f<h.length;f++){const p=Zt(u[f],h[f]);if(p!==0)return p}return Zt(u.length,h.length)})(s.referenceValue,t.referenceValue);case 8:return(function(a,l){const u=Zt(Ye(a.latitude),Ye(l.latitude));return u!==0?u:Zt(Ye(a.longitude),Ye(l.longitude))})(s.geoPointValue,t.geoPointValue);case 9:return xA(s.arrayValue,t.arrayValue);case 10:return(function(a,l){const u=a.fields||{},h=l.fields||{},f=u[Pf]?.arrayValue,p=h[Pf]?.arrayValue,y=Zt(f?.values?.length||0,p?.values?.length||0);return y!==0?y:xA(f,p)})(s.mapValue,t.mapValue);case 11:return(function(a,l){if(a===Gd.mapValue&&l===Gd.mapValue)return 0;if(a===Gd.mapValue)return 1;if(l===Gd.mapValue)return-1;const u=a.fields||{},h=Object.keys(u),f=l.fields||{},p=Object.keys(f);h.sort(),p.sort();for(let y=0;y<h.length&&y<p.length;++y){const v=dy(h[y],p[y]);if(v!==0)return v;const b=Vl(u[h[y]],f[p[y]]);if(b!==0)return b}return Zt(h.length,p.length)})(s.mapValue,t.mapValue);default:throw Ut(23264,{he:e})}}function IA(s,t){if(typeof s=="string"&&typeof t=="string"&&s.length===t.length)return Zt(s,t);const e=ya(s),n=ya(t),i=Zt(e.seconds,n.seconds);return i!==0?i:Zt(e.nanos,n.nanos)}function xA(s,t){const e=s.values||[],n=t.values||[];for(let i=0;i<e.length&&i<n.length;++i){const a=Vl(e[i],n[i]);if(a)return a}return Zt(e.length,n.length)}function jl(s){return fy(s)}function fy(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(e){const n=ya(e);return`time(${n.seconds},${n.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(e){return _a(e).toBase64()})(s.bytesValue):"referenceValue"in s?(function(e){return Pt.fromName(e).toString()})(s.referenceValue):"geoPointValue"in s?(function(e){return`geo(${e.latitude},${e.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(e){let n="[",i=!0;for(const a of e.values||[])i?i=!1:n+=",",n+=fy(a);return n+"]"})(s.arrayValue):"mapValue"in s?(function(e){const n=Object.keys(e.fields||{}).sort();let i="{",a=!0;for(const l of n)a?a=!1:i+=",",i+=`${l}:${fy(e.fields[l])}`;return i+"}"})(s.mapValue):Ut(61005,{value:s})}function pf(s){switch(va(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=sp(s);return t?16+pf(t):16;case 5:return 2*s.stringValue.length;case 6:return _a(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((i,a)=>i+pf(a)),0)})(s.arrayValue);case 10:case 11:return(function(n){let i=0;return wo(n.fields,((a,l)=>{i+=a.length+pf(l)})),i})(s.mapValue);default:throw Ut(13486,{value:s})}}function py(s){return!!s&&"integerValue"in s}function g_(s){return!!s&&"arrayValue"in s}function DA(s){return!!s&&"nullValue"in s}function NA(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function gf(s){return!!s&&"mapValue"in s}function _2(s){return(s?.mapValue?.fields||{})[kS]?.stringValue===PS}function Cu(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const t={mapValue:{fields:{}}};return wo(s.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Cu(n))),t}if(s.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(s.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Cu(s.arrayValue.values[e]);return t}return{...s}}function v2(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===y2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(t){this.value=t}static empty(){return new Vi({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!gf(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Cu(e)}setAll(t){let e=kn.emptyPath(),n={},i=[];t.forEach(((l,u)=>{if(!e.isImmediateParentOf(u)){const h=this.getFieldsMap(e);this.applyChanges(h,n,i),n={},i=[],e=u.popLast()}l?n[u.lastSegment()]=Cu(l):i.push(u.lastSegment())}));const a=this.getFieldsMap(e);this.applyChanges(a,n,i)}delete(t){const e=this.field(t.popLast());gf(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Ms(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];gf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){wo(e,((i,a)=>t[i]=a));for(const i of n)delete t[i]}clone(){return new Vi(Cu(this.value))}}function OS(s){const t=[];return wo(s.fields,((e,n)=>{const i=new kn([e]);if(gf(n)){const a=OS(n.mapValue).fields;if(a.length===0)t.push(i);else for(const l of a)t.push(i.child(l))}else t.push(i)})),new Ji(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(t,e,n,i,a,l,u){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=a,this.data=l,this.documentState=u}static newInvalidDocument(t){return new jn(t,0,zt.min(),zt.min(),zt.min(),Vi.empty(),0)}static newFoundDocument(t,e,n,i){return new jn(t,1,e,zt.min(),n,i,0)}static newNoDocument(t,e){return new jn(t,2,e,zt.min(),zt.min(),Vi.empty(),0)}static newUnknownDocument(t,e){return new jn(t,3,e,zt.min(),zt.min(),Vi.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(zt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Vi.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Vi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=zt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof jn&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new jn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(t,e){this.position=t,this.inclusive=e}}function MA(s,t,e){let n=0;for(let i=0;i<s.position.length;i++){const a=t[i],l=s.position[i];if(a.field.isKeyField()?n=Pt.comparator(Pt.fromName(l.referenceValue),e.key):n=Vl(l,e.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function kA(s,t){if(s===null)return t===null;if(t===null||s.inclusive!==t.inclusive||s.position.length!==t.position.length)return!1;for(let e=0;e<s.position.length;e++)if(!Ms(s.position[e],t.position[e]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(t,e="asc"){this.field=t,this.dir=e}}function b2(s,t){return s.dir===t.dir&&s.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{}class pn extends LS{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,n):new A2(t,e,n):e==="array-contains"?new S2(t,n):e==="in"?new C2(t,n):e==="not-in"?new R2(t,n):e==="array-contains-any"?new I2(t,n):new pn(t,e,n)}static createKeyFieldInFilter(t,e,n){return e==="in"?new w2(t,n):new T2(t,n)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(Vl(e,this.value)):e!==null&&va(this.value)===va(e)&&this.matchesComparison(Vl(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Ut(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ks extends LS{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new ks(t,e)}matches(t){return BS(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function BS(s){return s.op==="and"}function FS(s){return E2(s)&&BS(s)}function E2(s){for(const t of s.filters)if(t instanceof ks)return!1;return!0}function gy(s){if(s instanceof pn)return s.field.canonicalString()+s.op.toString()+jl(s.value);if(FS(s))return s.filters.map((t=>gy(t))).join(",");{const t=s.filters.map((e=>gy(e))).join(",");return`${s.op}(${t})`}}function US(s,t){return s instanceof pn?(function(n,i){return i instanceof pn&&n.op===i.op&&n.field.isEqual(i.field)&&Ms(n.value,i.value)})(s,t):s instanceof ks?(function(n,i){return i instanceof ks&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce(((a,l,u)=>a&&US(l,i.filters[u])),!0):!1})(s,t):void Ut(19439)}function VS(s){return s instanceof pn?(function(e){return`${e.field.canonicalString()} ${e.op} ${jl(e.value)}`})(s):s instanceof ks?(function(e){return e.op.toString()+" {"+e.getFilters().map(VS).join(" ,")+"}"})(s):"Filter"}class A2 extends pn{constructor(t,e,n){super(t,e,n),this.key=Pt.fromName(n.referenceValue)}matches(t){const e=Pt.comparator(t.key,this.key);return this.matchesComparison(e)}}class w2 extends pn{constructor(t,e){super(t,"in",e),this.keys=jS("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class T2 extends pn{constructor(t,e){super(t,"not-in",e),this.keys=jS("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function jS(s,t){return(t.arrayValue?.values||[]).map((e=>Pt.fromName(e.referenceValue)))}class S2 extends pn{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return g_(e)&&Hu(e.arrayValue,this.value)}}class C2 extends pn{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Hu(this.value.arrayValue,e)}}class R2 extends pn{constructor(t,e){super(t,"not-in",e)}matches(t){if(Hu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Hu(this.value.arrayValue,e)}}class I2 extends pn{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!g_(e)||!e.arrayValue.values)&&e.arrayValue.values.some((n=>Hu(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x2{constructor(t,e=null,n=[],i=[],a=null,l=null,u=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=l,this.endAt=u,this.Te=null}}function PA(s,t=null,e=[],n=[],i=null,a=null,l=null){return new x2(s,t,e,n,i,a,l)}function m_(s){const t=qt(s);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((n=>gy(n))).join(","),e+="|ob:",e+=t.orderBy.map((n=>(function(a){return a.field.canonicalString()+a.dir})(n))).join(","),ip(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((n=>jl(n))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((n=>jl(n))).join(",")),t.Te=e}return t.Te}function y_(s,t){if(s.limit!==t.limit||s.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<s.orderBy.length;e++)if(!b2(s.orderBy[e],t.orderBy[e]))return!1;if(s.filters.length!==t.filters.length)return!1;for(let e=0;e<s.filters.length;e++)if(!US(s.filters[e],t.filters[e]))return!1;return s.collectionGroup===t.collectionGroup&&!!s.path.isEqual(t.path)&&!!kA(s.startAt,t.startAt)&&kA(s.endAt,t.endAt)}function my(s){return Pt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(t,e=null,n=[],i=[],a=null,l="F",u=null,h=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=l,this.startAt=u,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function D2(s,t,e,n,i,a,l,u){return new rp(s,t,e,n,i,a,l,u)}function __(s){return new rp(s)}function OA(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function N2(s){return s.collectionGroup!==null}function Ru(s){const t=qt(s);if(t.Ie===null){t.Ie=[];const e=new Set;for(const a of t.explicitOrderBy)t.Ie.push(a),e.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new gn(kn.comparator);return l.filters.forEach((h=>{h.getFlattenedFilters().forEach((f=>{f.isInequality()&&(u=u.add(f.field))}))})),u})(t).forEach((a=>{e.has(a.canonicalString())||a.isKeyField()||t.Ie.push(new Lf(a,n))})),e.has(kn.keyField().canonicalString())||t.Ie.push(new Lf(kn.keyField(),n))}return t.Ie}function Is(s){const t=qt(s);return t.Ee||(t.Ee=M2(t,Ru(s))),t.Ee}function M2(s,t){if(s.limitType==="F")return PA(s.path,s.collectionGroup,t,s.filters,s.limit,s.startAt,s.endAt);{t=t.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new Lf(i.field,a)}));const e=s.endAt?new Of(s.endAt.position,s.endAt.inclusive):null,n=s.startAt?new Of(s.startAt.position,s.startAt.inclusive):null;return PA(s.path,s.collectionGroup,t,s.filters,s.limit,e,n)}}function yy(s,t,e){return new rp(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),t,e,s.startAt,s.endAt)}function ap(s,t){return y_(Is(s),Is(t))&&s.limitType===t.limitType}function HS(s){return`${m_(Is(s))}|lt:${s.limitType}`}function Al(s){return`Query(target=${(function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map((i=>VS(i))).join(", ")}]`),ip(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map((i=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(i))).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>jl(i))).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>jl(i))).join(",")),`Target(${n})`})(Is(s))}; limitType=${s.limitType})`}function op(s,t){return t.isFoundDocument()&&(function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Pt.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)})(s,t)&&(function(n,i){for(const a of Ru(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(s,t)&&(function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0})(s,t)&&(function(n,i){return!(n.startAt&&!(function(l,u,h){const f=MA(l,u,h);return l.inclusive?f<=0:f<0})(n.startAt,Ru(n),i)||n.endAt&&!(function(l,u,h){const f=MA(l,u,h);return l.inclusive?f>=0:f>0})(n.endAt,Ru(n),i))})(s,t)}function k2(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function zS(s){return(t,e)=>{let n=!1;for(const i of Ru(s)){const a=P2(i,t,e);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function P2(s,t,e){const n=s.field.isKeyField()?Pt.comparator(t.key,e.key):(function(a,l,u){const h=l.data.field(a),f=u.data.field(a);return h!==null&&f!==null?Vl(h,f):Ut(42886)})(s.field,t,e);switch(s.dir){case"asc":return n;case"desc":return-1*n;default:return Ut(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,t))return a}}has(t){return this.get(t)!==void 0}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return this.inner[n]=[[t,e]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],t))return void(i[a]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return n.length===1?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){wo(this.inner,((e,n)=>{for(const[i,a]of n)t(i,a)}))}isEmpty(){return RS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O2=new Be(Pt.comparator);function wr(){return O2}const GS=new Be(Pt.comparator);function mu(...s){let t=GS;for(const e of s)t=t.insert(e.key,e);return t}function qS(s){let t=GS;return s.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function so(){return Iu()}function $S(){return Iu()}function Iu(){return new To((s=>s.toString()),((s,t)=>s.isEqual(t)))}const L2=new Be(Pt.comparator),B2=new gn(Pt.comparator);function te(...s){let t=B2;for(const e of s)t=t.add(e);return t}const F2=new gn(Zt);function U2(){return F2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(s,t){if(s.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mf(t)?"-0":t}}function YS(s){return{integerValue:""+s}}function V2(s,t){return d2(t)?YS(t):v_(s,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(){this._=void 0}}function j2(s,t,e){return s instanceof Bf?(function(i,a){const l={fields:{[DS]:{stringValue:xS},[MS]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&p_(a)&&(a=sp(a)),a&&(l.fields[NS]=a),{mapValue:l}})(e,t):s instanceof zu?KS(s,t):s instanceof Gu?WS(s,t):(function(i,a){const l=XS(i,a),u=LA(l)+LA(i.Ae);return py(l)&&py(i.Ae)?YS(u):v_(i.serializer,u)})(s,t)}function H2(s,t,e){return s instanceof zu?KS(s,t):s instanceof Gu?WS(s,t):e}function XS(s,t){return s instanceof Ff?(function(n){return py(n)||(function(a){return!!a&&"doubleValue"in a})(n)})(t)?t:{integerValue:0}:null}class Bf extends lp{}class zu extends lp{constructor(t){super(),this.elements=t}}function KS(s,t){const e=QS(t);for(const n of s.elements)e.some((i=>Ms(i,n)))||e.push(n);return{arrayValue:{values:e}}}class Gu extends lp{constructor(t){super(),this.elements=t}}function WS(s,t){let e=QS(t);for(const n of s.elements)e=e.filter((i=>!Ms(i,n)));return{arrayValue:{values:e}}}class Ff extends lp{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function LA(s){return Ye(s.integerValue||s.doubleValue)}function QS(s){return g_(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}function z2(s,t){return s.field.isEqual(t.field)&&(function(n,i){return n instanceof zu&&i instanceof zu||n instanceof Gu&&i instanceof Gu?Ul(n.elements,i.elements,Ms):n instanceof Ff&&i instanceof Ff?Ms(n.Ae,i.Ae):n instanceof Bf&&i instanceof Bf})(s.transform,t.transform)}class G2{constructor(t,e){this.version=t,this.transformResults=e}}class _r{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new _r}static exists(t){return new _r(void 0,t)}static updateTime(t){return new _r(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function mf(s,t){return s.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(s.updateTime):s.exists===void 0||s.exists===t.isFoundDocument()}class cp{}function JS(s,t){if(!s.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return s.isNoDocument()?new t1(s.key,_r.none()):new oh(s.key,s.data,_r.none());{const e=s.data,n=Vi.empty();let i=new gn(kn.comparator);for(let a of t.fields)if(!i.has(a)){let l=e.field(a);l===null&&a.length>1&&(a=a.popLast(),l=e.field(a)),l===null?n.delete(a):n.set(a,l),i=i.add(a)}return new So(s.key,n,new Ji(i.toArray()),_r.none())}}function q2(s,t,e){s instanceof oh?(function(i,a,l){const u=i.value.clone(),h=FA(i.fieldTransforms,a,l.transformResults);u.setAll(h),a.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(s,t,e):s instanceof So?(function(i,a,l){if(!mf(i.precondition,a))return void a.convertToUnknownDocument(l.version);const u=FA(i.fieldTransforms,a,l.transformResults),h=a.data;h.setAll(ZS(i)),h.setAll(u),a.convertToFoundDocument(l.version,h).setHasCommittedMutations()})(s,t,e):(function(i,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,t,e)}function xu(s,t,e,n){return s instanceof oh?(function(a,l,u,h){if(!mf(a.precondition,l))return u;const f=a.value.clone(),p=UA(a.fieldTransforms,h,l);return f.setAll(p),l.convertToFoundDocument(l.version,f).setHasLocalMutations(),null})(s,t,e,n):s instanceof So?(function(a,l,u,h){if(!mf(a.precondition,l))return u;const f=UA(a.fieldTransforms,h,l),p=l.data;return p.setAll(ZS(a)),p.setAll(f),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),u===null?null:u.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((y=>y.field)))})(s,t,e,n):(function(a,l,u){return mf(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(s,t,e)}function $2(s,t){let e=null;for(const n of s.fieldTransforms){const i=t.data.field(n.field),a=XS(n.transform,i||null);a!=null&&(e===null&&(e=Vi.empty()),e.set(n.field,a))}return e||null}function BA(s,t){return s.type===t.type&&!!s.key.isEqual(t.key)&&!!s.precondition.isEqual(t.precondition)&&!!(function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Ul(n,i,((a,l)=>z2(a,l)))})(s.fieldTransforms,t.fieldTransforms)&&(s.type===0?s.value.isEqual(t.value):s.type!==1||s.data.isEqual(t.data)&&s.fieldMask.isEqual(t.fieldMask))}class oh extends cp{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class So extends cp{constructor(t,e,n,i,a=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function ZS(s){const t=new Map;return s.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const n=s.data.field(e);t.set(e,n)}})),t}function FA(s,t,e){const n=new Map;pe(s.length===e.length,32656,{Re:e.length,Ve:s.length});for(let i=0;i<e.length;i++){const a=s[i],l=a.transform,u=t.data.field(a.field);n.set(a.field,H2(l,u,e[i]))}return n}function UA(s,t,e){const n=new Map;for(const i of s){const a=i.transform,l=e.data.field(i.field);n.set(i.field,j2(a,l,t))}return n}class t1 extends cp{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Y2 extends cp{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(t.key)&&q2(a,t,n[i])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=xu(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=xu(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=$S();return this.mutations.forEach((i=>{const a=t.get(i.key),l=a.overlayedDocument;let u=this.applyToLocalView(l,a.mutatedFields);u=e.has(i.key)?null:u;const h=JS(l,u);h!==null&&n.set(i.key,h),l.isValidDocument()||l.convertToNoDocument(zt.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),te())}isEqual(t){return this.batchId===t.batchId&&Ul(this.mutations,t.mutations,((e,n)=>BA(e,n)))&&Ul(this.baseMutations,t.baseMutations,((e,n)=>BA(e,n)))}}class b_{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){pe(t.mutations.length===n.length,58842,{me:t.mutations.length,fe:n.length});let i=(function(){return L2})();const a=t.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,n[l].version);return new b_(t,e,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(t,e){this.count=t,this.unchangedNames=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sn,oe;function Q2(s){switch(s){case _t.OK:return Ut(64938);case _t.CANCELLED:case _t.UNKNOWN:case _t.DEADLINE_EXCEEDED:case _t.RESOURCE_EXHAUSTED:case _t.INTERNAL:case _t.UNAVAILABLE:case _t.UNAUTHENTICATED:return!1;case _t.INVALID_ARGUMENT:case _t.NOT_FOUND:case _t.ALREADY_EXISTS:case _t.PERMISSION_DENIED:case _t.FAILED_PRECONDITION:case _t.ABORTED:case _t.OUT_OF_RANGE:case _t.UNIMPLEMENTED:case _t.DATA_LOSS:return!0;default:return Ut(15467,{code:s})}}function e1(s){if(s===void 0)return Ar("GRPC error has no .code"),_t.UNKNOWN;switch(s){case sn.OK:return _t.OK;case sn.CANCELLED:return _t.CANCELLED;case sn.UNKNOWN:return _t.UNKNOWN;case sn.DEADLINE_EXCEEDED:return _t.DEADLINE_EXCEEDED;case sn.RESOURCE_EXHAUSTED:return _t.RESOURCE_EXHAUSTED;case sn.INTERNAL:return _t.INTERNAL;case sn.UNAVAILABLE:return _t.UNAVAILABLE;case sn.UNAUTHENTICATED:return _t.UNAUTHENTICATED;case sn.INVALID_ARGUMENT:return _t.INVALID_ARGUMENT;case sn.NOT_FOUND:return _t.NOT_FOUND;case sn.ALREADY_EXISTS:return _t.ALREADY_EXISTS;case sn.PERMISSION_DENIED:return _t.PERMISSION_DENIED;case sn.FAILED_PRECONDITION:return _t.FAILED_PRECONDITION;case sn.ABORTED:return _t.ABORTED;case sn.OUT_OF_RANGE:return _t.OUT_OF_RANGE;case sn.UNIMPLEMENTED:return _t.UNIMPLEMENTED;case sn.DATA_LOSS:return _t.DATA_LOSS;default:return Ut(39323,{code:s})}}(oe=sn||(sn={}))[oe.OK=0]="OK",oe[oe.CANCELLED=1]="CANCELLED",oe[oe.UNKNOWN=2]="UNKNOWN",oe[oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",oe[oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",oe[oe.NOT_FOUND=5]="NOT_FOUND",oe[oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",oe[oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",oe[oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",oe[oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",oe[oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",oe[oe.ABORTED=10]="ABORTED",oe[oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",oe[oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",oe[oe.INTERNAL=13]="INTERNAL",oe[oe.UNAVAILABLE=14]="UNAVAILABLE",oe[oe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J2(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z2=new da([4294967295,4294967295],0);function VA(s){const t=J2().encode(s),e=new yS;return e.update(t),new Uint8Array(e.digest())}function jA(s){const t=new DataView(s.buffer),e=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new da([e,n],0),new da([i,a],0)]}class E_{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new yu(`Invalid padding: ${e}`);if(n<0)throw new yu(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new yu(`Invalid hash count: ${n}`);if(t.length===0&&e!==0)throw new yu(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=da.fromNumber(this.ge)}ye(t,e,n){let i=t.add(e.multiply(da.fromNumber(n)));return i.compare(Z2)===1&&(i=new da([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=VA(t),[n,i]=jA(e);for(let a=0;a<this.hashCount;a++){const l=this.ye(n,i,a);if(!this.we(l))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,a=new Uint8Array(Math.ceil(t/8)),l=new E_(a,i,e);return n.forEach((u=>l.insert(u))),l}insert(t){if(this.ge===0)return;const e=VA(t),[n,i]=jA(e);for(let a=0;a<this.hashCount;a++){const l=this.ye(n,i,a);this.Se(l)}}Se(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class yu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(t,e,n,i,a){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,lh.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new up(zt.min(),i,new Be(Zt),wr(),te())}}class lh{constructor(t,e,n,i,a){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new lh(n,e,te(),te(),te())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(t,e,n,i){this.be=t,this.removedTargetIds=e,this.key=n,this.De=i}}class n1{constructor(t,e){this.targetId=t,this.Ce=e}}class i1{constructor(t,e,n=On.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class HA{constructor(){this.ve=0,this.Fe=zA(),this.Me=On.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=te(),e=te(),n=te();return this.Fe.forEach(((i,a)=>{switch(a){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:Ut(38017,{changeType:a})}})),new lh(this.Me,this.xe,t,e,n)}qe(){this.Oe=!1,this.Fe=zA()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,pe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class tP{constructor(t){this.Ge=t,this.ze=new Map,this.je=wr(),this.Je=qd(),this.He=qd(),this.Ye=new Be(Zt)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const n=this.nt(e);switch(t.state){case 0:this.rt(e)&&n.Le(t.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(t.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(n.We(),n.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),n.Le(t.resumeToken));break;default:Ut(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((n,i)=>{this.rt(i)&&e(i)}))}st(t){const e=t.targetId,n=t.Ce.count,i=this.ot(e);if(i){const a=i.target;if(my(a))if(n===0){const l=new Pt(a.path);this.et(e,l,jn.newNoDocument(l,zt.min()))}else pe(n===1,20013,{expectedCount:n});else{const l=this._t(e);if(l!==n){const u=this.ut(t),h=u?this.ct(u,t,l):1;if(h!==0){this.it(e);const f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,f)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=e;let l,u;try{l=_a(n).toUint8Array()}catch(h){if(h instanceof IS)return Fl("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new E_(l,i,a)}catch(h){return Fl(h instanceof yu?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.ge===0?null:u}ct(t,e,n){return e.Ce.count===n-this.Pt(t,e.targetId)?0:2}Pt(t,e){const n=this.Ge.getRemoteKeysForTarget(e);let i=0;return n.forEach((a=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;t.mightContain(u)||(this.et(e,a,null),i++)})),i}Tt(t){const e=new Map;this.ze.forEach(((a,l)=>{const u=this.ot(l);if(u){if(a.current&&my(u.target)){const h=new Pt(u.target.path);this.It(h).has(l)||this.Et(l,h)||this.et(l,h,jn.newNoDocument(h,t))}a.Be&&(e.set(l,a.ke()),a.qe())}}));let n=te();this.He.forEach(((a,l)=>{let u=!0;l.forEachWhile((h=>{const f=this.ot(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(a))})),this.je.forEach(((a,l)=>l.setReadTime(t)));const i=new up(t,e,this.Ye,this.je,n);return this.je=wr(),this.Je=qd(),this.He=qd(),this.Ye=new Be(Zt),i}Xe(t,e){if(!this.rt(t))return;const n=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,n),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,n){if(!this.rt(t))return;const i=this.nt(t);this.Et(t,e)?i.Qe(e,1):i.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),n&&(this.je=this.je.insert(e,n))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new HA,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new gn(Zt),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new gn(Zt),this.Je=this.Je.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||At("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new HA),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function qd(){return new Be(Pt.comparator)}function zA(){return new Be(Pt.comparator)}const eP={asc:"ASCENDING",desc:"DESCENDING"},nP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iP={and:"AND",or:"OR"};class sP{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function _y(s,t){return s.useProto3Json||ip(t)?t:{value:t}}function Uf(s,t){return s.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function s1(s,t){return s.useProto3Json?t.toBase64():t.toUint8Array()}function rP(s,t){return Uf(s,t.toTimestamp())}function xs(s){return pe(!!s,49232),zt.fromTimestamp((function(e){const n=ya(e);return new Se(n.seconds,n.nanos)})(s))}function A_(s,t){return vy(s,t).canonicalString()}function vy(s,t){const e=(function(i){return new Le(["projects",i.projectId,"databases",i.database])})(s).child("documents");return t===void 0?e:e.child(t)}function r1(s){const t=Le.fromString(s);return pe(u1(t),10190,{key:t.toString()}),t}function by(s,t){return A_(s.databaseId,t.path)}function Fm(s,t){const e=r1(t);if(e.get(1)!==s.databaseId.projectId)throw new Rt(_t.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+s.databaseId.projectId);if(e.get(3)!==s.databaseId.database)throw new Rt(_t.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+s.databaseId.database);return new Pt(o1(e))}function a1(s,t){return A_(s.databaseId,t)}function aP(s){const t=r1(s);return t.length===4?Le.emptyPath():o1(t)}function Ey(s){return new Le(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function o1(s){return pe(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function GA(s,t,e){return{name:by(s,t),fields:e.value.mapValue.fields}}function oP(s,t){let e;if("targetChange"in t){t.targetChange;const n=(function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:Ut(39313,{state:f})})(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=(function(f,p){return f.useProto3Json?(pe(p===void 0||typeof p=="string",58123),On.fromBase64String(p||"")):(pe(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),On.fromUint8Array(p||new Uint8Array))})(s,t.targetChange.resumeToken),l=t.targetChange.cause,u=l&&(function(f){const p=f.code===void 0?_t.UNKNOWN:e1(f.code);return new Rt(p,f.message||"")})(l);e=new i1(n,i,a,u||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const i=Fm(s,n.document.name),a=xs(n.document.updateTime),l=n.document.createTime?xs(n.document.createTime):zt.min(),u=new Vi({mapValue:{fields:n.document.fields}}),h=jn.newFoundDocument(i,a,l,u),f=n.targetIds||[],p=n.removedTargetIds||[];e=new yf(f,p,h.key,h)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const i=Fm(s,n.document),a=n.readTime?xs(n.readTime):zt.min(),l=jn.newNoDocument(i,a),u=n.removedTargetIds||[];e=new yf([],u,l.key,l)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const i=Fm(s,n.document),a=n.removedTargetIds||[];e=new yf([],a,i,null)}else{if(!("filter"in t))return Ut(11601,{Rt:t});{t.filter;const n=t.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,l=new W2(i,a),u=n.targetId;e=new n1(u,l)}}return e}function lP(s,t){let e;if(t instanceof oh)e={update:GA(s,t.key,t.value)};else if(t instanceof t1)e={delete:by(s,t.key)};else if(t instanceof So)e={update:GA(s,t.key,t.data),updateMask:yP(t.fieldMask)};else{if(!(t instanceof Y2))return Ut(16599,{Vt:t.type});e={verify:by(s,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((n=>(function(a,l){const u=l.transform;if(u instanceof Bf)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof zu)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Gu)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Ff)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw Ut(20930,{transform:l.transform})})(0,n)))),t.precondition.isNone||(e.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:rP(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ut(27497)})(s,t.precondition)),e}function cP(s,t){return s&&s.length>0?(pe(t!==void 0,14353),s.map((e=>(function(i,a){let l=i.updateTime?xs(i.updateTime):xs(a);return l.isEqual(zt.min())&&(l=xs(a)),new G2(l,i.transformResults||[])})(e,t)))):[]}function uP(s,t){return{documents:[a1(s,t.path)]}}function hP(s,t){const e={structuredQuery:{}},n=t.path;let i;t.collectionGroup!==null?(i=n,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=n.popLast(),e.structuredQuery.from=[{collectionId:n.lastSegment()}]),e.parent=a1(s,i);const a=(function(f){if(f.length!==0)return c1(ks.create(f,"and"))})(t.filters);a&&(e.structuredQuery.where=a);const l=(function(f){if(f.length!==0)return f.map((p=>(function(v){return{field:wl(v.field),direction:pP(v.dir)}})(p)))})(t.orderBy);l&&(e.structuredQuery.orderBy=l);const u=_y(s,t.limit);return u!==null&&(e.structuredQuery.limit=u),t.startAt&&(e.structuredQuery.startAt=(function(f){return{before:f.inclusive,values:f.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(f){return{before:!f.inclusive,values:f.position}})(t.endAt)),{ft:e,parent:i}}function dP(s){let t=aP(s.parent);const e=s.structuredQuery,n=e.from?e.from.length:0;let i=null;if(n>0){pe(n===1,65062);const p=e.from[0];p.allDescendants?i=p.collectionId:t=t.child(p.collectionId)}let a=[];e.where&&(a=(function(y){const v=l1(y);return v instanceof ks&&FS(v)?v.getFilters():[v]})(e.where));let l=[];e.orderBy&&(l=(function(y){return y.map((v=>(function(T){return new Lf(Tl(T.field),(function(I){switch(I){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(T.direction))})(v)))})(e.orderBy));let u=null;e.limit&&(u=(function(y){let v;return v=typeof y=="object"?y.value:y,ip(v)?null:v})(e.limit));let h=null;e.startAt&&(h=(function(y){const v=!!y.before,b=y.values||[];return new Of(b,v)})(e.startAt));let f=null;return e.endAt&&(f=(function(y){const v=!y.before,b=y.values||[];return new Of(b,v)})(e.endAt)),D2(t,i,l,a,u,"F",h,f)}function fP(s,t){const e=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ut(28987,{purpose:i})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function l1(s){return s.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=Tl(e.unaryFilter.field);return pn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Tl(e.unaryFilter.field);return pn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Tl(e.unaryFilter.field);return pn.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Tl(e.unaryFilter.field);return pn.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ut(61313);default:return Ut(60726)}})(s):s.fieldFilter!==void 0?(function(e){return pn.create(Tl(e.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ut(58110);default:return Ut(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(e){return ks.create(e.compositeFilter.filters.map((n=>l1(n))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ut(1026)}})(e.compositeFilter.op))})(s):Ut(30097,{filter:s})}function pP(s){return eP[s]}function gP(s){return nP[s]}function mP(s){return iP[s]}function wl(s){return{fieldPath:s.canonicalString()}}function Tl(s){return kn.fromServerFormat(s.fieldPath)}function c1(s){return s instanceof pn?(function(e){if(e.op==="=="){if(NA(e.value))return{unaryFilter:{field:wl(e.field),op:"IS_NAN"}};if(DA(e.value))return{unaryFilter:{field:wl(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(NA(e.value))return{unaryFilter:{field:wl(e.field),op:"IS_NOT_NAN"}};if(DA(e.value))return{unaryFilter:{field:wl(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wl(e.field),op:gP(e.op),value:e.value}}})(s):s instanceof ks?(function(e){const n=e.getFilters().map((i=>c1(i)));return n.length===1?n[0]:{compositeFilter:{op:mP(e.op),filters:n}}})(s):Ut(54877,{filter:s})}function yP(s){const t=[];return s.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function u1(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(t,e,n,i,a=zt.min(),l=zt.min(),u=On.EMPTY_BYTE_STRING,h=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(t){return new ca(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new ca(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ca(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ca(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(t){this.yt=t}}function vP(s){const t=dP({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?yy(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(){this.Cn=new EP}addToCollectionParentIndex(t,e){return this.Cn.add(e),gt.resolve()}getCollectionParents(t,e){return gt.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return gt.resolve()}deleteFieldIndex(t,e){return gt.resolve()}deleteAllFieldIndexes(t){return gt.resolve()}createTargetIndexes(t,e){return gt.resolve()}getDocumentsMatchingTarget(t,e){return gt.resolve(null)}getIndexType(t,e){return gt.resolve(0)}getFieldIndexes(t,e){return gt.resolve([])}getNextCollectionGroupToUpdate(t){return gt.resolve(null)}getMinOffset(t,e){return gt.resolve(ma.min())}getMinOffsetFromCollectionGroup(t,e){return gt.resolve(ma.min())}updateCollectionGroup(t,e,n){return gt.resolve()}updateIndexEntries(t,e){return gt.resolve()}}class EP{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new gn(Le.comparator),a=!i.has(n);return this.index[e]=i.add(n),a}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new gn(Le.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qA={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},h1=41943040;class oi{static withCacheSize(t){return new oi(t,oi.DEFAULT_COLLECTION_PERCENTILE,oi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */oi.DEFAULT_COLLECTION_PERCENTILE=10,oi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oi.DEFAULT=new oi(h1,oi.DEFAULT_COLLECTION_PERCENTILE,oi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oi.DISABLED=new oi(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new Hl(0)}static cr(){return new Hl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A="LruGarbageCollector",AP=1048576;function YA([s,t],[e,n]){const i=Zt(s,e);return i===0?Zt(t,n):i}class wP{constructor(t){this.Ir=t,this.buffer=new gn(YA),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const n=this.buffer.last();YA(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}}get maxValue(){return this.buffer.last()[0]}}class TP{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){At($A,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Jl(e)?At($A,"Ignoring IndexedDB error during garbage collection: ",e):await Ql(e)}await this.Vr(3e5)}))}}class SP{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next((n=>Math.floor(e/100*n)))}nthSequenceNumber(t,e){if(e===0)return gt.resolve(np.ce);const n=new wP(e);return this.mr.forEachTarget(t,(i=>n.Ar(i.sequenceNumber))).next((()=>this.mr.pr(t,(i=>n.Ar(i))))).next((()=>n.maxValue))}removeTargets(t,e,n){return this.mr.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(At("LruGarbageCollector","Garbage collection skipped; disabled"),gt.resolve(qA)):this.getCacheSize(t).next((n=>n<this.params.cacheSizeCollectionThreshold?(At("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),qA):this.yr(t,e)))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let n,i,a,l,u,h,f;const p=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((y=>(y>this.params.maximumSequenceNumbersToCollect?(At("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,l=Date.now(),this.nthSequenceNumber(t,i)))).next((y=>(n=y,u=Date.now(),this.removeTargets(t,n,e)))).next((y=>(a=y,h=Date.now(),this.removeOrphanedDocuments(t,n)))).next((y=>(f=Date.now(),El()<=Jt.DEBUG&&At("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-p}ms
	Determined least recently used ${i} in `+(u-l)+`ms
	Removed ${a} targets in `+(h-u)+`ms
	Removed ${y} documents in `+(f-h)+`ms
Total Duration: ${f-p}ms`),gt.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:y}))))}}function CP(s,t){return new SP(s,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(){this.changes=new To((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,jn.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return n!==void 0?gt.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((i=>(n!==null&&xu(n.mutation,i,Ji.empty(),Se.now()),i)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((n=>this.getLocalViewOfDocuments(t,n,te()).next((()=>n))))}getLocalViewOfDocuments(t,e,n=te()){const i=so();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((a=>{let l=mu();return a.forEach(((u,h)=>{l=l.insert(u,h.overlayedDocument)})),l}))))}getOverlayedDocuments(t,e){const n=so();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,te())))}populateOverlays(t,e,n){const i=[];return n.forEach((a=>{e.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(t,i).next((a=>{a.forEach(((l,u)=>{e.set(l,u)}))}))}computeViews(t,e,n,i){let a=wr();const l=Iu(),u=(function(){return Iu()})();return e.forEach(((h,f)=>{const p=n.get(f.key);i.has(f.key)&&(p===void 0||p.mutation instanceof So)?a=a.insert(f.key,f):p!==void 0?(l.set(f.key,p.mutation.getFieldMask()),xu(p.mutation,f,p.mutation.getFieldMask(),Se.now())):l.set(f.key,Ji.empty())})),this.recalculateAndSaveOverlays(t,a).next((h=>(h.forEach(((f,p)=>l.set(f,p))),e.forEach(((f,p)=>u.set(f,new IP(p,l.get(f)??null)))),u)))}recalculateAndSaveOverlays(t,e){const n=Iu();let i=new Be(((l,u)=>l-u)),a=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((l=>{for(const u of l)u.keys().forEach((h=>{const f=e.get(h);if(f===null)return;let p=n.get(h)||Ji.empty();p=u.applyToLocalView(f,p),n.set(h,p);const y=(i.get(u.batchId)||te()).add(h);i=i.insert(u.batchId,y)}))})).next((()=>{const l=[],u=i.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),f=h.key,p=h.value,y=$S();p.forEach((v=>{if(!a.has(v)){const b=JS(e.get(v),n.get(v));b!==null&&y.set(v,b),a=a.add(v)}})),l.push(this.documentOverlayCache.saveOverlays(t,f,y))}return gt.waitFor(l)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((n=>this.recalculateAndSaveOverlays(t,n)))}getDocumentsMatchingQuery(t,e,n,i){return(function(l){return Pt.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):N2(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-a.size):gt.resolve(so());let u=Uu,h=a;return l.next((f=>gt.forEach(f,((p,y)=>(u<y.largestBatchId&&(u=y.largestBatchId),a.get(p)?gt.resolve():this.remoteDocumentCache.getEntry(t,p).next((v=>{h=h.insert(p,v)}))))).next((()=>this.populateOverlays(t,f,a))).next((()=>this.computeViews(t,h,f,te()))).next((p=>({batchId:u,changes:qS(p)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Pt(e)).next((n=>{let i=mu();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const a=e.collectionGroup;let l=mu();return this.indexManager.getCollectionParents(t,a).next((u=>gt.forEach(u,(h=>{const f=(function(y,v){return new rp(v,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)})(e,h.child(a));return this.getDocumentsMatchingCollectionQuery(t,f,n,i).next((p=>{p.forEach(((y,v)=>{l=l.insert(y,v)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(t,e,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,a,i)))).next((l=>{a.forEach(((h,f)=>{const p=f.getKey();l.get(p)===null&&(l=l.insert(p,jn.newInvalidDocument(p)))}));let u=mu();return l.forEach(((h,f)=>{const p=a.get(h);p!==void 0&&xu(p.mutation,f,Ji.empty(),Se.now()),op(e,f)&&(u=u.insert(h,f))})),u}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return gt.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,(function(i){return{id:i.id,version:i.version,createTime:xs(i.createTime)}})(e)),gt.resolve()}getNamedQuery(t,e){return gt.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,(function(i){return{name:i.name,query:vP(i.bundledQuery),readTime:xs(i.readTime)}})(e)),gt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(){this.overlays=new Be(Pt.comparator),this.qr=new Map}getOverlay(t,e){return gt.resolve(this.overlays.get(e))}getOverlays(t,e){const n=so();return gt.forEach(e,(i=>this.getOverlay(t,i).next((a=>{a!==null&&n.set(i,a)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((i,a)=>{this.St(t,e,a)})),gt.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(n)),gt.resolve()}getOverlaysForCollection(t,e,n){const i=so(),a=e.length+1,l=new Pt(e.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const h=u.getNext().value,f=h.getKey();if(!e.isPrefixOf(f.path))break;f.path.length===a&&h.largestBatchId>n&&i.set(h.getKey(),h)}return gt.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let a=new Be(((f,p)=>f-p));const l=this.overlays.getIterator();for(;l.hasNext();){const f=l.getNext().value;if(f.getKey().getCollectionGroup()===e&&f.largestBatchId>n){let p=a.get(f.largestBatchId);p===null&&(p=so(),a=a.insert(f.largestBatchId,p)),p.set(f.getKey(),f)}}const u=so(),h=a.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((f,p)=>u.set(f,p))),!(u.size()>=i)););return gt.resolve(u)}St(t,e,n){const i=this.overlays.get(n.key);if(i!==null){const l=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new K2(e,n));let a=this.qr.get(e);a===void 0&&(a=te(),this.qr.set(e,a)),this.qr.set(e,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(){this.sessionToken=On.EMPTY_BYTE_STRING}getSessionToken(t){return gt.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,gt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(){this.Qr=new gn(An.$r),this.Ur=new gn(An.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const n=new An(t,e);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(t,e){t.forEach((n=>this.addReference(n,e)))}removeReference(t,e){this.Gr(new An(t,e))}zr(t,e){t.forEach((n=>this.removeReference(n,e)))}jr(t){const e=new Pt(new Le([])),n=new An(e,t),i=new An(e,t+1),a=[];return this.Ur.forEachInRange([n,i],(l=>{this.Gr(l),a.push(l.key)})),a}Jr(){this.Qr.forEach((t=>this.Gr(t)))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new Pt(new Le([])),n=new An(e,t),i=new An(e,t+1);let a=te();return this.Ur.forEachInRange([n,i],(l=>{a=a.add(l.key)})),a}containsKey(t){const e=new An(t,0),n=this.Qr.firstAfterOrEqual(e);return n!==null&&t.isEqual(n.key)}}class An{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return Pt.comparator(t.key,e.key)||Zt(t.Yr,e.Yr)}static Kr(t,e){return Zt(t.Yr,e.Yr)||Pt.comparator(t.key,e.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new gn(An.$r)}checkEmpty(t){return gt.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,n,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new X2(a,e,n,i);this.mutationQueue.push(l);for(const u of i)this.Zr=this.Zr.add(new An(u.key,a)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast());return gt.resolve(l)}lookupMutationBatch(t,e){return gt.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.ei(n),a=i<0?0:i;return gt.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return gt.resolve(this.mutationQueue.length===0?f_:this.tr-1)}getAllMutationBatches(t){return gt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new An(e,0),i=new An(e,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,i],(l=>{const u=this.Xr(l.Yr);a.push(u)})),gt.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new gn(Zt);return e.forEach((i=>{const a=new An(i,0),l=new An(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,l],(u=>{n=n.add(u.Yr)}))})),gt.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let a=n;Pt.isDocumentKey(a)||(a=a.child(""));const l=new An(new Pt(a),0);let u=new gn(Zt);return this.Zr.forEachWhile((h=>{const f=h.key.path;return!!n.isPrefixOf(f)&&(f.length===i&&(u=u.add(h.Yr)),!0)}),l),gt.resolve(this.ti(u))}ti(t){const e=[];return t.forEach((n=>{const i=this.Xr(n);i!==null&&e.push(i)})),e}removeMutationBatch(t,e){pe(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return gt.forEach(e.mutations,(i=>{const a=new An(i.key,e.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.Zr=n}))}ir(t){}containsKey(t,e){const n=new An(e,0),i=this.Zr.firstAfterOrEqual(n);return gt.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,gt.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(t){this.ri=t,this.docs=(function(){return new Be(Pt.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),a=i?i.size:0,l=this.ri(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return gt.resolve(n?n.document.mutableCopy():jn.newInvalidDocument(e))}getEntries(t,e){let n=wr();return e.forEach((i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():jn.newInvalidDocument(i))})),gt.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let a=wr();const l=e.path,u=new Pt(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:f,value:{document:p}}=h.getNext();if(!l.isPrefixOf(f.path))break;f.path.length>l.length+1||l2(o2(p),n)<=0||(i.has(p.key)||op(e,p))&&(a=a.insert(p.key,p.mutableCopy()))}return gt.resolve(a)}getAllFromCollectionGroup(t,e,n,i){Ut(9500)}ii(t,e){return gt.forEach(this.docs,(n=>e(n)))}newChangeBuffer(t){return new OP(this)}getSize(t){return gt.resolve(this.size)}}class OP extends RP{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.Nr.addEntry(t,i)):this.Nr.removeEntry(n)})),gt.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(t){this.persistence=t,this.si=new To((e=>m_(e)),y_),this.lastRemoteSnapshotVersion=zt.min(),this.highestTargetId=0,this.oi=0,this._i=new w_,this.targetCount=0,this.ai=Hl.ur()}forEachTarget(t,e){return this.si.forEach(((n,i)=>e(i))),gt.resolve()}getLastRemoteSnapshotVersion(t){return gt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return gt.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),gt.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.oi&&(this.oi=e),gt.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new Hl(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,gt.resolve()}updateTargetData(t,e){return this.Pr(e),gt.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,gt.resolve()}removeTargets(t,e,n){let i=0;const a=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=e&&n.get(u.targetId)===null&&(this.si.delete(l),a.push(this.removeMatchingKeysForTargetId(t,u.targetId)),i++)})),gt.waitFor(a).next((()=>i))}getTargetCount(t){return gt.resolve(this.targetCount)}getTargetData(t,e){const n=this.si.get(e)||null;return gt.resolve(n)}addMatchingKeys(t,e,n){return this._i.Wr(e,n),gt.resolve()}removeMatchingKeys(t,e,n){this._i.zr(e,n);const i=this.persistence.referenceDelegate,a=[];return i&&e.forEach((l=>{a.push(i.markPotentiallyOrphaned(t,l))})),gt.waitFor(a)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),gt.resolve()}getMatchingKeysForTargetId(t,e){const n=this._i.Hr(e);return gt.resolve(n)}containsKey(t,e){return gt.resolve(this._i.containsKey(e))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(t,e){this.ui={},this.overlays={},this.ci=new np(0),this.li=!1,this.li=!0,this.hi=new MP,this.referenceDelegate=t(this),this.Pi=new LP(this),this.indexManager=new bP,this.remoteDocumentCache=(function(i){return new PP(i)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new _P(e),this.Ii=new DP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new NP,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.ui[t.toKey()];return n||(n=new kP(e,this.referenceDelegate),this.ui[t.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,n){At("MemoryPersistence","Starting transaction:",t);const i=new BP(this.ci.next());return this.referenceDelegate.Ei(),n(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(t,e){return gt.or(Object.values(this.ui).map((n=>()=>n.containsKey(t,e))))}}class BP extends u2{constructor(t){super(),this.currentSequenceNumber=t}}class T_{constructor(t){this.persistence=t,this.Ri=new w_,this.Vi=null}static mi(t){return new T_(t)}get fi(){if(this.Vi)return this.Vi;throw Ut(60996)}addReference(t,e,n){return this.Ri.addReference(n,e),this.fi.delete(n.toString()),gt.resolve()}removeReference(t,e,n){return this.Ri.removeReference(n,e),this.fi.add(n.toString()),gt.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),gt.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach((i=>this.fi.add(i.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>n.removeTargetData(t,e)))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return gt.forEach(this.fi,(n=>{const i=Pt.fromPath(n);return this.gi(t,i).next((a=>{a||e.removeEntry(i,zt.min())}))})).next((()=>(this.Vi=null,e.apply(t))))}updateLimboDocument(t,e){return this.gi(t,e).next((n=>{n?this.fi.delete(e.toString()):this.fi.add(e.toString())}))}Ti(t){return 0}gi(t,e){return gt.or([()=>gt.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class Vf{constructor(t,e){this.persistence=t,this.pi=new To((n=>f2(n.path)),((n,i)=>n.isEqual(i))),this.garbageCollector=CP(this,e)}static mi(t,e){return new Vf(t,e)}Ei(){}di(t){return gt.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next((n=>e.next((i=>n+i))))}wr(t){let e=0;return this.pr(t,(n=>{e++})).next((()=>e))}pr(t,e){return gt.forEach(this.pi,((n,i)=>this.br(t,n,i).next((a=>a?gt.resolve():e(i)))))}removeTargets(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)}removeOrphanedDocuments(t,e){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(t,(l=>this.br(t,l,e).next((u=>{u||(n++,a.removeEntry(l,zt.min()))})))).next((()=>a.apply(t))).next((()=>n))}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),gt.resolve()}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,e,n){return this.pi.set(n,t.currentSequenceNumber),gt.resolve()}removeReference(t,e,n){return this.pi.set(n,t.currentSequenceNumber),gt.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),gt.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=pf(t.data.value)),e}br(t,e,n){return gt.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const i=this.pi.get(e);return gt.resolve(i!==void 0&&i>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Es=n,this.ds=i}static As(t,e){let n=te(),i=te();for(const a of e.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new S_(t,e.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return hD()?8:h2(zn())>0?6:4})()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,n,i){const a={result:null};return this.ys(t,e).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ws(t,e,i,n).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new FP;return this.Ss(t,e,l).next((u=>{if(a.result=u,this.Vs)return this.bs(t,e,l,u.size)}))})).next((()=>a.result))}bs(t,e,n,i){return n.documentReadCount<this.fs?(El()<=Jt.DEBUG&&At("QueryEngine","SDK will not create cache indexes for query:",Al(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),gt.resolve()):(El()<=Jt.DEBUG&&At("QueryEngine","Query:",Al(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(El()<=Jt.DEBUG&&At("QueryEngine","The SDK decides to create cache indexes for query:",Al(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Is(e))):gt.resolve())}ys(t,e){if(OA(e))return gt.resolve(null);let n=Is(e);return this.indexManager.getIndexType(t,n).next((i=>i===0?null:(e.limit!==null&&i===1&&(e=yy(e,null,"F"),n=Is(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((a=>{const l=te(...a);return this.ps.getDocuments(t,l).next((u=>this.indexManager.getMinOffset(t,n).next((h=>{const f=this.Ds(e,u);return this.Cs(e,f,l,h.readTime)?this.ys(t,yy(e,null,"F")):this.vs(t,f,e,h)}))))})))))}ws(t,e,n,i){return OA(e)||i.isEqual(zt.min())?gt.resolve(null):this.ps.getDocuments(t,n).next((a=>{const l=this.Ds(e,a);return this.Cs(e,l,n,i)?gt.resolve(null):(El()<=Jt.DEBUG&&At("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Al(e)),this.vs(t,l,e,a2(i,Uu)).next((u=>u)))}))}Ds(t,e){let n=new gn(zS(t));return e.forEach(((i,a)=>{op(t,a)&&(n=n.add(a))})),n}Cs(t,e,n,i){if(t.limit===null)return!1;if(n.size!==e.size)return!0;const a=t.limitType==="F"?e.last():e.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(t,e,n){return El()<=Jt.DEBUG&&At("QueryEngine","Using full collection scan to execute query:",Al(e)),this.ps.getDocumentsMatchingQuery(t,e,ma.min(),n)}vs(t,e,n,i){return this.ps.getDocumentsMatchingQuery(t,n,i).next((a=>(e.forEach((l=>{a=a.insert(l.key,l)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_="LocalStore",VP=3e8;class jP{constructor(t,e,n,i){this.persistence=t,this.Fs=e,this.serializer=i,this.Ms=new Be(Zt),this.xs=new To((a=>m_(a)),y_),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(n)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new xP(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ms)))}}function HP(s,t,e,n){return new jP(s,t,e,n)}async function f1(s,t){const e=qt(s);return await e.persistence.runTransaction("Handle user change","readonly",(n=>{let i;return e.mutationQueue.getAllMutationBatches(n).next((a=>(i=a,e.Bs(t),e.mutationQueue.getAllMutationBatches(n)))).next((a=>{const l=[],u=[];let h=te();for(const f of i){l.push(f.batchId);for(const p of f.mutations)h=h.add(p.key)}for(const f of a){u.push(f.batchId);for(const p of f.mutations)h=h.add(p.key)}return e.localDocuments.getDocuments(n,h).next((f=>({Ls:f,removedBatchIds:l,addedBatchIds:u})))}))}))}function zP(s,t){const e=qt(s);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const i=t.batch.keys(),a=e.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,h,f,p){const y=f.batch,v=y.keys();let b=gt.resolve();return v.forEach((T=>{b=b.next((()=>p.getEntry(h,T))).next((S=>{const I=f.docVersions.get(T);pe(I!==null,48541),S.version.compareTo(I)<0&&(y.applyToRemoteDocument(S,f),S.isValidDocument()&&(S.setReadTime(f.commitVersion),p.addEntry(S)))}))})),b.next((()=>u.mutationQueue.removeMutationBatch(h,y)))})(e,n,t,a).next((()=>a.apply(n))).next((()=>e.mutationQueue.performConsistencyCheck(n))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(n,i,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let h=te();for(let f=0;f<u.mutationResults.length;++f)u.mutationResults[f].transformResults.length>0&&(h=h.add(u.batch.mutations[f].key));return h})(t)))).next((()=>e.localDocuments.getDocuments(n,i)))}))}function p1(s){const t=qt(s);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function GP(s,t){const e=qt(s),n=t.snapshotVersion;let i=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=e.Ns.newChangeBuffer({trackRemovals:!0});i=e.Ms;const u=[];t.targetChanges.forEach(((p,y)=>{const v=i.get(y);if(!v)return;u.push(e.Pi.removeMatchingKeys(a,p.removedDocuments,y).next((()=>e.Pi.addMatchingKeys(a,p.addedDocuments,y))));let b=v.withSequenceNumber(a.currentSequenceNumber);t.targetMismatches.get(y)!==null?b=b.withResumeToken(On.EMPTY_BYTE_STRING,zt.min()).withLastLimboFreeSnapshotVersion(zt.min()):p.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(p.resumeToken,n)),i=i.insert(y,b),(function(S,I,x){return S.resumeToken.approximateByteSize()===0||I.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=VP?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0})(v,b,p)&&u.push(e.Pi.updateTargetData(a,b))}));let h=wr(),f=te();if(t.documentUpdates.forEach((p=>{t.resolvedLimboDocuments.has(p)&&u.push(e.persistence.referenceDelegate.updateLimboDocument(a,p))})),u.push(qP(a,l,t.documentUpdates).next((p=>{h=p.ks,f=p.qs}))),!n.isEqual(zt.min())){const p=e.Pi.getLastRemoteSnapshotVersion(a).next((y=>e.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n)));u.push(p)}return gt.waitFor(u).next((()=>l.apply(a))).next((()=>e.localDocuments.getLocalViewOfDocuments(a,h,f))).next((()=>h))})).then((a=>(e.Ms=i,a)))}function qP(s,t,e){let n=te(),i=te();return e.forEach((a=>n=n.add(a))),t.getEntries(s,n).next((a=>{let l=wr();return e.forEach(((u,h)=>{const f=a.get(u);h.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(zt.min())?(t.removeEntry(u,h.readTime),l=l.insert(u,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(t.addEntry(h),l=l.insert(u,h)):At(C_,"Ignoring outdated watch update for ",u,". Current version:",f.version," Watch version:",h.version)})),{ks:l,qs:i}}))}function $P(s,t){const e=qt(s);return e.persistence.runTransaction("Get next mutation batch","readonly",(n=>(t===void 0&&(t=f_),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t))))}function YP(s,t){const e=qt(s);return e.persistence.runTransaction("Allocate target","readwrite",(n=>{let i;return e.Pi.getTargetData(n,t).next((a=>a?(i=a,gt.resolve(i)):e.Pi.allocateTargetId(n).next((l=>(i=new ca(t,l,"TargetPurposeListen",n.currentSequenceNumber),e.Pi.addTargetData(n,i).next((()=>i)))))))})).then((n=>{const i=e.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(n.targetId,n),e.xs.set(t,n.targetId)),n}))}async function Ay(s,t,e){const n=qt(s),i=n.Ms.get(t),a=e?"readwrite":"readwrite-primary";try{e||await n.persistence.runTransaction("Release target",a,(l=>n.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!Jl(l))throw l;At(C_,`Failed to update sequence numbers for target ${t}: ${l}`)}n.Ms=n.Ms.remove(t),n.xs.delete(i.target)}function XA(s,t,e){const n=qt(s);let i=zt.min(),a=te();return n.persistence.runTransaction("Execute query","readwrite",(l=>(function(h,f,p){const y=qt(h),v=y.xs.get(p);return v!==void 0?gt.resolve(y.Ms.get(v)):y.Pi.getTargetData(f,p)})(n,l,Is(t)).next((u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(l,u.targetId).next((h=>{a=h}))})).next((()=>n.Fs.getDocumentsMatchingQuery(l,t,e?i:zt.min(),e?a:te()))).next((u=>(XP(n,k2(t),u),{documents:u,Qs:a})))))}function XP(s,t,e){let n=s.Os.get(t)||zt.min();e.forEach(((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)})),s.Os.set(t,n)}class KA{constructor(){this.activeTargetIds=U2()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class KP{constructor(){this.Mo=new KA,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,n){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new KA,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{Oo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WA="ConnectivityMonitor";class QA{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){At(WA,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){At(WA,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $d=null;function wy(){return $d===null?$d=(function(){return 268435456+Math.round(2147483648*Math.random())})():$d++,"0x"+$d.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um="RestConnection",QP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class JP{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===kf?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(t,e,n,i,a){const l=wy(),u=this.zo(t,e.toUriEncodedString());At(Um,`Sending RPC '${t}' ${l}:`,u,n);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,i,a);const{host:f}=new URL(u),p=Ta(f);return this.Jo(t,u,h,n,p).then((y=>(At(Um,`Received RPC '${t}' ${l}: `,y),y)),(y=>{throw Fl(Um,`RPC '${t}' ${l} failed with error: `,y,"url: ",u,"request:",n),y}))}Ho(t,e,n,i,a,l){return this.Go(t,e,n,i,a)}jo(t,e,n){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Wl})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((i,a)=>t[a]=i)),n&&n.headers.forEach(((i,a)=>t[a]=i))}zo(t,e){const n=QP[t];return`${this.Uo}/v1/${e}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Un="WebChannelConnection";class tO extends JP{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,n,i,a){const l=wy();return new Promise(((u,h)=>{const f=new _S;f.setWithCredentials(!0),f.listenOnce(vS.COMPLETE,(()=>{try{switch(f.getLastErrorCode()){case ff.NO_ERROR:const y=f.getResponseJson();At(Un,`XHR for RPC '${t}' ${l} received:`,JSON.stringify(y)),u(y);break;case ff.TIMEOUT:At(Un,`RPC '${t}' ${l} timed out`),h(new Rt(_t.DEADLINE_EXCEEDED,"Request time out"));break;case ff.HTTP_ERROR:const v=f.getStatus();if(At(Un,`RPC '${t}' ${l} failed with status:`,v,"response text:",f.getResponseText()),v>0){let b=f.getResponseJson();Array.isArray(b)&&(b=b[0]);const T=b?.error;if(T&&T.status&&T.message){const S=(function(x){const k=x.toLowerCase().replace(/_/g,"-");return Object.values(_t).indexOf(k)>=0?k:_t.UNKNOWN})(T.status);h(new Rt(S,T.message))}else h(new Rt(_t.UNKNOWN,"Server responded with status "+f.getStatus()))}else h(new Rt(_t.UNAVAILABLE,"Connection failed."));break;default:Ut(9055,{l_:t,streamId:l,h_:f.getLastErrorCode(),P_:f.getLastError()})}}finally{At(Un,`RPC '${t}' ${l} completed.`)}}));const p=JSON.stringify(i);At(Un,`RPC '${t}' ${l} sending request:`,i),f.send(e,"POST",p,n,15)}))}T_(t,e,n){const i=wy(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],l=AS(),u=ES(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,e,n),h.encodeInitMessageHeaders=!0;const p=a.join("");At(Un,`Creating RPC '${t}' stream ${i}: ${p}`,h);const y=l.createWebChannel(p,h);this.I_(y);let v=!1,b=!1;const T=new ZP({Yo:I=>{b?At(Un,`Not sending because RPC '${t}' stream ${i} is closed:`,I):(v||(At(Un,`Opening RPC '${t}' stream ${i} transport.`),y.open(),v=!0),At(Un,`RPC '${t}' stream ${i} sending:`,I),y.send(I))},Zo:()=>y.close()}),S=(I,x,k)=>{I.listen(x,(O=>{try{k(O)}catch(G){setTimeout((()=>{throw G}),0)}}))};return S(y,gu.EventType.OPEN,(()=>{b||(At(Un,`RPC '${t}' stream ${i} transport opened.`),T.o_())})),S(y,gu.EventType.CLOSE,(()=>{b||(b=!0,At(Un,`RPC '${t}' stream ${i} transport closed`),T.a_(),this.E_(y))})),S(y,gu.EventType.ERROR,(I=>{b||(b=!0,Fl(Un,`RPC '${t}' stream ${i} transport errored. Name:`,I.name,"Message:",I.message),T.a_(new Rt(_t.UNAVAILABLE,"The operation could not be completed")))})),S(y,gu.EventType.MESSAGE,(I=>{if(!b){const x=I.data[0];pe(!!x,16349);const k=x,O=k?.error||k[0]?.error;if(O){At(Un,`RPC '${t}' stream ${i} received error:`,O);const G=O.status;let H=(function(N){const B=sn[N];if(B!==void 0)return e1(B)})(G),K=O.message;H===void 0&&(H=_t.INTERNAL,K="Unknown error status: "+G+" with message "+O.message),b=!0,T.a_(new Rt(H,K)),y.close()}else At(Un,`RPC '${t}' stream ${i} received:`,x),T.u_(x)}})),S(u,bS.STAT_EVENT,(I=>{I.stat===hy.PROXY?At(Un,`RPC '${t}' stream ${i} detected buffering proxy`):I.stat===hy.NOPROXY&&At(Un,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{T.__()}),0),T}terminate(){this.c_.forEach((t=>t.close())),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter((e=>e===t))}}function Vm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hp(s){return new sP(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{constructor(t,e,n=1e3,i=1.5,a=6e4){this.Mi=t,this.timerId=e,this.d_=n,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,e-n);i>0&&At("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),t()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JA="PersistentStream";class m1{constructor(t,e,n,i,a,l,u,h){this.Mi=t,this.S_=n,this.b_=i,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new g1(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===_t.RESOURCE_EXHAUSTED?(Ar(e.toString()),Ar("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===_t.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,i])=>{this.D_===e&&this.G_(n,i)}),(n=>{t((()=>{const i=new Rt(_t.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)}))}))}G_(t,e){const n=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{n((()=>this.z_(i)))})),this.stream.onMessage((i=>{n((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return At(JA,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget((()=>this.D_===t?e():(At(JA,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class eO extends m1{constructor(t,e,n,i,a,l){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,l),this.serializer=a}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=oP(this.serializer,t),n=(function(a){if(!("targetChange"in a))return zt.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?zt.min():l.readTime?xs(l.readTime):zt.min()})(t);return this.listener.H_(e,n)}Y_(t){const e={};e.database=Ey(this.serializer),e.addTarget=(function(a,l){let u;const h=l.target;if(u=my(h)?{documents:uP(a,h)}:{query:hP(a,h).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=s1(a,l.resumeToken);const f=_y(a,l.expectedCount);f!==null&&(u.expectedCount=f)}else if(l.snapshotVersion.compareTo(zt.min())>0){u.readTime=Uf(a,l.snapshotVersion.toTimestamp());const f=_y(a,l.expectedCount);f!==null&&(u.expectedCount=f)}return u})(this.serializer,t);const n=fP(this.serializer,t);n&&(e.labels=n),this.q_(e)}Z_(t){const e={};e.database=Ey(this.serializer),e.removeTarget=t,this.q_(e)}}class nO extends m1{constructor(t,e,n,i,a,l){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,l),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}J_(t){return pe(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,pe(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){pe(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=cP(t.writeResults,t.commitTime),n=xs(t.commitTime);return this.listener.na(n,e)}ra(){const t={};t.database=Ey(this.serializer),this.q_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map((n=>lP(this.serializer,n)))};this.q_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{}class sO extends iO{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Rt(_t.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Go(t,vy(e,n),i,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===_t.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Rt(_t.UNKNOWN,a.toString())}))}Ho(t,e,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(t,vy(e,n),i,l,u,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===_t.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Rt(_t.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class rO{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ar(e),this.aa=!1):At("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yo="RemoteStore";class aO{constructor(t,e,n,i,a){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((l=>{n.enqueueAndForget((async()=>{Co(this)&&(At(yo,"Restarting streams for network reachability change."),await(async function(h){const f=qt(h);f.Ea.add(4),await ch(f),f.Ra.set("Unknown"),f.Ea.delete(4),await dp(f)})(this))}))})),this.Ra=new rO(n,i)}}async function dp(s){if(Co(s))for(const t of s.da)await t(!0)}async function ch(s){for(const t of s.da)await t(!1)}function y1(s,t){const e=qt(s);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),D_(e)?x_(e):Zl(e).O_()&&I_(e,t))}function R_(s,t){const e=qt(s),n=Zl(e);e.Ia.delete(t),n.O_()&&_1(e,t),e.Ia.size===0&&(n.O_()?n.L_():Co(e)&&e.Ra.set("Unknown"))}function I_(s,t){if(s.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(zt.min())>0){const e=s.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}Zl(s).Y_(t)}function _1(s,t){s.Va.Ue(t),Zl(s).Z_(t)}function x_(s){s.Va=new tP({getRemoteKeysForTarget:t=>s.remoteSyncer.getRemoteKeysForTarget(t),At:t=>s.Ia.get(t)||null,ht:()=>s.datastore.serializer.databaseId}),Zl(s).start(),s.Ra.ua()}function D_(s){return Co(s)&&!Zl(s).x_()&&s.Ia.size>0}function Co(s){return qt(s).Ea.size===0}function v1(s){s.Va=void 0}async function oO(s){s.Ra.set("Online")}async function lO(s){s.Ia.forEach(((t,e)=>{I_(s,t)}))}async function cO(s,t){v1(s),D_(s)?(s.Ra.ha(t),x_(s)):s.Ra.set("Unknown")}async function uO(s,t,e){if(s.Ra.set("Online"),t instanceof i1&&t.state===2&&t.cause)try{await(async function(i,a){const l=a.cause;for(const u of a.targetIds)i.Ia.has(u)&&(await i.remoteSyncer.rejectListen(u,l),i.Ia.delete(u),i.Va.removeTarget(u))})(s,t)}catch(n){At(yo,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await jf(s,n)}else if(t instanceof yf?s.Va.Ze(t):t instanceof n1?s.Va.st(t):s.Va.tt(t),!e.isEqual(zt.min()))try{const n=await p1(s.localStore);e.compareTo(n)>=0&&await(function(a,l){const u=a.Va.Tt(l);return u.targetChanges.forEach(((h,f)=>{if(h.resumeToken.approximateByteSize()>0){const p=a.Ia.get(f);p&&a.Ia.set(f,p.withResumeToken(h.resumeToken,l))}})),u.targetMismatches.forEach(((h,f)=>{const p=a.Ia.get(h);if(!p)return;a.Ia.set(h,p.withResumeToken(On.EMPTY_BYTE_STRING,p.snapshotVersion)),_1(a,h);const y=new ca(p.target,h,f,p.sequenceNumber);I_(a,y)})),a.remoteSyncer.applyRemoteEvent(u)})(s,e)}catch(n){At(yo,"Failed to raise snapshot:",n),await jf(s,n)}}async function jf(s,t,e){if(!Jl(t))throw t;s.Ea.add(1),await ch(s),s.Ra.set("Offline"),e||(e=()=>p1(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{At(yo,"Retrying IndexedDB access"),await e(),s.Ea.delete(1),await dp(s)}))}function b1(s,t){return t().catch((e=>jf(s,e,t)))}async function fp(s){const t=qt(s),e=ba(t);let n=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:f_;for(;hO(t);)try{const i=await $P(t.localStore,n);if(i===null){t.Ta.length===0&&e.L_();break}n=i.batchId,dO(t,i)}catch(i){await jf(t,i)}E1(t)&&A1(t)}function hO(s){return Co(s)&&s.Ta.length<10}function dO(s,t){s.Ta.push(t);const e=ba(s);e.O_()&&e.X_&&e.ea(t.mutations)}function E1(s){return Co(s)&&!ba(s).x_()&&s.Ta.length>0}function A1(s){ba(s).start()}async function fO(s){ba(s).ra()}async function pO(s){const t=ba(s);for(const e of s.Ta)t.ea(e.mutations)}async function gO(s,t,e){const n=s.Ta.shift(),i=b_.from(n,t,e);await b1(s,(()=>s.remoteSyncer.applySuccessfulWrite(i))),await fp(s)}async function mO(s,t){t&&ba(s).X_&&await(async function(n,i){if((function(l){return Q2(l)&&l!==_t.ABORTED})(i.code)){const a=n.Ta.shift();ba(n).B_(),await b1(n,(()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i))),await fp(n)}})(s,t),E1(s)&&A1(s)}async function ZA(s,t){const e=qt(s);e.asyncQueue.verifyOperationInProgress(),At(yo,"RemoteStore received new credentials");const n=Co(e);e.Ea.add(3),await ch(e),n&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await dp(e)}async function yO(s,t){const e=qt(s);t?(e.Ea.delete(2),await dp(e)):t||(e.Ea.add(2),await ch(e),e.Ra.set("Unknown"))}function Zl(s){return s.ma||(s.ma=(function(e,n,i){const a=qt(e);return a.sa(),new eO(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(s.datastore,s.asyncQueue,{Xo:oO.bind(null,s),t_:lO.bind(null,s),r_:cO.bind(null,s),H_:uO.bind(null,s)}),s.da.push((async t=>{t?(s.ma.B_(),D_(s)?x_(s):s.Ra.set("Unknown")):(await s.ma.stop(),v1(s))}))),s.ma}function ba(s){return s.fa||(s.fa=(function(e,n,i){const a=qt(e);return a.sa(),new nO(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(s.datastore,s.asyncQueue,{Xo:()=>Promise.resolve(),t_:fO.bind(null,s),r_:mO.bind(null,s),ta:pO.bind(null,s),na:gO.bind(null,s)}),s.da.push((async t=>{t?(s.fa.B_(),await fp(s)):(await s.fa.stop(),s.Ta.length>0&&(At(yo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(t,e,n,i,a){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new fa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,a){const l=Date.now()+n,u=new N_(t,e,l,i,a);return u.start(n),u}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Rt(_t.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function M_(s,t){if(Ar("AsyncQueue",`${t}: ${s}`),Jl(s))return new Rt(_t.UNAVAILABLE,`${t}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{static emptySet(t){return new Pl(t.comparator)}constructor(t){this.comparator=t?(e,n)=>t(e,n)||Pt.comparator(e.key,n.key):(e,n)=>Pt.comparator(e.key,n.key),this.keyedMap=mu(),this.sortedSet=new Be(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Pl)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const i=e.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const n=new Pl;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(){this.ga=new Be(Pt.comparator)}track(t){const e=t.doc.key,n=this.ga.get(e);n?t.type!==0&&n.type===3?this.ga=this.ga.insert(e,t):t.type===3&&n.type!==1?this.ga=this.ga.insert(e,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.ga=this.ga.remove(e):t.type===1&&n.type===2?this.ga=this.ga.insert(e,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):Ut(63341,{Rt:t,pa:n}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,n)=>{t.push(n)})),t}}class zl{constructor(t,e,n,i,a,l,u,h,f){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(t,e,n,i,a){const l=[];return e.forEach((u=>{l.push({type:0,doc:u})})),new zl(t,e,Pl.emptySet(e),l,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ap(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((t=>t.Da()))}}class vO{constructor(){this.queries=ew(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,n){const i=qt(e),a=i.queries;i.queries=ew(),a.forEach(((l,u)=>{for(const h of u.Sa)h.onError(n)}))})(this,new Rt(_t.ABORTED,"Firestore shutting down"))}}function ew(){return new To((s=>HS(s)),ap)}async function bO(s,t){const e=qt(s);let n=3;const i=t.query;let a=e.queries.get(i);a?!a.ba()&&t.Da()&&(n=2):(a=new _O,n=t.Da()?0:1);try{switch(n){case 0:a.wa=await e.onListen(i,!0);break;case 1:a.wa=await e.onListen(i,!1);break;case 2:await e.onFirstRemoteStoreListen(i)}}catch(l){const u=M_(l,`Initialization of query '${Al(t.query)}' failed`);return void t.onError(u)}e.queries.set(i,a),a.Sa.push(t),t.va(e.onlineState),a.wa&&t.Fa(a.wa)&&k_(e)}async function EO(s,t){const e=qt(s),n=t.query;let i=3;const a=e.queries.get(n);if(a){const l=a.Sa.indexOf(t);l>=0&&(a.Sa.splice(l,1),a.Sa.length===0?i=t.Da()?0:1:!a.ba()&&t.Da()&&(i=2))}switch(i){case 0:return e.queries.delete(n),e.onUnlisten(n,!0);case 1:return e.queries.delete(n),e.onUnlisten(n,!1);case 2:return e.onLastRemoteStoreUnlisten(n);default:return}}function AO(s,t){const e=qt(s);let n=!1;for(const i of t){const a=i.query,l=e.queries.get(a);if(l){for(const u of l.Sa)u.Fa(i)&&(n=!0);l.wa=i}}n&&k_(e)}function wO(s,t,e){const n=qt(s),i=n.queries.get(t);if(i)for(const a of i.Sa)a.onError(e);n.queries.delete(t)}function k_(s){s.Ca.forEach((t=>{t.next()}))}var Ty,nw;(nw=Ty||(Ty={})).Ma="default",nw.Cache="cache";class TO{constructor(t,e,n){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(t){if(!this.options.includeMetadataChanges){const n=[];for(const i of t.docChanges)i.type!==3&&n.push(i);t=new zl(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const n=e!=="Offline";return(!this.options.qa||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=zl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==Ty.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(t){this.key=t}}class T1{constructor(t){this.key=t}}class SO{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=te(),this.mutatedKeys=te(),this.eu=zS(t),this.tu=new Pl(this.eu)}get nu(){return this.Ya}ru(t,e){const n=e?e.iu:new tw,i=e?e.tu:this.tu;let a=e?e.mutatedKeys:this.mutatedKeys,l=i,u=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((p,y)=>{const v=i.get(p),b=op(this.query,y)?y:null,T=!!v&&this.mutatedKeys.has(v.key),S=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let I=!1;v&&b?v.data.isEqual(b.data)?T!==S&&(n.track({type:3,doc:b}),I=!0):this.su(v,b)||(n.track({type:2,doc:b}),I=!0,(h&&this.eu(b,h)>0||f&&this.eu(b,f)<0)&&(u=!0)):!v&&b?(n.track({type:0,doc:b}),I=!0):v&&!b&&(n.track({type:1,doc:v}),I=!0,(h||f)&&(u=!0)),I&&(b?(l=l.add(b),a=S?a.add(p):a.delete(p)):(l=l.delete(p),a=a.delete(p)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const p=this.query.limitType==="F"?l.last():l.first();l=l.delete(p.key),a=a.delete(p.key),n.track({type:1,doc:p})}return{tu:l,iu:n,Cs:u,mutatedKeys:a}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const a=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const l=t.iu.ya();l.sort(((p,y)=>(function(b,T){const S=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ut(20277,{Rt:I})}};return S(b)-S(T)})(p.type,y.type)||this.eu(p.doc,y.doc))),this.ou(n),i=i??!1;const u=e&&!i?this._u():[],h=this.Xa.size===0&&this.current&&!i?1:0,f=h!==this.Za;return this.Za=h,l.length!==0||f?{snapshot:new zl(this.query,t.tu,a,l,t.mutatedKeys,h===0,f,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new tw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=te(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const e=[];return t.forEach((n=>{this.Xa.has(n)||e.push(new T1(n))})),this.Xa.forEach((n=>{t.has(n)||e.push(new w1(n))})),e}cu(t){this.Ya=t.Qs,this.Xa=te();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return zl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const P_="SyncEngine";class CO{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class RO{constructor(t){this.key=t,this.hu=!1}}class IO{constructor(t,e,n,i,a,l){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new To((u=>HS(u)),ap),this.Iu=new Map,this.Eu=new Set,this.du=new Be(Pt.comparator),this.Au=new Map,this.Ru=new w_,this.Vu={},this.mu=new Map,this.fu=Hl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function xO(s,t,e=!0){const n=D1(s);let i;const a=n.Tu.get(t);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await S1(n,t,e,!0),i}async function DO(s,t){const e=D1(s);await S1(e,t,!0,!1)}async function S1(s,t,e,n){const i=await YP(s.localStore,Is(t)),a=i.targetId,l=s.sharedClientState.addLocalQueryTarget(a,e);let u;return n&&(u=await NO(s,t,a,l==="current",i.resumeToken)),s.isPrimaryClient&&e&&y1(s.remoteStore,i),u}async function NO(s,t,e,n,i){s.pu=(y,v,b)=>(async function(S,I,x,k){let O=I.view.ru(x);O.Cs&&(O=await XA(S.localStore,I.query,!1).then((({documents:P})=>I.view.ru(P,O))));const G=k&&k.targetChanges.get(I.targetId),H=k&&k.targetMismatches.get(I.targetId)!=null,K=I.view.applyChanges(O,S.isPrimaryClient,G,H);return sw(S,I.targetId,K.au),K.snapshot})(s,y,v,b);const a=await XA(s.localStore,t,!0),l=new SO(t,a.Qs),u=l.ru(a.documents),h=lh.createSynthesizedTargetChangeForCurrentChange(e,n&&s.onlineState!=="Offline",i),f=l.applyChanges(u,s.isPrimaryClient,h);sw(s,e,f.au);const p=new CO(t,e,l);return s.Tu.set(t,p),s.Iu.has(e)?s.Iu.get(e).push(t):s.Iu.set(e,[t]),f.snapshot}async function MO(s,t,e){const n=qt(s),i=n.Tu.get(t),a=n.Iu.get(i.targetId);if(a.length>1)return n.Iu.set(i.targetId,a.filter((l=>!ap(l,t)))),void n.Tu.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Ay(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),e&&R_(n.remoteStore,i.targetId),Sy(n,i.targetId)})).catch(Ql)):(Sy(n,i.targetId),await Ay(n.localStore,i.targetId,!0))}async function kO(s,t){const e=qt(s),n=e.Tu.get(t),i=e.Iu.get(n.targetId);e.isPrimaryClient&&i.length===1&&(e.sharedClientState.removeLocalQueryTarget(n.targetId),R_(e.remoteStore,n.targetId))}async function PO(s,t,e){const n=jO(s);try{const i=await(function(l,u){const h=qt(l),f=Se.now(),p=u.reduce(((b,T)=>b.add(T.key)),te());let y,v;return h.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let T=wr(),S=te();return h.Ns.getEntries(b,p).next((I=>{T=I,T.forEach(((x,k)=>{k.isValidDocument()||(S=S.add(x))}))})).next((()=>h.localDocuments.getOverlayedDocuments(b,T))).next((I=>{y=I;const x=[];for(const k of u){const O=$2(k,y.get(k.key).overlayedDocument);O!=null&&x.push(new So(k.key,O,OS(O.value.mapValue),_r.exists(!0)))}return h.mutationQueue.addMutationBatch(b,f,x,u)})).next((I=>{v=I;const x=I.applyToLocalDocumentSet(y,S);return h.documentOverlayCache.saveOverlays(b,I.batchId,x)}))})).then((()=>({batchId:v.batchId,changes:qS(y)})))})(n.localStore,t);n.sharedClientState.addPendingMutation(i.batchId),(function(l,u,h){let f=l.Vu[l.currentUser.toKey()];f||(f=new Be(Zt)),f=f.insert(u,h),l.Vu[l.currentUser.toKey()]=f})(n,i.batchId,e),await uh(n,i.changes),await fp(n.remoteStore)}catch(i){const a=M_(i,"Failed to persist write");e.reject(a)}}async function C1(s,t){const e=qt(s);try{const n=await GP(e.localStore,t);t.targetChanges.forEach(((i,a)=>{const l=e.Au.get(a);l&&(pe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?l.hu=!0:i.modifiedDocuments.size>0?pe(l.hu,14607):i.removedDocuments.size>0&&(pe(l.hu,42227),l.hu=!1))})),await uh(e,n,t)}catch(n){await Ql(n)}}function iw(s,t,e){const n=qt(s);if(n.isPrimaryClient&&e===0||!n.isPrimaryClient&&e===1){const i=[];n.Tu.forEach(((a,l)=>{const u=l.view.va(t);u.snapshot&&i.push(u.snapshot)})),(function(l,u){const h=qt(l);h.onlineState=u;let f=!1;h.queries.forEach(((p,y)=>{for(const v of y.Sa)v.va(u)&&(f=!0)})),f&&k_(h)})(n.eventManager,t),i.length&&n.Pu.H_(i),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function OO(s,t,e){const n=qt(s);n.sharedClientState.updateQueryState(t,"rejected",e);const i=n.Au.get(t),a=i&&i.key;if(a){let l=new Be(Pt.comparator);l=l.insert(a,jn.newNoDocument(a,zt.min()));const u=te().add(a),h=new up(zt.min(),new Map,new Be(Zt),l,u);await C1(n,h),n.du=n.du.remove(a),n.Au.delete(t),O_(n)}else await Ay(n.localStore,t,!1).then((()=>Sy(n,t,e))).catch(Ql)}async function LO(s,t){const e=qt(s),n=t.batch.batchId;try{const i=await zP(e.localStore,t);I1(e,n,null),R1(e,n),e.sharedClientState.updateMutationState(n,"acknowledged"),await uh(e,i)}catch(i){await Ql(i)}}async function BO(s,t,e){const n=qt(s);try{const i=await(function(l,u){const h=qt(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",(f=>{let p;return h.mutationQueue.lookupMutationBatch(f,u).next((y=>(pe(y!==null,37113),p=y.keys(),h.mutationQueue.removeMutationBatch(f,y)))).next((()=>h.mutationQueue.performConsistencyCheck(f))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(f,p,u))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,p))).next((()=>h.localDocuments.getDocuments(f,p)))}))})(n.localStore,t);I1(n,t,e),R1(n,t),n.sharedClientState.updateMutationState(t,"rejected",e),await uh(n,i)}catch(i){await Ql(i)}}function R1(s,t){(s.mu.get(t)||[]).forEach((e=>{e.resolve()})),s.mu.delete(t)}function I1(s,t,e){const n=qt(s);let i=n.Vu[n.currentUser.toKey()];if(i){const a=i.get(t);a&&(e?a.reject(e):a.resolve(),i=i.remove(t)),n.Vu[n.currentUser.toKey()]=i}}function Sy(s,t,e=null){s.sharedClientState.removeLocalQueryTarget(t);for(const n of s.Iu.get(t))s.Tu.delete(n),e&&s.Pu.yu(n,e);s.Iu.delete(t),s.isPrimaryClient&&s.Ru.jr(t).forEach((n=>{s.Ru.containsKey(n)||x1(s,n)}))}function x1(s,t){s.Eu.delete(t.path.canonicalString());const e=s.du.get(t);e!==null&&(R_(s.remoteStore,e),s.du=s.du.remove(t),s.Au.delete(e),O_(s))}function sw(s,t,e){for(const n of e)n instanceof w1?(s.Ru.addReference(n.key,t),FO(s,n)):n instanceof T1?(At(P_,"Document no longer in limbo: "+n.key),s.Ru.removeReference(n.key,t),s.Ru.containsKey(n.key)||x1(s,n.key)):Ut(19791,{wu:n})}function FO(s,t){const e=t.key,n=e.path.canonicalString();s.du.get(e)||s.Eu.has(n)||(At(P_,"New document in limbo: "+e),s.Eu.add(n),O_(s))}function O_(s){for(;s.Eu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const t=s.Eu.values().next().value;s.Eu.delete(t);const e=new Pt(Le.fromString(t)),n=s.fu.next();s.Au.set(n,new RO(e)),s.du=s.du.insert(e,n),y1(s.remoteStore,new ca(Is(__(e.path)),n,"TargetPurposeLimboResolution",np.ce))}}async function uh(s,t,e){const n=qt(s),i=[],a=[],l=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,h)=>{l.push(n.pu(h,t,e).then((f=>{if((f||e)&&n.isPrimaryClient){const p=f?!f.fromCache:e?.targetChanges.get(h.targetId)?.current;n.sharedClientState.updateQueryState(h.targetId,p?"current":"not-current")}if(f){i.push(f);const p=S_.As(h.targetId,f);a.push(p)}})))})),await Promise.all(l),n.Pu.H_(i),await(async function(h,f){const p=qt(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(y=>gt.forEach(f,(v=>gt.forEach(v.Es,(b=>p.persistence.referenceDelegate.addReference(y,v.targetId,b))).next((()=>gt.forEach(v.ds,(b=>p.persistence.referenceDelegate.removeReference(y,v.targetId,b)))))))))}catch(y){if(!Jl(y))throw y;At(C_,"Failed to update sequence numbers: "+y)}for(const y of f){const v=y.targetId;if(!y.fromCache){const b=p.Ms.get(v),T=b.snapshotVersion,S=b.withLastLimboFreeSnapshotVersion(T);p.Ms=p.Ms.insert(v,S)}}})(n.localStore,a))}async function UO(s,t){const e=qt(s);if(!e.currentUser.isEqual(t)){At(P_,"User change. New user:",t.toKey());const n=await f1(e.localStore,t);e.currentUser=t,(function(a,l){a.mu.forEach((u=>{u.forEach((h=>{h.reject(new Rt(_t.CANCELLED,l))}))})),a.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await uh(e,n.Ls)}}function VO(s,t){const e=qt(s),n=e.Au.get(t);if(n&&n.hu)return te().add(n.key);{let i=te();const a=e.Iu.get(t);if(!a)return i;for(const l of a){const u=e.Tu.get(l);i=i.unionWith(u.view.nu)}return i}}function D1(s){const t=qt(s);return t.remoteStore.remoteSyncer.applyRemoteEvent=C1.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=VO.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=OO.bind(null,t),t.Pu.H_=AO.bind(null,t.eventManager),t.Pu.yu=wO.bind(null,t.eventManager),t}function jO(s){const t=qt(s);return t.remoteStore.remoteSyncer.applySuccessfulWrite=LO.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=BO.bind(null,t),t}class Hf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=hp(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return HP(this.persistence,new UP,t.initialUser,this.serializer)}Cu(t){return new d1(T_.mi,this.serializer)}Du(t){return new KP}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hf.provider={build:()=>new Hf};class HO extends Hf{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){pe(this.persistence.referenceDelegate instanceof Vf,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new TP(n,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?oi.withCacheSize(this.cacheSizeBytes):oi.DEFAULT;return new d1((n=>Vf.mi(n,e)),this.serializer)}}class Cy{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>iw(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=UO.bind(null,this.syncEngine),await yO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new vO})()}createDatastore(t){const e=hp(t.databaseInfo.databaseId),n=(function(a){return new tO(a)})(t.databaseInfo);return(function(a,l,u,h){return new sO(a,l,u,h)})(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return(function(n,i,a,l,u){return new aO(n,i,a,l,u)})(this.localStore,this.datastore,t.asyncQueue,(e=>iw(this.syncEngine,e,0)),(function(){return QA.v()?new QA:new WP})())}createSyncEngine(t,e){return(function(i,a,l,u,h,f,p){const y=new IO(i,a,l,u,h,f);return p&&(y.gu=!0),y})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const n=qt(e);At(yo,"RemoteStore shutting down."),n.Ea.add(5),await ch(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Cy.provider={build:()=>new Cy};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):Ar("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ea="FirestoreClient";class GO{constructor(t,e,n,i,a){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=Vn.UNAUTHENTICATED,this.clientId=h_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,(async l=>{At(Ea,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(n,(l=>(At(Ea,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new fa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=M_(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function jm(s,t){s.asyncQueue.verifyOperationInProgress(),At(Ea,"Initializing OfflineComponentProvider");const e=s.configuration;await t.initialize(e);let n=e.initialUser;s.setCredentialChangeListener((async i=>{n.isEqual(i)||(await f1(t.localStore,i),n=i)})),t.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=t}async function rw(s,t){s.asyncQueue.verifyOperationInProgress();const e=await qO(s);At(Ea,"Initializing OnlineComponentProvider"),await t.initialize(e,s.configuration),s.setCredentialChangeListener((n=>ZA(t.remoteStore,n))),s.setAppCheckTokenChangeListener(((n,i)=>ZA(t.remoteStore,i))),s._onlineComponents=t}async function qO(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){At(Ea,"Using user provided OfflineComponentProvider");try{await jm(s,s._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(i){return i.name==="FirebaseError"?i.code===_t.FAILED_PRECONDITION||i.code===_t.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(e))throw e;Fl("Error using user provided cache. Falling back to memory cache: "+e),await jm(s,new Hf)}}else At(Ea,"Using default OfflineComponentProvider"),await jm(s,new HO(void 0));return s._offlineComponents}async function N1(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(At(Ea,"Using user provided OnlineComponentProvider"),await rw(s,s._uninitializedComponentsProvider._online)):(At(Ea,"Using default OnlineComponentProvider"),await rw(s,new Cy))),s._onlineComponents}function $O(s){return N1(s).then((t=>t.syncEngine))}async function YO(s){const t=await N1(s),e=t.eventManager;return e.onListen=xO.bind(null,t.syncEngine),e.onUnlisten=MO.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=DO.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=kO.bind(null,t.syncEngine),e}function XO(s,t,e={}){const n=new fa;return s.asyncQueue.enqueueAndForget((async()=>(function(a,l,u,h,f){const p=new zO({next:v=>{p.Nu(),l.enqueueAndForget((()=>EO(a,y)));const b=v.docs.has(u);!b&&v.fromCache?f.reject(new Rt(_t.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&v.fromCache&&h&&h.source==="server"?f.reject(new Rt(_t.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(v)},error:v=>f.reject(v)}),y=new TO(__(u.path),p,{includeMetadataChanges:!0,qa:!0});return bO(a,y)})(await YO(s),s.asyncQueue,t,e,n))),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M1(s){const t={};return s.timeoutSeconds!==void 0&&(t.timeoutSeconds=s.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aw=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1="firestore.googleapis.com",ow=!0;class lw{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new Rt(_t.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=k1,this.ssl=ow}else this.host=t.host,this.ssl=t.ssl??ow;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=h1;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<AP)throw new Rt(_t.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}r2("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=M1(t.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Rt(_t.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Rt(_t.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Rt(_t.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(n,i){return n.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class L_{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Rt(_t.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Rt(_t.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lw(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new Xk;switch(n.type){case"firstParty":return new Jk(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Rt(_t.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const n=aw.get(e);n&&(At("ComponentProvider","Removing Datastore"),aw.delete(e),n.terminate())})(this),Promise.resolve()}}function KO(s,t,e,n={}){s=Fu(s,L_);const i=Ta(t),a=s._getSettings(),l={...a,emulatorOptions:s._getEmulatorOptions()},u=`${t}:${e}`;i&&(Ky(`https://${u}`),Wy("Firestore",!0)),a.host!==k1&&a.host!==u&&Fl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...a,host:u,ssl:i,emulatorOptions:n};if(!ho(h,l)&&(s._setSettings(h),n.mockUserToken)){let f,p;if(typeof n.mockUserToken=="string")f=n.mockUserToken,p=Vn.MOCK_USER;else{f=NT(n.mockUserToken,s._app?.options.projectId);const y=n.mockUserToken.sub||n.mockUserToken.user_id;if(!y)throw new Rt(_t.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Vn(y)}s._authCredentials=new Kk(new TS(f,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new B_(this.firestore,t,this._query)}}class wn{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qu(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new wn(this.firestore,t,this._key)}toJSON(){return{type:wn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,n){if(ah(e,wn._jsonSchema))return new wn(t,n||null,new Pt(Le.fromString(e.referencePath)))}}wn._jsonSchemaVersion="firestore/documentReference/1.0",wn._jsonSchema={type:on("string",wn._jsonSchemaVersion),referencePath:on("string")};class qu extends B_{constructor(t,e,n){super(t,e,__(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new wn(this.firestore,null,new Pt(t))}withConverter(t){return new qu(this.firestore,t,this._path)}}function Yd(s,t,...e){if(s=Xe(s),arguments.length===1&&(t=h_.newId()),s2("doc","path",t),s instanceof L_){const n=Le.fromString(t,...e);return AA(n),new wn(s,null,new Pt(n))}{if(!(s instanceof wn||s instanceof qu))throw new Rt(_t.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(Le.fromString(t,...e));return AA(n),new wn(s.firestore,s instanceof qu?s.converter:null,new Pt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cw="AsyncQueue";class uw{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new g1(this,"async_queue_retry"),this._c=()=>{const n=Vm();n&&At(cw,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=t;const e=Vm();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=Vm();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new fa;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Xu.push(t),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!Jl(t))throw t;At(cw,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((n=>{throw this.nc=n,this.rc=!1,Ar("INTERNAL UNHANDLED ERROR: ",hw(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=e,e}enqueueAfterDelay(t,e,n){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const i=N_.createAndSchedule(this,t,e,n,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Ut(47125,{Pc:hw(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,n)=>e.targetTimeMs-n.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function hw(s){let t=s.message||"";return s.stack&&(t=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),t}class F_ extends L_{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new uw,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new uw(t),this._firestoreClient=void 0,await t}}}function WO(s,t){const e=typeof s=="object"?s:Zy(),n=typeof s=="string"?s:kf,i=Jf(e,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=IT("firestore");a&&KO(i,...a)}return i}function P1(s){if(s._terminated)throw new Rt(_t.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||QO(s),s._firestoreClient}function QO(s){const t=s._freezeSettings(),e=(function(i,a,l,u){return new m2(i,a,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,M1(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(s._databaseId,s._app?.options.appId||"",s._persistenceKey,t);s._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),s._firestoreClient=new GO(s._authCredentials,s._appCheckCredentials,s._queue,e,s._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(s._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(t){this._byteString=t}static fromBase64String(t){try{return new ji(On.fromBase64String(t))}catch(e){throw new Rt(_t.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new ji(On.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:ji._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(ah(t,ji._jsonSchema))return ji.fromBase64String(t.bytes)}}ji._jsonSchemaVersion="firestore/bytes/1.0",ji._jsonSchema={type:on("string",ji._jsonSchemaVersion),bytes:on("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new Rt(_t.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kn(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Rt(_t.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Rt(_t.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Zt(this._lat,t._lat)||Zt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ds._jsonSchemaVersion}}static fromJSON(t){if(ah(t,Ds._jsonSchema))return new Ds(t.latitude,t.longitude)}}Ds._jsonSchemaVersion="firestore/geoPoint/1.0",Ds._jsonSchema={type:on("string",Ds._jsonSchemaVersion),latitude:on("number"),longitude:on("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0})(this._values,t._values)}toJSON(){return{type:Ns._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(ah(t,Ns._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new Ns(t.vectorValues);throw new Rt(_t.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ns._jsonSchemaVersion="firestore/vectorValue/1.0",Ns._jsonSchema={type:on("string",Ns._jsonSchemaVersion),vectorValues:on("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JO=/^__.*__$/;class ZO{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return this.fieldMask!==null?new So(t,this.data,this.fieldMask,e,this.fieldTransforms):new oh(t,this.data,e,this.fieldTransforms)}}function L1(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ut(40011,{Ac:s})}}class V_{constructor(t,e,n,i,a,l){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new V_({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){const e=this.path?.child(t),n=this.Vc({path:e,fc:!1});return n.gc(t),n}yc(t){const e=this.path?.child(t),n=this.Vc({path:e,fc:!1});return n.Rc(),n}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return zf(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(L1(this.Ac)&&JO.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class tL{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||hp(t)}Cc(t,e,n,i=!1){return new V_({Ac:t,methodName:e,Dc:n,path:kn.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function eL(s){const t=s._freezeSettings(),e=hp(s._databaseId);return new tL(s._databaseId,!!t.ignoreUndefinedProperties,e)}function nL(s,t,e,n,i,a={}){const l=s.Cc(a.merge||a.mergeFields?2:0,t,e,i);V1("Data must be an object, but it was:",l,n);const u=F1(n,l);let h,f;if(a.merge)h=new Ji(l.fieldMask),f=l.fieldTransforms;else if(a.mergeFields){const p=[];for(const y of a.mergeFields){const v=iL(t,y,e);if(!l.contains(v))throw new Rt(_t.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);rL(p,v)||p.push(v)}h=new Ji(p),f=l.fieldTransforms.filter((y=>h.covers(y.field)))}else h=null,f=l.fieldTransforms;return new ZO(new Vi(u),h,f)}function B1(s,t){if(U1(s=Xe(s)))return V1("Unsupported field value:",t,s),F1(s,t);if(s instanceof O1)return(function(n,i){if(!L1(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(s,t),null;if(s===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),s instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return(function(n,i){const a=[];let l=0;for(const u of n){let h=B1(u,i.wc(l));h==null&&(h={nullValue:"NULL_VALUE"}),a.push(h),l++}return{arrayValue:{values:a}}})(s,t)}return(function(n,i){if((n=Xe(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return V2(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=Se.fromDate(n);return{timestampValue:Uf(i.serializer,a)}}if(n instanceof Se){const a=new Se(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Uf(i.serializer,a)}}if(n instanceof Ds)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ji)return{bytesValue:s1(i.serializer,n._byteString)};if(n instanceof wn){const a=i.databaseId,l=n.firestore._databaseId;if(!l.isEqual(a))throw i.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:A_(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Ns)return(function(l,u){return{mapValue:{fields:{[kS]:{stringValue:PS},[Pf]:{arrayValue:{values:l.toArray().map((f=>{if(typeof f!="number")throw u.Sc("VectorValues must only contain numeric values.");return v_(u.serializer,f)}))}}}}}})(n,i);throw i.Sc(`Unsupported field value: ${d_(n)}`)})(s,t)}function F1(s,t){const e={};return RS(s)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):wo(s,((n,i)=>{const a=B1(i,t.mc(n));a!=null&&(e[n]=a)})),{mapValue:{fields:e}}}function U1(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Se||s instanceof Ds||s instanceof ji||s instanceof wn||s instanceof O1||s instanceof Ns)}function V1(s,t,e){if(!U1(e)||!SS(e)){const n=d_(e);throw n==="an object"?t.Sc(s+" a custom object"):t.Sc(s+" "+n)}}function iL(s,t,e){if((t=Xe(t))instanceof U_)return t._internalPath;if(typeof t=="string")return j1(s,t);throw zf("Field path arguments must be of type string or ",s,!1,void 0,e)}const sL=new RegExp("[~\\*/\\[\\]]");function j1(s,t,e){if(t.search(sL)>=0)throw zf(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,e);try{return new U_(...t.split("."))._internalPath}catch{throw zf(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,e)}}function zf(s,t,e,n,i){const a=n&&!n.isEmpty(),l=i!==void 0;let u=`Function ${t}() called with invalid data`;e&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(a||l)&&(h+=" (found",a&&(h+=` in field ${n}`),l&&(h+=` in document ${i}`),h+=")"),new Rt(_t.INVALID_ARGUMENT,u+s+h)}function rL(s,t){return s.some((e=>e.isEqual(t)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1{constructor(t,e,n,i,a){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new wn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new aL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(z1("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class aL extends H1{data(){return super.data()}}function z1(s,t){return typeof t=="string"?j1(s,t):t instanceof U_?t._internalPath:t._delegate._internalPath}class oL{convertValue(t,e="none"){switch(va(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ye(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(_a(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw Ut(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return wo(t,((i,a)=>{n[i]=this.convertValue(a,e)})),n}convertVectorValue(t){const e=t.fields?.[Pf].arrayValue?.values?.map((n=>Ye(n.doubleValue)));return new Ns(e)}convertGeoPoint(t){return new Ds(Ye(t.latitude),Ye(t.longitude))}convertArray(t,e){return(t.values||[]).map((n=>this.convertValue(n,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=sp(t);return n==null?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Vu(t));default:return null}}convertTimestamp(t){const e=ya(t);return new Se(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=Le.fromString(t);pe(u1(n),9688,{name:t});const i=new ju(n.get(1),n.get(3)),a=new Pt(n.popFirst(5));return i.isEqual(e)||Ar(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lL(s,t,e){let n;return n=s?s.toFirestore(t):t,n}class _u{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class co extends H1{constructor(t,e,n,i,a,l){super(t,e,n,i,l),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new _f(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(z1("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Rt(_t.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=co._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}co._jsonSchemaVersion="firestore/documentSnapshot/1.0",co._jsonSchema={type:on("string",co._jsonSchemaVersion),bundleSource:on("string","DocumentSnapshot"),bundleName:on("string"),bundle:on("string")};class _f extends co{data(t={}){return super.data(t)}}class Du{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new _u(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new _f(this._firestore,this._userDataWriter,n.key,n,new _u(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Rt(_t.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map((u=>{const h=new _f(i._firestore,i._userDataWriter,u.doc.key,u.doc,new _u(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}}))}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((u=>a||u.type!==3)).map((u=>{const h=new _f(i._firestore,i._userDataWriter,u.doc.key,u.doc,new _u(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,p=-1;return u.type!==0&&(f=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),p=l.indexOf(u.doc.key)),{type:cL(u.type),doc:h,oldIndex:f,newIndex:p}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Rt(_t.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Du._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=h_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],n=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(e.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function cL(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ut(61501,{type:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xd(s){s=Fu(s,wn);const t=Fu(s.firestore,F_);return XO(P1(t),s._key).then((e=>dL(t,s,e)))}Du._jsonSchemaVersion="firestore/querySnapshot/1.0",Du._jsonSchema={type:on("string",Du._jsonSchemaVersion),bundleSource:on("string","QuerySnapshot"),bundleName:on("string"),bundle:on("string")};class uL extends oL{constructor(t){super(),this.firestore=t}convertBytes(t){return new ji(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new wn(this.firestore,null,e)}}function dw(s,t,e){s=Fu(s,wn);const n=Fu(s.firestore,F_),i=lL(s.converter,t);return hL(n,[nL(eL(n),"setDoc",s._key,i,s.converter!==null,e).toMutation(s._key,_r.none())])}function hL(s,t){return(function(n,i){const a=new fa;return n.asyncQueue.enqueueAndForget((async()=>PO(await $O(n),i,a))),a.promise})(P1(s),t)}function dL(s,t,e){const n=e.docs.get(t._key),i=new uL(s);return new co(s,i,t._key,n,new _u(e.hasPendingWrites,e.fromCache),t.converter)}(function(t,e=!0){(function(i){Wl=i})(Ao),fo(new ga("firestore",((n,{instanceIdentifier:i,options:a})=>{const l=n.getProvider("app").getImmediate(),u=new F_(new Wk(n.getProvider("auth-internal")),new Zk(l,n.getProvider("app-check-internal")),(function(f,p){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new Rt(_t.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ju(f.options.projectId,p)})(l,i),l);return a={useFetchStreams:e,...a},u._setSettings(a),u}),"PUBLIC").setMultipleInstances(!0)),Cs(_A,vA,t),Cs(_A,vA,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1="firebasestorage.googleapis.com",q1="storageBucket",fL=120*1e3,pL=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He extends Ls{constructor(t,e,n=0){super(Hm(t),`Firebase Storage: ${e} (${Hm(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,He.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return Hm(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var je;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(je||(je={}));function Hm(s){return"storage/"+s}function j_(){const s="An unknown error occurred, please check the error payload for server response.";return new He(je.UNKNOWN,s)}function gL(s){return new He(je.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function mL(s){return new He(je.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function yL(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new He(je.UNAUTHENTICATED,s)}function _L(){return new He(je.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function vL(s){return new He(je.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function bL(){return new He(je.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function EL(){return new He(je.CANCELED,"User canceled the upload/download.")}function AL(s){return new He(je.INVALID_URL,"Invalid URL '"+s+"'.")}function wL(s){return new He(je.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function TL(){return new He(je.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+q1+"' property when initializing the app?")}function SL(){return new He(je.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function CL(){return new He(je.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function RL(s){return new He(je.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ry(s){return new He(je.INVALID_ARGUMENT,s)}function $1(){return new He(je.APP_DELETED,"The Firebase app was deleted.")}function IL(s){return new He(je.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Nu(s,t){return new He(je.INVALID_FORMAT,"String does not match format '"+s+"': "+t)}function ou(s){throw new He(je.INTERNAL_ERROR,"Internal error: "+s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let n;try{n=Jn.makeFromUrl(t,e)}catch{return new Jn(t,"")}if(n.path==="")return n;throw wL(t)}static makeFromUrl(t,e){let n=null;const i="([A-Za-z0-9.\\-_]+)";function a(G){G.path.charAt(G.path.length-1)==="/"&&(G.path_=G.path_.slice(0,-1))}const l="(/(.*))?$",u=new RegExp("^gs://"+i+l,"i"),h={bucket:1,path:3};function f(G){G.path_=decodeURIComponent(G.path)}const p="v[A-Za-z0-9_]+",y=e.replace(/[.]/g,"\\."),v="(/([^?#]*).*)?$",b=new RegExp(`^https?://${y}/${p}/b/${i}/o${v}`,"i"),T={bucket:1,path:3},S=e===G1?"(?:storage.googleapis.com|storage.cloud.google.com)":e,I="([^?#]*)",x=new RegExp(`^https?://${S}/${i}/${I}`,"i"),O=[{regex:u,indices:h,postModify:a},{regex:b,indices:T,postModify:f},{regex:x,indices:{bucket:1,path:2},postModify:f}];for(let G=0;G<O.length;G++){const H=O[G],K=H.regex.exec(t);if(K){const P=K[H.indices.bucket];let N=K[H.indices.path];N||(N=""),n=new Jn(P,N),H.postModify(n);break}}if(n==null)throw AL(t);return n}}class xL{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DL(s,t,e){let n=1,i=null,a=null,l=!1,u=0;function h(){return u===2}let f=!1;function p(...I){f||(f=!0,t.apply(null,I))}function y(I){i=setTimeout(()=>{i=null,s(b,h())},I)}function v(){a&&clearTimeout(a)}function b(I,...x){if(f){v();return}if(I){v(),p.call(null,I,...x);return}if(h()||l){v(),p.call(null,I,...x);return}n<64&&(n*=2);let O;u===1?(u=2,O=0):O=(n+Math.random())*1e3,y(O)}let T=!1;function S(I){T||(T=!0,v(),!f&&(i!==null?(I||(u=2),clearTimeout(i),y(0)):I||(u=1)))}return y(0),a=setTimeout(()=>{l=!0,S(!0)},e),S}function NL(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ML(s){return s!==void 0}function kL(s){return typeof s=="object"&&!Array.isArray(s)}function H_(s){return typeof s=="string"||s instanceof String}function fw(s){return z_()&&s instanceof Blob}function z_(){return typeof Blob<"u"}function Iy(s,t,e,n){if(n<t)throw Ry(`Invalid value for '${s}'. Expected ${t} or greater.`);if(n>e)throw Ry(`Invalid value for '${s}'. Expected ${e} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hh(s,t,e){let n=t;return e==null&&(n=`https://${t}`),`${e}://${n}/v0${s}`}function Y1(s){const t=encodeURIComponent;let e="?";for(const n in s)if(s.hasOwnProperty(n)){const i=t(n)+"="+t(s[n]);e=e+i+"&"}return e=e.slice(0,-1),e}var uo;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(uo||(uo={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PL(s,t){const e=s>=500&&s<600,i=[408,429].indexOf(s)!==-1,a=t.indexOf(s)!==-1;return e||i||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OL{constructor(t,e,n,i,a,l,u,h,f,p,y,v=!0,b=!1){this.url_=t,this.method_=e,this.headers_=n,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=u,this.errorCallback_=h,this.timeout_=f,this.progressCallback_=p,this.connectionFactory_=y,this.retry=v,this.isUsingEmulator=b,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,S)=>{this.resolve_=T,this.reject_=S,this.start_()})}start_(){const t=(n,i)=>{if(i){n(!1,new Kd(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const l=u=>{const h=u.loaded,f=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,f)};this.progressCallback_!==null&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const u=a.getErrorCode()===uo.NO_ERROR,h=a.getStatus();if(!u||PL(h,this.additionalRetryCodes_)&&this.retry){const p=a.getErrorCode()===uo.ABORT;n(!1,new Kd(!1,null,p));return}const f=this.successCodes_.indexOf(h)!==-1;n(!0,new Kd(f,a))})},e=(n,i)=>{const a=this.resolve_,l=this.reject_,u=i.connection;if(i.wasSuccessCode)try{const h=this.callback_(u,u.getResponse());ML(h)?a(h):a()}catch(h){l(h)}else if(u!==null){const h=j_();h.serverResponse=u.getErrorText(),this.errorCallback_?l(this.errorCallback_(u,h)):l(h)}else if(i.canceled){const h=this.appDelete_?$1():EL();l(h)}else{const h=bL();l(h)}};this.canceled_?e(!1,new Kd(!1,null,!0)):this.backoffId_=DL(t,e,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&NL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Kd{constructor(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n}}function LL(s,t){t!==null&&t.length>0&&(s.Authorization="Firebase "+t)}function BL(s,t){s["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function FL(s,t){t&&(s["X-Firebase-GMPID"]=t)}function UL(s,t){t!==null&&(s["X-Firebase-AppCheck"]=t)}function VL(s,t,e,n,i,a,l=!0,u=!1){const h=Y1(s.urlParams),f=s.url+h,p=Object.assign({},s.headers);return FL(p,t),LL(p,e),BL(p,a),UL(p,n),new OL(f,s.method,p,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,i,l,u)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jL(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function HL(...s){const t=jL();if(t!==void 0){const e=new t;for(let n=0;n<s.length;n++)e.append(s[n]);return e.getBlob()}else{if(z_())return new Blob(s);throw new He(je.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function zL(s,t,e){return s.webkitSlice?s.webkitSlice(t,e):s.mozSlice?s.mozSlice(t,e):s.slice?s.slice(t,e):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GL(s){if(typeof atob>"u")throw RL("base-64");return atob(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class zm{constructor(t,e){this.data=t,this.contentType=e||null}}function qL(s,t){switch(s){case Ss.RAW:return new zm(X1(t));case Ss.BASE64:case Ss.BASE64URL:return new zm(K1(s,t));case Ss.DATA_URL:return new zm(YL(t),XL(t))}throw j_()}function X1(s){const t=[];for(let e=0;e<s.length;e++){let n=s.charCodeAt(e);if(n<=127)t.push(n);else if(n<=2047)t.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(e<s.length-1&&(s.charCodeAt(e+1)&64512)===56320))t.push(239,191,189);else{const a=n,l=s.charCodeAt(++e);n=65536|(a&1023)<<10|l&1023,t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?t.push(239,191,189):t.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(t)}function $L(s){let t;try{t=decodeURIComponent(s)}catch{throw Nu(Ss.DATA_URL,"Malformed data URL.")}return X1(t)}function K1(s,t){switch(s){case Ss.BASE64:{const i=t.indexOf("-")!==-1,a=t.indexOf("_")!==-1;if(i||a)throw Nu(s,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Ss.BASE64URL:{const i=t.indexOf("+")!==-1,a=t.indexOf("/")!==-1;if(i||a)throw Nu(s,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let e;try{e=GL(t)}catch(i){throw i.message.includes("polyfill")?i:Nu(s,"Invalid character found")}const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n}class W1{constructor(t){this.base64=!1,this.contentType=null;const e=t.match(/^data:([^,]+)?,/);if(e===null)throw Nu(Ss.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=e[1]||null;n!=null&&(this.base64=KL(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=t.substring(t.indexOf(",")+1)}}function YL(s){const t=new W1(s);return t.base64?K1(Ss.BASE64,t.rest):$L(t.rest)}function XL(s){return new W1(s).contentType}function KL(s,t){return s.length>=t.length?s.substring(s.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(t,e){let n=0,i="";fw(t)?(this.data_=t,n=t.size,i=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,e){if(fw(this.data_)){const n=this.data_,i=zL(n,t,e);return i===null?null:new aa(i)}else{const n=new Uint8Array(this.data_.buffer,t,e-t);return new aa(n,!0)}}static getBlob(...t){if(z_()){const e=t.map(n=>n instanceof aa?n.data_:n);return new aa(HL.apply(null,e))}else{const e=t.map(l=>H_(l)?qL(Ss.RAW,l).data:l.data_);let n=0;e.forEach(l=>{n+=l.byteLength});const i=new Uint8Array(n);let a=0;return e.forEach(l=>{for(let u=0;u<l.length;u++)i[a++]=l[u]}),new aa(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G_(s){let t;try{t=JSON.parse(s)}catch{return null}return kL(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WL(s){if(s.length===0)return null;const t=s.lastIndexOf("/");return t===-1?"":s.slice(0,t)}function QL(s,t){const e=t.split("/").filter(n=>n.length>0).join("/");return s.length===0?e:s+"/"+e}function Q1(s){const t=s.lastIndexOf("/",s.length-2);return t===-1?s:s.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JL(s,t){return t}class Xn{constructor(t,e,n,i){this.server=t,this.local=e||t,this.writable=!!n,this.xform=i||JL}}let Wd=null;function ZL(s){return!H_(s)||s.length<2?s:Q1(s)}function J1(){if(Wd)return Wd;const s=[];s.push(new Xn("bucket")),s.push(new Xn("generation")),s.push(new Xn("metageneration")),s.push(new Xn("name","fullPath",!0));function t(a,l){return ZL(l)}const e=new Xn("name");e.xform=t,s.push(e);function n(a,l){return l!==void 0?Number(l):l}const i=new Xn("size");return i.xform=n,s.push(i),s.push(new Xn("timeCreated")),s.push(new Xn("updated")),s.push(new Xn("md5Hash",null,!0)),s.push(new Xn("cacheControl",null,!0)),s.push(new Xn("contentDisposition",null,!0)),s.push(new Xn("contentEncoding",null,!0)),s.push(new Xn("contentLanguage",null,!0)),s.push(new Xn("contentType",null,!0)),s.push(new Xn("metadata","customMetadata",!0)),Wd=s,Wd}function tB(s,t){function e(){const n=s.bucket,i=s.fullPath,a=new Jn(n,i);return t._makeStorageReference(a)}Object.defineProperty(s,"ref",{get:e})}function eB(s,t,e){const n={};n.type="file";const i=e.length;for(let a=0;a<i;a++){const l=e[a];n[l.local]=l.xform(n,t[l.server])}return tB(n,s),n}function Z1(s,t,e){const n=G_(t);return n===null?null:eB(s,n,e)}function nB(s,t,e,n){const i=G_(t);if(i===null||!H_(i.downloadTokens))return null;const a=i.downloadTokens;if(a.length===0)return null;const l=encodeURIComponent;return a.split(",").map(f=>{const p=s.bucket,y=s.fullPath,v="/b/"+l(p)+"/o/"+l(y),b=hh(v,e,n),T=Y1({alt:"media",token:f});return b+T})[0]}function iB(s,t){const e={},n=t.length;for(let i=0;i<n;i++){const a=t[i];a.writable&&(e[a.server]=s[a.local])}return JSON.stringify(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pw="prefixes",gw="items";function sB(s,t,e){const n={prefixes:[],items:[],nextPageToken:e.nextPageToken};if(e[pw])for(const i of e[pw]){const a=i.replace(/\/$/,""),l=s._makeStorageReference(new Jn(t,a));n.prefixes.push(l)}if(e[gw])for(const i of e[gw]){const a=s._makeStorageReference(new Jn(t,i.name));n.items.push(a)}return n}function rB(s,t,e){const n=G_(e);return n===null?null:sB(s,t,n)}class pp{constructor(t,e,n,i){this.url=t,this.method=e,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q_(s){if(!s)throw j_()}function aB(s,t){function e(n,i){const a=Z1(s,i,t);return q_(a!==null),a}return e}function oB(s,t){function e(n,i){const a=rB(s,t,i);return q_(a!==null),a}return e}function lB(s,t){function e(n,i){const a=Z1(s,i,t);return q_(a!==null),nB(a,i,s.host,s._protocol)}return e}function $_(s){function t(e,n){let i;return e.getStatus()===401?e.getErrorText().includes("Firebase App Check token is invalid")?i=_L():i=yL():e.getStatus()===402?i=mL(s.bucket):e.getStatus()===403?i=vL(s.path):i=n,i.status=e.getStatus(),i.serverResponse=n.serverResponse,i}return t}function tC(s){const t=$_(s);function e(n,i){let a=t(n,i);return n.getStatus()===404&&(a=gL(s.path)),a.serverResponse=i.serverResponse,a}return e}function cB(s,t,e,n,i){const a={};t.isRoot?a.prefix="":a.prefix=t.path+"/",e.length>0&&(a.delimiter=e),n&&(a.pageToken=n),i&&(a.maxResults=i);const l=t.bucketOnlyServerUrl(),u=hh(l,s.host,s._protocol),h="GET",f=s.maxOperationRetryTime,p=new pp(u,h,oB(s,t.bucket),f);return p.urlParams=a,p.errorHandler=$_(t),p}function uB(s,t,e){const n=t.fullServerUrl(),i=hh(n,s.host,s._protocol),a="GET",l=s.maxOperationRetryTime,u=new pp(i,a,lB(s,e),l);return u.errorHandler=tC(t),u}function hB(s,t){const e=t.fullServerUrl(),n=hh(e,s.host,s._protocol),i="DELETE",a=s.maxOperationRetryTime;function l(h,f){}const u=new pp(n,i,l,a);return u.successCodes=[200,204],u.errorHandler=tC(t),u}function dB(s,t){return s&&s.contentType||t&&t.type()||"application/octet-stream"}function fB(s,t,e){const n=Object.assign({},e);return n.fullPath=s.path,n.size=t.size(),n.contentType||(n.contentType=dB(null,t)),n}function pB(s,t,e,n,i){const a=t.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function u(){let O="";for(let G=0;G<2;G++)O=O+Math.random().toString().slice(2);return O}const h=u();l["Content-Type"]="multipart/related; boundary="+h;const f=fB(t,n,i),p=iB(f,e),y="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+p+`\r
--`+h+`\r
Content-Type: `+f.contentType+`\r
\r
`,v=`\r
--`+h+"--",b=aa.getBlob(y,n,v);if(b===null)throw SL();const T={name:f.fullPath},S=hh(a,s.host,s._protocol),I="POST",x=s.maxUploadRetryTime,k=new pp(S,I,aB(s,e),x);return k.urlParams=T,k.headers=l,k.body=b.uploadData(),k.errorHandler=$_(t),k}class gB{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=uo.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=uo.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=uo.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,e,n,i,a){if(this.sent_)throw ou("cannot .send() more than once");if(Ta(t)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(e,t,!0),a!==void 0)for(const l in a)a.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,a[l].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ou("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ou("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ou("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ou("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class mB extends gB{initXhr(){this.xhr_.responseType="text"}}function gp(){return new mB}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(t,e){this._service=t,e instanceof Jn?this._location=e:this._location=Jn.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new _o(t,e)}get root(){const t=new Jn(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Q1(this._location.path)}get storage(){return this._service}get parent(){const t=WL(this._location.path);if(t===null)return null;const e=new Jn(this._location.bucket,t);return new _o(this._service,e)}_throwIfRoot(t){if(this._location.path==="")throw IL(t)}}function yB(s,t,e){s._throwIfRoot("uploadBytes");const n=pB(s.storage,s._location,J1(),new aa(t,!0),e);return s.storage.makeRequestWithTokens(n,gp).then(i=>({metadata:i,ref:s}))}function _B(s){const t={prefixes:[],items:[]};return eC(s,t).then(()=>t)}async function eC(s,t,e){const i=await vB(s,{pageToken:e});t.prefixes.push(...i.prefixes),t.items.push(...i.items),i.nextPageToken!=null&&await eC(s,t,i.nextPageToken)}function vB(s,t){t!=null&&typeof t.maxResults=="number"&&Iy("options.maxResults",1,1e3,t.maxResults);const e=t||{},n=cB(s.storage,s._location,"/",e.pageToken,e.maxResults);return s.storage.makeRequestWithTokens(n,gp)}function bB(s){s._throwIfRoot("getDownloadURL");const t=uB(s.storage,s._location,J1());return s.storage.makeRequestWithTokens(t,gp).then(e=>{if(e===null)throw CL();return e})}function EB(s){s._throwIfRoot("deleteObject");const t=hB(s.storage,s._location);return s.storage.makeRequestWithTokens(t,gp)}function AB(s,t){const e=QL(s._location.path,t),n=new Jn(s._location.bucket,e);return new _o(s.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wB(s){return/^[A-Za-z]+:\/\//.test(s)}function TB(s,t){return new _o(s,t)}function nC(s,t){if(s instanceof Y_){const e=s;if(e._bucket==null)throw TL();const n=new _o(e,e._bucket);return t!=null?nC(n,t):n}else return t!==void 0?AB(s,t):s}function SB(s,t){if(t&&wB(t)){if(s instanceof Y_)return TB(s,t);throw Ry("To use ref(service, url), the first argument must be a Storage instance.")}else return nC(s,t)}function mw(s,t){const e=t?.[q1];return e==null?null:Jn.makeFromBucketSpec(e,s)}function CB(s,t,e,n={}){s.host=`${t}:${e}`;const i=Ta(t);i&&(Ky(`https://${s.host}/b`),Wy("Storage",!0)),s._isUsingEmulator=!0,s._protocol=i?"https":"http";const{mockUserToken:a}=n;a&&(s._overrideAuthToken=typeof a=="string"?a:NT(a,s.app.options.projectId))}class Y_{constructor(t,e,n,i,a,l=!1){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._url=i,this._firebaseVersion=a,this._isUsingEmulator=l,this._bucket=null,this._host=G1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=fL,this._maxUploadRetryTime=pL,this._requests=new Set,i!=null?this._bucket=Jn.makeFromBucketSpec(i,this._host):this._bucket=mw(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=Jn.makeFromBucketSpec(this._url,t):this._bucket=mw(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){Iy("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){Iy("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(e!==null)return e.accessToken}return null}async _getAppCheckToken(){if(li(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new _o(this,t)}_makeRequest(t,e,n,i,a=!0){if(this._deleted)return new xL($1());{const l=VL(t,this._appId,n,i,e,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(t,e){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,n,i).getPromise()}}const yw="@firebase/storage",_w="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC="storage";function RB(s,t,e){return s=Xe(s),yB(s,t,e)}function sC(s){return s=Xe(s),_B(s)}function IB(s){return s=Xe(s),bB(s)}function xB(s){return s=Xe(s),EB(s)}function Gf(s,t){return s=Xe(s),SB(s,t)}function DB(s=Zy(),t){s=Xe(s);const n=Jf(s,iC).getImmediate({identifier:t}),i=IT("storage");return i&&NB(n,...i),n}function NB(s,t,e,n={}){CB(s,t,e,n)}function MB(s,{instanceIdentifier:t}){const e=s.getProvider("app").getImmediate(),n=s.getProvider("auth-internal"),i=s.getProvider("app-check-internal");return new Y_(e,n,i,t,Ao)}function kB(){fo(new ga(iC,MB,"PUBLIC").setMultipleInstances(!0)),Cs(yw,_w,""),Cs(yw,_w,"esm2020")}kB();const PB={apiKey:"AIzaSyBxD-ELTkbweIZnsiQQu-T97SrCpNEwi7Y",authDomain:"ldd-backend-910d6.firebaseapp.com",projectId:"ldd-backend-910d6",storageBucket:"ldd-backend-910d6.firebasestorage.app",messagingSenderId:"245318789124",appId:"1:245318789124:web:f6a04d784a4199a570ad51"},X_=PT(PB),bi=$k(X_),xy=new fr,Ui=DB(X_),vu=WO(X_);console.log("Firebase initialized:",{auth:bi,db:vu,storage:Ui});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function OB(s,t,e,n){function i(a){return a instanceof e?a:new e(function(l){l(a)})}return new(e||(e=Promise))(function(a,l){function u(p){try{f(n.next(p))}catch(y){l(y)}}function h(p){try{f(n.throw(p))}catch(y){l(y)}}function f(p){p.done?a(p.value):i(p.value).then(u,h)}f((n=n.apply(s,[])).next())})}function LB(s,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,l;return l={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function u(f){return function(p){return h([f,p])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(a=f[0]&2?i.return:f[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,f[1])).done)return a;switch(i=0,a&&(f=[f[0]&2,a.value]),f[0]){case 0:case 1:a=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,i=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!a||f[1]>a[0]&&f[1]<a[3])){e.label=f[1];break}if(f[0]===6&&e.label<a[1]){e.label=a[1],a=f;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(f);break}a[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(s,e)}catch(p){f=[6,p],i=0}finally{n=a=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Il=function(){return Il=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},Il.apply(this,arguments)},rC=function(s){return{loading:s==null,value:s}},BB=function(){return function(s,t){switch(t.type){case"error":return Il(Il({},s),{error:t.error,loading:!1,value:void 0});case"reset":return rC(t.defaultValue);case"value":return Il(Il({},s),{error:void 0,loading:!1,value:t.value});default:return s}}},FB=(function(s){var t=s?s():void 0,e=st.useReducer(BB(),rC(t)),n=e[0],i=e[1],a=st.useCallback(function(){var h=s?s():void 0;i({type:"reset",defaultValue:h})},[s]),l=st.useCallback(function(h){i({type:"error",error:h})},[]),u=st.useCallback(function(h){i({type:"value",value:h})},[]);return st.useMemo(function(){return{error:n.error,loading:n.loading,reset:a,setError:l,setValue:u,value:n.value}},[n.error,n.loading,a,l,u,n.value])}),K_=(function(s,t){var e=FB(function(){return s.currentUser}),n=e.error,i=e.loading,a=e.setError,l=e.setValue,u=e.value;return st.useEffect(function(){var h=rS(s,function(f){return OB(void 0,void 0,void 0,function(){var p;return LB(this,function(y){switch(y.label){case 0:return[3,4];case 1:return y.trys.push([1,3,,4]),[4,t.onUserChanged(f)];case 2:return y.sent(),[3,4];case 3:return p=y.sent(),a(p),[3,4];case 4:return l(f),[2]}})})},a);return function(){h()}},[s]),[u,i,n]});const UB=()=>{const[s,t]=st.useState(!1),[e]=K_(bi),n=Xl();st.useEffect(()=>{const l=()=>{t(window.scrollY>50)};return window.addEventListener("scroll",l),()=>{window.removeEventListener("scroll",l)}},[]);const i=async()=>{await cy(bi),n("/auth")},a=()=>e?.photoURL?e.photoURL:`https://ui-avatars.com/api/?name=${e?.displayName||e?.email||"User"}&background=${Math.floor(Math.random()*16777215).toString(16)}&color=fff`;return z.jsxs("nav",{className:`container ${s?"dark-nav":""}`,children:[z.jsx("img",{src:Yx,alt:"Logo",className:"logo"}),z.jsxs("ul",{children:[z.jsx("li",{children:z.jsx(wu,{to:"/",className:"nav-link",children:"Home"})}),z.jsx("li",{children:"Stories"}),z.jsx("li",{children:"Document Scanner"}),z.jsx("li",{children:"About Us"}),e?z.jsxs(z.Fragment,{children:[z.jsx(wu,{to:"/profile",className:"profile-link",children:z.jsxs("li",{className:"navbar-profile",children:[z.jsx("img",{src:a(),alt:"profile",className:"profile-pic",style:{width:32,height:32,borderRadius:"50%",marginRight:8},onError:l=>{l.target.src=`https://ui-avatars.com/api/?name=${e.displayName||e.email||"User"}&background=${Math.floor(Math.random()*16777215).toString(16)}&color=fff`}}),z.jsx("span",{children:e.displayName||e.email})]})}),z.jsx("li",{children:z.jsx("button",{className:"btn",onClick:i,children:"Sign Out"})})]}):z.jsx("li",{children:z.jsx(wu,{to:"/auth",className:"btn",children:"Login"})})]})]})},VB=()=>{const[s,t]=st.useState(!0),[e,n]=st.useState({email:"",password:""}),[i,a]=st.useState({name:"",phone:"",email:"",password:"",age:"",source:""}),[l,u]=st.useState(""),[h,f]=st.useState(""),[p,y]=st.useState(""),v=Xl();st.useEffect(()=>{const k=rS(bi,O=>{O?console.log("Auth State Changed:",{uid:O.uid,email:O.email}):(console.log("No user authenticated"),y("Please signup or login to continue."))});return()=>k()},[]);const b=(k,O)=>{const{name:G,value:H}=k.target;if(O==="signup"){if(G==="age"&&H&&isNaN(parseInt(H,10))){u("Age must be a valid number");return}a(K=>({...K,[G]:H})),G==="age"&&u("")}else n(K=>({...K,[G]:H}))},T=async k=>{k.preventDefault();const O=parseInt(i.age,10);if(O<18||isNaN(O)){u("Age must be a valid number and at least 18");return}if(!i.name||!i.phone||!i.email||!i.password||!i.source){f("All fields are required for signup.");return}try{const H=(await NM(bi,i.email,i.password)).user;await kM(H),alert("Verification email sent! Please check your inbox.");const K=Yd(vu,"users",H.uid);(await Xd(K)).exists()||await dw(K,{name:i.name,phone:i.phone,email:i.email,age:O,source:i.source,createdAt:new Date,providerId:H.providerId}),t(!0)}catch(G){console.error("Signup error:",G),G.code==="auth/email-already-in-use"?f("This email is already registered. Please log in."):f(G.message)}},S=async k=>{if(k.preventDefault(),!e.email||!e.password){f("Email and password are required.");return}try{const G=(await MM(bi,e.email,e.password)).user;if(!G.emailVerified){f("Please verify your email before logging in.");return}(await Xd(Yd(vu,"users",G.uid))).exists()?v("/"):(f("No user data found in database. Please sign up first."),await cy(bi))}catch(O){console.error("Login error:",O),O.code==="auth/user-not-found"?f("No account found with this email. Please sign up."):O.code==="auth/wrong-password"?f("Incorrect password. Please try again."):f(O.message)}},I=async()=>{f("");try{const O=(await cA(bi,xy)).user,G=Yd(vu,"users",O.uid);(await Xd(G)).exists()||await dw(G,{name:O.displayName||"Google User",phone:"",email:O.email,age:0,source:"Google",createdAt:new Date,providerId:O.providerId}),v("/")}catch(k){console.error("Google signup error:",k),f(k.message)}},x=async()=>{f("");try{const O=(await cA(bi,xy)).user,G=Yd(vu,"users",O.uid);if(!(await Xd(G)).exists()){try{await LM(O)}catch(K){console.warn("Could not delete user (might need re-auth):",K)}await cy(bi),f("You've not yet Signed up with us!");return}v("/")}catch(k){console.error("Google login error:",k),f(k.message)}};return z.jsx("div",{className:"auth-container",children:z.jsxs("div",{className:`form-flipper ${s?"":"show-signup"}`,children:[z.jsx("div",{className:"form-wrapper login-form",children:z.jsxs("form",{onSubmit:S,children:[z.jsx("h2",{children:"Login"}),p&&z.jsx("p",{className:"auth-message",children:p}),z.jsxs("div",{className:"form-group",children:[z.jsx("label",{htmlFor:"login-email",children:"Email ID"}),z.jsx("input",{type:"email",id:"login-email",name:"email",value:e.email,onChange:k=>b(k,"login"),required:!0})]}),z.jsxs("div",{className:"form-group",children:[z.jsx("label",{htmlFor:"login-password",children:"Password"}),z.jsx("input",{type:"password",id:"login-password",name:"password",value:e.password,onChange:k=>b(k,"login"),required:!0})]}),z.jsx("button",{type:"submit",className:"btn",children:"Login"}),z.jsx("button",{type:"button",className:"btn google-btn",onClick:x,children:"Login with Google"}),h&&z.jsx("p",{className:"error-message",children:h}),z.jsxs("p",{className:"toggle-text",children:["Don't have an account?"," ",z.jsx("span",{onClick:()=>t(!1),children:"Sign Up"})]})]})}),z.jsx("div",{className:"form-wrapper signup-form",children:z.jsxs("form",{onSubmit:T,children:[z.jsx("h2",{children:"Sign Up"}),z.jsxs("div",{className:"form-group",children:[z.jsx("label",{htmlFor:"name",children:"Name"}),z.jsx("input",{type:"text",id:"name",name:"name",value:i.name,onChange:k=>b(k,"signup"),required:!0})]}),z.jsxs("div",{className:"form-group",children:[z.jsx("label",{htmlFor:"phone",children:"Phone Number"}),z.jsx("input",{type:"tel",id:"phone",name:"phone",value:i.phone,onChange:k=>b(k,"signup"),required:!0})]}),z.jsxs("div",{className:"form-group",children:[z.jsx("label",{htmlFor:"signup-email",children:"Email ID"}),z.jsx("input",{type:"email",id:"signup-email",name:"email",value:i.email,onChange:k=>b(k,"signup"),required:!0})]}),z.jsxs("div",{className:"form-group",children:[z.jsx("label",{htmlFor:"signup-password",children:"Password"}),z.jsx("input",{type:"password",id:"signup-password",name:"password",value:i.password,onChange:k=>b(k,"signup"),required:!0})]}),z.jsxs("div",{className:"form-group",children:[z.jsx("label",{htmlFor:"age",children:"Age"}),z.jsx("input",{type:"number",id:"age",name:"age",value:i.age,onChange:k=>b(k,"signup"),required:!0}),l&&z.jsx("p",{className:"error-message",children:l})]}),z.jsxs("div",{className:"form-group",children:[z.jsx("label",{htmlFor:"source",children:"How did you hear about us?"}),z.jsxs("select",{id:"source",name:"source",value:i.source,onChange:k=>b(k,"signup"),required:!0,children:[z.jsx("option",{value:"",disabled:!0,children:"Select an option"}),z.jsx("option",{value:"social-media",children:"Social Media"}),z.jsx("option",{value:"friend",children:"From a friend"}),z.jsx("option",{value:"search-engine",children:"Search Engine"}),z.jsx("option",{value:"advertisement",children:"Advertisement"}),z.jsx("option",{value:"other",children:"Other"})]})]}),z.jsx("button",{type:"submit",className:"btn",children:"Sign Up"}),z.jsx("button",{type:"button",className:"btn google-btn",onClick:I,children:"Sign Up with Google"}),h&&z.jsx("p",{className:"error-message",children:h}),z.jsxs("p",{className:"toggle-text",children:["Already have an account?"," ",z.jsx("span",{onClick:()=>t(!0),children:"Login"})]})]})})]})})},jB=()=>{const s=Tr(),t=Xl(),{result:e}=s.state||{},n=st.useRef(null);st.useEffect(()=>{e&&e.verificationId&&console.log("RESULTS PAGE LOADED WITH VERIFICATION ID:",e.verificationId)},[e]);const i=l=>{if(n.current){const u=l==="left"?-200:200;n.current.scrollBy({left:u,behavior:"smooth"})}};if(!e)return z.jsxs("div",{className:"error-container",children:[z.jsx("h2",{children:"No results found"}),z.jsx("button",{onClick:()=>t("/"),children:"Go Back"})]});const a=e.images?[...new Set(e.images)]:[];return z.jsxs("div",{className:"results-container",children:[z.jsxs("div",{className:"verdict-header",children:[z.jsx("h1",{children:"Verification Results"}),z.jsx("p",{className:e.status==="Original"?"verdict-original":"verdict-fake",children:e.status==="Original"?"✅ Original Document":"❌ Fake Document"}),e.verificationId&&z.jsxs("p",{className:"verification-id",children:[z.jsx("strong",{children:"Verification ID:"})," ",e.verificationId]})]}),z.jsxs("div",{className:"summary-section",children:[z.jsx("h3",{children:"Uploaded Document Preview"}),a.length>0?z.jsxs("div",{className:"slider-container",children:[z.jsx("button",{className:"slider-button slider-left",onClick:()=>i("left"),children:"←"}),z.jsx("div",{className:"image-slider",ref:n,children:a.map((l,u)=>z.jsxs("div",{className:"pdf-image-wrapper",children:[z.jsx("img",{src:`data:image/png;base64,${l}`,alt:`Page ${u+1}`}),z.jsxs("p",{children:["Page ",u+1]})]},u))}),z.jsx("button",{className:"slider-button slider-right",onClick:()=>i("right"),children:"→"})]}):z.jsx("p",{children:"No PDF images available."})]}),z.jsxs("div",{className:"summary-section",children:[z.jsx("h3",{children:"Page-wise Summaries"}),e.pageSummaries&&e.pageSummaries.length>0?e.pageSummaries.map((l,u)=>z.jsxs("div",{className:"extracted-text-page",children:[z.jsxs("h4",{children:["Page ",u+1]}),z.jsx("div",{className:"page-html-content",children:l||"No summary available."})]},u)):z.jsx("p",{children:"No summaries could be generated from the document."})]}),z.jsxs("div",{className:"summary-section",children:[z.jsx("h3",{children:"Analysis and Field Verification"}),e.analysis&&z.jsx("p",{className:"analysis-text",children:e.analysis}),z.jsx("div",{className:"comparison-table",children:z.jsxs("table",{children:[z.jsx("thead",{children:z.jsxs("tr",{children:[z.jsx("th",{children:"Field"}),z.jsx("th",{children:"User Data"}),z.jsx("th",{children:"Data From Document"}),z.jsx("th",{children:"Status"})]})}),z.jsx("tbody",{children:e.details&&e.details.length>0?e.details.map((l,u)=>z.jsxs("tr",{children:[z.jsx("td",{children:l.field}),z.jsx("td",{className:"document-data-cell",children:l.userData||"-"}),z.jsx("td",{className:"document-data-cell",children:l.dataFromDocument||"-"}),z.jsx("td",{className:l.status==="✅ Match"?"status-match":"status-mismatch",children:l.status})]},u)):z.jsx("tr",{children:z.jsx("td",{colSpan:"4",children:"No verification details available."})})})]})})]}),e.status!=="Original"&&z.jsxs("div",{className:"mismatch-reason",children:[z.jsx("strong",{children:'Reason for "Fake" Verdict:'}),z.jsx("p",{children:"One or more fields did not match the data extracted from the document. Please review the mismatches highlighted in the table above."})]}),z.jsx("button",{className:"back-link",onClick:()=>t("/"),children:"Verify Another Document"})]})},HB="/AuthentiDoc/assets/delete_icon-M_PWsJ8f.png",zB=()=>{const[s,t]=K_(bi),[e,n]=st.useState([]),[i,a]=st.useState(""),l=async()=>{if(!s||!Ui){a("Authentication or storage not initialized.");return}try{const h=Gf(Ui,`uploads/${s.uid}/`),p=(await sC(h)).items.map(y=>y.name);n(p)}catch(h){a(`Failed to list files. [${h.message}]`)}};st.useEffect(()=>{s&&!t&&Ui&&l()},[s,t,Ui]);const u=async h=>{if(!s||!Ui){a("Authentication or storage not initialized.");return}try{const f=Gf(Ui,`uploads/${s.uid}/${h}`);await xB(f),n(e.filter(p=>p!==h))}catch(f){a(`Failed to delete file. [${f.message}]`)}};return t?z.jsx("div",{className:"profile-container",children:"Loading profile..."}):s?z.jsxs("div",{className:"profile-container",children:[z.jsxs("h1",{children:["Hello, ",s.displayName||s.email,"!"]}),z.jsxs("div",{className:"file-list-section",children:[z.jsx("h2",{children:"Your Uploaded Files:"}),i&&z.jsx("div",{className:"error-message",children:i}),e.length>0?z.jsx("ul",{children:e.map((h,f)=>z.jsxs("li",{className:"file-item",children:[h,z.jsx("button",{className:"delete-btn",onClick:()=>u(h),children:z.jsx("img",{src:HB,alt:"Delete",className:"delete-icon"})})]},f))}):z.jsx("p",{children:"No files uploaded yet."})]})]}):z.jsx("div",{className:"profile-container",children:"Please log in to view your profile."})},GB=()=>z.jsx("div",{className:"hero container",children:z.jsxs("div",{className:"hero-text",children:[z.jsx("h1",{children:"Demistify Legal Documents – Upload, Scan & Verify Instantly"}),z.jsx("p",{children:" Transform the way you handle official documents with our AI-powered document scanner. Simply upload any government document, ask questions in natural language, and get instant, accurate answers. With built-in multi-language translation, the system makes information accessible to everyone, bridging gaps and saving time."}),z.jsx("button",{className:"btn",children:"Learn more"})]})}),qB="/AuthentiDoc/assets/program-1-m9P6QJUB.png",$B="/AuthentiDoc/assets/program-2-DSW_0IDX.png",YB="/AuthentiDoc/assets/program-3-BLYGjM74.png",XB="/AuthentiDoc/assets/program-4-DEOdhSQu.png",KB="/AuthentiDoc/assets/pragram-icon-1-CKPnXbJj.png",WB="/AuthentiDoc/assets/program-icon-2-xrxBF6Sy.png",QB="/AuthentiDoc/assets/program-icon-3-x3jSIxVf.png",JB="/AuthentiDoc/assets/program-icon-4-BZw1DVjS.png",ZB=()=>z.jsx("div",{children:z.jsxs("div",{className:"program-container",children:[z.jsxs("div",{className:"program-card",children:[z.jsx("img",{src:qB,alt:"Power of Attorney"}),z.jsxs("div",{className:"caption",children:[z.jsx("img",{src:KB,alt:"icon"}),z.jsx("p",{children:"POWER OF ATTORNEY"})]})]}),z.jsxs("div",{className:"program-card",children:[z.jsx("img",{src:$B,alt:"Rental Agreement"}),z.jsxs("div",{className:"caption",children:[z.jsx("img",{src:WB,alt:"icon"}),z.jsx("p",{children:"RENTAL AGREEMENT"})]})]}),z.jsxs("div",{className:"program-card",children:[z.jsx("img",{src:YB,alt:"Employment Agreement"}),z.jsxs("div",{className:"caption",children:[z.jsx("img",{src:QB,alt:"icon"}),z.jsx("p",{children:"EMPLOYMENT AGREEMENT"})]})]}),z.jsxs("div",{className:"program-card",children:[z.jsx("img",{src:XB,alt:"Partnership Agreement"}),z.jsxs("div",{className:"caption",children:[z.jsx("img",{src:JB,alt:"icon"}),z.jsx("p",{children:"PARTNERSHIP AGREEMENT"})]})]})]})}),vw=({subTitle:s,title:t})=>z.jsxs("div",{className:"title",children:[z.jsx("p",{children:s}),z.jsx("h2",{children:t})]}),tF="/AuthentiDoc/assets/Gemini_Generated_Image_mjrej0mjrej0mjre-DI4TlcrN.png",eF=()=>z.jsxs("div",{className:"about",children:[z.jsx("div",{className:"about-left",children:z.jsx("img",{src:tF,alt:"About illustration",className:"about-img"})}),z.jsxs("div",{className:"about-right",children:[z.jsx("h3",{children:"ABOUT OUR WEBSITE"}),z.jsx("h2",{children:"Turning Documents into Truth, Knowledge into Power"}),z.jsx("p",{children:"Our AI-powered cloud platform is built to transform the way you handle official documents, making the process smarter, faster, and more reliable. It instantly checks whether a document is real and authentic, validates that the format is correct, and ensures compliance with official standards."}),z.jsx("p",{children:"With integrated multi-language translation, you can convert documents across languages while preserving accuracy and meaning. Beyond simple verification, our intelligent system allows you to ask questions directly about your document, delivering clear, contextual answers that save time and eliminate confusion. Backed by secure cloud infrastructure, every document is processed and stored safely, giving you real-time accessibility, advanced protection against tampering, and complete peace of mind."}),z.jsx("p",{children:"By combining the power of artificial intelligence and cloud technology, we bring you a platform that ensures trust, transparency, and efficiency in every document you manage. Our instant verification system automatically checks whether your document is genuine, ensuring there are no forgeries or invalid copies."})]})]});/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nF=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),iF=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,n)=>n?n.toUpperCase():e.toLowerCase()),bw=s=>{const t=iF(s);return t.charAt(0).toUpperCase()+t.slice(1)},aC=(...s)=>s.filter((t,e,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===e).join(" ").trim(),sF=s=>{for(const t in s)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=st.forwardRef(({color:s="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:l,...u},h)=>st.createElement("svg",{ref:h,...rF,width:t,height:t,stroke:s,strokeWidth:n?Number(e)*24/Number(t):e,className:aC("lucide",i),...!a&&!sF(u)&&{"aria-hidden":"true"},...u},[...l.map(([f,p])=>st.createElement(f,p)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oF=(s,t)=>{const e=st.forwardRef(({className:n,...i},a)=>st.createElement(aF,{ref:a,iconNode:t,className:aC(`lucide-${nF(bw(s))}`,`lucide-${s}`,n),...i}));return e.displayName=bw(s),e};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lF=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],cF=oF("upload",lF),Wn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Dy=[.001,0,0,.001,0,0],Gm=1.35,vi={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},oa={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},oC="pdfjs_internal_editor_",jt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},ne={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},uF={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},xn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},vf={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},nn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Sl={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},mp={ERRORS:0,WARNINGS:1,INFOS:5},$u={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Qd={moveTo:0,lineTo:1,curveTo:2,closePath:3},hF={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let yp=mp.WARNINGS;function dF(s){Number.isInteger(s)&&(yp=s)}function fF(){return yp}function _p(s){yp>=mp.INFOS&&console.log(`Info: ${s}`)}function Gt(s){yp>=mp.WARNINGS&&console.log(`Warning: ${s}`)}function Ee(s){throw new Error(s)}function an(s,t){s||Ee(t)}function pF(s){switch(s?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function lC(s,t=null,e=null){if(!s)return null;if(e&&typeof s=="string"&&(e.addDefaultProtocol&&s.startsWith("www.")&&s.match(/\./g)?.length>=2&&(s=`http://${s}`),e.tryConvertEncoding))try{s=vF(s)}catch{}const n=t?URL.parse(s,t):URL.parse(s);return pF(n)?n:null}function cC(s,t,e=!1){const n=URL.parse(s);return n?(n.hash=t,n.href):e&&lC(s,"http://example.com")?s.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Kt(s,t,e,n=!1){return Object.defineProperty(s,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const Ro=(function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t})();class Ew extends Ro{constructor(t,e){super(t,"PasswordException"),this.code=e}}class qm extends Ro{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Ny extends Ro{constructor(t){super(t,"InvalidPDFException")}}class qf extends Ro{constructor(t,e,n){super(t,"ResponseException"),this.status=e,this.missing=n}}class gF extends Ro{constructor(t){super(t,"FormatError")}}class Aa extends Ro{constructor(t){super(t,"AbortException")}}function uC(s){(typeof s!="object"||s?.length===void 0)&&Ee("Invalid argument for bytesToString");const t=s.length,e=8192;if(t<e)return String.fromCharCode.apply(null,s);const n=[];for(let i=0;i<t;i+=e){const a=Math.min(i+e,t),l=s.subarray(i,a);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function dh(s){typeof s!="string"&&Ee("Invalid argument for stringToBytes");const t=s.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=s.charCodeAt(n)&255;return e}function mF(s){return String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255)}function yF(){const s=new Uint8Array(4);return s[0]=1,new Uint32Array(s.buffer,0,1)[0]===1}function _F(){try{return new Function(""),!0}catch{return!1}}class Pn{static get isLittleEndian(){return Kt(this,"isLittleEndian",yF())}static get isEvalSupported(){return Kt(this,"isEvalSupported",_F())}static get isOffscreenCanvasSupported(){return Kt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Kt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Kt(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Kt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const $m=Array.from(Array(256).keys(),s=>s.toString(16).padStart(2,"0"));class St{static makeHexColor(t,e,n){return`#${$m[t]}${$m[e]}${$m[n]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,n=0){const i=t[n],a=t[n+1];t[n]=i*e[0]+a*e[2]+e[4],t[n+1]=i*e[1]+a*e[3]+e[5]}static applyTransformToBezier(t,e,n=0){const i=e[0],a=e[1],l=e[2],u=e[3],h=e[4],f=e[5];for(let p=0;p<6;p+=2){const y=t[n+p],v=t[n+p+1];t[n+p]=y*i+v*l+h,t[n+p+1]=y*a+v*u+f}}static applyInverseTransform(t,e){const n=t[0],i=t[1],a=e[0]*e[3]-e[1]*e[2];t[0]=(n*e[3]-i*e[2]+e[2]*e[5]-e[4]*e[3])/a,t[1]=(-n*e[1]+i*e[0]+e[4]*e[1]-e[5]*e[0])/a}static axialAlignedBoundingBox(t,e,n){const i=e[0],a=e[1],l=e[2],u=e[3],h=e[4],f=e[5],p=t[0],y=t[1],v=t[2],b=t[3];let T=i*p+h,S=T,I=i*v+h,x=I,k=u*y+f,O=k,G=u*b+f,H=G;if(a!==0||l!==0){const K=a*p,P=a*v,N=l*y,B=l*b;T+=N,x+=N,I+=B,S+=B,k+=K,H+=K,G+=P,O+=P}n[0]=Math.min(n[0],T,I,S,x),n[1]=Math.min(n[1],k,G,O,H),n[2]=Math.max(n[2],T,I,S,x),n[3]=Math.max(n[3],k,G,O,H)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const n=t[0],i=t[1],a=t[2],l=t[3],u=n**2+i**2,h=n*a+i*l,f=a**2+l**2,p=(u+f)/2,y=Math.sqrt(p**2-(u*f-h**2));e[0]=Math.sqrt(p+y||1),e[1]=Math.sqrt(p-y||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>i)return null;const a=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return a>l?null:[n,a,i,l]}static pointBoundingBox(t,e,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}static rectBoundingBox(t,e,n,i,a){a[0]=Math.min(a[0],t,n),a[1]=Math.min(a[1],e,i),a[2]=Math.max(a[2],t,n),a[3]=Math.max(a[3],e,i)}static#t(t,e,n,i,a,l,u,h,f,p){if(f<=0||f>=1)return;const y=1-f,v=f*f,b=v*f,T=y*(y*(y*t+3*f*e)+3*v*n)+b*i,S=y*(y*(y*a+3*f*l)+3*v*u)+b*h;p[0]=Math.min(p[0],T),p[1]=Math.min(p[1],S),p[2]=Math.max(p[2],T),p[3]=Math.max(p[3],S)}static#e(t,e,n,i,a,l,u,h,f,p,y,v){if(Math.abs(f)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,e,n,i,a,l,u,h,-y/p,v);return}const b=p**2-4*y*f;if(b<0)return;const T=Math.sqrt(b),S=2*f;this.#t(t,e,n,i,a,l,u,h,(-p+T)/S,v),this.#t(t,e,n,i,a,l,u,h,(-p-T)/S,v)}static bezierBoundingBox(t,e,n,i,a,l,u,h,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],e,h),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],e,h),this.#e(t,n,a,u,e,i,l,h,3*(-t+3*(n-a)+u),6*(t-2*n+a),3*(n-t),f),this.#e(t,n,a,u,e,i,l,h,3*(-e+3*(i-l)+h),6*(e-2*i+l),3*(i-e),f)}}function vF(s){return decodeURIComponent(escape(s))}let Ym=null,Aw=null;function bF(s){return Ym||(Ym=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Aw=new Map([["ﬅ","ſt"]])),s.replaceAll(Ym,(t,e,n)=>e?e.normalize("NFKC"):Aw.get(n))}function hC(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const s=new Uint8Array(32);return crypto.getRandomValues(s),uC(s)}const W_="pdfjs_internal_id_";function EF(s,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[n,i,...a]=e;if(!s(n)&&!Number.isInteger(n)||!t(i))return!1;const l=a.length;let u=!0;switch(i.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;u=!1;break;default:return!1}for(const h of a)if(!(typeof h=="number"||u&&h===null))return!1;return!0}function Qn(s,t,e){return Math.min(Math.max(s,t),e)}function dC(s){return Uint8Array.prototype.toBase64?s.toBase64():btoa(uC(s))}function AF(s){return Uint8Array.fromBase64?Uint8Array.fromBase64(s):dh(atob(s))}typeof Promise.try!="function"&&(Promise.try=function(s,...t){return new Promise(e=>{e(s(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(s){return s.reduce((t,e)=>t+e,0)});const ur="http://www.w3.org/2000/svg";class Gl{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function fh(s,t="text"){if(bu(s,document.baseURI)){const e=await fetch(s);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const i=new XMLHttpRequest;i.open("GET",s,!0),i.responseType=t,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(i.response);return}e(i.responseText);return}n(new Error(i.statusText))}},i.send(null)})}class ph{constructor({viewBox:t,userUnit:e,scale:n,rotation:i,offsetX:a=0,offsetY:l=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=n,this.rotation=i,this.offsetX=a,this.offsetY=l,n*=e;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let p,y,v,b;switch(i%=360,i<0&&(i+=360),i){case 180:p=-1,y=0,v=0,b=1;break;case 90:p=0,y=1,v=1,b=0;break;case 270:p=0,y=-1,v=-1,b=0;break;case 0:p=1,y=0,v=0,b=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(v=-v,b=-b);let T,S,I,x;p===0?(T=Math.abs(f-t[1])*n+a,S=Math.abs(h-t[0])*n+l,I=(t[3]-t[1])*n,x=(t[2]-t[0])*n):(T=Math.abs(h-t[0])*n+a,S=Math.abs(f-t[1])*n+l,I=(t[2]-t[0])*n,x=(t[3]-t[1])*n),this.transform=[p*n,y*n,v*n,b*n,T-p*n*h-v*n*f,S-y*n*h-b*n*f],this.width=I,this.height=x}get rawDims(){const t=this.viewBox;return Kt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:a=!1}={}){return new ph({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:a})}convertToViewportPoint(t,e){const n=[t,e];return St.applyTransform(n,this.transform),n}convertToViewportRectangle(t){const e=[t[0],t[1]];St.applyTransform(e,this.transform);const n=[t[2],t[3]];return St.applyTransform(n,this.transform),[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){const n=[t,e];return St.applyInverseTransform(n,this.transform),n}}class Q_ extends Ro{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function vp(s){const t=s.length;let e=0;for(;e<t&&s[e].trim()==="";)e++;return s.substring(e,e+5).toLowerCase()==="data:"}function J_(s){return typeof s=="string"&&/\.pdf$/i.test(s)}function wF(s){return[s]=s.split(/[#?]/,1),s.substring(s.lastIndexOf("/")+1)}function TF(s,t="document.pdf"){if(typeof s!="string")return t;if(vp(s))return Gt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(s);if(!n)return t;const i=u=>{try{let h=decodeURIComponent(u);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:u):h}catch{return u}},a=/\.pdf$/i,l=n.pathname.split("/").at(-1);if(a.test(l))return i(l);if(n.searchParams.size>0){const u=Array.from(n.searchParams.values()).reverse();for(const f of u)if(a.test(f))return i(f);const h=Array.from(n.searchParams.keys()).reverse();for(const f of h)if(a.test(f))return i(f)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return i(h[0])}return t}class ww{started=Object.create(null);times=[];time(t){t in this.started&&Gt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Gt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:i,end:a}of this.times)t.push(`${n.padEnd(e)} ${a-i}ms
`);return t.join("")}}function bu(s,t){const e=t?URL.parse(s,t):URL.parse(s);return e?.protocol==="http:"||e?.protocol==="https:"}function zi(s){s.preventDefault()}function rn(s){s.preventDefault(),s.stopPropagation()}function SF(s){console.log("Deprecated API usage: "+s)}class My{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const n=parseInt(e[1],10);let i=parseInt(e[2],10);i=i>=1&&i<=12?i-1:0;let a=parseInt(e[3],10);a=a>=1&&a<=31?a:1;let l=parseInt(e[4],10);l=l>=0&&l<=23?l:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const f=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let y=parseInt(e[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(l+=p,u+=y):f==="+"&&(l-=p,u-=y),new Date(Date.UTC(n,i,a,l,u,h))}}function CF(s,{scale:t=1,rotation:e=0}){const{width:n,height:i}=s.attributes.style,a=[0,0,parseInt(n),parseInt(i)];return new ph({viewBox:a,userUnit:1,scale:t,rotation:e})}function bp(s){if(s.startsWith("#")){const t=parseInt(s.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return s.startsWith("rgb(")?s.slice(4,-1).split(",").map(t=>parseInt(t)):s.startsWith("rgba(")?s.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Gt(`Not a valid color format: "${s}"`),[0,0,0])}function RF(s){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of s.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;s.set(e,bp(n))}t.remove()}function Oe(s){const{a:t,b:e,c:n,d:i,e:a,f:l}=s.getTransform();return[t,e,n,i,a,l]}function bs(s){const{a:t,b:e,c:n,d:i,e:a,f:l}=s.getTransform().invertSelf();return[t,e,n,i,a,l]}function vo(s,t,e=!1,n=!0){if(t instanceof ph){const{pageWidth:i,pageHeight:a}=t.rawDims,{style:l}=s,u=Pn.isCSSRoundSupported,h=`var(--total-scale-factor) * ${i}px`,f=`var(--total-scale-factor) * ${a}px`,p=u?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,y=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(l.width=p,l.height=y):(l.width=y,l.height=p)}n&&s.setAttribute("data-main-rotation",t.rotation)}class Ps{constructor(){const{pixelRatio:t}=Ps;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,n,i,a=-1){let l=1/0,u=1/0,h=1/0;n=Ps.capPixels(n,a),n>0&&(l=Math.sqrt(n/(t*e))),i!==-1&&(u=i/t,h=i/e);const f=Math.min(l,u,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,n):n}return t}}const ky=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Mu{#t=null;#e=null;#n;#i=null;#r=null;#s=null;#a=null;static#o=null;constructor(t){this.#n=t,Mu.#o||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#n._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",zi,{signal:e}),t.addEventListener("pointerdown",Mu.#l,{signal:e}));const n=this.#i=document.createElement("div");n.className="buttons",t.append(n);const i=this.#n.toolbarPosition;if(i){const{style:a}=t,l=this.#n._uiManager.direction==="ltr"?1-i[0]:i[0];a.insetInlineEnd=`${100*l}%`,a.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#c(t){this.#n._focusEventsAllowed=!1,rn(t)}#d(t){this.#n._focusEventsAllowed=!0,rn(t)}#u(t){const e=this.#n._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#c.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",zi,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown(),this.#s?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#n,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",Mu.#o[t]),this.#u(n)&&n.addEventListener("click",i=>{e.delete()},{signal:e._signal}),this.#i.append(n)}get#f(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#u(e),this.#i.append(e,this.#f),this.#r=t}addComment(t){if(this.#s)return;const e=t.render();e&&(this.#u(e),this.#i.append(e,this.#f),this.#s=t,t.toolbar=this)}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#u(e),this.#i.append(e,this.#f)}async addEditSignatureButton(t){const e=this.#a=await t.renderEditButton(this.#n);this.#u(e),this.#i.append(e,this.#f)}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(e);break}}updateEditSignatureButton(t){this.#a&&(this.#a.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class IF{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#n._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",zi,{signal:e});const n=this.#t=document.createElement("div");return n.className="buttons",t.append(n),this.#n.hasCommentManager()&&this.#s("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#s("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#r(t,e){let n=0,i=0;for(const a of t){const l=a.y+a.height;if(l<n)continue;const u=a.x+(e?a.width:0);if(l>n){i=u,n=l;continue}e?u>i&&(i=u):u<i&&(i=u)}return[e?1-i:i,n]}show(t,e,n){const[i,a]=this.#r(e,n),{style:l}=this.#e||=this.#i();t.append(this.#e),l.insetInlineEnd=`${100*i}%`,l.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#s(t,e,n,i){const a=document.createElement("button");a.classList.add("basic",t),a.tabIndex=0,a.setAttribute("data-l10n-id",e);const l=document.createElement("span");a.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",n);const u=this.#n._signal;u instanceof AbortSignal&&!u.aborted&&(a.addEventListener("contextmenu",zi,{signal:u}),a.addEventListener("click",i,{signal:u})),this.#t.append(a)}}function fC(s,t,e){for(const n of e)t.addEventListener(n,s[n].bind(s))}class xF{#t=0;get id(){return`${oC}${this.#t++}`}}class Z_{#t=hC();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=t;const a=i.decode().then(()=>(n.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Kt(this,"_isSVGFittingCanvas",a)}async#i(t,e){this.#n||=new Map;let n=this.#n.get(t);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let i;if(typeof e=="string"?(n.url=e,i=await fh(e,"blob")):e instanceof File?i=n.file=e:e instanceof Blob&&(i=e),i.type==="image/svg+xml"){const a=Z_._isSVGFittingCanvas,l=new FileReader,u=new Image,h=new Promise((f,p)=>{u.onload=()=>{n.bitmap=u,n.isSvg=!0,f()},l.onload=async()=>{const y=n.svgUrl=l.result;u.src=await a?`${y}#svgView(preserveAspectRatio(none))`:y},u.onerror=l.onerror=p});l.readAsDataURL(i),await h}else n.bitmap=await createImageBitmap(i);n.refCounter=1}catch(i){Gt(i),n=null}return this.#n.set(t,n),n&&this.#n.set(n.id,n),n}async getFromFile(t){const{lastModified:e,name:n,size:i,type:a}=t;return this.#i(`${e}_${n}_${i}_${a}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,e){const n=await e;return this.#i(t,n)}async getFromId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#n||=new Map;let n=this.#n.get(t);if(n?.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(e.width,e.height);return i.getContext("2d").drawImage(e,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,n),this.#n.set(n.id,n),n}getSvgUrl(t){const e=this.#n.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const i=new OffscreenCanvas(n.width,n.height);i.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=i.convertToBlob()}n.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class DF{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:e,post:n,mustExec:i,type:a=NaN,overwriteIfSameType:l=!1,keepUndo:u=!1}){if(i&&t(),this.#e)return;const h={cmd:t,undo:e,post:n,type:a};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(h);return}if(l&&this.#t[this.#i].type===a){u&&(h.undo=this.#t[this.#i].undo),this.#t[this.#i]=h;return}const f=this.#i+1;f===this.#n?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(h)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let e=this.#i;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#i-e),this.#i=e;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class gh{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Pn.platform;for(const[n,i,a={}]of t)for(const l of n){const u=l.startsWith("mac+");e&&u?(this.callbacks.set(l.slice(4),{callback:i,options:a}),this.allKeys.add(l.split("+").at(-1))):!e&&!u&&(this.callbacks.set(l,{callback:i,options:a}),this.allKeys.add(l.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(this.#t(e));if(!n)return;const{callback:i,options:{bubbles:a=!1,args:l=[],checker:u=null}}=n;u&&!u(t,e)||(i.bind(t,...l,e)(),a||rn(e))}}class tv{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return RF(t),Kt(this,"_colors",t)}convert(t){const e=bp(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,i]of this._colors)if(i.every((a,l)=>a===e[l]))return tv._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?St.makeHexColor(...e):t}}class wa{#t=new AbortController;#e=null;#n=null;#i=new Map;#r=new Map;#s=null;#a=null;#o=null;#l=new DF;#c=null;#d=null;#u=null;#f=0;#g=new Set;#p=null;#h=null;#m=new Set;_editorUndoBar=null;#v=!1;#y=!1;#E=!1;#A=null;#_=null;#w=null;#I=null;#C=!1;#T=null;#M=new xF;#R=!1;#x=!1;#O=!1;#k=null;#P=null;#L=null;#N=null;#U=null;#S=jt.NONE;#b=new Set;#V=null;#j=null;#z=null;#X=null;#$=null;#Y={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#B=[0,0];#G=null;#q=null;#J=null;#Z=null;#F=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=wa.prototype,e=l=>l.#q.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},i=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Kt(this,"_keyboardManager",new gh([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#q.contains(u)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#q.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}]]))}constructor(t,e,n,i,a,l,u,h,f,p,y,v,b,T,S,I){const x=this._signal=this.#t.signal;this.#q=t,this.#J=e,this.#Z=n,this.#s=i,this.#c=a,this.#j=l,this.#$=h,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:x}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:x}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:x}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:x}),u._on("setpreference",this.onSetPreference.bind(this),{signal:x}),u._on("switchannotationeditorparams",k=>this.updateParams(k.type,k.value),{signal:x}),window.addEventListener("pointerdown",()=>{this.#x=!0},{capture:!0,signal:x}),window.addEventListener("pointerup",()=>{this.#x=!1},{capture:!0,signal:x}),this.#lt(),this.#dt(),this.#et(),this.#a=h.annotationStorage,this.#A=h.filterFactory,this.#z=f,this.#I=p||null,this.#v=y,this.#y=v,this.#E=b,this.#U=T||null,this.viewParameters={realScale:Gl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=S||null,this._supportsPinchToZoom=I!==!1}destroy(){this.#F?.resolve(),this.#F=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#r.values())t.destroy();this.#r.clear(),this.#i.clear(),this.#m.clear(),this.#N?.clear(),this.#e=null,this.#b.clear(),this.#l.destroy(),this.#s?.destroy(),this.#c?.destroy(),this.#j?.destroy(),this.#T?.hide(),this.#T=null,this.#L?.destroy(),this.#L=null,this.#n=null,this.#_&&(clearTimeout(this.#_),this.#_=null),this.#G&&(clearTimeout(this.#G),this.#G=null),this._editorUndoBar?.destroy(),this.#$=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#U}get useNewAltTextFlow(){return this.#y}get useNewAltTextWhenAddingImage(){return this.#E}get hcmFilter(){return Kt(this,"hcmFilter",this.#z?this.#A.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return Kt(this,"direction",getComputedStyle(this.#q).direction)}get _highlightColors(){return Kt(this,"_highlightColors",this.#I?new Map(this.#I.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Kt(this,"highlightColors",null);const e=new Map,n=!!this.#z;for(const[i,a]of t){const l=i.endsWith("_HCM");if(n&&l){e.set(i.replace("_HCM",""),a);continue}!n&&!l&&e.set(i,a)}return Kt(this,"highlightColors",e)}get highlightColorNames(){return Kt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#u=t}setMainHighlightColorPicker(t){this.#L=t}editAltText(t,e=!1){this.#s?.editAltText(this,t,e)}hasCommentManager(){return!!this.#c}editComment(t,e){this.#c?.open(this,t,e)}getSignature(t){this.#j?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#j}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#E=e;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#q.focus()}findParent(t,e){for(const n of this.#r.values()){const{x:i,y:a,width:l,height:u}=n.div.getBoundingClientRect();if(t>=i&&t<=i+l&&e>=a&&e<=a+u)return n}return null}disableUserSelect(t=!1){this.#J.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#m.add(t)}removeShouldRescale(t){this.#m.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Gl.PDF_TO_CSS_UNITS;for(const e of this.#m)e.onScaleChanging();this.#u?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of this.#r.values())if(n.hasTextLayer(t))return n;return null}highlightSelection(t="",e=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:i,anchorOffset:a,focusNode:l,focusOffset:u}=n,h=n.toString(),p=this.#Q(n).closest(".textLayer"),y=this.getSelectionBoxes(p);if(!y)return;n.empty();const v=this.#tt(p),b=this.#S===jt.NONE,T=()=>{const S=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:i,anchorOffset:a,focusNode:l,focusOffset:u,text:h});b&&this.showAllEditors("highlight",!0,!0),e&&S?.editComment()};if(b){this.switchToMode(jt.HIGHLIGHT,T);return}T()}commentSelection(t=""){this.highlightSelection(t,!0)}#at(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=this.#Q(t).closest(".textLayer"),i=this.getSelectionBoxes(n);i&&(this.#T||=new IF(this),this.#T.show(n,i,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#a&&!this.#a.has(t.id)&&this.#a.setValue(t.id,t)}a11yAlert(t,e=null){const n=this.#Z;n&&(n.setAttribute("data-l10n-id",t),e?n.setAttribute("data-l10n-args",JSON.stringify(e)):n.removeAttribute("data-l10n-args"))}#ot(){const t=document.getSelection();if(!t||t.isCollapsed){this.#V&&(this.#T?.hide(),this.#V=null,this.#D({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#V)return;const i=this.#Q(t).closest(".textLayer");if(!i){this.#V&&(this.#T?.hide(),this.#V=null,this.#D({hasSelectedText:!1}));return}if(this.#T?.hide(),this.#V=e,this.#D({hasSelectedText:!0}),!(this.#S!==jt.HIGHLIGHT&&this.#S!==jt.NONE)&&(this.#S===jt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#C=this.isShiftKeyDown,!this.isShiftKeyDown)){const a=this.#S===jt.HIGHLIGHT?this.#tt(i):null;if(a?.toggleDrawing(),this.#x){const l=new AbortController,u=this.combinedSignal(l),h=f=>{f.type==="pointerup"&&f.button!==0||(l.abort(),a?.toggleDrawing(!0),f.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}else a?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#S===jt.HIGHLIGHT?this.highlightSelection(t):this.#v&&this.#at()}#lt(){document.addEventListener("selectionchange",this.#ot.bind(this),{signal:this._signal})}#ct(){if(this.#w)return;this.#w=new AbortController;const t=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ut(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#C&&(this.#C=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#b)if(e.div.contains(t)){this.#P=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#P)return;const[t,e]=this.#P;this.#P=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#k)return;this.#k=new AbortController;const t=this.combinedSignal(this.#k);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ht(){this.#k?.abort(),this.#k=null}#nt(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#it(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.#nt()}removeEditListeners(){this.#ht(),this.#it()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of this.#h)if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of this.#h)if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const n of this.#b){const i=n.serialize(!0);i&&e.push(i)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const a of e.items)for(const l of this.#h)if(l.isHandlingMimeForPasting(a.type)){l.paste(a,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(a){Gt(`paste: "${a.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const a=[];for(const h of n){const f=await i.deserialize(h);if(!f)return;a.push(f)}const l=()=>{for(const h of a)this.#st(h);this.#rt(a)},u=()=>{for(const h of a)h.remove()};this.addCommands({cmd:l,undo:u,mustExec:!0})}catch(a){Gt(`paste: "${a.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#S!==jt.NONE&&!this.isEditorHandlingKeyboard&&wa._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#C&&(this.#C=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#D(t){Object.entries(t).some(([n,i])=>this.#Y[n]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#Y,t)}),this.#S===jt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#H([[ne.HIGHLIGHT_FREE,!0]]))}#H(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ct(),this.#nt(),this.#D({isEditing:this.#S!==jt.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:this.#l.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ut(),this.#it(),this.#D({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#h){this.#h=t;for(const e of this.#h)this.#H(e.defaultPropertiesToUpdate)}}getId(){return this.#M.id}get currentLayer(){return this.#r.get(this.#f)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#r.set(t.pageIndex,t),this.#R?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,e=null,n=!1,i=!1,a=!1){if(this.#S!==t&&!(this.#F&&(await this.#F.promise,!this.#F))){if(this.#F=Promise.withResolvers(),this.#u?.commitOrRemove(),this.#S===jt.POPUP&&this.#c?.hideSidebar(),this.#S=t,t===jt.NONE){this.setEditingState(!1),this.#pt(),this._editorUndoBar?.hide(),this.#F.resolve();return}t===jt.SIGNATURE&&await this.#j?.loadSignatures(),t===jt.POPUP&&(this.#n||=await this.#$.getAnnotationsByType(new Set(this.#h.map(l=>l._editorType))),this.#c?.showSidebar(this.#n)),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const l of this.#r.values())l.updateMode(t);if(!e){n&&this.addNewEditorFromKeyboard(),this.#F.resolve();return}for(const l of this.#i.values())l.annotationElementId===e||l.id===e?(this.setSelected(l),a?l.editComment():i&&l.enterInEditMode()):l.unselect();this.#F.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#S&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#h){switch(t){case ne.CREATE:this.currentLayer.addNewEditor(e);return;case ne.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#X||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const n of this.#b)n.updateParams(t,e);else for(const n of this.#h)n.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){for(const a of this.#i.values())a.editorType===t&&a.show(e);(this.#X?.get(ne.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#H([[ne.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#O!==t){this.#O=t;for(const e of this.#r.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#R){this.#R=!0;const t=[];for(const e of this.#r.values())t.push(e.enable());await Promise.all(t);for(const e of this.#i.values())e.enable()}}#pt(){if(this.unselectAll(),this.#R){this.#R=!1;for(const t of this.#r.values())t.disable();for(const t of this.#i.values())t.disable()}}getEditors(t){const e=[];for(const n of this.#i.values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#_&&clearTimeout(this.#_),this.#_=setTimeout(()=>{this.focusMainContainer(),this.#_=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#N?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#g.has(t.annotationElementId))&&this.#a?.remove(t.id)}addDeletedAnnotationElement(t){this.#g.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#g.has(t)}removeDeletedAnnotationElement(t){this.#g.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#st(t){const e=this.#r.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#H(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#b);return t}updateUI(t){this.#gt===t&&this.#H(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#H(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#b.has(t)){this.#b.delete(t),t.unselect(),this.#D({hasSelectedEditor:this.hasSelection});return}this.#b.add(t),t.select(),this.#H(t.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),this.#u?.commitOrRemove();for(const e of this.#b)e!==t&&e.unselect();this.#b.clear(),this.#b.add(t),t.select(),this.#H(t.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}isSelected(t){return this.#b.has(t)}get firstSelectedEditor(){return this.#b.values().next().value}unselect(t){t.unselect(),this.#b.delete(t),this.#D({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#b.size!==0}get isEnterHandled(){return this.#b.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#l.undo(),this.#D({hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#l.redo(),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:this.#l.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(t){this.#l.add(t),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(t){this.#l.cleanType(t)}#W(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#b],n=()=>{this._editorUndoBar?.show(i,e.length===1?e[0].editorType:e.length);for(const a of e)a.remove()},i=()=>{for(const a of e)this.#st(a)};this.addCommands({cmd:n,undo:i,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#rt(t){for(const e of this.#b)e.unselect();this.#b.clear();for(const e of t)e.isEmpty()||(this.#b.add(e),e.select());this.#D({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#b)t.commit();this.#rt(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#S!==jt.NONE))&&!this.#u?.commitOrRemove()&&this.hasSelection){for(const t of this.#b)t.unselect();this.#b.clear(),this.#D({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#B[0]+=t,this.#B[1]+=e;const[i,a]=this.#B,l=[...this.#b],u=1e3;this.#G&&clearTimeout(this.#G),this.#G=setTimeout(()=>{this.#G=null,this.#B[0]=this.#B[1]=0,this.addCommands({cmd:()=>{for(const h of l)this.#i.has(h.id)&&(h.translateInPage(i,a),h.translationDone())},undo:()=>{for(const h of l)this.#i.has(h.id)&&(h.translateInPage(-i,-a),h.translationDone())},mustExec:!1})},u);for(const h of l)h.translateInPage(t,e),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const t of this.#b)this.#p.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const t=this.#p;this.#p=null;let e=!1;for(const[{x:i,y:a,pageIndex:l},u]of t)u.newX=i,u.newY=a,u.newPageIndex=l,e||=i!==u.savedX||a!==u.savedY||l!==u.savedPageIndex;if(!e)return!1;const n=(i,a,l,u)=>{if(this.#i.has(i.id)){const h=this.#r.get(u);h?i._setParentAndPosition(h,a,l):(i.pageIndex=u,i.x=a,i.y=l)}};return this.addCommands({cmd:()=>{for(const[i,{newX:a,newY:l,newPageIndex:u}]of t)n(i,a,l,u)},undo:()=>{for(const[i,{savedX:a,savedY:l,savedPageIndex:u}]of t)n(i,a,l,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#p)for(const n of this.#p.keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#b.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#S}get imageManager(){return Kt(this,"imageManager",new Z_)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,p=e.rangeCount;f<p;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:n,y:i,width:a,height:l}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,p,y,v)=>({x:(p-i)/l,y:1-(f+y-n)/a,width:v/l,height:y/a});break;case"180":u=(f,p,y,v)=>({x:1-(f+y-n)/a,y:1-(p+v-i)/l,width:y/a,height:v/l});break;case"270":u=(f,p,y,v)=>({x:1-(p+v-i)/l,y:(f-n)/a,width:v/l,height:y/a});break;default:u=(f,p,y,v)=>({x:(f-n)/a,y:(p-i)/l,width:y/a,height:v/l});break}const h=[];for(let f=0,p=e.rangeCount;f<p;f++){const y=e.getRangeAt(f);if(!y.collapsed)for(const{x:v,y:b,width:T,height:S}of y.getClientRects())T===0||S===0||h.push(u(v,b,T,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const n=this.#a.getRawValue(e);n&&(this.#S===jt.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}setMissingCanvas(t,e,n){const i=this.#N?.get(t);i&&(i.setCanvas(e,n),this.#N.delete(t))}addMissingCanvas(t,e){(this.#N||=new Map).set(t,e)}}class Ts{#t=null;#e=!1;#n=null;#i=null;#r=null;#s=null;#a=!1;#o=null;#l=null;#c=null;#d=null;#u=!1;static#f=null;static _l10n=null;constructor(t){this.#l=t,this.#u=t._uiManager.useNewAltTextFlow,Ts.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Ts._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#i=document.createElement("span");t.append(e),this.#u?(t.classList.add("new"),t.setAttribute("data-l10n-id",Ts.#f.missing),e.setAttribute("data-l10n-id",Ts.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#l._uiManager._signal;t.addEventListener("contextmenu",zi,{signal:n}),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const i=a=>{a.preventDefault(),this.#l._uiManager.editAltText(this.#l),this.#u&&this.#l._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return t.addEventListener("click",i,{capture:!0,signal:n}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#a=!0,i(a))},{signal:n}),await this.#p(),t}get#g(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#a}),this.#a=!1)}isEmpty(){return this.#u?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#u?this.#t!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(t){this.#t===null&&(this.#c=t,this.#d=await Ts._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#u||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#l.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#c===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#c,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:i,cancel:a=!1}){n&&(this.#c=n,this.#d=i),!(this.#t===t&&this.#e===e)&&(a||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#n&&(!t&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#n.disabled=!t)}shown(){this.#l._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#r=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#n;if(!t)return;if(this.#u){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Ts.#f[this.#g]),this.#i?.setAttribute("data-l10n-id",Ts.#f[`${this.#g}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#r;if(!e){this.#r=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#l.id}`;const i=100,a=this.#l._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#r.classList.add("show"),this.#l._reportTelemetry({action:"alt_text_tooltip"})},i)},{signal:a}),t.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#r?.classList.remove("show")},{signal:a})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#l.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class Jd{#t=null;#e=!1;#n=null;#i=null;#r=null;#s=null;#a=!1;constructor(t){this.#n=t,this.toolbar=null}render(){if(!this.#n._uiManager.hasCommentManager())return null;const t=this.#t=document.createElement("button");t.className="comment",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button");const e=this.#n._uiManager._signal;if(!(e instanceof AbortSignal)||e.aborted)return t;t.addEventListener("contextmenu",zi,{signal:e}),t.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:e});const n=i=>{i.preventDefault(),this.edit()};return t.addEventListener("click",n,{capture:!0,signal:e}),t.addEventListener("keydown",i=>{i.target===t&&i.key==="Enter"&&(this.#e=!0,n(i))},{signal:e}),t}edit(){const{bottom:t,left:e,right:n}=this.#n.getClientDimensions(),i={top:t};this.#n._uiManager.direction==="ltr"?i.right=n:i.left=e,this.#n._uiManager.editComment(this.#n,i)}finish(){this.#t&&(this.#t.focus({focusVisible:this.#e}),this.#e=!1)}isDeleted(){return this.#a||this.#r===""}hasBeenEdited(){return this.isDeleted()||this.#r!==this.#i}serialize(){return this.data}get data(){return{text:this.#r,date:this.#s,deleted:this.#a}}set data(t){if(t===null){this.#r="",this.#a=!0;return}this.#r=t,this.#s=new Date,this.#a=!1}setInitialText(t){this.#i=t,this.data=t}toggle(t=!1){this.#t&&(this.#t.disabled=!t)}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#r="",this.#s=null,this.#n=null,this.#e=!1,this.#a=!1}}class Ep{#t;#e=!1;#n=null;#i;#r;#s;#a;#o=null;#l;#c=null;#d;#u=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:i=null,onPinching:a=null,onPinchEnd:l=null,signal:u}){this.#t=t,this.#n=n,this.#i=e,this.#r=i,this.#s=a,this.#a=l,this.#d=new AbortController,this.#l=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#l})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ps.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const i=this.#o=new AbortController,a=AbortSignal.any([this.#l,i.signal]),l=this.#t,u={capture:!0,signal:a,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};l.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(rn(f),h(f))},u),l.addEventListener("pointerup",h,u),l.addEventListener("pointercancel",h,u);return}if(!this.#u){this.#u=new AbortController;const i=AbortSignal.any([this.#l,this.#u.signal]),a=this.#t,l={signal:i,capture:!1,passive:!1};a.addEventListener("touchmove",this.#g.bind(this),l);const u=this.#p.bind(this);a.addEventListener("touchend",u,l),a.addEventListener("touchcancel",u,l),l.capture=!0,a.addEventListener("pointerdown",rn,l),a.addEventListener("pointermove",rn,l),a.addEventListener("pointercancel",rn,l),a.addEventListener("pointerup",rn,l),this.#r?.()}if(rn(t),t.touches.length!==2||this.#n?.()){this.#c=null;return}let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]),this.#c={touch0X:e.screenX,touch0Y:e.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#g(t){if(!this.#c||t.touches.length!==2)return;rn(t);let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]);const{screenX:i,screenY:a}=e,{screenX:l,screenY:u}=n,h=this.#c,{touch0X:f,touch0Y:p,touch1X:y,touch1Y:v}=h,b=y-f,T=v-p,S=l-i,I=u-a,x=Math.hypot(S,I)||1,k=Math.hypot(b,T)||1;if(!this.#e&&Math.abs(k-x)<=Ep.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=i,h.touch0Y=a,h.touch1X=l,h.touch1Y=u,!this.#e){this.#e=!0;return}const O=[(i+l)/2,(a+u)/2];this.#s?.(O,k,x)}#p(t){t.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#a?.()),this.#c&&(rn(t),this.#c=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class kt{#t=null;#e=null;#n=null;#i=null;#r=!1;#s=null;#a="";#o=!1;#l=null;#c=null;#d=null;#u=null;#f="";#g=!1;#p=null;#h=!1;#m=!1;#v=!1;#y=null;#E=0;#A=0;#_=null;#w=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#I=!1;#C=kt._zIndex++;static _borderLineWidth=-1;static _colorManager=new tv;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=kt.prototype._resizeWithKeyboard,e=wa.TRANSLATE_SMALL,n=wa.TRANSLATE_BIG;return Kt(this,"_resizerKeyboardManager",new gh([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],kt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:i,pageX:a,pageY:l}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[a,l];const[u,h]=this.parentDimensions;this.x=t.x/u,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Kt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new NF({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(kt._l10n??=t,kt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),kt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);kt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Ee("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#I}set _isDraggable(t){this.#I=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#C}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#B(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,i){const[a,l]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(t+n)/a,this.y=(e+i)/l,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[n,i]=this.parentDimensions;this.setAt(t*n,e*i,this.width*n,this.height*i),this._onTranslated()}#T([t,e],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/t,this.y+=i/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#T(this.parentDimensions,t,e)}translateInPage(t,e){this.#p||=[this.x,this.y,this.width,this.height],this.#T(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#p||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[i,a]}=this;if(this.x+=t/i,this.y+=e/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:u}=this;const[h,f]=this.getBaseTranslation();l+=h,u+=f;const{style:p}=n;p.left=`${(100*l).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(l,u),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#p&&(this.#p[0]!==this.x||this.#p[1]!==this.y)}get _hasBeenResized(){return!!this.#p&&(this.#p[2]!==this.width||this.#p[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=kt,i=n/t,a=n/e;switch(this.rotation){case 90:return[-i,a];case 180:return[i,a];case 270:return[i,-a];default:return[-i,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[n,i]}=this;let{x:a,y:l,width:u,height:h}=this;if(u*=n,h*=i,a*=n,l*=i,this._mustFixPosition)switch(t){case 0:a=Qn(a,0,n-u),l=Qn(l,0,i-h);break;case 90:a=Qn(a,0,n-h),l=Qn(l,u,i);break;case 180:a=Qn(a,u,n),l=Qn(l,h,i);break;case 270:a=Qn(a,h,n),l=Qn(l,0,i-u);break}this.x=a/=n,this.y=l/=i;const[f,p]=this.getBaseTranslation();a+=f,l+=p,e.left=`${(100*a).toFixed(2)}%`,e.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#M(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return kt.#M(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return kt.#M(t,e,360-this.parentRotation)}#R(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,i]=this.parentDimensions,{style:a}=this.div;a.width=`${(100*t/n).toFixed(2)}%`,this.#o||(a.height=`${(100*e/i).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,i=n.endsWith("%"),a=!this.#o&&e.endsWith("%");if(i&&a)return;const[l,u]=this.parentDimensions;i||(t.width=`${(100*parseFloat(n)/l).toFixed(2)}%`),!this.#o&&!a&&(t.height=`${(100*parseFloat(e)/u).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#x(){if(this.#l)return;this.#l=document.createElement("div"),this.#l.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const i=document.createElement("div");this.#l.append(i),i.classList.add("resizer",n),i.setAttribute("data-resizer-name",n),i.addEventListener("pointerdown",this.#O.bind(this,n),{signal:e}),i.addEventListener("contextmenu",zi,{signal:e}),i.tabIndex=-1}this.div.prepend(this.#l)}#O(t,e){e.preventDefault();const{isMac:n}=Pn.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#n?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,this.#c=[e.screenX,e.screenY];const a=new AbortController,l=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#L.bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",rn,{passive:!1,signal:l}),window.addEventListener("contextmenu",zi,{signal:l}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{a.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#P()};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})}#k(t,e,n,i){this.width=n,this.height=i,this.x=t,this.y=e;const[a,l]=this.parentDimensions;this.setDims(a*n,l*i),this.fixAndSetPosition(),this._onResized()}_onResized(){}#P(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:i}=this.#d;this.#d=null;const a=this.x,l=this.y,u=this.width,h=this.height;a===t&&l===e&&u===n&&h===i||this.addCommands({cmd:this.#k.bind(this,a,l,u,h),undo:this.#k.bind(this,t,e,n,i),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#L(t,e){const[n,i]=this.parentDimensions,a=this.x,l=this.y,u=this.width,h=this.height,f=kt.MIN_SIZE/n,p=kt.MIN_SIZE/i,y=this.#R(this.rotation),v=(J,ct)=>[y[0]*J+y[2]*ct,y[1]*J+y[3]*ct],b=this.#R(360-this.rotation),T=(J,ct)=>[b[0]*J+b[2]*ct,b[1]*J+b[3]*ct];let S,I,x=!1,k=!1;switch(t){case"topLeft":x=!0,S=(J,ct)=>[0,0],I=(J,ct)=>[J,ct];break;case"topMiddle":S=(J,ct)=>[J/2,0],I=(J,ct)=>[J/2,ct];break;case"topRight":x=!0,S=(J,ct)=>[J,0],I=(J,ct)=>[0,ct];break;case"middleRight":k=!0,S=(J,ct)=>[J,ct/2],I=(J,ct)=>[0,ct/2];break;case"bottomRight":x=!0,S=(J,ct)=>[J,ct],I=(J,ct)=>[0,0];break;case"bottomMiddle":S=(J,ct)=>[J/2,ct],I=(J,ct)=>[J/2,0];break;case"bottomLeft":x=!0,S=(J,ct)=>[0,ct],I=(J,ct)=>[J,0];break;case"middleLeft":k=!0,S=(J,ct)=>[0,ct/2],I=(J,ct)=>[J,ct/2];break}const O=S(u,h),G=I(u,h);let H=v(...G);const K=kt._round(a+H[0]),P=kt._round(l+H[1]);let N=1,B=1,j,V;if(e.fromKeyboard)({deltaX:j,deltaY:V}=e);else{const{screenX:J,screenY:ct}=e,[mt,Mt]=this.#c;[j,V]=this.screenToPageTranslation(J-mt,ct-Mt),this.#c[0]=J,this.#c[1]=ct}if([j,V]=T(j/n,V/i),x){const J=Math.hypot(u,h);N=B=Math.max(Math.min(Math.hypot(G[0]-O[0]-j,G[1]-O[1]-V)/J,1/u,1/h),f/u,p/h)}else k?N=Qn(Math.abs(G[0]-O[0]-j),f,1)/u:B=Qn(Math.abs(G[1]-O[1]-V),p,1)/h;const Y=kt._round(u*N),U=kt._round(h*B);H=v(...I(Y,U));const Nt=K-H[0],Dt=P-H[1];this.#p||=[this.x,this.y,this.width,this.height],this.width=Y,this.height=U,this.x=Nt,this.y=Dt,this.setDims(n*Y,i*U),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#m)return this._editToolbar;this._editToolbar=new Mu(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,n]of t)await this._editToolbar.addButton(e,n);return this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(Ts.initialize(kt._l10n),this.#n=new Ts(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}addCommentButton(){return this.#i?this.#i:this.#i=new Jd(this)}get commentColor(){return null}get comment(){const t=this.#i;return{text:t.data.text,date:t.data.date,deleted:t.isDeleted(),color:this.commentColor}}set comment(t){this.#i||(this.#i=new Jd(this)),this.#i.data=t}setCommentData(t){this.#i||(this.#i=new Jd(this)),this.#i.setInitialText(t)}get hasEditedComment(){return this.#i?.hasBeenEdited()}async editComment(){this.#i||(this.#i=new Jd(this)),this.#i.edit()}addComment(t){if(this.hasEditedComment){const[,,,i]=t.rect,[a]=this.pageDimensions,[l]=this.pageTranslation,u=l+a+1,h=i-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,h,f,i]}}}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#r?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#j();const[e,n]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*n/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/n).toFixed(2)}%`);const[i,a]=this.getInitialTranslation();return this.translate(i,a),fC(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#w||=new Ep({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#N.bind(this),onPinching:this.#U.bind(this),onPinchEnd:this.#S.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),t}#N(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#U(t,e,n){let a=.7*(n/e)+1-.7;if(a===1)return;const l=this.#R(this.rotation),u=(K,P)=>[l[0]*K+l[2]*P,l[1]*K+l[3]*P],[h,f]=this.parentDimensions,p=this.x,y=this.y,v=this.width,b=this.height,T=kt.MIN_SIZE/h,S=kt.MIN_SIZE/f;a=Math.max(Math.min(a,1/v,1/b),T/v,S/b);const I=kt._round(v*a),x=kt._round(b*a);if(I===v&&x===b)return;this.#p||=[p,y,v,b];const k=u(v/2,b/2),O=kt._round(p+k[0]),G=kt._round(y+k[1]),H=u(I/2,x/2);this.x=O-H[0],this.y=G-H[1],this.width=I,this.height=x,this.setDims(h*I,f*x),this.fixAndSetPosition(),this._onResizing()}#S(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#P()}pointerdown(t){const{isMac:e}=Pn.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#V(t);return}this.#b(t)}#b(t){const{isMac:e}=Pn.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#V(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,a=this._uiManager.combinedSignal(i),l={capture:!0,passive:!1,signal:a},u=f=>{i.abort(),this.#s=null,this.#g=!1,this._uiManager.endDragSession()||this.#b(f),n&&this._onStopDragging()};e&&(this.#E=t.clientX,this.#A=t.clientY,this.#s=t.pointerId,this.#a=t.pointerType,window.addEventListener("pointermove",f=>{n||(n=!0,this._onStartDragging());const{clientX:p,clientY:y,pointerId:v}=f;if(v!==this.#s){rn(f);return}const[b,T]=this.screenToPageTranslation(p-this.#E,y-this.#A);this.#E=p,this.#A=y,this._uiManager.dragSelectedEditors(b,T)},l),window.addEventListener("touchmove",rn,l),window.addEventListener("pointerdown",f=>{f.pointerType===this.#a&&(this.#w||f.isPrimary)&&u(f),rn(f)},l));const h=f=>{if(!this.#s||this.#s===f.pointerId){u(f);return}rn(f)};window.addEventListener("pointerup",h,{signal:a}),window.addEventListener("blur",h,{signal:a})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,n=this.rotation){const i=this.parentScale,[a,l]=this.pageDimensions,[u,h]=this.pageTranslation,f=t/i,p=e/i,y=this.x*a,v=this.y*l,b=this.width*a,T=this.height*l;switch(n){case 0:return[y+f+u,l-v-p-T+h,y+f+b+u,l-v-p+h];case 90:return[y+p+u,l-v+f+h,y+p+T+u,l-v+f+b+h];case 180:return[y-f-b+u,l-v+p+h,y-f+u,l-v+p+T+h];case 270:return[y-p-T+u,l-v-f-b+h,y-p+u,l-v-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,i,a,l]=t,u=a-n,h=l-i;switch(this.rotation){case 0:return[n,e-l,u,h];case 90:return[n,e-i,h,u];case 180:return[a,e-i,u,h];case 270:return[a,e-l,h,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#m=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#m=!1,!0):!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:a,innerWidth:l}=window;return e<l&&i>0&&t<a&&n>0}#j(){if(this.#u||!this.div)return;this.#u=new AbortController;const t=this._uiManager.combinedSignal(this.#u);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#j()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){Ee("An editor must be serializable")}static async deserialize(t,e,n){const i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n,annotationElementId:t.annotationElementId});i.rotation=t.rotation,i.#t=t.accessibilityData,i._isCopy=t.isCopy||!1;const[a,l]=i.pageDimensions,[u,h,f,p]=i.getRectInCurrentCoords(t.rect,l);return i.x=u/a,i.y=h/l,i.width=f/a,i.height=p/l,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#u?.abort(),this.#u=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#B(),this.removeEditToolbar(),this.#_){for(const t of this.#_.values())clearTimeout(t);this.#_=null}this.parent=null,this.#w?.destroy(),this.#w=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#x(),this.#l.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#l.children;if(!this.#e){this.#e=Array.from(e);const l=this.#z.bind(this),u=this.#X.bind(this),h=this._uiManager._signal;for(const f of this.#e){const p=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:h}),f.addEventListener("blur",u,{signal:h}),f.addEventListener("focus",this.#$.bind(this,p),{signal:h}),f.setAttribute("data-l10n-id",kt._l10nResizer[p])}}const n=this.#e[0];let i=0;for(const l of e){if(l===n)break;i++}const a=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(a!==i){if(a<i)for(let u=0;u<i-a;u++)this.#l.append(this.#l.firstChild);else if(a>i)for(let u=0;u<a-i;u++)this.#l.firstChild.before(this.#l.lastChild);let l=0;for(const u of e){const f=this.#e[l++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",kt._l10nResizer[f])}}this.#Y(0),this.#v=!0,this.#l.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#z(t){kt._resizerKeyboardManager.exec(this,t)}#X(t){this.#v&&t.relatedTarget?.parentNode!==this.#l&&this.#B()}#$(t){this.#f=this.#v?t:""}#Y(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#v&&this.#L(this.#f,{deltaX:t,deltaY:e,fromKeyboard:!0})}#B(){this.#v=!1,this.#Y(-1),this.#P()}_stopResizingWithKeyboard(){this.#B(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#l?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#h}set isEditing(t){this.#h=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#o=!0;const n=t/e,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#_||=new Map;const{action:n}=t;let i=this.#_.get(n);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(t),this.#_.delete(n),this.#_.size===0&&(this.#_=null)},kt._telemetryTimeout),this.#_.set(n,i);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class NF extends kt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Tw=3285377520,Li=4294901760,Es=65535;class pC{constructor(t){this.h1=t?t&4294967295:Tw,this.h2=t?t&4294967295:Tw}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let S=0,I=t.length;S<I;S++){const x=t.charCodeAt(S);x<=255?e[n++]=x:(e[n++]=x>>>8,e[n++]=x&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=n>>2,a=n-i*4,l=new Uint32Array(e.buffer,0,i);let u=0,h=0,f=this.h1,p=this.h2;const y=3432918353,v=461845907,b=y&Es,T=v&Es;for(let S=0;S<i;S++)S&1?(u=l[S],u=u*y&Li|u*b&Es,u=u<<15|u>>>17,u=u*v&Li|u*T&Es,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(h=l[S],h=h*y&Li|h*b&Es,h=h<<15|h>>>17,h=h*v&Li|h*T&Es,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,a){case 3:u^=e[i*4+2]<<16;case 2:u^=e[i*4+1]<<8;case 1:u^=e[i*4],u=u*y&Li|u*b&Es,u=u<<15|u>>>17,u=u*v&Li|u*T&Es,i&1?f^=u:p^=u}this.h1=f,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Li|t*36045&Es,e=e*4283543511&Li|((e<<16|t>>>16)*2950163797&Li)>>>16,t^=e>>>1,t=t*444984403&Li|t*60499&Es,e=e*3301882366&Li|((e<<16|t>>>16)*3120437893&Li)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Py=Object.freeze({map:null,hash:"",transfer:void 0});class ev{#t=!1;#e=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=this.#n.get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return this.#n.get(t)}remove(t){if(this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of this.#n.values())if(e instanceof kt)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=this.#n.get(t);let i=!1;if(n!==void 0)for(const[a,l]of Object.entries(e))n[a]!==l&&(i=!0,n[a]=l);else i=!0,this.#n.set(t,e);i&&this.#i(),e instanceof kt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#n.has(t)}get size(){return this.#n.size}#i(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new gC(this)}get serializable(){if(this.#n.size===0)return Py;const t=new Map,e=new pC,n=[],i=Object.create(null);let a=!1;for(const[l,u]of this.#n){const h=u instanceof kt?u.serialize(!1,i):u;h&&(t.set(l,h),e.update(`${l}:${JSON.stringify(h)}`),a||=!!h.bitmap)}if(a)for(const l of t.values())l.bitmap&&n.push(l.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:Py}get editorStats(){let t=null;const e=new Map;for(const n of this.#n.values()){if(!(n instanceof kt))continue;const i=n.telemetryFinalData;if(!i)continue;const{type:a}=i;e.has(a)||e.set(a,Object.getPrototypeOf(n).constructor),t||=Object.create(null);const l=t[a]||=new Map;for(const[u,h]of Object.entries(i)){if(u==="type")continue;let f=l.get(u);f||(f=new Map,l.set(u,f));const p=f.get(h)??0;f.set(h,p+1)}}for(const[n,i]of e)t[n]=i.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;const t=[];for(const e of this.#n.values())!(e instanceof kt)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class gC extends ev{#t;constructor(t){super();const{map:e,hash:n,transfer:i}=t.serializable,a=structuredClone(e,i?{transfer:i}:null);this.#t={map:a,hash:n,transfer:i}}get print(){Ee("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Kt(this,"modifiedIds",{ids:new Set,hash:""})}}class MF{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:n}){if(!(!t||this.#t.has(t.loadedName))){if(an(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:a,style:l}=t,u=new FontFace(i,a,l);this.addNativeFontFace(u);try{await u.load(),this.#t.add(i),n?.(t)}catch{Gt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Ee("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(i){throw Gt(`Failed to load font '${n.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const i=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,i)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Kt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Kt(this,"isSyncFontLoadingSupported",Wn||Pn.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(an(!i.done,"completeRequest() cannot be called twice."),i.done=!0;n.length>0&&n[0].done;){const a=n.shift();setTimeout(a.callback,0)}}const{loadingRequests:n}=this,i={done:!1,complete:e,callback:t};return n.push(i),i}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Kt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(G,H){return G.charCodeAt(H)<<24|G.charCodeAt(H+1)<<16|G.charCodeAt(H+2)<<8|G.charCodeAt(H+3)&255}function i(G,H,K,P){const N=G.substring(0,H),B=G.substring(H+K);return N+P+B}let a,l;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let f=0;function p(G,H){if(++f>30){Gt("Load test font never loaded."),H();return}if(h.font="30px "+G,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){H();return}setTimeout(p.bind(null,G,H))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=i(v,976,y.length,y);const T=16,S=1482184792;let I=n(v,T);for(a=0,l=y.length-3;a<l;a+=4)I=I-S+n(y,a)|0;a<y.length&&(I=I-S+n(y+"XXX",a)|0),v=i(v,T,4,mF(I));const x=`url(data:font/opentype;base64,${btoa(v)});`,k=`@font-face {font-family:"${y}";src:${x}}`;this.insertRule(k);const O=this._document.createElement("div");O.style.visibility="hidden",O.style.width=O.style.height="10px",O.style.position="absolute",O.style.top=O.style.left="0px";for(const G of[t.loadedName,y]){const H=this._document.createElement("span");H.textContent="Hi",H.style.fontFamily=G,O.append(H)}this._document.body.append(O),p(y,()=>{O.remove(),e.complete()})}}class kF{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const n in t)this[n]=t[n];this._inspectFont=e}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${dC(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let i;try{i=t.get(n)}catch(l){Gt(`getPathGenerator - ignoring character: "${l}".`)}const a=new Path2D(i||"");return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=a}}function PF(s){if(s instanceof URL)return s.href;if(typeof s=="string"){if(Wn)return s;const t=URL.parse(s,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function OF(s){if(Wn&&typeof Buffer<"u"&&s instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength)return s;if(typeof s=="string")return dh(s);if(s instanceof ArrayBuffer||ArrayBuffer.isView(s)||typeof s=="object"&&!isNaN(s?.length))return new Uint8Array(s);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Zd(s){if(typeof s!="string")return null;if(s.endsWith("/"))return s;throw new Error(`Invalid factory url: "${s}" must include trailing slash.`)}const Oy=s=>typeof s=="object"&&Number.isInteger(s?.num)&&s.num>=0&&Number.isInteger(s?.gen)&&s.gen>=0,LF=s=>typeof s=="object"&&typeof s?.name=="string",BF=EF.bind(null,Oy,LF);class FF{#t=new Map;#e=Promise.resolve();postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[i]of this.#t)i.call(this,n)})}addEventListener(t,e,n=null){let i=null;if(n?.signal instanceof AbortSignal){const{signal:a}=n;if(a.aborted){Gt("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,e);i=()=>a.removeEventListener("abort",l),a.addEventListener("abort",l)}this.#t.set(e,i)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const tf={DATA:1,ERROR:2},en={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Sw(){}function ri(s){if(s instanceof Aa||s instanceof Ny||s instanceof Ew||s instanceof qf||s instanceof qm)return s;switch(s instanceof Error||typeof s=="object"&&s!==null||Ee('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),s.name){case"AbortException":return new Aa(s.message);case"InvalidPDFException":return new Ny(s.message);case"PasswordException":return new Ew(s.message,s.code);case"ResponseException":return new qf(s.message,s.status,s.missing);case"UnknownErrorException":return new qm(s.message,s.details)}return new qm(s.message,s.toString())}class Eu{#t=new AbortController;constructor(t,e,n){this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const n=t.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===tf.DATA)i.resolve(t.data);else if(t.callback===tf.ERROR)i.reject(ri(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,i=t.sourceName,a=this.comObj;Promise.try(e,t.data).then(function(l){a.postMessage({sourceName:n,targetName:i,callback:tf.DATA,callbackId:t.callbackId,data:l})},function(l){a.postMessage({sourceName:n,targetName:i,callback:tf.ERROR,callbackId:t.callbackId,reason:ri(l)})});return}if(t.streamId){this.#n(t);return}e(t.data)}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const i=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[i]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},n)}catch(l){a.reject(l)}return a.promise}sendWithStream(t,e,n,i){const a=this.streamId++,l=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const p=Promise.withResolvers();return this.streamControllers[a]={controller:f,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:u,action:t,streamId:a,data:e,desiredSize:f.desiredSize},i),p.promise},pull:f=>{const p=Promise.withResolvers();return this.streamControllers[a].pullCall=p,h.postMessage({sourceName:l,targetName:u,stream:en.PULL,streamId:a,desiredSize:f.desiredSize}),p.promise},cancel:f=>{an(f instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[a].cancelCall=p,this.streamControllers[a].isClosed=!0,h.postMessage({sourceName:l,targetName:u,stream:en.CANCEL,streamId:a,reason:ri(f)}),p.promise}},n)}#n(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,a=this.comObj,l=this,u=this.actionHandler[t.action],h={enqueue(f,p=1,y){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=p,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:n,targetName:i,stream:en.ENQUEUE,streamId:e,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:i,stream:en.CLOSE,streamId:e}),delete l.streamSinks[e])},error(f){an(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:i,stream:en.ERROR,streamId:e,reason:ri(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(u,t.data,h).then(function(){a.postMessage({sourceName:n,targetName:i,stream:en.START_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:n,targetName:i,stream:en.START_COMPLETE,streamId:e,reason:ri(f)})})}#i(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,a=this.comObj,l=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case en.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(ri(t.reason));break;case en.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(ri(t.reason));break;case en.PULL:if(!u){a.postMessage({sourceName:n,targetName:i,stream:en.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||Sw).then(function(){a.postMessage({sourceName:n,targetName:i,stream:en.PULL_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:n,targetName:i,stream:en.PULL_COMPLETE,streamId:e,reason:ri(f)})});break;case en.ENQUEUE:if(an(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case en.CLOSE:if(an(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#r(l,e);break;case en.ERROR:an(l,"error should have stream controller"),l.controller.error(ri(t.reason)),this.#r(l,e);break;case en.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(ri(t.reason)),this.#r(l,e);break;case en.CANCEL:if(!u)break;const h=ri(t.reason);Promise.try(u.onCancel||Sw,h).then(function(){a.postMessage({sourceName:n,targetName:i,stream:en.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:n,targetName:i,stream:en.CANCEL_COMPLETE,streamId:e,reason:ri(f)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#r(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class mC{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Ee("Abstract method `_createCanvas` called.")}}class UF extends mC{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}class yC{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Ee("Abstract method `_fetch` called.")}}class Cw extends yC{async _fetch(t){const e=await fh(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):dh(e)}}class _C{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,i,a){return"none"}destroy(t=!1){}}class VF extends _C{#t;#e;#n;#i;#r;#s;#a=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#i=t,this.#r=e}get#o(){return this.#e||=new Map}get#l(){return this.#s||=new Map}get#c(){if(!this.#n){const t=this.#r.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const n=this.#r.createElementNS(ur,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#n=this.#r.createElementNS(ur,"defs"),t.append(n),n.append(this.#n),this.#r.body.append(t)}return this.#n}#d(t){if(t.length===1){const h=t[0],f=new Array(256);for(let y=0;y<256;y++)f[y]=h[y]/255;const p=f.join(",");return[p,p,p]}const[e,n,i]=t,a=new Array(256),l=new Array(256),u=new Array(256);for(let h=0;h<256;h++)a[h]=e[h]/255,l[h]=n[h]/255,u[h]=i[h]/255;return[a.join(","),l.join(","),u.join(",")]}#u(t){if(this.#t===void 0){this.#t="";const e=this.#r.URL;e!==this.#r.baseURI&&(vp(e)?Gt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=cC(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[n,i,a]=this.#d(t),l=t.length===1?n:`${n}${i}${a}`;if(e=this.#o.get(l),e)return this.#o.set(t,e),e;const u=`g_${this.#i}_transfer_map_${this.#a++}`,h=this.#u(u);this.#o.set(t,h),this.#o.set(l,h);const f=this.#p(u);return this.#m(n,i,a,f),h}addHCMFilter(t,e){const n=`${t}-${e}`,i="base";let a=this.#l.get(i);if(a?.key===n||(a?(a.filter?.remove(),a.key=n,a.url="none",a.filter=null):(a={key:n,url:"none",filter:null},this.#l.set(i,a)),!t||!e))return a.url;const l=this.#y(t);t=St.makeHexColor(...l);const u=this.#y(e);if(e=St.makeHexColor(...u),this.#c.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return a.url;const h=new Array(256);for(let b=0;b<=255;b++){const T=b/255;h[b]=T<=.03928?T/12.92:((T+.055)/1.055)**2.4}const f=h.join(","),p=`g_${this.#i}_hcm_filter`,y=a.filter=this.#p(p);this.#m(f,f,f,y),this.#g(y);const v=(b,T)=>{const S=l[b]/255,I=u[b]/255,x=new Array(T+1);for(let k=0;k<=T;k++)x[k]=S+k/T*(I-S);return x.join(",")};return this.#m(v(0,5),v(1,5),v(2,5),y),a.url=this.#u(p),a.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[n]=this.#d([t]),i=`alpha_${n}`;if(e=this.#o.get(i),e)return this.#o.set(t,e),e;const a=`g_${this.#i}_alpha_map_${this.#a++}`,l=this.#u(a);this.#o.set(t,l),this.#o.set(i,l);const u=this.#p(a);return this.#v(n,u),l}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let n,i;if(t?([n]=this.#d([t]),i=`luminosity_${n}`):i="luminosity",e=this.#o.get(i),e)return this.#o.set(t,e),e;const a=`g_${this.#i}_luminosity_map_${this.#a++}`,l=this.#u(a);this.#o.set(t,l),this.#o.set(i,l);const u=this.#p(a);return this.#f(u),t&&this.#v(n,u),l}addHighlightHCMFilter(t,e,n,i,a){const l=`${e}-${n}-${i}-${a}`;let u=this.#l.get(t);if(u?.key===l||(u?(u.filter?.remove(),u.key=l,u.url="none",u.filter=null):(u={key:l,url:"none",filter:null},this.#l.set(t,u)),!e||!n))return u.url;const[h,f]=[e,n].map(this.#y.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[v,b]=[i,a].map(this.#y.bind(this));y<p&&([p,y,v,b]=[y,p,b,v]),this.#c.style.color="";const T=(x,k,O)=>{const G=new Array(256),H=(y-p)/O,K=x/255,P=(k-x)/(255*O);let N=0;for(let B=0;B<=O;B++){const j=Math.round(p+B*H),V=K+B*P;for(let Y=N;Y<=j;Y++)G[Y]=V;N=j+1}for(let B=N;B<256;B++)G[B]=G[N-1];return G.join(",")},S=`g_${this.#i}_hcm_${t}_filter`,I=u.filter=this.#p(S);return this.#g(I),this.#m(T(v[0],b[0],5),T(v[1],b[1],5),T(v[2],b[2],5),I),u.url=this.#u(S),u.url}destroy(t=!1){t&&this.#s?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#s?.clear(),this.#s=null,this.#a=0)}#f(t){const e=this.#r.createElementNS(ur,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#g(t){const e=this.#r.createElementNS(ur,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#r.createElementNS(ur,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#c.append(e),e}#h(t,e,n){const i=this.#r.createElementNS(ur,e);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),t.append(i)}#m(t,e,n,i){const a=this.#r.createElementNS(ur,"feComponentTransfer");i.append(a),this.#h(a,"feFuncR",t),this.#h(a,"feFuncG",e),this.#h(a,"feFuncB",n)}#v(t,e){const n=this.#r.createElementNS(ur,"feComponentTransfer");e.append(n),this.#h(n,"feFuncA",t)}#y(t){return this.#c.style.color=t,bp(getComputedStyle(this.#c).getPropertyValue("color"))}}class vC{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Ee("Abstract method `_fetch` called.")}}class Rw extends vC{async _fetch(t){const e=await fh(t,"arraybuffer");return new Uint8Array(e)}}class bC{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Ee("Abstract method `_fetch` called.")}}class Iw extends bC{async _fetch(t){const e=await fh(t,"arraybuffer");return new Uint8Array(e)}}Wn&&Gt("Please use the `legacy` build in Node.js environments.");async function nv(s){const e=await process.getBuiltinModule("fs").promises.readFile(s);return new Uint8Array(e)}class jF extends _C{}class HF extends mC{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class zF extends yC{async _fetch(t){return nv(t)}}class GF extends vC{async _fetch(t){return nv(t)}}class qF extends bC{async _fetch(t){return nv(t)}}const _l="__forcedDependency";class $F{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[_l]:[]};#n=new Map;#i=[];#r=[];#s=[[1,0,0,1,0,0]];#a=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#l=-1;#c=new Set;#d=new Map;#u=new Map;#f;#g;constructor(t){this.#f=t.width,this.#g=t.height}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[_l]:{__proto__:this.#e[_l]}},this.#a={__proto__:this.#a},this.#i.push([t,null]),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#a=Object.getPrototypeOf(this.#a);const n=this.#i.pop();return n!==void 0&&(n[1]=t),this}recordOpenMarker(t){return this.#i.push([t,null]),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)[0]}recordCloseMarker(t){const e=this.#i.pop();return e!==void 0&&(e[1]=t),this}beginMarkedContent(t){return this.#r.push([t,null]),this}endMarkedContent(t){const e=this.#r.pop();return e!==void 0&&(e[1]=t),this}pushBaseTransform(t){return this.#s.push(St.multiplyByDOMMatrix(this.#s.at(-1),t.getTransform())),this}popBaseTransform(){return this.#s.length>1&&this.#s.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#n.set(t,e),this}recordFutureForcedDependency(t,e){return this.recordIncrementalData(_l,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#c)this.recordFutureForcedDependency(_l,t);return this}resetBBox(t){return this.#l=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0,this}get hasPendingBBox(){return this.#l!==-1}recordClipBox(t,e,n,i,a,l){const u=St.multiplyByDOMMatrix(this.#s.at(-1),e.getTransform()),h=[1/0,1/0,-1/0,-1/0];St.axialAlignedBoundingBox([n,a,i,l],u,h);const f=St.intersect(this.#a,h);return f?(this.#a[0]=f[0],this.#a[1]=f[1],this.#a[2]=f[2],this.#a[3]=f[3]):(this.#a[0]=this.#a[1]=1/0,this.#a[2]=this.#a[3]=-1/0),this}recordBBox(t,e,n,i,a,l){const u=this.#a;if(u[0]===1/0)return this;const h=St.multiplyByDOMMatrix(this.#s.at(-1),e.getTransform());if(u[0]===-1/0)return St.axialAlignedBoundingBox([n,a,i,l],h,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return St.axialAlignedBoundingBox([n,a,i,l],h,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,e,n,i=1,a=0,l=0,u){const h=n.bbox;let f,p;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&this.#u.get(n),f!==!1&&(p=[0,0,0,0],St.axialAlignedBoundingBox(h,n.fontMatrix,p),(i!==1||a!==0||l!==0)&&St.scaleMinMax([i,0,0,-i,a,l],p),f)))return this.recordBBox(t,e,p[0],p[2],p[1],p[3]);if(!u)return this.recordFullPageBBox(t);const y=u();return h&&p&&f===void 0&&(f=p[0]<=a-y.actualBoundingBoxLeft&&p[2]>=a+y.actualBoundingBoxRight&&p[1]<=l-y.actualBoundingBoxAscent&&p[3]>=l+y.actualBoundingBoxDescent,this.#u.set(n,f),f)?this.recordBBox(t,e,p[0],p[2],p[1],p[3]):this.recordBBox(t,e,a-y.actualBoundingBoxLeft,a+y.actualBoundingBoxRight,l-y.actualBoundingBoxAscent,l+y.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#a[0]),this.#o[1]=Math.max(0,this.#a[1]),this.#o[2]=Math.min(this.#f,this.#a[2]),this.#o[3]=Math.min(this.#g,this.#a[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const n=this.#c,i=this.#t,a=this.#e;for(const l of e)l in this.#t?n.add(i[l]):l in a&&a[l].forEach(n.add,n);return this}copyDependenciesFromIncrementalOperation(t,e){const n=this.#d,i=this.#c;for(const a of this.#e[e])n.get(a).dependencies.forEach(i.add,i.add(a));return this}recordNamedDependency(t,e){return this.#n.has(e)&&this.#c.add(this.#n.get(e)),this}recordOperation(t,e=!1){this.recordDependencies(t,[_l]);const n=new Set(this.#c),i=this.#i.concat(this.#r),a=this.#l===t?{minX:this.#o[0],minY:this.#o[1],maxX:this.#o[2],maxY:this.#o[3]}:null;return this.#d.set(t,{bbox:a,pairs:i,dependencies:n}),e||(this.#l=-1),this.#c.clear(),this}bboxToClipBoxDropOperation(t){return this.#l!==-1&&(this.#l=-1,this.#a[0]=Math.max(this.#a[0],this.#o[0]),this.#a[1]=Math.max(this.#a[1],this.#o[1]),this.#a[2]=Math.min(this.#a[2],this.#o[2]),this.#a[3]=Math.min(this.#a[3],this.#o[3])),this.#c.clear(),this}_takePendingDependencies(){const t=this.#c;return this.#c=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#c.add(e)}take(){return this.#u.clear(),Array.from(this.#d,([t,{bbox:e,pairs:n,dependencies:i}])=>(n.forEach(a=>a.forEach(i.add,i)),i.delete(t),{minX:(e?.minX??0)/this.#f,maxX:(e?.maxX??this.#f)/this.#f,minY:(e?.minY??0)/this.#g,maxY:(e?.maxY??this.#g)/this.#g,dependencies:Array.from(i).sort((a,l)=>a-l),idx:t}))}}class $f{#t;#e;#n=0;#i;#r=0;constructor(t,e){if(t instanceof $f)return t;this.#t=t,this.#i=t._takePendingDependencies(),this.#e=e}save(t){return this.#r++,this.#t.save(this.#e),this}restore(t){return this.#r>0&&(this.#t.restore(this.#e),this.#r--),this}recordOpenMarker(t){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#n--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#t.hasPendingBBox||this.#t.resetBBox(this.#e),this}get hasPendingBBox(){return this.#t.hasPendingBBox}recordClipBox(t,e,n,i,a,l){return this.#t.recordClipBox(this.#e,e,n,i,a,l),this}recordBBox(t,e,n,i,a,l){return this.#t.recordBBox(this.#e,e,n,i,a,l),this}recordCharacterBBox(t,e,n,i,a,l,u){return this.#t.recordCharacterBBox(this.#e,e,n,i,a,l,u),this}recordFullPageBBox(t){return this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}copyDependenciesFromIncrementalOperation(t,e){return this.#t.copyDependenciesFromIncrementalOperation(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){this.#t.recordOperation(this.#e,!0);const e=this.#t._extractOperation(this.#e);for(const n of e.dependencies)this.#i.add(n);return this.#i.delete(this.#e),this.#i.delete(null),this}bboxToClipBoxDropOperation(t){return this.#t.bboxToClipBoxDropOperation(this.#e),this}recordNestedDependencies(){this.#t._pushPendingDependencies(this.#i)}take(){throw new Error("Unreachable")}}const Bi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation"],transform:["transform"],transformAndFill:["transform","fillColor"]},Mn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Ly(s,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],e,n),s.clip(i)}class iv{isModifyingCurrentTransform(){return!1}getPattern(){Ee("Abstract method `getPattern` called.")}}class YF extends iv{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)e.addColorStop(n[0],n[1]);return e}getPattern(t,e,n,i){let a;if(i===Mn.STROKE||i===Mn.FILL){const l=e.current.getClippedPathBoundingBox(i,Oe(t))||[0,0,0,0],u=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,f=e.cachedCanvases.getCanvas("pattern",u,h),p=f.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-l[0],-l[1]),n=St.transform(n,[1,0,0,1,l[0],l[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),Ly(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),a=t.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(n);a.setTransform(y)}else Ly(t,this._bbox),a=this._createGradient(t);return a}}function Xm(s,t,e,n,i,a,l,u){const h=t.coords,f=t.colors,p=s.data,y=s.width*4;let v;h[e+1]>h[n+1]&&(v=e,e=n,n=v,v=a,a=l,l=v),h[n+1]>h[i+1]&&(v=n,n=i,i=v,v=l,l=u,u=v),h[e+1]>h[n+1]&&(v=e,e=n,n=v,v=a,a=l,l=v);const b=(h[e]+t.offsetX)*t.scaleX,T=(h[e+1]+t.offsetY)*t.scaleY,S=(h[n]+t.offsetX)*t.scaleX,I=(h[n+1]+t.offsetY)*t.scaleY,x=(h[i]+t.offsetX)*t.scaleX,k=(h[i+1]+t.offsetY)*t.scaleY;if(T>=k)return;const O=f[a],G=f[a+1],H=f[a+2],K=f[l],P=f[l+1],N=f[l+2],B=f[u],j=f[u+1],V=f[u+2],Y=Math.round(T),U=Math.round(k);let Nt,Dt,J,ct,mt,Mt,$,ut;for(let Q=Y;Q<=U;Q++){if(Q<I){const It=Q<T?0:(T-Q)/(T-I);Nt=b-(b-S)*It,Dt=O-(O-K)*It,J=G-(G-P)*It,ct=H-(H-N)*It}else{let It;Q>k?It=1:I===k?It=0:It=(I-Q)/(I-k),Nt=S-(S-x)*It,Dt=K-(K-B)*It,J=P-(P-j)*It,ct=N-(N-V)*It}let at;Q<T?at=0:Q>k?at=1:at=(T-Q)/(T-k),mt=b-(b-x)*at,Mt=O-(O-B)*at,$=G-(G-j)*at,ut=H-(H-V)*at;const yt=Math.round(Math.min(Nt,mt)),bt=Math.round(Math.max(Nt,mt));let Et=y*Q+yt*4;for(let It=yt;It<=bt;It++)at=(Nt-It)/(Nt-mt),at<0?at=0:at>1&&(at=1),p[Et++]=Dt-(Dt-Mt)*at|0,p[Et++]=J-(J-$)*at|0,p[Et++]=ct-(ct-ut)*at|0,p[Et++]=255}}function XF(s,t,e){const n=t.coords,i=t.colors;let a,l;switch(t.type){case"lattice":const u=t.verticesPerRow,h=Math.floor(n.length/u)-1,f=u-1;for(a=0;a<h;a++){let p=a*u;for(let y=0;y<f;y++,p++)Xm(s,e,n[p],n[p+1],n[p+u],i[p],i[p+1],i[p+u]),Xm(s,e,n[p+u+1],n[p+1],n[p+u],i[p+u+1],i[p+1],i[p+u])}break;case"triangles":for(a=0,l=n.length;a<l;a+=3)Xm(s,e,n[a],n[a+1],n[a+2],i[a],i[a+1],i[a+2]);break;default:throw new Error("illegal figure")}}class KF extends iv{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,n){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-h,y=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),b=f/y,T=p/v,S={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/b,scaleY:1/T},I=y+4,x=v+4,k=n.getCanvas("mesh",I,x),O=k.context,G=O.createImageData(y,v);if(e){const K=G.data;for(let P=0,N=K.length;P<N;P+=4)K[P]=e[0],K[P+1]=e[1],K[P+2]=e[2],K[P+3]=255}for(const K of this._figures)XF(G,K,S);return O.putImageData(G,2,2),{canvas:k.canvas,offsetX:u-2*b,offsetY:h-2*T,scaleX:b,scaleY:T}}isModifyingCurrentTransform(){return!0}getPattern(t,e,n,i){Ly(t,this._bbox);const a=new Float32Array(2);if(i===Mn.SHADING)St.singularValueDecompose2dScale(Oe(t),a);else if(this.matrix){St.singularValueDecompose2dScale(this.matrix,a);const[u,h]=a;St.singularValueDecompose2dScale(e.baseTransform,a),a[0]*=u,a[1]*=h}else St.singularValueDecompose2dScale(e.baseTransform,a);const l=this._createMeshCanvas(a,i===Mn.SHADING?null:this._background,e.cachedCanvases);return i!==Mn.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class WF extends iv{getPattern(){return"hotpink"}}function QF(s){switch(s[0]){case"RadialAxial":return new YF(s);case"Mesh":return new KF(s);case"Dummy":return new WF}throw new Error(`Unknown IR type: ${s[0]}`)}const xw={COLORED:1,UNCOLORED:2};class sv{static MAX_PATTERN_SIZE=3e3;constructor(t,e,n,i){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:i,tilingType:a,color:l,canvasGraphicsFactory:u}=this;let{xstep:h,ystep:f}=this;h=Math.abs(h),f=Math.abs(f),_p("TilingType: "+a);const p=e[0],y=e[1],v=e[2],b=e[3],T=v-p,S=b-y,I=new Float32Array(2);St.singularValueDecompose2dScale(this.matrix,I);const[x,k]=I;St.singularValueDecompose2dScale(this.baseTransform,I);const O=x*I[0],G=k*I[1];let H=T,K=S,P=!1,N=!1;const B=Math.ceil(h*O),j=Math.ceil(f*G),V=Math.ceil(T*O),Y=Math.ceil(S*G);B>=V?H=h:P=!0,j>=Y?K=f:N=!0;const U=this.getSizeAndScale(H,this.ctx.canvas.width,O),Nt=this.getSizeAndScale(K,this.ctx.canvas.height,G),Dt=t.cachedCanvases.getCanvas("pattern",U.size,Nt.size),J=Dt.context,ct=u.createCanvasGraphics(J);if(ct.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(ct,i,l),J.translate(-U.scale*p,-Nt.scale*y),ct.transform(0,U.scale,0,0,Nt.scale,0,0),J.save(),ct.dependencyTracker?.save(),this.clipBbox(ct,p,y,v,b),ct.baseTransform=Oe(ct.ctx),ct.executeOperatorList(n),ct.endDrawing(),ct.dependencyTracker?.restore().recordNestedDependencies?.(),J.restore(),P||N){const mt=Dt.canvas;P&&(H=h),N&&(K=f);const Mt=this.getSizeAndScale(H,this.ctx.canvas.width,O),$=this.getSizeAndScale(K,this.ctx.canvas.height,G),ut=Mt.size,Q=$.size,at=t.cachedCanvases.getCanvas("pattern-workaround",ut,Q),yt=at.context,bt=P?Math.floor(T/h):0,Et=N?Math.floor(S/f):0;for(let It=0;It<=bt;It++)for(let xt=0;xt<=Et;xt++)yt.drawImage(mt,ut*It,Q*xt,ut,Q,0,0,ut,Q);return{canvas:at.canvas,scaleX:Mt.scale,scaleY:$.scale,offsetX:p,offsetY:y}}return{canvas:Dt.canvas,scaleX:U.scale,scaleY:Nt.scale,offsetX:p,offsetY:y}}getSizeAndScale(t,e,n){const i=Math.max(sv.MAX_PATTERN_SIZE,e);let a=Math.ceil(t*n);return a>=i?a=i:n=a/t,{scale:n,size:a}}clipBbox(t,e,n,i,a){const l=i-e,u=a-n;t.ctx.rect(e,n,l,u),St.axialAlignedBoundingBox([e,n,i,a],Oe(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const i=t.ctx,a=t.current;switch(e){case xw.COLORED:const{fillStyle:l,strokeStyle:u}=this.ctx;i.fillStyle=a.fillColor=l,i.strokeStyle=a.strokeColor=u;break;case xw.UNCOLORED:i.fillStyle=i.strokeStyle=n,a.fillColor=a.strokeColor=n;break;default:throw new gF(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,n,i){let a=n;i!==Mn.SHADING&&(a=St.transform(a,e.baseTransform),this.matrix&&(a=St.transform(a,this.matrix)));const l=this.createPatternCanvas(e);let u=new DOMMatrix(a);u=u.translate(l.offsetX,l.offsetY),u=u.scale(1/l.scaleX,1/l.scaleY);const h=t.createPattern(l.canvas,"repeat");return h.setTransform(u),h}}function JF({src:s,srcPos:t=0,dest:e,width:n,height:i,nonBlackColor:a=4294967295,inverseDecode:l=!1}){const u=Pn.isLittleEndian?4278190080:255,[h,f]=l?[a,u]:[u,a],p=n>>3,y=n&7,v=s.length;e=new Uint32Array(e.buffer);let b=0;for(let T=0;T<i;T++){for(const I=t+p;t<I;t++){const x=t<v?s[t]:255;e[b++]=x&128?f:h,e[b++]=x&64?f:h,e[b++]=x&32?f:h,e[b++]=x&16?f:h,e[b++]=x&8?f:h,e[b++]=x&4?f:h,e[b++]=x&2?f:h,e[b++]=x&1?f:h}if(y===0)continue;const S=t<v?s[t++]:255;for(let I=0;I<y;I++)e[b++]=S&1<<7-I?f:h}return{srcPos:t,destPos:b}}const Dw=16,Nw=100,ZF=15,Mw=10,ai=16,Km=new DOMMatrix,Ei=new Float32Array(2),xl=new Float32Array([1/0,1/0,-1/0,-1/0]);function tU(s,t){if(s._removeMirroring)throw new Error("Context is already forwarding operations.");s.__originalSave=s.save,s.__originalRestore=s.restore,s.__originalRotate=s.rotate,s.__originalScale=s.scale,s.__originalTranslate=s.translate,s.__originalTransform=s.transform,s.__originalSetTransform=s.setTransform,s.__originalResetTransform=s.resetTransform,s.__originalClip=s.clip,s.__originalMoveTo=s.moveTo,s.__originalLineTo=s.lineTo,s.__originalBezierCurveTo=s.bezierCurveTo,s.__originalRect=s.rect,s.__originalClosePath=s.closePath,s.__originalBeginPath=s.beginPath,s._removeMirroring=()=>{s.save=s.__originalSave,s.restore=s.__originalRestore,s.rotate=s.__originalRotate,s.scale=s.__originalScale,s.translate=s.__originalTranslate,s.transform=s.__originalTransform,s.setTransform=s.__originalSetTransform,s.resetTransform=s.__originalResetTransform,s.clip=s.__originalClip,s.moveTo=s.__originalMoveTo,s.lineTo=s.__originalLineTo,s.bezierCurveTo=s.__originalBezierCurveTo,s.rect=s.__originalRect,s.closePath=s.__originalClosePath,s.beginPath=s.__originalBeginPath,delete s._removeMirroring},s.save=function(){t.save(),this.__originalSave()},s.restore=function(){t.restore(),this.__originalRestore()},s.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},s.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},s.transform=function(e,n,i,a,l,u){t.transform(e,n,i,a,l,u),this.__originalTransform(e,n,i,a,l,u)},s.setTransform=function(e,n,i,a,l,u){t.setTransform(e,n,i,a,l,u),this.__originalSetTransform(e,n,i,a,l,u)},s.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},s.rotate=function(e){t.rotate(e),this.__originalRotate(e)},s.clip=function(e){t.clip(e),this.__originalClip(e)},s.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},s.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},s.bezierCurveTo=function(e,n,i,a,l,u){t.bezierCurveTo(e,n,i,a,l,u),this.__originalBezierCurveTo(e,n,i,a,l,u)},s.rect=function(e,n,i,a){t.rect(e,n,i,a),this.__originalRect(e,n,i,a)},s.closePath=function(){t.closePath(),this.__originalClosePath()},s.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class eU{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let i;return this.cache[t]!==void 0?(i=this.cache[t],this.canvasFactory.reset(i,e,n)):(i=this.canvasFactory.create(e,n),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function ef(s,t,e,n,i,a,l,u,h,f){const[p,y,v,b,T,S]=Oe(s);if(y===0&&v===0){const k=l*p+T,O=Math.round(k),G=u*b+S,H=Math.round(G),K=(l+h)*p+T,P=Math.abs(Math.round(K)-O)||1,N=(u+f)*b+S,B=Math.abs(Math.round(N)-H)||1;return s.setTransform(Math.sign(p),0,0,Math.sign(b),O,H),s.drawImage(t,e,n,i,a,0,0,P,B),s.setTransform(p,y,v,b,T,S),[P,B]}if(p===0&&b===0){const k=u*v+T,O=Math.round(k),G=l*y+S,H=Math.round(G),K=(u+f)*v+T,P=Math.abs(Math.round(K)-O)||1,N=(l+h)*y+S,B=Math.abs(Math.round(N)-H)||1;return s.setTransform(0,Math.sign(y),Math.sign(v),0,O,H),s.drawImage(t,e,n,i,a,0,0,B,P),s.setTransform(p,y,v,b,T,S),[B,P]}s.drawImage(t,e,n,i,a,l,u,h,f);const I=Math.hypot(p,y),x=Math.hypot(v,b);return[I*h,x*f]}class kw{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Dy;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=xn.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,n){n?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=xl.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Mn.FILL,e=null){const n=this.minMax.slice();if(t===Mn.STROKE){e||Ee("Stroke bounding box must include transform."),St.singularValueDecompose2dScale(e,Ei);const i=Ei[0]*this.lineWidth/2,a=Ei[1]*this.lineWidth/2;n[0]-=i,n[1]-=a,n[2]+=i,n[3]+=a}return n}updateClipFromPath(){const t=St.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(xl,0)}getClippedPathBoundingBox(t=Mn.FILL,e=null){return St.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Pw(s,t){if(t instanceof ImageData){s.putImageData(t,0,0);return}const e=t.height,n=t.width,i=e%ai,a=(e-i)/ai,l=i===0?a:a+1,u=s.createImageData(n,ai);let h=0,f;const p=t.data,y=u.data;let v,b,T,S;if(t.kind===vf.GRAYSCALE_1BPP){const I=p.byteLength,x=new Uint32Array(y.buffer,0,y.byteLength>>2),k=x.length,O=n+7>>3,G=4294967295,H=Pn.isLittleEndian?4278190080:255;for(v=0;v<l;v++){for(T=v<a?ai:i,f=0,b=0;b<T;b++){const K=I-h;let P=0;const N=K>O?n:K*8-7,B=N&-8;let j=0,V=0;for(;P<B;P+=8)V=p[h++],x[f++]=V&128?G:H,x[f++]=V&64?G:H,x[f++]=V&32?G:H,x[f++]=V&16?G:H,x[f++]=V&8?G:H,x[f++]=V&4?G:H,x[f++]=V&2?G:H,x[f++]=V&1?G:H;for(;P<N;P++)j===0&&(V=p[h++],j=128),x[f++]=V&j?G:H,j>>=1}for(;f<k;)x[f++]=0;s.putImageData(u,0,v*ai)}}else if(t.kind===vf.RGBA_32BPP){for(b=0,S=n*ai*4,v=0;v<a;v++)y.set(p.subarray(h,h+S)),h+=S,s.putImageData(u,0,b),b+=ai;v<l&&(S=n*i*4,y.set(p.subarray(h,h+S)),s.putImageData(u,0,b))}else if(t.kind===vf.RGB_24BPP)for(T=ai,S=n*T,v=0;v<l;v++){for(v>=a&&(T=i,S=n*T),f=0,b=S;b--;)y[f++]=p[h++],y[f++]=p[h++],y[f++]=p[h++],y[f++]=255;s.putImageData(u,0,v*ai)}else throw new Error(`bad image kind: ${t.kind}`)}function Ow(s,t){if(t.bitmap){s.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,i=e%ai,a=(e-i)/ai,l=i===0?a:a+1,u=s.createImageData(n,ai);let h=0;const f=t.data,p=u.data;for(let y=0;y<l;y++){const v=y<a?ai:i;({srcPos:h}=JF({src:f,srcPos:h,dest:p,width:n,height:v,nonBlackColor:0})),s.putImageData(u,0,y*ai)}}function lu(s,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)s[n]!==void 0&&(t[n]=s[n]);s.setLineDash!==void 0&&(t.setLineDash(s.getLineDash()),t.lineDashOffset=s.lineDashOffset)}function nf(s){s.strokeStyle=s.fillStyle="#000000",s.fillRule="nonzero",s.globalAlpha=1,s.lineWidth=1,s.lineCap="butt",s.lineJoin="miter",s.miterLimit=10,s.globalCompositeOperation="source-over",s.font="10px sans-serif",s.setLineDash!==void 0&&(s.setLineDash([]),s.lineDashOffset=0);const{filter:t}=s;t!=="none"&&t!==""&&(s.filter="none")}function Lw(s,t){if(t)return!0;St.singularValueDecompose2dScale(s,Ei);const e=Math.fround(Ps.pixelRatio*Gl.PDF_TO_CSS_UNITS);return Ei[0]<=e&&Ei[1]<=e}const nU=["butt","round","square"],iU=["miter","round","bevel"],sU={},Bw={};class Ol{constructor(t,e,n,i,a,{optionalContentConfig:l,markedContentStack:u=null},h,f,p){this.ctx=t,this.current=new kw(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=i,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=l,this.cachedCanvases=new eU(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,e,n=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):n}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:i=null}){const a=this.ctx.canvas.width,l=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,a,l),this.ctx.fillStyle=u,n){const h=this.cachedCanvases.getCanvas("transparent",a,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Oe(this.compositeCtx))}this.ctx.save(),nf(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Oe(this.ctx)}executeOperatorList(t,e,n,i,a){const l=t.argsArray,u=t.fnArray;let h=e||0;const f=l.length;if(f===h)return h;const p=f-h>Mw&&typeof n=="function",y=p?Date.now()+ZF:0;let v=0;const b=this.commonObjs,T=this.objs;let S,I;for(;;){if(i!==void 0&&h===i.nextBreakPoint)return i.breakIt(h,n),h;if(!a||a.has(h))if(S=u[h],I=l[h]??null,S!==$u.dependency)I===null?this[S](h):this[S](h,...I);else for(const x of I){this.dependencyTracker?.recordNamedData(x,h);const k=x.startsWith("g_")?b:T;if(!k.has(x))return k.get(x,n),h}if(h++,h===f)return h;if(p&&++v>Mw){if(Date.now()>y)return n(),h;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const n=t.width??t.displayWidth,i=t.height??t.displayHeight;let a=Math.max(Math.hypot(e[0],e[1]),1),l=Math.max(Math.hypot(e[2],e[3]),1),u=n,h=i,f="prescale1",p,y;for(;a>2&&u>1||l>2&&h>1;){let v=u,b=h;a>2&&u>1&&(v=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),a/=u/v),l>2&&h>1&&(b=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/b),p=this.cachedCanvases.getCanvas(f,v,b),y=p.context,y.clearRect(0,0,v,b),y.drawImage(t,0,0,u,h,0,0,v,b),t=p.canvas,u=v,h=b,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:h}}_createMaskCanvas(t,e){const n=this.ctx,{width:i,height:a}=e,l=this.current.fillColor,u=this.current.patternFill,h=Oe(n);let f,p,y,v;if((e.bitmap||e.data)&&e.count>1){const j=e.bitmap||e.data.buffer;p=JSON.stringify(u?h:[h.slice(0,4),l]),f=this._cachedBitmapsMap.get(j),f||(f=new Map,this._cachedBitmapsMap.set(j,f));const V=f.get(p);if(V&&!u){const Y=Math.round(Math.min(h[0],h[2])+h[4]),U=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,Bi.transformAndFill),{canvas:V,offsetX:Y,offsetY:U}}y=V}y||(v=this.cachedCanvases.getCanvas("maskCanvas",i,a),Ow(v.context,e));let b=St.transform(h,[1/i,0,0,-1/a,0,0]);b=St.transform(b,[1,0,0,1,0,-a]);const T=xl.slice();St.axialAlignedBoundingBox([0,0,i,a],b,T);const[S,I,x,k]=T,O=Math.round(x-S)||1,G=Math.round(k-I)||1,H=this.cachedCanvases.getCanvas("fillCanvas",O,G),K=H.context,P=S,N=I;K.translate(-P,-N),K.transform(...b),y||(y=this._scaleImage(v.canvas,bs(K)),y=y.img,f&&u&&f.set(p,y)),K.imageSmoothingEnabled=Lw(Oe(K),e.interpolate),ef(K,y,0,0,y.width,y.height,0,0,i,a),K.globalCompositeOperation="source-in";const B=St.transform(bs(K),[1,0,0,1,-P,-N]);return K.fillStyle=u?l.getPattern(n,this,B,Mn.FILL):l,K.fillRect(0,0,i,a),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,H.canvas)),this.dependencyTracker?.recordDependencies(t,Bi.transformAndFill),{canvas:H.canvas,offsetX:Math.round(P),offsetY:Math.round(N)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=nU[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=iU[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,n){this.dependencyTracker?.recordSimpleData("dash",t);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=n)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[n,i]of e)switch(n){case"LW":this.setLineWidth(t,i);break;case"LC":this.setLineCap(t,i);break;case"LJ":this.setLineJoin(t,i);break;case"ML":this.setMiterLimit(t,i);break;case"D":this.setDash(t,i[0],i[1]);break;case"RI":this.setRenderingIntent(t,i);break;case"FL":this.setFlatness(t,i);break;case"Font":this.setFont(t,i[0],i[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=i;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=i;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=i;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,n=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(i,e,n);this.suspendedCtx=this.ctx;const l=this.ctx=a.context;l.setTransform(this.suspendedCtx.getTransform()),lu(this.suspendedCtx,l),tU(l,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),lu(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,i){const a=i[0],l=i[1],u=i[2]-a,h=i[3]-l;u===0||h===0||(this.genericComposeSMask(e.context,n,u,h,e.subtype,e.backdrop,e.transferMap,a,l,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,i,a,l,u,h,f,p,y){let v=t.canvas,b=h-p,T=f-y;if(l)if(b<0||T<0||b+n>v.width||T+i>v.height){const I=this.cachedCanvases.getCanvas("maskExtension",n,i),x=I.context;x.drawImage(v,-b,-T),x.globalCompositeOperation="destination-atop",x.fillStyle=l,x.fillRect(0,0,n,i),x.globalCompositeOperation="source-over",v=I.canvas,b=T=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const I=new Path2D;I.rect(b,T,n,i),t.clip(I),t.globalCompositeOperation="destination-atop",t.fillStyle=l,t.fillRect(b,T,n,i),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),a==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):a==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const S=new Path2D;S.rect(h,f,n,i),e.clip(S),e.globalCompositeOperation="destination-in",e.drawImage(v,b,T,n,i,h,f,n,i),e.restore()}save(t){this.inSMaskMode&&lu(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&lu(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,n,i,a,l,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,n,i,a,l,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n,i){let[a]=n;if(!i){a||=n[0]=new Path2D,this[e](t,a);return}if(this.dependencyTracker!==null){const l=e===$u.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,i[0]-l,i[2]+l,i[1]-l,i[3]+l).recordDependencies(t,["transform"])}if(!(a instanceof Path2D)){const l=n[0]=new Path2D;for(let u=0,h=a.length;u<h;)switch(a[u++]){case Qd.moveTo:l.moveTo(a[u++],a[u++]);break;case Qd.lineTo:l.lineTo(a[u++],a[u++]);break;case Qd.curveTo:l.bezierCurveTo(a[u++],a[u++],a[u++],a[u++],a[u++],a[u++]);break;case Qd.closePath:l.closePath();break;default:Gt(`Unrecognized drawing path operator: ${a[u-1]}`);break}a=l}St.axialAlignedBoundingBox(i,Oe(this.ctx),this.current.minMax),this[e](t,a),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,n=!0){const i=this.ctx,a=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&a?.getPattern){const l=a.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=a.getPattern(i,this,bs(i),Mn.STROKE),l){const u=new Path2D;u.addPath(e,i.getTransform().invertSelf().multiplySelf(l)),e=u}this.rescaleAndStroke(e,!1),i.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,Bi.stroke),n&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(Mn.STROKE,Oe(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,n=!0){const i=this.ctx,a=this.current.fillColor,l=this.current.patternFill;let u=!1;if(l){const f=a.isModifyingCurrentTransform()?i.getTransform():null;if(this.dependencyTracker?.save(t),i.save(),i.fillStyle=a.getPattern(i,this,bs(i),Mn.FILL),f){const p=new Path2D;p.addPath(e,i.getTransform().invertSelf().multiplySelf(f)),e=p}u=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(i.fill(e,"evenodd"),this.pendingEOFill=!1):i.fill(e)),this.dependencyTracker?.recordDependencies(t,Bi.fill),u&&(i.restore(),this.dependencyTracker?.restore(t)),n&&this.consumePath(t,e,h)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,Bi.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=sU}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Bw}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;e!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",t),i.recordCloseMarker(t)}if(e!==void 0){const i=new Path2D,a=n.getTransform().invertSelf();for(const{transform:l,x:u,y:h,fontSize:f,path:p}of e)p&&i.addPath(p,new DOMMatrix(l).preMultiplySelf(a).translate(u,h).scale(f,-f));n.clip(i)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,n){this.dependencyTracker?.recordSimpleData("font",t).recordNamedDependency(t,e);const i=this.commonObjs.get(e),a=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(a.fontMatrix=i.fontMatrix||Dy,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&Gt("Invalid font matrix for font "+e),n<0?(n=-n,a.fontDirection=-1):a.fontDirection=1,this.current.font=i,this.current.fontSize=n,i.isType3Font)return;const l=i.loadedName||"sans-serif",u=i.systemFontInfo?.css||`"${l}", ${i.fallbackName}`;let h="normal";i.black?h="900":i.bold&&(h="bold");const f=i.italic?"italic":"normal";let p=n;n<Dw?p=Dw:n>Nw&&(p=Nw),this.current.fontSizeScale=n/p,this.ctx.font=`${f} ${h} ${p}px ${u}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=n}setLeadingMoveText(t,e,n){this.setLeading(t,-n),this.moveText(t,e,n)}setTextMatrix(t,e){this.dependencyTracker?.recordSimpleData("textMatrix",t);const{current:n}=this;n.textMatrix=e,n.textMatrixScale=Math.hypot(e[0],e[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,e,n){const i=new Path2D;return i.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),i}paintChar(t,e,n,i,a,l){const u=this.ctx,h=this.current,f=h.font,p=h.textRenderingMode,y=h.fontSize/h.fontSizeScale,v=p&xn.FILL_STROKE_MASK,b=!!(p&xn.ADD_TO_PATH_FLAG),T=h.patternFill&&!f.missingFile,S=h.patternStroke&&!f.missingFile;let I;if((f.disableFontFace||b||T||S)&&!f.missingFile&&(I=f.getPathGenerator(this.commonObjs,e)),I&&(f.disableFontFace||T||S)){u.save(),u.translate(n,i),u.scale(y,-y),this.dependencyTracker?.recordCharacterBBox(t,u,f);let x;if(v===xn.FILL||v===xn.FILL_STROKE)if(a){x=u.getTransform(),u.setTransform(...a);const k=this.#n(I,x,a);u.fill(k)}else u.fill(I);if(v===xn.STROKE||v===xn.FILL_STROKE)if(l){x||=u.getTransform(),u.setTransform(...l);const{a:k,b:O,c:G,d:H}=x,K=St.inverseTransform(l),P=St.transform([k,O,G,H,0,0],K);St.singularValueDecompose2dScale(P,Ei),u.lineWidth*=Math.max(Ei[0],Ei[1])/y,u.stroke(this.#n(I,x,l))}else u.lineWidth/=y,u.stroke(I);u.restore()}else(v===xn.FILL||v===xn.FILL_STROKE)&&(u.fillText(e,n,i),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,n,i,()=>u.measureText(e))),(v===xn.STROKE||v===xn.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,y,n,i,()=>u.measureText(e)).recordDependencies(t,Bi.stroke),u.strokeText(e,n,i));b&&((this.pendingTextPaths||=[]).push({transform:Oe(u),x:n,y:i,fontSize:y,path:I}),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,n,i))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<e.length;i+=4)if(e[i]>0&&e[i]<255){n=!0;break}return Kt(this,"isFontSubpixelAAEnabled",n)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Bi.showText).copyDependenciesFromIncrementalOperation(t,"sameLineText").resetBBox(t),this.current.textRenderingMode&xn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,i=n.font;if(i.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordOperation(t).recordIncrementalData("sameLineText",t);return}const a=n.fontSize;if(a===0){this.dependencyTracker?.recordOperation(t);return}const l=this.ctx,u=n.fontSizeScale,h=n.charSpacing,f=n.wordSpacing,p=n.fontDirection,y=n.textHScale*p,v=e.length,b=i.vertical,T=b?1:-1,S=i.defaultVMetrics,I=a*n.fontMatrix[0],x=n.textRenderingMode===xn.FILL&&!i.disableFontFace&&!n.patternFill;l.save(),n.textMatrix&&l.transform(...n.textMatrix),l.translate(n.x,n.y+n.textRise),p>0?l.scale(y,-1):l.scale(y,1);let k,O;if(n.patternFill){l.save();const N=n.fillColor.getPattern(l,this,bs(l),Mn.FILL);k=Oe(l),l.restore(),l.fillStyle=N}if(n.patternStroke){l.save();const N=n.strokeColor.getPattern(l,this,bs(l),Mn.STROKE);O=Oe(l),l.restore(),l.strokeStyle=N}let G=n.lineWidth;const H=n.textMatrixScale;if(H===0||G===0){const N=n.textRenderingMode&xn.FILL_STROKE_MASK;(N===xn.STROKE||N===xn.FILL_STROKE)&&(G=this.getSinglePixelWidth())}else G/=H;if(u!==1&&(l.scale(u,u),G/=u),l.lineWidth=G,i.isInvalidPDFjsFont){const N=[];let B=0;for(const V of e)N.push(V.unicode),B+=V.width;const j=N.join("");if(l.fillText(j,0,0),this.dependencyTracker!==null){const V=l.measureText(j);this.dependencyTracker.recordBBox(t,this.ctx,-V.actualBoundingBoxLeft,V.actualBoundingBoxRight,-V.actualBoundingBoxAscent,V.actualBoundingBoxDescent).recordOperation(t).recordIncrementalData("sameLineText",t)}n.x+=B*I*y,l.restore(),this.compose();return}let K=0,P;for(P=0;P<v;++P){const N=e[P];if(typeof N=="number"){K+=T*N*a/1e3;continue}let B=!1;const j=(N.isSpace?f:0)+h,V=N.fontChar,Y=N.accent;let U,Nt,Dt=N.width;if(b){const mt=N.vmetric||S,Mt=-(N.vmetric?mt[1]:Dt*.5)*I,$=mt[2]*I;Dt=mt?-mt[0]:Dt,U=Mt/u,Nt=(K+$)/u}else U=K/u,Nt=0;let J;if(i.remeasure&&Dt>0){J=l.measureText(V);const mt=J.width*1e3/a*u;if(Dt<mt&&this.isFontSubpixelAAEnabled){const Mt=Dt/mt;B=!0,l.save(),l.scale(Mt,1),U/=Mt}else Dt!==mt&&(U+=(Dt-mt)/2e3*a/u)}if(this.contentVisible&&(N.isInFont||i.missingFile)){if(x&&!Y)l.fillText(V,U,Nt),this.dependencyTracker?.recordCharacterBBox(t,l,J?{bbox:null}:i,a/u,U,Nt,()=>J??l.measureText(V));else if(this.paintChar(t,V,U,Nt,k,O),Y){const mt=U+a*Y.offset.x/u,Mt=Nt-a*Y.offset.y/u;this.paintChar(t,Y.fontChar,mt,Mt,k,O)}}const ct=b?Dt*I-j*p:Dt*I+j*p;K+=ct,B&&l.restore()}b?n.y-=K:n.x+=K*y,l.restore(),this.compose(),this.dependencyTracker?.recordOperation(t).recordIncrementalData("sameLineText",t)}showType3Text(t,e){const n=this.ctx,i=this.current,a=i.font,l=i.fontSize,u=i.fontDirection,h=a.vertical?1:-1,f=i.charSpacing,p=i.wordSpacing,y=i.textHScale*u,v=i.fontMatrix||Dy,b=e.length,T=i.textRenderingMode===xn.INVISIBLE;let S,I,x,k;if(T||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),i.textMatrix&&n.transform(...i.textMatrix),n.translate(i.x,i.y+i.textRise),n.scale(y,u);const O=this.dependencyTracker;for(this.dependencyTracker=O?new $f(O,t):null,S=0;S<b;++S){if(I=e[S],typeof I=="number"){k=h*I*l/1e3,this.ctx.translate(k,0),i.x+=k*y;continue}const G=(I.isSpace?p:0)+f,H=a.charProcOperatorList[I.operatorListId];H?this.contentVisible&&(this.save(),n.scale(l,l),n.transform(...v),this.executeOperatorList(H),this.restore()):Gt(`Type3 character "${I.operatorListId}" is not available.`);const K=[I.width,0];St.applyTransform(K,v),x=K[0]*l+G,n.translate(x,0),i.x+=x*y}n.restore(),O&&(this.dependencyTracker.recordNestedDependencies(),this.dependencyTracker=O)}setCharWidth(t,e,n){}setCharWidthAndBounds(t,e,n,i,a,l,u){const h=new Path2D;h.rect(i,a,l-i,u-a),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,i,l,a,u).recordClipBox(t,this.ctx,i,l,a,u),this.endPath(t)}getColorN_Pattern(t,e){let n;if(e[0]==="TilingPattern"){const i=this.baseTransform||Oe(this.ctx),a={createCanvasGraphics:l=>new Ol(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new $f(this.dependencyTracker,t):null)};n=new sv(e,this.ctx,a,i)}else n=this._getPattern(t,e[1],e[2]);return n}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,n=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=QF(this.getObject(t,e)),this.cachedPatterns.set(e,i)),n&&(i.matrix=n),i}shadingFill(t,e){if(!this.contentVisible)return;const n=this.ctx;this.save(t);const i=this._getPattern(t,e);n.fillStyle=i.getPattern(n,this,bs(n),Mn.SHADING);const a=bs(n);if(a){const{width:l,height:u}=n.canvas,h=xl.slice();St.axialAlignedBoundingBox([0,0,l,u],a,h);const[f,p,y,v]=h;this.ctx.fillRect(f,p,y-f,v-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Bi.transform).recordDependencies(t,Bi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Ee("Should not call beginInlineImage")}beginImageData(){Ee("Should not call beginImageData")}paintFormXObjectBegin(t,e,n){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=Oe(this.ctx),n)){St.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[i,a,l,u]=n,h=new Path2D;h.rect(i,a,l-i,u-a),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,i,l,a,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;e.isolated||_p("TODO: Support non-isolated groups."),e.knockout&&Gt("Knockout groups not supported.");const i=Oe(n);if(e.matrix&&n.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let a=xl.slice();St.axialAlignedBoundingBox(e.bbox,Oe(n),a);const l=[0,0,n.canvas.width,n.canvas.height];a=St.intersect(a,l)||[0,0,0,0];const u=Math.floor(a[0]),h=Math.floor(a[1]),f=Math.max(Math.ceil(a[2])-u,1),p=Math.max(Math.ceil(a[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,p]);let y="groupAt"+this.groupLevel;e.smask&&(y+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(y,f,p),b=v.context;b.translate(-u,-h),b.transform(...i);let T=new Path2D;const[S,I,x,k]=e.bbox;if(T.rect(S,I,x-S,k-I),e.matrix){const O=new Path2D;O.addPath(T,new DOMMatrix(e.matrix)),T=O}b.clip(T),e.smask&&this.smaskStack.push({canvas:v.canvas,context:b,offsetX:u,offsetY:h,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(u,h),n.save()),lu(n,b),this.ctx=b,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=Oe(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...a);const l=xl.slice();St.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],a,l),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,e,n,i,a,l){if(this.#t(),nf(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const u=n[2]-n[0],h=n[3]-n[1];if(l&&this.annotationCanvasMap){i=i.slice(),i[4]-=n[0],i[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=u,n[3]=h,St.singularValueDecompose2dScale(Oe(this.ctx),Ei);const{viewportScale:f}=this,p=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(p,y);const{canvas:v,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(e,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(Ei[0],0,0,-Ei[1],0,h*Ei[1]),nf(this.ctx)}else{nf(this.ctx),this.endPath(t);const f=new Path2D;f.rect(n[0],n[1],u,h),this.ctx.clip(f)}}this.current=new kw(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...i),this.transform(t,...a)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const n=e.count;e=this.getObject(t,e.data,e),e.count=n;const i=this.ctx,a=this._createMaskCanvas(t,e),l=a.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(l,a.offsetX,a.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,a.offsetX,a.offsetX+l.width,a.offsetY,a.offsetY+l.height).recordOperation(t),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n,i=0,a=0,l,u){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const h=this.ctx;h.save();const f=Oe(h);h.transform(n,i,a,l,0,0);const p=this._createMaskCanvas(t,e);h.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let y=0,v=u.length;y<v;y+=2){const b=St.transform(f,[n,i,a,l,u[y],u[y+1]]);h.drawImage(p.canvas,b[4],b[5]),this.dependencyTracker?.recordBBox(t,this.ctx,b[4],b[4]+p.canvas.width,b[5],b[5]+p.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx,i=this.current.fillColor,a=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Bi.transformAndFill);for(const l of e){const{data:u,width:h,height:f,transform:p}=l,y=this.cachedCanvases.getCanvas("maskCanvas",h,f),v=y.context;v.save();const b=this.getObject(t,u,l);Ow(v,b),v.globalCompositeOperation="source-in",v.fillStyle=a?i.getPattern(v,this,bs(n),Mn.FILL):i,v.fillRect(0,0,h,f),v.restore(),n.save(),n.transform(...p),n.scale(1,-1),ef(n,y.canvas,0,0,h,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,n,0,h,0,f),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const n=this.getObject(t,e);if(!n){Gt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,n)}paintImageXObjectRepeat(t,e,n,i,a){if(!this.contentVisible)return;const l=this.getObject(t,e);if(!l){Gt("Dependent image isn't ready yet");return}const u=l.width,h=l.height,f=[];for(let p=0,y=a.length;p<y;p+=2)f.push({transform:[n,0,0,i,a[p],a[p+1]],x:0,y:0,w:u,h});this.paintInlineImageXObjectGroup(t,l,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:i}=t,a=this.cachedCanvases.getCanvas("inlineImage",n,i),l=a.context;return l.filter=this.current.transferMaps,l.drawImage(e,0,0),l.filter="none",a.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const n=e.width,i=e.height,a=this.ctx;this.save(t);const{filter:l}=a;l!=="none"&&l!==""&&(a.filter="none"),a.scale(1/n,-1/i);let u;if(e.bitmap)u=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)u=e;else{const p=this.cachedCanvases.getCanvas("inlineImage",n,i).context;Pw(p,e),u=this.applyTransferMapsToCanvas(p)}const h=this._scaleImage(u,bs(a));a.imageSmoothingEnabled=Lw(Oe(a),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,a,0,n,-i,0).recordDependencies(t,Bi.imageXObject).recordOperation(t),ef(a,h.img,0,0,h.paintWidth,h.paintHeight,0,-i,n,i),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,n){if(!this.contentVisible)return;const i=this.ctx;let a;if(e.bitmap)a=e.bitmap;else{const l=e.width,u=e.height,f=this.cachedCanvases.getCanvas("inlineImage",l,u).context;Pw(f,e),a=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const l of n)i.save(),i.transform(...l.transform),i.scale(1,-1),ef(i,a,l.x,l.y,l.w,l.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,1,-1,0),i.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Bi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,n){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,n){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,n){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const a=this.ctx;this.pendingClip?(i||(this.pendingClip===Bw?a.clip(e,"evenodd"):a.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Oe(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:i,d:a}=this.ctx.getTransform();let l,u;if(n===0&&i===0){const h=Math.abs(e),f=Math.abs(a);if(h===f)if(t===0)l=u=1/h;else{const p=h*t;l=u=p<1?1/p:1}else if(t===0)l=1/h,u=1/f;else{const p=h*t,y=f*t;l=p<1?1/p:1,u=y<1?1/y:1}}else{const h=Math.abs(e*a-n*i),f=Math.hypot(e,n),p=Math.hypot(i,a);if(t===0)l=p/h,u=f/h;else{const y=t*h;l=p>y?p/y:1,u=f>y?f/y:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:n,current:{lineWidth:i}}=this,[a,l]=this.getScaleForStroking();if(a===l){n.lineWidth=(i||1)*a,n.stroke(t);return}const u=n.getLineDash();e&&n.save(),n.scale(a,l),Km.a=1/a,Km.d=1/l;const h=new Path2D;if(h.addPath(t,Km),u.length>0){const f=Math.max(a,l);n.setLineDash(u.map(p=>p/f)),n.lineDashOffset/=f}n.lineWidth=i||1,n.stroke(h),e&&n.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const s in $u)Ol.prototype[s]!==void 0&&(Ol.prototype[$u[s]]=Ol.prototype[s]);class Ll{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class rU{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Cl=Symbol("INTERNAL");class aU{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:e,intent:n,usage:i,rbGroups:a}){this.#t=!!(t&vi.DISPLAY),this.#e=!!(t&vi.PRINT),this.name=e,this.intent=n,this.usage=i,this.rbGroups=a}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,n=!1){t!==Cl&&Ee("Internal method `_setVisible` called."),this.#n=n,this.#i=e}}class oU{#t=null;#e=new Map;#n=null;#i=null;constructor(t,e=vi.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const n of t.groups)this.#e.set(n.id,new aU(e,n));if(t.baseState==="OFF")for(const n of this.#e.values())n._setVisible(Cl,!1);for(const n of t.on)this.#e.get(n)._setVisible(Cl,!0);for(const n of t.off)this.#e.get(n)._setVisible(Cl,!1);this.#n=this.getHash()}}#r(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let i=1;i<e;i++){const a=t[i];let l;if(Array.isArray(a))l=this.#r(a);else if(this.#e.has(a))l=this.#e.get(a).visible;else return Gt(`Optional content group not found: ${a}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return _p("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(Gt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return Gt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return Gt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return Gt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return Gt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return Gt(`Unknown optional content policy ${t.policy}.`),!0}return Gt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){const i=this.#e.get(t);if(!i){Gt(`Optional content group not found: ${t}`);return}if(n&&e&&i.rbGroups.length)for(const a of i.rbGroups)for(const l of a)l!==t&&this.#e.get(l)?._setVisible(Cl,!1,!0);i._setVisible(Cl,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let n;for(const i of t){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const a=this.#e.get(i);if(a)switch(n){case"ON":this.setVisibility(i,!0,e);break;case"OFF":this.setVisibility(i,!1,e);break;case"Toggle":this.setVisibility(i,!a.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new pC;for(const[e,n]of this.#e)t.update(`${e}:${n.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class lU{constructor(t,{disableRange:e=!1,disableStream:n=!1}){an(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:a,progressiveDone:l,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=u,a?.length>0){const h=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const i=this._rangeReaders.some(function(a){return a._begin!==t?!1:(a._enqueue(n),!0)});an(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){an(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new cU(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new uU(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class cU{constructor(t,e,n=!1,i=null){this._stream=t,this._done=n||!1,this._filename=J_(i)?i:null,this._queuedChunks=e||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class uU{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function hU(s){let t=!0,e=n("filename\\*","i").exec(s);if(e){e=e[1];let p=u(e);return p=unescape(p),p=h(p),p=f(p),a(p)}if(e=l(s),e){const p=f(e);return a(p)}if(e=n("filename","i").exec(s),e){e=e[1];let p=u(e);return p=f(p),a(p)}function n(p,y){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function i(p,y){if(p){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const v=new TextDecoder(p,{fatal:!0}),b=dh(y);y=v.decode(b),t=!1}catch{}}return y}function a(p){return t&&/[\x80-\xff]/.test(p)&&(p=i("utf-8",p),t&&(p=i("iso-8859-1",p))),p}function l(p){const y=[];let v;const b=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=b.exec(p))!==null;){let[,S,I,x]=v;if(S=parseInt(S,10),S in y){if(S===0)break;continue}y[S]=[I,x]}const T=[];for(let S=0;S<y.length&&S in y;++S){let[I,x]=y[S];x=u(x),I&&(x=unescape(x),S===0&&(x=h(x))),T.push(x)}return T.join("")}function u(p){if(p.startsWith('"')){const y=p.slice(1).split('\\"');for(let v=0;v<y.length;++v){const b=y[v].indexOf('"');b!==-1&&(y[v]=y[v].slice(0,b),y.length=v+1),y[v]=y[v].replaceAll(/\\(.)/g,"$1")}p=y.join('"')}return p}function h(p){const y=p.indexOf("'");if(y===-1)return p;const v=p.slice(0,y),T=p.slice(y+1).replace(/^[^']*'/,"");return i(v,T)}function f(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,v,b,T){if(b==="q"||b==="Q")return T=T.replaceAll("_"," "),T=T.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,I){return String.fromCharCode(parseInt(I,16))}),i(v,T);try{T=atob(T)}catch{}return i(v,T)})}return""}function EC(s,t){const e=new Headers;if(!s||!t||typeof t!="object")return e;for(const n in t){const i=t[n];i!==void 0&&e.append(n,i)}return e}function Ap(s){return URL.parse(s)?.origin??null}function AC({responseHeaders:s,isHttp:t,rangeChunkSize:e,disableRange:n}){const i={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(s.get("Content-Length"),10);return!Number.isInteger(a)||(i.suggestedLength=a,a<=2*e)||n||!t||s.get("Accept-Ranges")!=="bytes"||(s.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function wC(s){const t=s.get("Content-Disposition");if(t){let e=hU(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(J_(e))return e}return null}function mh(s,t){return new qf(`Unexpected server response (${s}) while retrieving PDF "${t}".`,s,s===404||s===0&&t.startsWith("file:"))}function TC(s){return s===200||s===206}function SC(s,t,e){return{method:"GET",headers:s,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function CC(s){return s instanceof Uint8Array?s.buffer:s instanceof ArrayBuffer?s:(Gt(`getArrayBuffer - unexpected data format: ${s}`),new Uint8Array(s).buffer)}class dU{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=EC(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return an(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new fU(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new pU(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class fU{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),i=e.url;fetch(i,SC(n,this._withCredentials,this._abortController)).then(a=>{if(t._responseOrigin=Ap(a.url),!TC(a.status))throw mh(a.status,i);this._reader=a.body.getReader(),this._headersCapability.resolve();const l=a.headers,{allowRangeRequests:u,suggestedLength:h}=AC({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=wC(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Aa("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:CC(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class pU{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const a=new Headers(t.headers);a.append("Range",`bytes=${e}-${n-1}`);const l=i.url;fetch(l,SC(a,this._withCredentials,this._abortController)).then(u=>{const h=Ap(u.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!TC(u.status))throw mh(u.status,l);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:CC(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Wm=200,Qm=206;function gU(s){const t=s.response;return typeof t!="string"?t:dh(t).buffer}class mU{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:n}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=EC(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[a,l]of this.headers)e.setRequestHeader(a,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.expectedStatus=Qm):i.expectedStatus=Wm,e.responseType="arraybuffer",an(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){const n=this.pendingRequests[t];n&&n.onProgress?.(e)}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),i.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],i.status===0&&this.isHttp){n.onError(i.status);return}const a=i.status||Wm;if(!(a===Wm&&n.expectedStatus===Qm)&&a!==n.expectedStatus){n.onError(i.status);return}const u=gU(i);if(a===Qm){const h=i.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?n.onDone({begin:parseInt(f[1],10),chunk:u}):(Gt('Missing or invalid "Content-Range" header.'),n.onError(0))}else u?n.onDone({begin:0,chunk:u}):n.onError(i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class yU{constructor(t){this._source=t,this._manager=new mU(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return an(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new _U(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new vU(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class _U{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=Ap(e.responseURL);const n=e.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...f]=u.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:l}=AC({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=wC(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=mh(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class vU{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=Ap(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=mh(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const bU=/^[a-z][a-z0-9\-+.]+:/i;function EU(s){if(bU.test(s))return new URL(s);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(s))}class AU{constructor(t){this.source=t,this.url=EU(t.url),an(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return an(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new wU(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new TU(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class wU{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=mh(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Aa("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class TU{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=t.source;this._isStreamingSupported=!i.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const cu=Symbol("INITIAL_DATA");class RC{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:cu}}get(t,e=null){if(e){const i=this.#e(t);return i.promise.then(()=>e(i.data)),null}const n=this.#t[t];if(!n||n.data===cu)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=this.#t[t];return!!e&&e.data!==cu}delete(t){const e=this.#t[t];return!e||e.data===cu?!1:(delete this.#t[t],!0)}resolve(t,e=null){const n=this.#e(t);n.data=e,n.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==cu&&(yield[t,e])}}}const SU=1e5,Fw=30;class Kn{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#s=null;#a=0;#o=0;#l=null;#c=null;#d=0;#u=0;#f=Object.create(null);#g=[];#p=null;#h=[];#m=new WeakMap;#v=null;static#y=new Map;static#E=new Map;static#A=new WeakMap;static#_=null;static#w=new Set;constructor({textContentSource:t,container:e,viewport:n}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#c=e,this.#u=n.scale*Ps.pixelRatio,this.#d=n.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:a,pageX:l,pageY:u}=n.rawDims;this.#v=[1,0,0,-1,-l,u+a],this.#o=i,this.#a=a,Kn.#x(),vo(e,n),this.#t.promise.finally(()=>{Kn.#w.delete(this),this.#s=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Pn.platform;return Kt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#l.read().then(({value:e,done:n})=>{if(n){this.#t.resolve();return}this.#r??=e.lang,Object.assign(this.#f,e.styles),this.#I(e.items),t()},this.#t.reject)};return this.#l=this.#p.getReader(),Kn.#w.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const n=t.scale*Ps.pixelRatio,i=t.rotation;if(i!==this.#d&&(e?.(),this.#d=i,vo(this.#c,{rotation:i})),n!==this.#u){e?.(),this.#u=n;const a={div:null,properties:null,ctx:Kn.#M(this.#r)};for(const l of this.#h)a.properties=this.#m.get(l),a.div=l,this.#T(a)}}cancel(){const t=new Aa("TextLayer task cancelled.");this.#l?.cancel(t).catch(()=>{}),this.#l=null,this.#t.reject(t)}get textDivs(){return this.#h}get textContentItemsStr(){return this.#g}#I(t){if(this.#n)return;this.#s.ctx??=Kn.#M(this.#r);const e=this.#h,n=this.#g;for(const i of t){if(e.length>SU){Gt("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){const a=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),i.id&&this.#e.setAttribute("id",`${i.id}`),a.append(this.#e)}else i.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}n.push(i.str),this.#C(i)}}#C(t){const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#h.push(e);const i=St.transform(this.#v,t.transform);let a=Math.atan2(i[1],i[0]);const l=this.#f[t.fontName];l.vertical&&(a+=Math.PI/2);let u=this.#i&&l.fontSubstitution||l.fontFamily;u=Kn.fontFamilyMap.get(u)||u;const h=Math.hypot(i[2],i[3]),f=h*Kn.#O(u,l,this.#r);let p,y;a===0?(p=i[4],y=i[5]-f):(p=i[4]+f*Math.sin(a),y=i[5]-f*Math.cos(a));const v="calc(var(--total-scale-factor) *",b=e.style;this.#e===this.#c?(b.left=`${(100*p/this.#o).toFixed(2)}%`,b.top=`${(100*y/this.#a).toFixed(2)}%`):(b.left=`${v}${p.toFixed(2)}px)`,b.top=`${v}${y.toFixed(2)}px)`),b.fontSize=`${v}${(Kn.#_*h).toFixed(2)}px)`,b.fontFamily=u,n.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#i&&(e.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),a!==0&&(n.angle=a*(180/Math.PI));let T=!1;if(t.str.length>1)T=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const S=Math.abs(t.transform[0]),I=Math.abs(t.transform[3]);S!==I&&Math.max(S,I)/Math.min(S,I)>1.5&&(T=!0)}if(T&&(n.canvasWidth=l.vertical?t.height:t.width),this.#m.set(e,n),this.#s.div=e,this.#s.properties=n,this.#T(this.#s),n.hasText&&this.#e.append(e),n.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this.#e.append(S)}}#T(t){const{div:e,properties:n,ctx:i}=t,{style:a}=e;let l="";if(Kn.#_>1&&(l=`scale(${1/Kn.#_})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:u}=a,{canvasWidth:h,fontSize:f}=n;Kn.#R(i,f*this.#u,u);const{width:p}=i.measureText(e.textContent);p>0&&(l=`scaleX(${h*this.#u/p}) ${l}`)}n.angle!==0&&(l=`rotate(${n.angle}deg) ${l}`),l.length>0&&(a.transform=l)}static cleanup(){if(!(this.#w.size>0)){this.#y.clear();for(const{canvas:t}of this.#E.values())t.remove();this.#E.clear()}}static#M(t=null){let e=this.#E.get(t||="");if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#E.set(t,e),this.#A.set(e,{size:0,family:""})}return e}static#R(t,e,n){const i=this.#A.get(t);e===i.size&&n===i.family||(t.font=`${e}px ${n}`,i.size=e,i.family=n)}static#x(){if(this.#_!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#_=t.getBoundingClientRect().height,t.remove()}static#O(t,e,n){const i=this.#y.get(t);if(i)return i;const a=this.#M(n);a.canvas.width=a.canvas.height=Fw,this.#R(a,Fw,t);const l=a.measureText(""),u=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let f=.8;return u?f=u/(u+h):(Pn.platform.isFirefox&&Gt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#y.set(t,f),f}}class Yu{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function i(a){if(!a)return;let l=null;const u=a.name;if(u==="#text")l=a.value;else if(Yu.shouldBuildText(u))a?.attributes?.textContent?l=a.attributes.textContent:a.value&&(l=a.value);else return;if(l!==null&&e.push({str:l}),!!a.children)for(const h of a.children)i(h)}return i(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const CU=100;function RU(s={}){typeof s=="string"||s instanceof URL?s={url:s}:(s instanceof ArrayBuffer||ArrayBuffer.isView(s))&&(s={data:s});const t=new rv,{docId:e}=t,n=s.url?PF(s.url):null,i=s.data?OF(s.data):null,a=s.httpHeaders||null,l=s.withCredentials===!0,u=s.password??null,h=s.range instanceof IC?s.range:null,f=Number.isInteger(s.rangeChunkSize)&&s.rangeChunkSize>0?s.rangeChunkSize:2**16;let p=s.worker instanceof Xu?s.worker:null;const y=s.verbosity,v=typeof s.docBaseUrl=="string"&&!vp(s.docBaseUrl)?s.docBaseUrl:null,b=Zd(s.cMapUrl),T=s.cMapPacked!==!1,S=s.CMapReaderFactory||(Wn?zF:Cw),I=Zd(s.iccUrl),x=Zd(s.standardFontDataUrl),k=s.StandardFontDataFactory||(Wn?GF:Rw),O=Zd(s.wasmUrl),G=s.WasmFactory||(Wn?qF:Iw),H=s.stopAtErrors!==!0,K=Number.isInteger(s.maxImageSize)&&s.maxImageSize>-1?s.maxImageSize:-1,P=s.isEvalSupported!==!1,N=typeof s.isOffscreenCanvasSupported=="boolean"?s.isOffscreenCanvasSupported:!Wn,B=typeof s.isImageDecoderSupported=="boolean"?s.isImageDecoderSupported:!Wn&&(Pn.platform.isFirefox||!globalThis.chrome),j=Number.isInteger(s.canvasMaxAreaInBytes)?s.canvasMaxAreaInBytes:-1,V=typeof s.disableFontFace=="boolean"?s.disableFontFace:Wn,Y=s.fontExtraProperties===!0,U=s.enableXfa===!0,Nt=s.ownerDocument||globalThis.document,Dt=s.disableRange===!0,J=s.disableStream===!0,ct=s.disableAutoFetch===!0,mt=s.pdfBug===!0,Mt=s.CanvasFactory||(Wn?HF:UF),$=s.FilterFactory||(Wn?jF:VF),ut=s.enableHWA===!0,Q=s.useWasm!==!1,at=h?h.length:s.length??NaN,yt=typeof s.useSystemFonts=="boolean"?s.useSystemFonts:!Wn&&!V,bt=typeof s.useWorkerFetch=="boolean"?s.useWorkerFetch:!!(S===Cw&&k===Rw&&G===Iw&&b&&x&&O&&bu(b,document.baseURI)&&bu(x,document.baseURI)&&bu(O,document.baseURI)),Et=null;dF(y);const It={canvasFactory:new Mt({ownerDocument:Nt,enableHWA:ut}),filterFactory:new $({docId:e,ownerDocument:Nt}),cMapReaderFactory:bt?null:new S({baseUrl:b,isCompressed:T}),standardFontDataFactory:bt?null:new k({baseUrl:x}),wasmFactory:bt?null:new G({baseUrl:O})};p||(p=Xu.create({verbosity:y,port:Ll.workerPort}),t._worker=p);const xt={docId:e,apiVersion:"5.4.149",data:i,password:u,disableAutoFetch:ct,rangeChunkSize:f,length:at,docBaseUrl:v,enableXfa:U,evaluatorOptions:{maxImageSize:K,disableFontFace:V,ignoreErrors:H,isEvalSupported:P,isOffscreenCanvasSupported:N,isImageDecoderSupported:B,canvasMaxAreaInBytes:j,fontExtraProperties:Y,useSystemFonts:yt,useWasm:Q,useWorkerFetch:bt,cMapUrl:b,iccUrl:I,standardFontDataUrl:x,wasmUrl:O}},ee={ownerDocument:Nt,pdfBug:mt,styleElement:Et,loadingParams:{disableAutoFetch:ct,enableXfa:U}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Me=p.messageHandler.sendWithPromise("GetDocRequest",xt,i?[i.buffer]:null);let ke;if(h)ke=new lU(h,{disableRange:Dt,disableStream:J});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");const ln=bu(n)?dU:Wn?AU:yU;ke=new ln({url:n,length:at,httpHeaders:a,withCredentials:l,rangeChunkSize:f,disableRange:Dt,disableStream:J})}return Me.then(ln=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const We=new Eu(e,ln,p.port),we=new DU(We,t,ke,ee,It,ut);t._transport=we,We.send("Ready",null)})}).catch(t._capability.reject),t}class rv{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${rv.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class IC{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#r=[];constructor(t,e,n=!1,i=null){this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=i}addRangeListener(t){this.#r.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const n of this.#r)n(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const n of this.#i)n(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#n)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){Ee("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class IU{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Kt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class xU{#t=!1;constructor(t,e,n,i=!1){this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=i?new ww:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new RC,this._intentStates=new Map,this.destroyed=!1,this.recordedGroups=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:a=!1}={}){return new ph({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:a})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Kt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:n,intent:i="display",annotationMode:a=oa.ENABLE,transform:l=null,background:u=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:y=null,isEditing:v=!1,recordOperations:b=!1,filteredOperationIndexes:T=null}){this._stats?.time("Overall");const S=this._transport.getRenderingIntent(i,a,y,v),{renderingIntent:I,cacheKey:x}=S;this.#t=!1,h||=this._transport.getOptionalContentConfig(I);let k=this._intentStates.get(x);k||(k=Object.create(null),this._intentStates.set(x,k)),k.streamReaderCancelTimeout&&(clearTimeout(k.streamReaderCancelTimeout),k.streamReaderCancelTimeout=null);const O=!!(I&vi.PRINT);k.displayReadyCapability||(k.displayReadyCapability=Promise.withResolvers(),k.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(S));const G=!this.recordedGroups&&(b||this._pdfBug&&globalThis.StepperManager?.enabled),H=N=>{if(k.renderTasks.delete(K),G){const B=K.gfx?.dependencyTracker.take();B?(K.stepper?.setOperatorGroups(B),b&&(this.recordedGroups=B)):b&&(this.recordedGroups=[])}O&&(this.#t=!0),this.#e(),N?(K.capability.reject(N),this._abortOperatorList({intentState:k,reason:N instanceof Error?N:new Error(N)})):K.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},K=new Dl({callback:H,params:{canvas:e,canvasContext:t,dependencyTracker:G?new $F(e):null,viewport:n,transform:l,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:k.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!O,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,filteredOperationIndexes:T});(k.renderTasks||=new Set).add(K);const P=K.task;return Promise.all([k.displayReadyCapability.promise,h]).then(([N,B])=>{if(this.destroyed){H();return}if(this._stats?.time("Rendering"),!(B.renderingIntent&I))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");K.initializeGraphics({transparency:N,optionalContentConfig:B}),K.operatorListChanged()}).catch(H),P}getOperatorList({intent:t="display",annotationMode:e=oa.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){function a(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(t,e,n,i,!0);let u=this._intentStates.get(l.cacheKey);u||(u=Object.create(null),this._intentStates.set(l.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=a,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Yu.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,i){function a(){l.read().then(function({value:h,done:f}){if(f){n(u);return}u.lang??=h.lang,Object.assign(u.styles,h.styles),u.items.push(...h.items),a()},i)}const l=e.getReader(),u={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new ww),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const n=this._intentStates.get(e);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let n=0,i=t.length;n<i;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:i}){const{map:a,transfer:l}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:a,modifiedIds:i},l).getReader(),f=this._intentStates.get(e);f.streamReader=h;const p=()=>{h.read().then(({value:y,done:v})=>{if(v){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),p())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const v of f.renderTasks)v.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};p()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof Q_){let i=CU;e.extraDelay>0&&e.extraDelay<1e3&&(i+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},i);return}}if(t.streamReader.cancel(new Aa(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[i,a]of this._intentStates)if(a===t){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}var la,Wi,dr,ao,Xf,oo,lo,Zn,bf,xC,DC,Au,Bl,Ef;const De=class De{constructor({name:t=null,port:e=null,verbosity:n=fF()}={}){_s(this,Zn);_s(this,la,Promise.withResolvers());_s(this,Wi,null);_s(this,dr,null);_s(this,ao,null);if(this.name=t,this.destroyed=!1,this.verbosity=n,e){if(xe(De,lo).has(e))throw new Error("Cannot use more than one PDFWorker per port.");xe(De,lo).set(e,this),vs(this,Zn,xC).call(this,e)}else vs(this,Zn,DC).call(this)}get promise(){return xe(this,la).promise}get port(){return xe(this,dr)}get messageHandler(){return xe(this,Wi)}destroy(){this.destroyed=!0,xe(this,ao)?.terminate(),si(this,ao,null),xe(De,lo).delete(xe(this,dr)),si(this,dr,null),xe(this,Wi)?.destroy(),si(this,Wi,null)}static create(t){const e=xe(this,lo).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new De(t)}static get workerSrc(){if(Ll.workerSrc)return Ll.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Kt(this,"_setupFakeWorkerGlobal",(async()=>xe(this,Bl,Ef)?xe(this,Bl,Ef):(await import(this.workerSrc)).WorkerMessageHandler)())}};la=new WeakMap,Wi=new WeakMap,dr=new WeakMap,ao=new WeakMap,Xf=new WeakMap,oo=new WeakMap,lo=new WeakMap,Zn=new WeakSet,bf=function(){xe(this,la).resolve(),xe(this,Wi).send("configure",{verbosity:this.verbosity})},xC=function(t){si(this,dr,t),si(this,Wi,new Eu("main","worker",t)),xe(this,Wi).on("ready",()=>{}),vs(this,Zn,bf).call(this)},DC=function(){if(xe(De,oo)||xe(De,Bl,Ef)){vs(this,Zn,Au).call(this);return}let{workerSrc:t}=De;try{De._isSameOrigin(window.location,t)||(t=De._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new Eu("main","worker",e),i=()=>{a.abort(),n.destroy(),e.terminate(),this.destroyed?xe(this,la).reject(new Error("Worker was destroyed")):vs(this,Zn,Au).call(this)},a=new AbortController;e.addEventListener("error",()=>{xe(this,ao)||i()},{signal:a.signal}),n.on("test",u=>{if(a.abort(),this.destroyed||!u){i();return}si(this,Wi,n),si(this,dr,e),si(this,ao,e),vs(this,Zn,bf).call(this)}),n.on("ready",u=>{if(a.abort(),this.destroyed){i();return}try{l()}catch{vs(this,Zn,Au).call(this)}});const l=()=>{const u=new Uint8Array;n.send("test",u,[u.buffer])};l();return}catch{_p("The worker has been disabled.")}vs(this,Zn,Au).call(this)},Au=function(){xe(De,oo)||(Gt("Setting up fake worker."),si(De,oo,!0)),De._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){xe(this,la).reject(new Error("Worker was destroyed"));return}const e=new FF;si(this,dr,e);const n=`fake${TE(De,Xf)._++}`,i=new Eu(n+"_worker",n,e);t.setup(i,e),si(this,Wi,new Eu(n,n+"_worker",e)),vs(this,Zn,bf).call(this)}).catch(t=>{xe(this,la).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Bl=new WeakSet,Ef=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},_s(De,Bl),_s(De,Xf,0),_s(De,oo,!1),_s(De,lo,new WeakMap),Wn&&(si(De,oo,!0),Ll.workerSrc||="./pdf.worker.mjs"),De._isSameOrigin=(t,e)=>{const n=URL.parse(t);if(!n?.origin||n.origin==="null")return!1;const i=new URL(e,n);return n.origin===i.origin},De._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},De.fromPort=t=>{if(SF("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return De.create(t)};let Xu=De;class DU{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#r=null;constructor(t,e,n,i,a,l){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new RC,this.fontLoader=new MF({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}#s(t,e=null){const n=this.#t.get(t);if(n)return n;const i=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,i),i}get annotationStorage(){return Kt(this,"annotationStorage",new ev)}getRenderingIntent(t,e=oa.ENABLE,n=null,i=!1,a=!1){let l=vi.DISPLAY,u=Py;switch(t){case"any":l=vi.ANY;break;case"display":break;case"print":l=vi.PRINT;break;default:Gt(`getRenderingIntent - invalid intent: ${t}`)}const h=l&vi.PRINT&&n instanceof gC?n:this.annotationStorage;switch(e){case oa.DISABLE:l+=vi.ANNOTATIONS_DISABLE;break;case oa.ENABLE:break;case oa.ENABLE_FORMS:l+=vi.ANNOTATIONS_FORMS;break;case oa.ENABLE_STORAGE:l+=vi.ANNOTATIONS_STORAGE,u=h.serializable;break;default:Gt(`getRenderingIntent - invalid annotationMode: ${e}`)}i&&(l+=vi.IS_EDITING),a&&(l+=vi.OPLIST);const{ids:f,hash:p}=h.modifiedIds,y=[l,u.hash,p];return{renderingIntent:l,cacheKey:y.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of this.#e.values())t.push(n._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Kn.cleanup(),this._networkStream?.cancelAllRequests(new Aa("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,i)=>{an(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},i.onPull=()=>{this._fullReader.read().then(function({value:a,done:l}){if(l){i.close();return}an(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{this._fullReader.cancel(a),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:a,contentLength:l}=this._fullReader;return(!i||!a)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{e.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:i,isRangeSupported:a,contentLength:l}}),t.on("GetRangeReader",(n,i)=>{an(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(n.begin,n.end);if(!a){i.close();return}i.onPull=()=>{a.read().then(function({value:l,done:u}){if(u){i.close();return}an(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{i.error(l)})},i.onCancel=l=>{a.cancel(l),i.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new IU(n,this))}),t.on("DocException",n=>{e._capability.reject(ri(n))}),t.on("PasswordRequest",n=>{this.#r=Promise.withResolvers();try{if(!e.onPassword)throw ri(n);const i=a=>{a instanceof Error?this.#r.reject(a):this.#r.resolve({password:a})};e.onPassword(i,n.code)}catch(i){this.#r.reject(i)}return this.#r.promise}),t.on("DataLoaded",n=>{e.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;this.#e.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,i,a])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(i){case"Font":if("error"in a){const f=a.error;Gt(`Error during font loading: ${f}`),this.commonObjs.resolve(n,f);break}const l=this._params.pdfBug&&globalThis.FontInspector?.enabled?(f,p)=>globalThis.FontInspector.fontAdded(f,p):null,u=new kF(a,l);this.fontLoader.bind(u).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!u.fontExtraProperties&&u.data&&(u.data=null),this.commonObjs.resolve(n,u)});break;case"CopyLocalImage":const{imageRef:h}=a;an(h,"The imageRef must be defined.");for(const f of this.#e.values())for(const[,p]of f.objs)if(p?.ref===h)return p.dataLen?(this.commonObjs.resolve(n,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,a);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),t.on("obj",([n,i,a,l])=>{if(this.destroyed)return;const u=this.#e.get(i);if(!u.objs.has(n)){if(u._intentStates.size===0){l?.bitmap?.close();return}switch(a){case"Image":case"Pattern":u.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${a}`)}}}),t.on("DocProgress",n=>{this.destroyed||e.onProgress?.({loaded:n.loaded,total:n.total})}),t.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[n.type];if(!i)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Gt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=this.#n.get(e);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&this.#i.set(a.refStr,t);const l=new xU(e,a,this,this._params.pdfBug);return this.#e.set(e,l),l});return this.#n.set(e,i),i}getPageIndex(t){return Oy(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#s("GetOptionalContentConfig").then(e=>new oU(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(i=>({info:i[0],metadata:i[1]?new rU(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Kn.cleanup()}}cachedPageNumber(t){if(!Oy(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(e)??null}}class NU{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Dl{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:n,commonObjs:i,annotationCanvasMap:a,operatorList:l,pageIndex:u,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:p=!1,pdfBug:y=!1,pageColors:v=null,enableHWA:b=!1,filteredOperationIndexes:T=null}){this.callback=t,this.params=e,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=y,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new NU(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=b,this._dependencyTracker=e.dependencyTracker,this._filteredOperationIndexes=T}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Dl.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Dl.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:i,background:a,dependencyTracker:l}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Ol(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:i,viewport:n,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Dl.#e.delete(this._canvas),t||=new Q_(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._filteredOperationIndexes),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Dl.#e.delete(this._canvas),this.callback())))}}const MU="5.4.149",kU="9e2e9e209";class Fi{#t=null;#e=null;#n;#i=null;#r=!1;#s=!1;#a=null;#o;#l=null;#c=null;static#d=null;static get _keyboardManager(){return Kt(this,"_keyboardManager",new gh([[["Escape","mac+Escape"],Fi.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Fi.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Fi.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Fi.prototype._moveToPrevious],[["Home","mac+Home"],Fi.prototype._moveToBeginning],[["End","mac+End"],Fi.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#s=!1,this.#a=t):this.#s=!0,this.#c=t?._uiManager||e,this.#o=this.#c._eventBus,this.#n=t?.color?.toUpperCase()||this.#c?.highlightColors.values().next().value||"#FFFF98",Fi.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#a&&(t.ariaControls=`${this.#a.id}_colorpicker_dropdown`);const e=this.#c._signal;t.addEventListener("click",this.#p.bind(this),{signal:e}),t.addEventListener("keydown",this.#g.bind(this),{signal:e});const n=this.#e=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#n,t.append(n),t}renderMainDropdown(){const t=this.#i=this.#u();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#u(){const t=document.createElement("div"),e=this.#c._signal;t.addEventListener("contextmenu",zi,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#a&&(t.id=`${this.#a.id}_colorpicker_dropdown`);for(const[n,i]of this.#c.highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",i),a.title=n,a.setAttribute("data-l10n-id",Fi.#d[n]);const l=document.createElement("span");a.append(l),l.className="swatch",l.style.backgroundColor=i,a.ariaSelected=i===this.#n,a.addEventListener("click",this.#f.bind(this,i),{signal:e}),t.append(a)}return t.addEventListener("keydown",this.#g.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:ne.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#p(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#m){this.#p(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#m&&this._hideDropdownFromKeyboard();return}this.#m||this.#p(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#m){this.#p(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#m){this.#p(t);return}this.#i.lastChild?.focus()}#g(t){Fi._keyboardManager.exec(this,t)}#p(t){if(this.#m){this.hideDropdown();return}if(this.#r=t.detail===0,this.#l||(this.#l=new AbortController,window.addEventListener("pointerdown",this.#h.bind(this),{signal:this.#c.combinedSignal(this.#l)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const e=this.#i=this.#u();this.#t.append(e)}#h(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#l?.abort(),this.#l=null}get#m(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#m){this.#a?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const e=this.#c.highlightColors.values();for(const n of this.#i.children)n.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class Ku{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,Ku.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,colorValue:n}=this.#e,i=this.#t=document.createElement("input");return i.type="color",i.value=n||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",Ku.#i[t]),i.addEventListener("input",()=>{this.#n.updateParams(e,i.value)},{signal:this.#n._signal}),i}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function Uw(s){return Math.floor(Math.max(0,Math.min(1,s))*255).toString(16).padStart(2,"0")}function uu(s){return Math.max(0,Math.min(255,255*s))}class Vw{static CMYK_G([t,e,n,i]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+i)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=uu(t),[t,t,t]}static G_HTML([t]){const e=Uw(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(uu)}static RGB_HTML(t){return`#${t.map(Uw).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,i]){return["RGB",1-Math.min(1,t+i),1-Math.min(1,n+i),1-Math.min(1,e+i)]}static CMYK_rgb([t,e,n,i]){return[uu(1-Math.min(1,t+i)),uu(1-Math.min(1,n+i)),uu(1-Math.min(1,e+i))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const i=1-t,a=1-e,l=1-n,u=Math.min(i,a,l);return["CMYK",i,a,l,u]}}class PU{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${e}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${e}`),i}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Ee("Abstract method `_createSVG` called.")}}class Yf extends PU{_createSVG(t){return document.createElementNS(ur,t)}}class NC{static setupStorage(t,e,n,i,a){const l=i.getValue(e,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),a==="print")break;t.addEventListener("input",u=>{i.setValue(e,{value:u.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?t.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&t.removeAttribute("checked"),a==="print")break;t.addEventListener("change",u=>{i.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),a==="print")break;t.addEventListener("input",u=>{i.setValue(e,{value:u.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const u of n.children)u.attributes.value===l.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const h=u.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;i.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:i,linkService:a}){const{attributes:l}=e,u=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${i}`);for(const[h,f]of Object.entries(l))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}u&&a.addLinkAttributes(t,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(t,l.dataId,e,n)}static render(t){const e=t.annotationStorage,n=t.linkService,i=t.xfaHtml,a=t.intent||"display",l=document.createElement(i.name);i.attributes&&this.setAttributes({html:l,element:i,intent:a,linkService:n});const u=a!=="richText",h=t.div;if(h.append(l),t.viewport){const y=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=y}u&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(i.children.length===0){if(i.value){const y=document.createTextNode(i.value);l.append(y),u&&Yu.shouldBuildText(i.name)&&f.push(y)}return{textDivs:f}}const p=[[i,-1,l]];for(;p.length>0;){const[y,v,b]=p.at(-1);if(v+1===y.children.length){p.pop();continue}const T=y.children[++p.at(-1)[1]];if(T===null)continue;const{name:S}=T;if(S==="#text"){const x=document.createTextNode(T.value);f.push(x),b.append(x);continue}const I=T?.attributes?.xmlns?document.createElementNS(T.attributes.xmlns,S):document.createElement(S);if(b.append(I),T.attributes&&this.setAttributes({html:I,element:T,storage:e,intent:a,linkService:n}),T.children?.length>0)p.push([T,-1,I]);else if(T.value){const x=document.createTextNode(T.value);u&&Yu.shouldBuildText(S)&&f.push(x),I.append(x)}}for(const y of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const OU=9,bo=new WeakSet,LU=new Date().getTimezoneOffset()*60*1e3;class jw{static create(t){switch(t.data.annotationType){case nn.LINK:return new av(t);case nn.TEXT:return new BU(t);case nn.WIDGET:switch(t.data.fieldType){case"Tx":return new FU(t);case"Btn":return t.data.radioButton?new MC(t):t.data.checkBox?new VU(t):new jU(t);case"Ch":return new HU(t);case"Sig":return new UU(t)}return new Io(t);case nn.POPUP:return new By(t);case nn.FREETEXT:return new kC(t);case nn.LINE:return new GU(t);case nn.SQUARE:return new qU(t);case nn.CIRCLE:return new $U(t);case nn.POLYLINE:return new PC(t);case nn.CARET:return new XU(t);case nn.INK:return new ov(t);case nn.POLYGON:return new YU(t);case nn.HIGHLIGHT:return new OC(t);case nn.UNDERLINE:return new KU(t);case nn.SQUIGGLY:return new WU(t);case nn.STRIKEOUT:return new QU(t);case nn.STAMP:return new LC(t);case nn.FILEATTACHMENT:return new JU(t);default:return new Ke(t)}}}class Ke{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ke._hasPopupData(this.data)}get hasCommentButton(){return this.enableComment&&this._isEditable&&this.hasPopupElement}get commentButtonPosition(){const{quadPoints:t,rect:e}=this.data;let n=-1/0,i=-1/0;if(t?.length>=8){for(let a=0;a<t.length;a+=8)t[a+1]>i?(i=t[a+1],n=t[a+2]):t[a+1]===i&&(n=Math.max(n,t[a+2]));return[n,i]}return e?[e[2],e[3]]:null}get commentButtonColor(){if(!this.data.color)return null;const[t,e,n]=this.data.color,a=255*(1-(this.data.opacity??1));return this.#i(Math.min(t+a,255),Math.min(e+a,255),Math.min(n+a,255))}#i(t,e,n){t/=255,e/=255,n/=255;const i=Math.max(t,e,n),a=Math.min(t,e,n),l=(i+a)/2,u=((1+Math.sqrt(l))/2*100).toFixed(2);if(i===a)return`hsl(0, 0%, ${u}%)`;const h=i-a;let f;i===t?f=(e-n)/h+(e<n?6:0):i===e?f=(n-t)/h+2:f=(t-e)/h+4,f=(f*60).toFixed(2);const p=(h/(1-Math.abs(2*l-1))*100).toFixed(2);return`hsl(${f}, ${p}%, ${u}%)`}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:n,pageHeight:i,pageX:a,pageY:l}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-a)/n,t[1]=100*(t[1]-l)/i,t}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:n}=t;e&&this.#r(e);let i=this.#n?.popup||this.popup;!i&&n?.text&&(this._createPopup(n),i=this.#n.popup),i&&(i.updateEdited(t),n?.deleted&&(i.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#r(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#r(t){const{container:{style:e},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:l,pageX:u,pageY:h}}}}=this;n?.splice(0,4,...t),e.left=`${100*(t[0]-u)/a}%`,e.top=`${100*(l-t[3]+h)/l}%`,i===0?(e.width=`${100*(t[2]-t[0])/a}%`,e.height=`${100*(t[3]-t[1])/l}%`):this.setRotation(i)}_createContainer(t){const{data:e,parent:{page:n,viewport:i}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",e.id),!(this instanceof Io)&&!(this instanceof av)&&(a.tabIndex=0);const{style:l}=a;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(a.title=e.alternativeText),e.noRotate&&a.classList.add("norotate"),!e.rect||this instanceof By){const{rotation:S}=e;return!e.hasOwnCanvas&&S!==0&&this.setRotation(S,a),a}const{width:u,height:h}=this;if(!t&&e.borderStyle.width>0){l.borderWidth=`${e.borderStyle.width}px`;const S=e.borderStyle.horizontalCornerRadius,I=e.borderStyle.verticalCornerRadius;if(S>0||I>0){const k=`calc(${S}px * var(--total-scale-factor)) / calc(${I}px * var(--total-scale-factor))`;l.borderRadius=k}else if(this instanceof MC){const k=`calc(${u}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=k}switch(e.borderStyle.style){case Sl.SOLID:l.borderStyle="solid";break;case Sl.DASHED:l.borderStyle="dashed";break;case Sl.BEVELED:Gt("Unimplemented border style: beveled");break;case Sl.INSET:Gt("Unimplemented border style: inset");break;case Sl.UNDERLINE:l.borderBottomStyle="solid";break}const x=e.borderColor||null;x?(this.#e=!0,l.borderColor=St.makeHexColor(x[0]|0,x[1]|0,x[2]|0)):l.borderWidth=0}const f=St.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:p,pageHeight:y,pageX:v,pageY:b}=i.rawDims;l.left=`${100*(f[0]-v)/p}%`,l.top=`${100*(f[1]-b)/y}%`;const{rotation:T}=e;return e.hasOwnCanvas||T===0?(l.width=`${100*u/p}%`,l.height=`${100*h/y}%`):this.setRotation(T,a),a}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims;let{width:a,height:l}=this;t%180!==0&&([a,l]=[l,a]),e.style.width=`${100*a/n}%`,e.style.height=`${100*l/i}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,i)=>{const a=i.detail[e],l=a[0],u=a.slice(1);i.target.style[n]=Vw[`${l}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[n]:Vw[`${l}_rgb`](u)})};return Kt(this,"_commonActions",{display:e=>{const{display:n}=e.detail,i=n%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const i of Object.keys(e.detail))(t[i]||n[i])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[i,a]of Object.entries(e)){const l=n[i];if(l){const u={detail:{[i]:a},target:t};l(u),delete e[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,i,a]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,I,x,k]=t.subarray(2,6);if(i===S&&a===I&&e===x&&n===k)return}const{style:l}=this.container;let u;if(this.#e){const{borderColor:S,borderWidth:I}=l;l.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${I}">`],this.container.classList.add("hasBorder")}const h=i-e,f=a-n,{svgFactory:p}=this,y=p.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const v=p.createElement("defs");y.append(v);const b=p.createElement("clipPath"),T=`clippath_${this.data.id}`;b.setAttribute("id",T),b.setAttribute("clipPathUnits","objectBoundingBox"),v.append(b);for(let S=2,I=t.length;S<I;S+=8){const x=t[S],k=t[S+1],O=t[S+2],G=t[S+3],H=p.createElement("rect"),K=(O-e)/h,P=(a-k)/f,N=(x-O)/h,B=(k-G)/f;H.setAttribute("x",K),H.setAttribute("y",P),H.setAttribute("width",N),H.setAttribute("height",B),b.append(H),u?.push(`<rect vector-effect="non-scaling-stroke" x="${K}" y="${P}" width="${N}" height="${B}"/>`)}this.#e&&(u.push("</g></svg>')"),l.backgroundImage=u.join("")),this.container.append(y),this.container.style.clipPath=`url(#${T})`}_createPopup(t=null){const{data:e}=this;let n,i;t?(n={str:t.text},i=t.date):(n=e.contentsObj,i=e.modificationDate);const a=this.#n=new By({data:{color:e.color,titleObj:e.titleObj,modificationDate:i,contentsObj:n,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent.div.append(a.render())}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}render(){Ee("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:a,id:l,exportValues:u}of i){if(a===-1||l===e)continue;const h=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!bo.has(f)){Gt(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:h,domElement:f})}return n}for(const i of document.getElementsByName(t)){const{exportValue:a}=i,l=i.getAttribute("data-element-id");l!==e&&bo.has(i)&&n.push({id:l,exportValue:a,domElement:i})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class av extends Ke{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let i=!1;return t.url?(e.addLinkAttributes(n,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(n,t.action,t.overlaidText),i=!0):t.attachment?(this.#e(n,t.attachment,t.overlaidText,t.attachmentDest),i=!0):t.setOCGState?(this.#n(n,t.setOCGState,t.overlaidText),i=!0):t.dest?(this._bindLink(n,t.dest,t.overlaidText),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),i=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(n),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,n=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),n&&(t.title=n)}_bindNamedAction(t,e,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),n&&(t.title=n),this.#t()}#e(t,e,n="",i=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:n&&(t.title=n),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,i),!1),this.#t()}#n(t,e,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),n&&(t.title=n),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(e.actions)){const a=n.get(i);a&&(t[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:i}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){Gt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(t.onclick=()=>!1);return}t.onclick=()=>{n?.();const{fields:i,refs:a,include:l}=e,u=[];if(i.length!==0||a.length!==0){const p=new Set(a);for(const y of i){const v=this._fieldObjects[y]||[];for(const{id:b}of v)p.add(b)}for(const y of Object.values(this._fieldObjects))for(const v of y)p.has(v.id)===l&&u.push(v)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const h=this.annotationStorage,f=[];for(const p of u){const{id:y}=p;switch(f.push(y),p.type){case"text":{const b=p.defaultValue||"";h.setValue(y,{value:b});break}case"checkbox":case"radiobutton":{const b=p.defaultValue===p.exportValues;h.setValue(y,{value:b});break}case"combobox":case"listbox":{const b=p.defaultValue||"";h.setValue(y,{value:b});break}default:continue}const v=document.querySelector(`[data-element-id="${y}"]`);if(v){if(!bo.has(v)){Gt(`_bindResetFormAction - element not allowed: ${y}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class BU extends Ke{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Io extends Ke{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Pn.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,i,a){n.includes("mouse")?t.addEventListener(n,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:a(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(n,l=>{if(n==="blur"){if(!e.focused||!l.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:a(l)}})})}_setEventListeners(t,e,n,i){for(const[a,l]of n)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,a,l,i),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":St.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||OU,a=t.style;let l;const u=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(f/(Gm*i))||1,y=f/p;l=Math.min(i,h(y/Gm))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);l=Math.min(i,h(f/Gm))}a.fontSize=`calc(${l}px * var(--total-scale-factor))`,a.color=St.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(a.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class FU extends Io{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,i){const a=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[e]=n),a.setValue(l.id,{[i]:n})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const i=t.getValue(e,{value:this.data.fieldValue});let a=i.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let u=i.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=u??a,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",u??a),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),bo.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:y}=this.data,v=!!p&&this.enableScripting;f&&(n.title=f),this._setRequired(n,this.data.required),l&&(n.maxLength=l),n.addEventListener("input",T=>{t.setValue(e,{value:T.target.value}),this.setPropertyOnSiblings(n,"value",T.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",T=>{const S=this.data.defaultFieldValue??"";n.value=h.userValue=S,h.formattedValue=null});let b=T=>{const{formattedValue:S}=h;S!=null&&(T.target.value=S),T.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",S=>{if(h.focused)return;const{target:I}=S;if(v&&(I.type=p,y&&(I.step=y)),h.userValue){const x=h.userValue;if(v)if(p==="time"){const k=new Date(x),O=[k.getHours(),k.getMinutes(),k.getSeconds()];I.value=O.map(G=>G.toString().padStart(2,"0")).join(":")}else I.value=new Date(x-LU).toISOString().split(p==="date"?"T":".",1)[0];else I.value=x}h.lastCommittedValue=I.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const I={value(x){h.userValue=x.detail.value??"",v||t.setValue(e,{value:h.userValue.toString()}),x.target.value=h.userValue},formattedValue(x){const{formattedValue:k}=x.detail;h.formattedValue=k,k!=null&&x.target!==document.activeElement&&(x.target.value=k);const O={formattedValue:k};v&&(O.value=k),t.setValue(e,O)},selRange(x){x.target.setSelectionRange(...x.detail.selRange)},charLimit:x=>{const{charLimit:k}=x.detail,{target:O}=x;if(k===0){O.removeAttribute("maxLength");return}O.setAttribute("maxLength",k);let G=h.userValue;!G||G.length<=k||(G=G.slice(0,k),O.value=h.userValue=G,t.setValue(e,{value:G}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:G,willCommit:!0,commitKey:1,selStart:O.selectionStart,selEnd:O.selectionEnd}}))}};this._dispatchEventFromSandbox(I,S)}),n.addEventListener("keydown",S=>{h.commitKey=1;let I=-1;if(S.key==="Escape"?I=0:S.key==="Enter"&&!this.data.multiLine?I=2:S.key==="Tab"&&(h.commitKey=3),I===-1)return;const{value:x}=S.target;h.lastCommittedValue!==x&&(h.lastCommittedValue=x,h.userValue=x,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:x,willCommit:!0,commitKey:I,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const T=b;b=null,n.addEventListener("blur",S=>{if(!h.focused||!S.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:I}=S;let{value:x}=I;if(v){if(x&&p==="time"){const k=x.split(":").map(O=>parseInt(O,10));x=new Date(2e3,0,1,k[0],k[1],k[2]||0).valueOf(),I.step=""}else x=new Date(x).valueOf();I.type="text"}h.userValue=x,h.lastCommittedValue!==x&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:x,willCommit:!0,commitKey:h.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}),T(S)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",S=>{h.lastCommittedValue=null;const{data:I,target:x}=S,{value:k,selectionStart:O,selectionEnd:G}=x;let H=O,K=G;switch(S.inputType){case"deleteWordBackward":{const P=k.substring(0,O).match(/\w*[^\w]*$/);P&&(H-=P[0].length);break}case"deleteWordForward":{const P=k.substring(O).match(/^[^\w]*\w*/);P&&(K+=P[0].length);break}case"deleteContentBackward":O===G&&(H-=1);break;case"deleteContentForward":O===G&&(K+=1);break}S.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:k,change:I||"",willCommit:!1,selStart:H,selEnd:K}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(b&&n.addEventListener("blur",b),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/l;n.classList.add("comb"),n.style.letterSpacing=`calc(${S}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class UU extends Io{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class VU extends Io{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",t.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return bo.add(a),a.setAttribute("data-element-id",n),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=e.fieldName,i&&a.setAttribute("checked",!0),a.setAttribute("exportValue",e.exportValue),a.tabIndex=0,a.addEventListener("change",l=>{const{name:u,checked:h}=l.target;for(const f of this._getElementsByName(u,n)){const p=h&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}t.setValue(n,{value:h})}),a.addEventListener("resetform",l=>{const u=e.defaultFieldValue||"Off";l.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",l=>{const u={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class MC extends Io{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof i=="string"&&(i=i!==e.buttonValue,t.setValue(n,{value:i})),i)for(const l of this._getElementsByName(e.fieldName,n))t.setValue(l.id,{value:!1});const a=document.createElement("input");if(bo.add(a),a.setAttribute("data-element-id",n),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=e.fieldName,i&&a.setAttribute("checked",!0),a.tabIndex=0,a.addEventListener("change",l=>{const{name:u,checked:h}=l.target;for(const f of this._getElementsByName(u,n))t.setValue(f.id,{value:!1});t.setValue(n,{value:h})}),a.addEventListener("resetform",l=>{const u=e.defaultFieldValue;l.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const l=e.buttonValue;a.addEventListener("updatefromsandbox",u=>{const h={value:f=>{const p=l===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const v=p&&y.id===n;y.domElement&&(y.domElement.checked=v),t.setValue(y.id,{value:v})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class jU extends av{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class HU extends Io{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),i=document.createElement("select");bo.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",p=>{const y=this.data.defaultFieldValue;for(const v of i.options)v.selected=v.value===y});for(const p of this.data.options){const y=document.createElement("option");y.textContent=p.displayValue,y.value=p.exportValue,n.value.includes(p.exportValue)&&(y.setAttribute("selected",!0),a=!1),i.append(y)}let l=null;if(a){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),i.prepend(p),l=()=>{p.remove(),i.removeEventListener("input",l),l=null},i.addEventListener("input",l)}const u=p=>{const y=p?"value":"textContent",{options:v,multiple:b}=i;return b?Array.prototype.filter.call(v,T=>T.selected).map(T=>T[y]):v.selectedIndex===-1?null:v[v.selectedIndex][y]};let h=u(!1);const f=p=>{const y=p.target.options;return Array.prototype.map.call(y,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",p=>{const y={value(v){l?.();const b=v.detail.value,T=new Set(Array.isArray(b)?b:[b]);for(const S of i.options)S.selected=T.has(S.value);t.setValue(e,{value:u(!0)}),h=u(!1)},multipleSelection(v){i.multiple=!0},remove(v){const b=i.options,T=v.detail.remove;b[T].selected=!1,i.remove(T),b.length>0&&Array.prototype.findIndex.call(b,I=>I.selected)===-1&&(b[0].selected=!0),t.setValue(e,{value:u(!0),items:f(v)}),h=u(!1)},clear(v){for(;i.length!==0;)i.remove(0);t.setValue(e,{value:null,items:[]}),h=u(!1)},insert(v){const{index:b,displayValue:T,exportValue:S}=v.detail.insert,I=i.children[b],x=document.createElement("option");x.textContent=T,x.value=S,I?I.before(x):i.append(x),t.setValue(e,{value:u(!0),items:f(v)}),h=u(!1)},items(v){const{items:b}=v.detail;for(;i.length!==0;)i.remove(0);for(const T of b){const{displayValue:S,exportValue:I}=T,x=document.createElement("option");x.textContent=S,x.value=I,i.append(x)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(e,{value:u(!0),items:f(v)}),h=u(!1)},indices(v){const b=new Set(v.detail.indices);for(const T of v.target.options)T.selected=b.has(T.index);t.setValue(e,{value:u(!0)}),h=u(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(y,p)}),i.addEventListener("input",p=>{const y=u(!0),v=u(!1);t.setValue(e,{value:y}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:v,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):i.addEventListener("input",function(p){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class By extends Ke{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:Ke._hasPopupData(e)}),this.elements=n,this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=new zU({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,eventBus:this.linkService.eventBus}),n=[];for(const i of this.elements)i.popup=e,i.container.ariaHasPopup="dialog",n.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(i=>`${W_}${i}`).join(",")),this.container}}class zU{#t=this.#P.bind(this);#e=this.#S.bind(this);#n=this.#U.bind(this);#i=this.#N.bind(this);#r=null;#s=null;#a=null;#o=null;#l=null;#c=null;#d=null;#u=null;#f=!1;#g=null;#p=null;#h=null;#m=null;#v=null;#y=null;#E=null;#A=null;#_=null;#w=null;#I=!1;constructor({container:t,color:e,elements:n,titleObj:i,modificationDate:a,contentsObj:l,richText:u,parent:h,rect:f,parentRect:p,open:y,eventBus:v=null}){this.#s=t,this.#_=i,this.#a=l,this.#A=u,this.#d=h,this.#r=e,this.#E=f,this.#u=p,this.#l=n,this.#c=v,this.#o=My.toDateObject(a),this.trigger=n.flatMap(b=>b.getElementsToTriggerPopup()),this.#C(),this.#s.hidden=!0,y&&this.#N()}#C(){if(this.#p)return;this.#p=new AbortController;const{signal:t}=this.#p;for(const e of this.trigger)e.addEventListener("click",this.#i,{signal:t}),e.addEventListener("mouseenter",this.#n,{signal:t}),e.addEventListener("mouseleave",this.#e,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#t,{signal:t});this.#M()}#T(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#v=t._normalizePoint(t.commentButtonPosition),this.#y=t.commentButtonColor)}#M(){if(this.#m||(this.#v||this.#T(),!this.#v))return;const t=this.#m=document.createElement("button");t.className="annotationCommentButton";const e=this.#l[0].container;t.style.zIndex=e.style.zIndex+1,t.tabIndex=0;const{signal:n}=this.#p;t.addEventListener("hover",this.#i,{signal:n}),t.addEventListener("keydown",this.#t,{signal:n}),t.addEventListener("click",()=>{const[{data:{id:a},annotationEditorType:l}]=this.#l;this.#c?.dispatch("switchannotationeditormode",{source:this,editId:a,mode:l,editComment:!0})},{signal:n});const{style:i}=t;i.left=`calc(${this.#v[0]}%)`,i.top=`calc(${this.#v[1]}% - var(--comment-button-dim))`,this.#y&&(i.backgroundColor=this.#y),e.after(t)}render(){if(this.#g)return;const t=this.#g=document.createElement("div");if(t.className="popup",this.#r){const i=t.style.outlineColor=St.makeHexColor(...this.#r);t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#_?.str){const i=document.createElement("span");i.className="title",e.append(i),{dir:i.dir,str:i.textContent}=this.#_}if(t.append(e),this.#o){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),i.dateTime=this.#o.toISOString(),e.append(i)}const n=this.#R;if(n)NC.render({xfaHtml:n,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const i=this._formatContents(this.#a);t.append(i)}this.#s.append(t)}get#R(){const t=this.#A,e=this.#a;return t?.str&&(!e?.str||e.str===t.str)&&this.#A.html||null}get#x(){return this.#R?.attributes?.style?.fontSize||0}get#O(){return this.#R?.attributes?.style?.color||null}#k(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},i={style:{color:this.#O,fontSize:this.#x?`calc(${this.#x}px * var(--total-scale-factor))`:""}};for(const a of t.split(`
`))e.push({name:"span",value:a,attributes:i});return n}_formatContents({str:t,dir:e}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=e;const i=t.split(/(?:\r\n?|\n)/);for(let a=0,l=i.length;a<l;++a){const u=i[a];n.append(document.createTextNode(u)),a<l-1&&n.append(document.createElement("br"))}return n}#P(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#N()}updateEdited({rect:t,popup:e,deleted:n}){if(n||e?.deleted){this.remove();return}this.#C(),this.#w||={contentsObj:this.#a,richText:this.#A},t&&(this.#h=null),e&&(this.#A=this.#k(e.text),this.#o=My.toDateObject(e.date),this.#a=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#w&&({contentsObj:this.#a,richText:this.#A}=this.#w,this.#w=null,this.#g?.remove(),this.#g=null,this.#h=null)}remove(){this.#p?.abort(),this.#p=null,this.#g?.remove(),this.#g=null,this.#I=!1,this.#f=!1;for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#L(){if(this.#h!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:i,pageY:a}}}=this.#d;let l=!!this.#u,u=l?this.#u:this.#E;for(const T of this.#l)if(!u||St.intersect(T.data.rect,u)!==null){u=T.data.rect,l=!0;break}const h=St.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),p=l?u[2]-u[0]+5:0,y=h[0]+p,v=h[1];this.#h=[100*(y-i)/e,100*(v-a)/n];const{style:b}=this.#s;b.left=`${this.#h[0]}%`,b.top=`${this.#h[1]}%`}#N(){this.#f=!this.#f,this.#f?(this.#U(),this.#s.addEventListener("click",this.#i),this.#s.addEventListener("keydown",this.#t)):(this.#S(),this.#s.removeEventListener("click",this.#i),this.#s.removeEventListener("keydown",this.#t))}#U(){this.#g||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#L(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#S(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#I=this.isVisible,this.#I&&(this.#s.hidden=!0)}maybeShow(){this.#C(),this.#I&&(this.#g||this.#U(),this.#I=!1,this.#s.hidden=!1)}get isVisible(){return this.#s.hidden===!1}}class kC extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=jt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class GU extends Ke{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:n}=this,i=this.svgFactory.create(e,n,!0),a=this.#t=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class qU extends Ke{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:n}=this,i=this.svgFactory.create(e,n,!0),a=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",a/2),l.setAttribute("y",a/2),l.setAttribute("width",e-a),l.setAttribute("height",n-a),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),i.append(l),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class $U extends Ke{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:n}=this,i=this.svgFactory.create(e,n,!0),a=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",e/2),l.setAttribute("cy",n/2),l.setAttribute("rx",e/2-a/2),l.setAttribute("ry",n/2-a/2),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),i.append(l),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class PC extends Ke{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:n,popupRef:i},width:a,height:l}=this;if(!e)return this.container;const u=this.svgFactory.create(a,l,!0);let h=[];for(let p=0,y=e.length;p<y;p+=2){const v=e[p]-t[0],b=t[3]-e[p+1];h.push(`${v},${b}`)}h=h.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",n.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class YU extends PC{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class XU extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class ov extends Ke{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?jt.HIGHLIGHT:jt.INK}#n(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:n,borderStyle:i,popupRef:a}}=this,{transform:l,width:u,height:h}=this.#n(e,t),f=this.svgFactory.create(u,h,!0),p=this.#t=this.svgFactory.createElement("svg:g");f.append(p),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",l);for(let y=0,v=n.length;y<v;y++){const b=this.svgFactory.createElement(this.svgElementName);this.#e.push(b),b.setAttribute("points",n[y].join(",")),p.append(b)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:n,rect:i}=t,a=this.#t;if(e>=0&&a.setAttribute("stroke-width",e||1),n)for(let l=0,u=this.#e.length;l<u;l++)this.#e[l].setAttribute("points",n[l].join(","));if(i){const{transform:l,width:u,height:h}=this.#n(this.data.rotation,i);a.parentElement.setAttribute("viewBox",`0 0 ${u} ${h}`),a.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}get commentButtonPosition(){const{inkLists:t,rect:e}=this.data;if(t?.length>=1){let n=-1/0,i=-1/0;for(const a of t)for(let l=0,u=a.length;l<u;l+=2)a[l+1]>i?(i=a[l+1],n=a[l]):a[l+1]===i&&(n=Math.max(n,a[l]));if(n!==1/0)return[n,i]}return e?[e[2],e[3]]:null}}class OC extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=jt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class KU extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class WU extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class QU extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class LC extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=jt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class JU extends Ke{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let n;e.hasAppearance||e.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#e.bind(this)),this.#t=n;const{isMac:i}=Pn.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(i?a.metaKey:a.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class lv{#t=null;#e=null;#n=new Map;#i=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:i,page:a,viewport:l,structTreeLayer:u}){this.div=t,this.#t=e,this.#e=n,this.#i=u||null,this.page=a,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return this.#n.size>0}async#r(t,e,n){const i=t.firstChild||t,a=i.id=`${W_}${e}`,l=await this.#i?.getAriaAttributes(a);if(l)for(const[u,h]of l)i.setAttribute(u,h);n?n.at(-1).container.after(t):(this.div.append(t),this.#t?.moveElementInDOM(this.div,t,i,!1))}async render(t){const{annotations:e}=t,n=this.div;vo(n,this.viewport);const i=new Map,a={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Yf,annotationStorage:t.annotationStorage||new ev,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of e){if(l.noHTML)continue;const u=l.annotationType===nn.POPUP;if(u){const p=i.get(l.id);if(!p)continue;a.elements=p}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;a.data=l;const h=jw.create(a);if(!h.isRenderable)continue;if(!u&&l.popupRef){const p=i.get(l.popupRef);p?p.push(h):i.set(l.popupRef,[h])}const f=h.render();l.hidden&&(f.style.visibility="hidden"),await this.#r(f,l.id,a.elements),h._isEditable&&(this.#n.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}this.#s()}async addLinkAnnotations(t,e){const n={data:null,layer:this.div,linkService:e,svgFactory:new Yf,parent:this};for(const i of t){i.borderStyle||=lv._defaultBorderStyle,n.data=i;const a=jw.create(n);if(!a.isRenderable)continue;const l=a.render();await this.#r(l,i.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,vo(e,{rotation:t.rotation}),this.#s(),e.hidden=!1}#s(){if(!this.#e)return;const t=this.div;for(const[e,n]of this.#e){const i=t.querySelector(`[data-annotation-id="${e}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:a}=i;a?a.nodeName==="CANVAS"?a.replaceWith(n):a.classList.contains("annotationContent")?a.after(n):a.before(n):i.append(n);const l=this.#n.get(e);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,i.id,n),l._hasNoCanvas=!1):l.canvas=n)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}static get _defaultBorderStyle(){return Kt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Sl.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const sf=/\r\n?|\n/g;class En extends kt{#t;#e="";#n=`${this.id}-editor`;#i=null;#r;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=En.prototype,e=a=>a.isEmpty(),n=wa.TRANSLATE_SMALL,i=wa.TRANSLATE_BIG;return Kt(this,"_keyboardManager",new gh([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}]]))}static _type="freetext";static _editorType=jt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#t=t.color||En._defaultColor||kt._defaultLineColor,this.#r=t.fontSize||En._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(t,e){kt.initialize(t,e);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case ne.FREETEXT_SIZE:En._defaultFontSize=e;break;case ne.FREETEXT_COLOR:En._defaultColor=e;break}}updateParams(t,e){switch(t){case ne.FREETEXT_SIZE:this.#s(e);break;case ne.FREETEXT_COLOR:this.#a(e);break}}static get defaultPropertiesToUpdate(){return[[ne.FREETEXT_SIZE,En._defaultFontSize],[ne.FREETEXT_COLOR,En._defaultColor||kt._defaultLineColor]]}get propertiesToUpdate(){return[[ne.FREETEXT_SIZE,this.#r],[ne.FREETEXT_COLOR,this.#t]]}get toolbarButtons(){return this._colorPicker||=new Ku(this),[["colorPicker",this._colorPicker]]}get colorType(){return ne.FREETEXT_COLOR}get colorValue(){return this.#t}#s(t){const e=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-this.#r)*this.parentScale),this.#r=i,this.#l()},n=this.#r;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ne.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#a(t){const e=i=>{this.#t=this.editorDiv.style.color=i,this._colorPicker?.update(i)},n=this.#t;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ne.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-En._internalPadding*t,-(En._internalPadding+this.#r)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const t=[];this.editorDiv.normalize();let e=null;for(const n of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(t.push(En.#c(n)),e=n);return t.join(`
`)}#l(){const[t,e]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:i,div:a}=this,l=a.style.display,u=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",i.div.append(this.div),n=a.getBoundingClientRect(),a.remove(),a.style.display=l,a.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=n.width/t,this.height=n.height/e):(this.width=n.height/t,this.height=n.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#e,e=this.#e=this.#o().trimEnd();if(t===e)return;const n=i=>{if(this.#e=i,!i){this.remove();return}this.#d(),this._uiManager.rebuild(this),this.#l()};this.addCommands({cmd:()=>{n(e)},undo:()=>{n(t)},mustExec:!1}),this.#l()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){En._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#r}px * var(--total-scale-factor))`,n.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,a]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[u,h]=this.getInitialTranslation();[u,h]=this.pageTranslationToScreen(u,h);const[f,p]=this.pageDimensions,[y,v]=this.pageTranslation;let b,T;switch(this.rotation){case 0:b=t+(l[0]-y)/f,T=e+this.height-(l[1]-v)/p;break;case 90:b=t+(l[0]-y)/f,T=e-(l[1]-v)/p,[u,h]=[h,-u];break;case 180:b=t-this.width+(l[0]-y)/f,T=e-(l[1]-v)/p,[u,h]=[-u,-h];break;case 270:b=t+(l[0]-y-this.height*p)/f,T=e+(l[1]-v-this.width*f)/p,[u,h]=[-h,u];break}this.setAt(b*i,T*a,u,h)}else this._moveAfterPaste(t,e);this.#d(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(sf,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:n}=e;if(n.length===1&&n[0]==="text/plain")return;t.preventDefault();const i=En.#f(e.getData("text")||"").replaceAll(sf,`
`);if(!i)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const l=a.getRangeAt(0);if(!i.includes(`
`)){l.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:u,startOffset:h}=l,f=[],p=[];if(u.nodeType===Node.TEXT_NODE){const b=u.parentElement;if(p.push(u.nodeValue.slice(h).replaceAll(sf,"")),b!==this.editorDiv){let T=f;for(const S of this.editorDiv.childNodes){if(S===b){T=p;continue}T.push(En.#c(S))}}f.push(u.nodeValue.slice(0,h).replaceAll(sf,""))}else if(u===this.editorDiv){let b=f,T=0;for(const S of this.editorDiv.childNodes)T++===h&&(b=p),b.push(En.#c(S))}this.#e=`${f.join(`
`)}${i}${p.join(`
`)}`,this.#d();const y=new Range;let v=Math.sumPrecise(f.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const T=b.nodeValue.length;if(v<=T){y.setStart(b,v),y.setEnd(b,v);break}v-=T}a.removeAllRanges(),a.addRange(y)}#d(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const t of this.#e.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#u(){return this.#e.replaceAll(" "," ")}static#f(t){return t.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=En._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,n){let i=null;if(t instanceof kC){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:h,rotation:f,id:p,popupRef:y,contentsObj:v},textContent:b,textPosition:T,parent:{page:{pageNumber:S}}}=t;if(!b||b.length===0)return null;i=t={annotationType:jt.FREETEXT,color:Array.from(u),fontSize:l,value:b.join(`
`),position:T,pageIndex:S-1,rect:h.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:y,comment:v?.str||null}}const a=await super.deserialize(t,e,n);return a.#r=t.fontSize,a.#t=St.makeHexColor(...t.color),a.#e=En.#f(t.value),a._initialData=i,t.comment&&a.setCommentData(t.comment),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=this.getPDFRect(),n=kt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),i={annotationType:jt.FREETEXT,color:n,fontSize:this.#r,value:this.#u(),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!this.#g(i)?null:(i.id=this.annotationElementId,i)}#g(t){const{value:e,fontSize:n,color:i,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==n||t.color.some((l,u)=>l!==i[u])||t.pageIndex!==a}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:n}=e;n.fontSize=`calc(${this.#r}px * var(--total-scale-factor))`,n.color=this.#t,e.replaceChildren();for(const a of this.#e.split(`
`)){const l=document.createElement("div");l.append(a?document.createTextNode(a):document.createElement("br")),e.append(l)}const i={rect:this.getPDFRect()};return i.popup=this.hasEditedComment?this.comment:{text:this.#e},t.updateEdited(i),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class wt{static PRECISION=1e-4;toSVGPath(){Ee("Abstract method `toSVGPath` must be implemented.")}get box(){Ee("Abstract getter `box` must be implemented.")}serialize(t,e){Ee("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,i,a,l){l||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)l[u]=e+t[u]*i,l[u+1]=n+t[u+1]*a;return l}static _rescaleAndSwap(t,e,n,i,a,l){l||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)l[u]=e+t[u+1]*i,l[u+1]=n+t[u]*a;return l}static _translate(t,e,n,i){i||=new Float32Array(t.length);for(let a=0,l=t.length;a<l;a+=2)i[a]=e+t[a],i[a+1]=n+t[a+1];return i}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,n,i,a){switch(a){case 90:return[1-e/n,t/i];case 180:return[1-t/n,1-e/i];case 270:return[e/n,1-t/i];default:return[t/n,e/i]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,i,a,l){return[(t+5*n)/6,(e+5*i)/6,(5*n+a)/6,(5*i+l)/6,(n+a)/2,(i+l)/2]}}class ro{#t;#e=[];#n;#i;#r=[];#s=new Float32Array(18);#a;#o;#l;#c;#d;#u;#f=[];static#g=8;static#p=2;static#h=ro.#g+ro.#p;constructor({x:t,y:e},n,i,a,l,u=0){this.#t=n,this.#u=a*i,this.#i=l,this.#s.set([NaN,NaN,NaN,NaN,t,e],6),this.#n=u,this.#c=ro.#g*i,this.#l=ro.#h*i,this.#d=i,this.#f.push(t,e)}isEmpty(){return isNaN(this.#s[8])}#m(){const t=this.#s.subarray(4,6),e=this.#s.subarray(16,18),[n,i,a,l]=this.#t;return[(this.#a+(t[0]-e[0])/2-n)/a,(this.#o+(t[1]-e[1])/2-i)/l,(this.#a+(e[0]-t[0])/2-n)/a,(this.#o+(e[1]-t[1])/2-i)/l]}add({x:t,y:e}){this.#a=t,this.#o=e;const[n,i,a,l]=this.#t;let[u,h,f,p]=this.#s.subarray(8,12);const y=t-f,v=e-p,b=Math.hypot(y,v);if(b<this.#l)return!1;const T=b-this.#c,S=T/b,I=S*y,x=S*v;let k=u,O=h;u=f,h=p,f+=I,p+=x,this.#f?.push(t,e);const G=-x/T,H=I/T,K=G*this.#u,P=H*this.#u;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([f+K,p+P],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([f-K,p-P],16),isNaN(this.#s[6])?(this.#r.length===0&&(this.#s.set([u+K,h+P],2),this.#r.push(NaN,NaN,NaN,NaN,(u+K-n)/a,(h+P-i)/l),this.#s.set([u-K,h-P],14),this.#e.push(NaN,NaN,NaN,NaN,(u-K-n)/a,(h-P-i)/l)),this.#s.set([k,O,u,h,f,p],6),!this.isEmpty()):(this.#s.set([k,O,u,h,f,p],6),Math.abs(Math.atan2(O-h,k-u)-Math.atan2(x,I))<Math.PI/2?([u,h,f,p]=this.#s.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((u+f)/2-n)/a,((h+p)/2-i)/l),[u,h,k,O]=this.#s.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((k+u)/2-n)/a,((O+h)/2-i)/l),!0):([k,O,u,h,f,p]=this.#s.subarray(0,6),this.#r.push(((k+5*u)/6-n)/a,((O+5*h)/6-i)/l,((5*u+f)/6-n)/a,((5*h+p)/6-i)/l,((u+f)/2-n)/a,((h+p)/2-i)/l),[f,p,u,h,k,O]=this.#s.subarray(12,18),this.#e.push(((k+5*u)/6-n)/a,((O+5*h)/6-i)/l,((5*u+f)/6-n)/a,((5*h+p)/6-i)/l,((u+f)/2-n)/a,((h+p)/2-i)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,e=this.#e;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#v();const n=[];n.push(`M${t[4]} ${t[5]}`);for(let i=6;i<t.length;i+=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);this.#E(n);for(let i=e.length-6;i>=6;i-=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);return this.#y(n),n.join(" ")}#v(){const[t,e,n,i]=this.#t,[a,l,u,h]=this.#m();return`M${(this.#s[2]-t)/n} ${(this.#s[3]-e)/i} L${(this.#s[4]-t)/n} ${(this.#s[5]-e)/i} L${a} ${l} L${u} ${h} L${(this.#s[16]-t)/n} ${(this.#s[17]-e)/i} L${(this.#s[14]-t)/n} ${(this.#s[15]-e)/i} Z`}#y(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#E(t){const[e,n,i,a]=this.#t,l=this.#s.subarray(4,6),u=this.#s.subarray(16,18),[h,f,p,y]=this.#m();t.push(`L${(l[0]-e)/i} ${(l[1]-n)/a} L${h} ${f} L${p} ${y} L${(u[0]-e)/i} ${(u[1]-n)/a}`)}newFreeDrawOutline(t,e,n,i,a,l){return new BC(t,e,n,i,a,l)}getOutlines(){const t=this.#r,e=this.#e,n=this.#s,[i,a,l,u]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let y=0,v=h.length-2;y<v;y+=2)h[y]=(this.#f[y]-i)/l,h[y+1]=(this.#f[y+1]-a)/u;if(h[h.length-2]=(this.#a-i)/l,h[h.length-1]=(this.#o-a)/u,isNaN(n[6])&&!this.isEmpty())return this.#A(h);const f=new Float32Array(this.#r.length+24+this.#e.length);let p=t.length;for(let y=0;y<p;y+=2){if(isNaN(t[y])){f[y]=f[y+1]=NaN;continue}f[y]=t[y],f[y+1]=t[y+1]}p=this.#w(f,p);for(let y=e.length-6;y>=6;y-=6)for(let v=0;v<6;v+=2){if(isNaN(e[y+v])){f[p]=f[p+1]=NaN,p+=2;continue}f[p]=e[y+v],f[p+1]=e[y+v+1],p+=2}return this.#_(f,p),this.newFreeDrawOutline(f,h,this.#t,this.#d,this.#n,this.#i)}#A(t){const e=this.#s,[n,i,a,l]=this.#t,[u,h,f,p]=this.#m(),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(e[2]-n)/a,(e[3]-i)/l,NaN,NaN,NaN,NaN,(e[4]-n)/a,(e[5]-i)/l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(e[16]-n)/a,(e[17]-i)/l,NaN,NaN,NaN,NaN,(e[14]-n)/a,(e[15]-i)/l],0),this.newFreeDrawOutline(y,t,this.#t,this.#d,this.#n,this.#i)}#_(t,e){const n=this.#e;return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6}#w(t,e){const n=this.#s.subarray(4,6),i=this.#s.subarray(16,18),[a,l,u,h]=this.#t,[f,p,y,v]=this.#m();return t.set([NaN,NaN,NaN,NaN,(n[0]-a)/u,(n[1]-l)/h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,y,v,NaN,NaN,NaN,NaN,(i[0]-a)/u,(i[1]-l)/h],e),e+=24}}class BC extends wt{#t;#e=new Float32Array(4);#n;#i;#r;#s;#a;constructor(t,e,n,i,a,l){super(),this.#a=t,this.#r=e,this.#t=n,this.#s=i,this.#n=a,this.#i=l,this.lastPoint=[NaN,NaN],this.#o(l);const[u,h,f,p]=this.#e;for(let y=0,v=t.length;y<v;y+=2)t[y]=(t[y]-u)/f,t[y+1]=(t[y+1]-h)/p;for(let y=0,v=e.length;y<v;y+=2)e[y]=(e[y]-u)/f,e[y+1]=(e[y+1]-h)/p}toSVGPath(){const t=[`M${this.#a[4]} ${this.#a[5]}`];for(let e=6,n=this.#a.length;e<n;e+=6){if(isNaN(this.#a[e])){t.push(`L${this.#a[e+4]} ${this.#a[e+5]}`);continue}t.push(`C${this.#a[e]} ${this.#a[e+1]} ${this.#a[e+2]} ${this.#a[e+3]} ${this.#a[e+4]} ${this.#a[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,n,i],a){const l=n-t,u=i-e;let h,f;switch(a){case 0:h=wt._rescale(this.#a,t,i,l,-u),f=wt._rescale(this.#r,t,i,l,-u);break;case 90:h=wt._rescaleAndSwap(this.#a,t,e,l,u),f=wt._rescaleAndSwap(this.#r,t,e,l,u);break;case 180:h=wt._rescale(this.#a,n,e,-l,u),f=wt._rescale(this.#r,n,e,-l,u);break;case 270:h=wt._rescaleAndSwap(this.#a,n,i,-l,-u),f=wt._rescaleAndSwap(this.#r,n,i,-l,-u);break}return{outline:Array.from(h),points:[Array.from(f)]}}#o(t){const e=this.#a;let n=e[4],i=e[5];const a=[n,i,n,i];let l=n,u=i;const h=t?Math.max:Math.min;for(let p=6,y=e.length;p<y;p+=6){const v=e[p+4],b=e[p+5];if(isNaN(e[p]))St.pointBoundingBox(v,b,a),u<b?(l=v,u=b):u===b&&(l=h(l,v));else{const T=[1/0,1/0,-1/0,-1/0];St.bezierBoundingBox(n,i,...e.slice(p,p+6),T),St.rectBoundingBox(...T,a),u<T[3]?(l=T[2],u=T[3]):u===T[3]&&(l=h(l,T[2]))}n=v,i=b}const f=this.#e;f[0]=a[0]-this.#n,f[1]=a[1]-this.#n,f[2]=a[2]-a[0]+2*this.#n,f[3]=a[3]-a[1]+2*this.#n,this.lastPoint=[l,u]}get box(){return this.#e}newOutliner(t,e,n,i,a,l=0){return new ro(t,e,n,i,a,l)}getNewOutline(t,e){const[n,i,a,l]=this.#e,[u,h,f,p]=this.#t,y=a*f,v=l*p,b=n*f+u,T=i*p+h,S=this.newOutliner({x:this.#r[0]*y+b,y:this.#r[1]*v+T},this.#t,this.#s,t,this.#i,e??this.#n);for(let I=2;I<this.#r.length;I+=2)S.add({x:this.#r[I]*y+b,y:this.#r[I+1]*v+T});return S.getOutlines()}}class Fy{#t;#e;#n=[];#i=[];constructor(t,e=0,n=0,i=!0){const a=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:b,y:T,width:S,height:I}of t){const x=Math.floor((b-e)/l)*l,k=Math.ceil((b+S+e)/l)*l,O=Math.floor((T-e)/l)*l,G=Math.ceil((T+I+e)/l)*l,H=[x,O,G,!0],K=[k,O,G,!1];this.#n.push(H,K),St.rectBoundingBox(x,O,k,G,a)}const u=a[2]-a[0]+2*n,h=a[3]-a[1]+2*n,f=a[0]-n,p=a[1]-n,y=this.#n.at(i?-1:-2),v=[y[0],y[2]];for(const b of this.#n){const[T,S,I]=b;b[0]=(T-f)/u,b[1]=(S-p)/h,b[2]=(I-p)/h}this.#t=new Float32Array([f,p,u,h]),this.#e=v}getOutlines(){this.#n.sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#l(e)),this.#a(e)):(this.#o(e),t.push(...this.#l(e)));return this.#r(t)}#r(t){const e=[],n=new Set;for(const l of t){const[u,h,f]=l;e.push([u,h,l],[u,f,l])}e.sort((l,u)=>l[1]-u[1]||l[0]-u[0]);for(let l=0,u=e.length;l<u;l+=2){const h=e[l][2],f=e[l+1][2];h.push(f),f.push(h),n.add(h),n.add(f)}const i=[];let a;for(;n.size>0;){const l=n.values().next().value;let[u,h,f,p,y]=l;n.delete(l);let v=u,b=h;for(a=[u,f],i.push(a);;){let T;if(n.has(p))T=p;else if(n.has(y))T=y;else break;n.delete(T),[u,h,f,p,y]=T,v!==u&&(a.push(v,b,u,b===h?h:f),v=u),b=b===h?f:h}a.push(v,b)}return new ZU(i,this.#t,this.#e)}#s(t){const e=this.#i;let n=0,i=e.length-1;for(;n<=i;){const a=n+i>>1,l=e[a][0];if(l===t)return a;l<t?n=a+1:i=a-1}return i+1}#a([,t,e]){const n=this.#s(t);this.#i.splice(n,0,[t,e])}#o([,t,e]){const n=this.#s(t);for(let i=n;i<this.#i.length;i++){const[a,l]=this.#i[i];if(a!==t)break;if(a===t&&l===e){this.#i.splice(i,1);return}}for(let i=n-1;i>=0;i--){const[a,l]=this.#i[i];if(a!==t)break;if(a===t&&l===e){this.#i.splice(i,1);return}}}#l(t){const[e,n,i]=t,a=[[e,n,i]],l=this.#s(i);for(let u=0;u<l;u++){const[h,f]=this.#i[u];for(let p=0,y=a.length;p<y;p++){const[,v,b]=a[p];if(!(f<=v||b<=h)){if(v>=h){if(b>f)a[p][1]=f;else{if(y===1)return[];a.splice(p,1),p--,y--}continue}a[p][2]=h,b>f&&a.push([e,f,b])}}}return a}}class ZU extends wt{#t;#e;constructor(t,e,n){super(),this.#e=t,this.#t=e,this.lastPoint=n}toSVGPath(){const t=[];for(const e of this.#e){let[n,i]=e;t.push(`M${n} ${i}`);for(let a=2;a<e.length;a+=2){const l=e[a],u=e[a+1];l===n?(t.push(`V${u}`),i=u):u===i&&(t.push(`H${l}`),n=l)}t.push("Z")}return t.join(" ")}serialize([t,e,n,i],a){const l=[],u=n-t,h=i-e;for(const f of this.#e){const p=new Array(f.length);for(let y=0;y<f.length;y+=2)p[y]=t+f[y]*u,p[y+1]=i-f[y+1]*h;l.push(p)}return l}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Uy extends ro{newFreeDrawOutline(t,e,n,i,a,l){return new tV(t,e,n,i,a,l)}}class tV extends BC{newOutliner(t,e,n,i,a,l=0){return new Uy(t,e,n,i,a,l)}}class $e extends kt{#t=null;#e=0;#n;#i=null;#r=null;#s=null;#a=null;#o=0;#l=null;#c=null;#d=null;#u=!1;#f=null;#g;#p=null;#h="";#m;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=jt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=$e.prototype;return Kt(this,"_keyboardManager",new gh([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||$e._defaultColor,this.#m=t.thickness||$e._defaultThickness,this.#g=t.opacity||$e._defaultOpacity,this.#n=t.boxes||null,this.#v=t.methodOfCreation||"",this.#h=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#u=!0,this.#E(t),this.#C()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#a=t.focusNode,this.#o=t.focusOffset,this.#y(),this.#C(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#m,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}get commentColor(){return this.color}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#y(){const t=new Fy(this.#n,.001);this.#c=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const e=new Fy(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=e.getOutlines();const{lastPoint:n}=this.#s;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#E({highlightOutlines:t,highlightId:e,clipPathId:n}){this.#c=t;const i=1.5;if(this.#s=t.getNewOutline(this.#m/2+i,.0025),e>=0)this.#d=e,this.#i=n,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:$e.#T(this.#c.box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:$e.#T(this.#s.box,p),path:{d:this.#s.toSVGPath()}})}const[a,l,u,h]=t.box;switch(this.rotation){case 0:this.x=a,this.y=l,this.width=u,this.height=h;break;case 90:{const[p,y]=this.parentDimensions;this.x=l,this.y=1-a,this.width=u*y/p,this.height=h*p/y;break}case 180:this.x=1-a,this.y=1-l,this.width=u,this.height=h;break;case 270:{const[p,y]=this.parentDimensions;this.x=1-l,this.y=a,this.width=u*y/p,this.height=h*p/y;break}}const{lastPoint:f}=this.#s;this.#f=[(f[0]-a)/u,(f[1]-l)/h]}static initialize(t,e){kt.initialize(t,e),$e._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case ne.HIGHLIGHT_COLOR:$e._defaultColor=e;break;case ne.HIGHLIGHT_THICKNESS:$e._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#f}updateParams(t,e){switch(t){case ne.HIGHLIGHT_COLOR:this.#A(e);break;case ne.HIGHLIGHT_THICKNESS:this.#_(e);break}}static get defaultPropertiesToUpdate(){return[[ne.HIGHLIGHT_COLOR,$e._defaultColor],[ne.HIGHLIGHT_THICKNESS,$e._defaultThickness]]}get propertiesToUpdate(){return[[ne.HIGHLIGHT_COLOR,this.color||$e._defaultColor],[ne.HIGHLIGHT_THICKNESS,this.#m||$e._defaultThickness],[ne.HIGHLIGHT_FREE,this.#u]]}#A(t){const e=(a,l)=>{this.color=a,this.#g=l,this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:a,"fill-opacity":l}}),this.#r?.updateColor(a)},n=this.color,i=this.#g;this.addCommands({cmd:e.bind(this,t,$e._defaultOpacity),undo:e.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ne.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#_(t){const e=this.#m,n=i=>{this.#m=i,this.#w(i)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ne.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new Fi({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#x())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#x())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#I(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#C(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#I():t&&(this.#C(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#w(t){if(!this.#u)return;this.#E({highlightOutlines:this.#c.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,n]=this.parentDimensions;this.setDims(this.width*e,this.height*n)}#I(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#C(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#g},rootClass:{highlight:!0,free:this.#u},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#u),this.#l&&(this.#l.style.clipPath=this.#i))}static#T([t,e,n,i],a){switch(a){case 90:return[1-e-i,t,i,n];case 180:return[1-t-n,1-e-i,n,i];case 270:return[e,1-t-n,i,n]}return[t,e,n,i]}rotate(t){const{drawLayer:e}=this.parent;let n;this.#u?(t=(t-this.rotation+360)%360,n=$e.#T(this.#c.box,t)):n=$e.#T([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:n,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:$e.#T(this.#s.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#h&&(t.setAttribute("aria-label",this.#h),t.setAttribute("role","mark")),this.#u?t.classList.add("free"):this.div.addEventListener("keydown",this.#M.bind(this),{signal:this._uiManager._signal});const e=this.#l=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#i;const[n,i]=this.parentDimensions;return this.setDims(this.width*n,this.height*i),fC(this,this.#l,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#M(t){$e._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#R(!0);break;case 1:case 3:this.#R(!1);break}}#R(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#a,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#R(!1))}get _mustFixPosition(){return!this.#u}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#x(){return this.#u?this.rotation:0}#O(){if(this.#u)return null;const[t,e]=this.pageDimensions,[n,i]=this.pageTranslation,a=this.#n,l=new Float32Array(a.length*8);let u=0;for(const{x:h,y:f,width:p,height:y}of a){const v=h*t+n,b=(1-f)*e+i;l[u]=l[u+4]=v,l[u+1]=l[u+3]=b,l[u+2]=l[u+6]=v+p*t,l[u+5]=l[u+7]=b-y*e,u+=8}return l}#k(t){return this.#c.serialize(t,this.#x())}static startHighlighting(t,e,{target:n,x:i,y:a}){const{x:l,y:u,width:h,height:f}=n.getBoundingClientRect(),p=new AbortController,y=t.combinedSignal(p),v=b=>{p.abort(),this.#L(t,b)};window.addEventListener("blur",v,{signal:y}),window.addEventListener("pointerup",v,{signal:y}),window.addEventListener("pointerdown",rn,{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",zi,{signal:y}),n.addEventListener("pointermove",this.#P.bind(this,t),{signal:y}),this._freeHighlight=new Uy({x:i,y:a},[l,u,h,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#P(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#L(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,n){let i=null;if(t instanceof OC){const{data:{quadPoints:T,rect:S,rotation:I,id:x,color:k,opacity:O,popupRef:G,contentsObj:H},parent:{page:{pageNumber:K}}}=t;i=t={annotationType:jt.HIGHLIGHT,color:Array.from(k),opacity:O,quadPoints:T,boxes:null,pageIndex:K-1,rect:S.slice(0),rotation:I,annotationElementId:x,id:x,deleted:!1,popupRef:G,comment:H?.str||null}}else if(t instanceof ov){const{data:{inkLists:T,rect:S,rotation:I,id:x,color:k,borderStyle:{rawWidth:O},popupRef:G,contentsObj:H},parent:{page:{pageNumber:K}}}=t;i=t={annotationType:jt.HIGHLIGHT,color:Array.from(k),thickness:O,inkLists:T,boxes:null,pageIndex:K-1,rect:S.slice(0),rotation:I,annotationElementId:x,id:x,deleted:!1,popupRef:G,comment:H?.str||null}}const{color:a,quadPoints:l,inkLists:u,opacity:h}=t,f=await super.deserialize(t,e,n);f.color=St.makeHexColor(...a),f.#g=h||1,u&&(f.#m=t.thickness),f._initialData=i,t.comment&&f.setCommentData(t.comment);const[p,y]=f.pageDimensions,[v,b]=f.pageTranslation;if(l){const T=f.#n=[];for(let S=0;S<l.length;S+=8)T.push({x:(l[S]-v)/p,y:1-(l[S+1]-b)/y,width:(l[S+2]-l[S])/p,height:(l[S+1]-l[S+5])/y});f.#y(),f.#C(),f.rotate(f.rotation)}else if(u){f.#u=!0;const T=u[0],S={x:T[0]-v,y:y-(T[1]-b)},I=new Uy(S,[0,0,p,y],1,f.#m/2,!0,.001);for(let O=0,G=T.length;O<G;O+=2)S.x=T[O]-v,S.y=y-(T[O+1]-b),I.add(S);const{id:x,clipPathId:k}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:I.toSVGPath()}},!0,!0);f.#E({highlightOutlines:I.getOutlines(),highlightId:x,clipPathId:k}),f.#C(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getPDFRect(),n=kt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i={annotationType:jt.HIGHLIGHT,color:n,opacity:this.#g,thickness:this.#m,quadPoints:this.#O(),outlines:this.#k(e),pageIndex:this.pageIndex,rect:e,rotation:this.#x(),structTreeParentId:this._structTreeParentId};return this.addComment(i),this.annotationElementId&&!this.#N(i)?null:(i.id=this.annotationElementId,i)}#N(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((n,i)=>n!==e[i])}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const e={rect:this.getPDFRect()};return this.hasEditedComment&&(e.popup=this.comment),t.updateEdited(e),null}static canCreateNewEmptyEditor(){return!1}}class FC{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,n)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Ee("Not implemented")}}class Bt extends kt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#r=null;static#s=NaN;static#a=null;static#o=null;static#l=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(this.#c(t),this.#f())}#c({drawOutlines:t,drawId:e,drawingOptions:n}){this.#t=t,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#h(t.box)}#d(t,e){const{id:n}=e.drawLayer.draw(Bt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(t,e){const n=new Set(Object.keys(t));for(const[i,a]of Object.entries(e))n.has(i)?Object.assign(t[i],a):t[i]=a;return t}static getDefaultDrawingOptions(t){Ee("Not implemented")}static get typesMap(){Ee("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,e),this._currentParent&&(Bt.#n.updateProperty(n,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[n,i]of this.typesMap)t.push([n,e[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[n,i]of this.constructor.typesMap)t.push([n,e[i]]);return t}_updateProperty(t,e,n){const i=this._drawingOptions,a=i[e],l=u=>{i.updateProperty(e,u);const h=this.#t.updateProperty(e,u);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),t===this.colorType&&this._colorPicker?.update(u)};this.addCommands({cmd:l.bind(this,n),undo:l.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#m()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#m()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#m()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#m()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#u()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#g([t,e,n,i]){const{parentDimensions:[a,l],rotation:u}=this;switch(u){case 90:return[e,1-t,n*(l/a),i*(a/l)];case 180:return[1-t,1-e,n,i];case 270:return[1-e,t,n*(l/a),i*(a/l)];default:return[t,e,n,i]}}#p(){const{x:t,y:e,width:n,height:i,parentDimensions:[a,l],rotation:u}=this;switch(u){case 90:return[1-e,t,n*(a/l),i*(l/a)];case 180:return[1-t,1-e,n,i];case 270:return[e,1-t,n*(a/l),i*(l/a)];default:return[t,e,n,i]}}#h(t){if([this.x,this.y,this.width,this.height]=this.#g(t),this.div){this.fixAndSetPosition();const[e,n]=this.parentDimensions;this.setDims(this.width*e,this.height*n)}this._onResized()}#m(){const{x:t,y:e,width:n,height:i,rotation:a,parentRotation:l,parentDimensions:[u,h]}=this;switch((a*4+l)/90){case 1:return[1-e-i,t,i,n];case 2:return[1-t-n,1-e-i,n,i];case 3:return[e,1-t-n,i,n];case 4:return[t,e-n*(u/h),i*(h/u),n*(u/h)];case 5:return[1-e,t,n*(u/h),i*(h/u)];case 6:return[1-t-i*(h/u),1-e,i*(h/u),n*(u/h)];case 7:return[e-n*(u/h),1-t-i*(h/u),n*(u/h),i*(h/u)];case 8:return[t-n,e-i,n,i];case 9:return[1-e,t-n,i,n];case 10:return[1-t,1-e,n,i];case 11:return[e-i,1-t,i,n];case 12:return[t-i*(h/u),e,i*(h/u),n*(u/h)];case 13:return[1-e-n*(u/h),t-i*(h/u),n*(u/h),i*(h/u)];case 14:return[1-t,1-e-n*(u/h),i*(h/u),n*(u/h)];case 15:return[e,1-t,n*(u/h),i*(h/u)];default:return[t,e,n,i]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties({bbox:this.#m()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const n=super.render();n.classList.add("draw");const i=document.createElement("div");n.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[a,l]=this.parentDimensions;return this.setDims(this.width*a,this.height*l),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),n}static createDrawerInstance(t,e,n,i,a){Ee("Not implemented")}static startDrawing(t,e,n,i){const{target:a,offsetX:l,offsetY:u,pointerId:h,pointerType:f}=i;if(Bt.#a&&Bt.#a!==f)return;const{viewport:{rotation:p}}=t,{width:y,height:v}=a.getBoundingClientRect(),b=Bt.#i=new AbortController,T=t.combinedSignal(b);if(Bt.#s||=h,Bt.#a??=f,window.addEventListener("pointerup",S=>{Bt.#s===S.pointerId?this._endDraw(S):Bt.#o?.delete(S.pointerId)},{signal:T}),window.addEventListener("pointercancel",S=>{Bt.#s===S.pointerId?this._currentParent.endDrawingSession():Bt.#o?.delete(S.pointerId)},{signal:T}),window.addEventListener("pointerdown",S=>{Bt.#a===S.pointerType&&((Bt.#o||=new Set).add(S.pointerId),Bt.#n.isCancellable()&&(Bt.#n.removeLastElement(),Bt.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:T}),window.addEventListener("contextmenu",zi,{signal:T}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:T}),a.addEventListener("touchmove",S=>{S.timeStamp===Bt.#l&&rn(S)},{signal:T}),t.toggleDrawing(),e._editorUndoBar?.hide(),Bt.#n){t.drawLayer.updateProperties(this._currentDrawId,Bt.#n.startNew(l,u,y,v,p));return}e.updateUIForDefaultProperties(this),Bt.#n=this.createDrawerInstance(l,u,y,v,p),Bt.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Bt.#r.toSVGProperties(),Bt.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Bt.#l=-1,!Bt.#n)return;const{offsetX:e,offsetY:n,pointerId:i}=t;if(Bt.#s===i){if(Bt.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Bt.#n.add(e,n)),Bt.#l=t.timeStamp,rn(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Bt.#n=null,Bt.#r=null,Bt.#a=null,Bt.#l=NaN),Bt.#i&&(Bt.#i.abort(),Bt.#i=null,Bt.#s=NaN,Bt.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Bt.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const n=Bt.#n,i=this._currentDrawId,a=n.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(i,n.setLastElement(a))},undo:()=>{e.drawLayer.updateProperties(i,n.removeLastElement())},mustExec:!1,type:ne.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(ne.DRAW_STEP),!Bt.#n.isEmpty()){const{pageDimensions:[n,i],scale:a}=e,l=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Bt.#n.getOutlines(n*a,i*a,a,this._INNER_MARGIN),drawingOptions:Bt.#r,mustBeCommitted:!t});return this._cleanup(!0),l}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,n,i,a,l){Ee("Not implemented")}static async deserialize(t,e,n){const{rawDims:{pageWidth:i,pageHeight:a,pageX:l,pageY:u}}=e.viewport,h=this.deserializeDraw(l,u,i,a,this._INNER_MARGIN,t),f=await super.deserialize(t,e,n);return f.createDrawingOptions(t),f.#c({drawOutlines:h}),f.#f(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,n]=this.pageTranslation,[i,a]=this.pageDimensions;return this.#t.serialize([e,n,i,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class eV{#t=new Float64Array(6);#e;#n;#i;#r;#s;#a="";#o=0;#l=new yh;#c;#d;constructor(t,e,n,i,a,l){this.#c=n,this.#d=i,this.#i=a,this.#r=l,[t,e]=this.#u(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#s=[t,e],this.#n=[{line:u,points:this.#s}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#r=e)}#u(t,e){return wt._normalizePoint(t,e,this.#c,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#s.length<=10}add(t,e){[t,e]=this.#u(t,e);const[n,i,a,l]=this.#t.subarray(2,6),u=t-a,h=e-l;return Math.hypot(this.#c*u,this.#d*h)<=2?null:(this.#s.push(t,e),isNaN(n)?(this.#t.set([a,l,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([n,i,a,l,t,e],0),this.#e.push(...wt.createBezierPoints(n,i,a,l,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const n=this.add(t,e);return n||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,i,a){this.#c=n,this.#d=i,this.#i=a,[t,e]=this.#u(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#s=[t,e];const u=this.#n.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#n.push({line:l,points:this.#s}),this.#t.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#s=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#l.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#l.removeLastElement();this.#n.pop(),this.#a="";for(let t=0,e=this.#n.length;t<e;t++){const{line:n,points:i}=this.#n[t];this.#e=n,this.#s=i,this.#o=0,this.toSVGPath()}return{path:{d:this.#a}}}toSVGPath(){const t=wt.svgRound(this.#e[4]),e=wt.svgRound(this.#e[5]);if(this.#s.length===2)return this.#a=`${this.#a} M ${t} ${e} Z`,this.#a;if(this.#s.length<=6){const i=this.#a.lastIndexOf("M");this.#a=`${this.#a.slice(0,i)} M ${t} ${e}`,this.#o=6}if(this.#s.length===4){const i=wt.svgRound(this.#e[10]),a=wt.svgRound(this.#e[11]);return this.#a=`${this.#a} L ${i} ${a}`,this.#o=12,this.#a}const n=[];this.#o===0&&(n.push(`M ${t} ${e}`),this.#o=6);for(let i=this.#o,a=this.#e.length;i<a;i+=6){const[l,u,h,f,p,y]=this.#e.slice(i,i+6).map(wt.svgRound);n.push(`C${l} ${u} ${h} ${f} ${p} ${y}`)}return this.#a+=n.join(" "),this.#o=this.#e.length,this.#a}getOutlines(t,e,n,i){const a=this.#n.at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),this.#l.build(this.#n,t,e,n,this.#i,this.#r,i),this.#t=null,this.#e=null,this.#n=null,this.#a=null,this.#l}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class yh extends wt{#t;#e=0;#n;#i;#r;#s;#a;#o;#l;build(t,e,n,i,a,l,u){this.#r=e,this.#s=n,this.#a=i,this.#o=a,this.#l=l,this.#n=u??0,this.#i=t,this.#u()}get thickness(){return this.#l}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#i){if(t.push(`M${wt.svgRound(e[4])} ${wt.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${wt.svgRound(e[10])} ${wt.svgRound(e[11])}`);continue}for(let n=6,i=e.length;n<i;n+=6){const[a,l,u,h,f,p]=e.subarray(n,n+6).map(wt.svgRound);t.push(`C${a} ${l} ${u} ${h} ${f} ${p}`)}}return t.join("")}serialize([t,e,n,i],a){const l=[],u=[],[h,f,p,y]=this.#d();let v,b,T,S,I,x,k,O,G;switch(this.#o){case 0:G=wt._rescale,v=t,b=e+i,T=n,S=-i,I=t+h*n,x=e+(1-f-y)*i,k=t+(h+p)*n,O=e+(1-f)*i;break;case 90:G=wt._rescaleAndSwap,v=t,b=e,T=n,S=i,I=t+f*n,x=e+h*i,k=t+(f+y)*n,O=e+(h+p)*i;break;case 180:G=wt._rescale,v=t+n,b=e,T=-n,S=i,I=t+(1-h-p)*n,x=e+f*i,k=t+(1-h)*n,O=e+(f+y)*i;break;case 270:G=wt._rescaleAndSwap,v=t+n,b=e+i,T=-n,S=-i,I=t+(1-f-y)*n,x=e+(1-h-p)*i,k=t+(1-f)*n,O=e+(1-h)*i;break}for(const{line:H,points:K}of this.#i)l.push(G(H,v,b,T,S,a?new Array(H.length):null)),u.push(G(K,v,b,T,S,a?new Array(K.length):null));return{lines:l,points:u,rect:[I,x,k,O]}}static deserialize(t,e,n,i,a,{paths:{lines:l,points:u},rotation:h,thickness:f}){const p=[];let y,v,b,T,S;switch(h){case 0:S=wt._rescale,y=-t/n,v=e/i+1,b=1/n,T=-1/i;break;case 90:S=wt._rescaleAndSwap,y=-e/i,v=-t/n,b=1/i,T=1/n;break;case 180:S=wt._rescale,y=t/n+1,v=-e/i,b=-1/n,T=1/i;break;case 270:S=wt._rescaleAndSwap,y=e/i+1,v=t/n+1,b=-1/i,T=-1/n;break}if(!l){l=[];for(const x of u){const k=x.length;if(k===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1]]));continue}if(k===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1],NaN,NaN,NaN,NaN,x[2],x[3]]));continue}const O=new Float32Array(3*(k-2));l.push(O);let[G,H,K,P]=x.subarray(0,4);O.set([NaN,NaN,NaN,NaN,G,H],0);for(let N=4;N<k;N+=2){const B=x[N],j=x[N+1];O.set(wt.createBezierPoints(G,H,K,P,B,j),(N-2)*3),[G,H,K,P]=[K,P,B,j]}}}for(let x=0,k=l.length;x<k;x++)p.push({line:S(l[x].map(O=>O??NaN),y,v,b,T),points:S(u[x].map(O=>O??NaN),y,v,b,T)});const I=new this.prototype.constructor;return I.build(p,n,i,1,h,f,a),I}#c(t=this.#l){const e=this.#n+t/2*this.#a;return this.#o%180===0?[e/this.#r,e/this.#s]:[e/this.#s,e/this.#r]}#d(){const[t,e,n,i]=this.#t,[a,l]=this.#c(0);return[t+a,e+l,n-2*a,i-2*l]}#u(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:i}of this.#i){if(i.length<=12){for(let u=4,h=i.length;u<h;u+=6)St.pointBoundingBox(i[u],i[u+1],t);continue}let a=i[4],l=i[5];for(let u=6,h=i.length;u<h;u+=6){const[f,p,y,v,b,T]=i.subarray(u,u+6);St.bezierBoundingBox(a,l,f,p,y,v,b,T,t),a=b,l=T}}const[e,n]=this.#c();t[0]=Qn(t[0]-e,0,1),t[1]=Qn(t[1]-n,0,1),t[2]=Qn(t[2]+e,0,1),t[3]=Qn(t[3]+n,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,n]=this.#c();this.#l=t;const[i,a]=this.#c(),[l,u]=[i-e,a-n],h=this.#t;return h[0]-=l,h[1]-=u,h[2]+=2*l,h[3]+=2*u,h}updateParentDimensions([t,e],n){const[i,a]=this.#c();this.#r=t,this.#s=e,this.#a=n;const[l,u]=this.#c(),h=l-i,f=u-a,p=this.#t;return p[0]-=h,p[1]-=f,p[2]+=2*h,p[3]+=2*f,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(wt.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${wt.svgRound(t)} ${wt.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let n=0,i=0,a=0,l=0,u=0,h=0;switch(this.#e){case 90:i=e/t,a=-t/e,u=t;break;case 180:n=-1,l=-1,u=t,h=e;break;case 270:i=-e/t,a=t/e,h=e;break;default:return""}return`matrix(${n} ${i} ${a} ${l} ${wt.svgRound(u)} ${wt.svgRound(h)})`}getPathResizingSVGProperties([t,e,n,i]){const[a,l]=this.#c(),[u,h,f,p]=this.#t;if(Math.abs(f-a)<=wt.PRECISION||Math.abs(p-l)<=wt.PRECISION){const S=t+n/2-(u+f/2),I=e+i/2-(h+p/2);return{path:{"transform-origin":`${wt.svgRound(t)} ${wt.svgRound(e)}`,transform:`${this.rotationTransform} translate(${S} ${I})`}}}const y=(n-2*a)/(f-2*a),v=(i-2*l)/(p-2*l),b=f/n,T=p/i;return{path:{"transform-origin":`${wt.svgRound(u)} ${wt.svgRound(h)}`,transform:`${this.rotationTransform} scale(${b} ${T}) translate(${wt.svgRound(a)} ${wt.svgRound(l)}) scale(${y} ${v}) translate(${wt.svgRound(-a)} ${wt.svgRound(-l)})`}}}getPathResizedSVGProperties([t,e,n,i]){const[a,l]=this.#c(),u=this.#t,[h,f,p,y]=u;if(u[0]=t,u[1]=e,u[2]=n,u[3]=i,Math.abs(p-a)<=wt.PRECISION||Math.abs(y-l)<=wt.PRECISION){const I=t+n/2-(h+p/2),x=e+i/2-(f+y/2);for(const{line:k,points:O}of this.#i)wt._translate(k,I,x,k),wt._translate(O,I,x,O);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${wt.svgRound(t)} ${wt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(n-2*a)/(p-2*a),b=(i-2*l)/(y-2*l),T=-v*(h+a)+t+a,S=-b*(f+l)+e+l;if(v!==1||b!==1||T!==0||S!==0)for(const{line:I,points:x}of this.#i)wt._rescale(I,T,S,v,b,I),wt._rescale(x,T,S,v,b,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${wt.svgRound(t)} ${wt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],n){const[i,a]=n,l=this.#t,u=t-l[0],h=e-l[1];if(this.#r===i&&this.#s===a)for(const{line:f,points:p}of this.#i)wt._translate(f,u,h,f),wt._translate(p,u,h,p);else{const f=this.#r/i,p=this.#s/a;this.#r=i,this.#s=a;for(const{line:y,points:v}of this.#i)wt._rescale(y,u,h,f,p,y),wt._rescale(v,u,h,f,p,v);l[2]*=f,l[3]*=p}return l[0]=t,l[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${wt.svgRound(t)} ${wt.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${wt.svgRound(t[0])} ${wt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class wp extends FC{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:kt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new wp(this._viewParameters);return t.updateAll(this),t}}class cv extends Bt{static _type="ink";static _editorType=jt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){kt.initialize(t,e),this._defaultDrawingOptions=new wp(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Kt(this,"typesMap",new Map([[ne.INK_THICKNESS,"stroke-width"],[ne.INK_COLOR,"stroke"],[ne.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,n,i,a){return new eV(t,e,n,i,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,n,i,a,l){return yh.deserialize(t,e,n,i,a,l)}static async deserialize(t,e,n){let i=null;if(t instanceof ov){const{data:{inkLists:l,rect:u,rotation:h,id:f,color:p,opacity:y,borderStyle:{rawWidth:v},popupRef:b,contentsObj:T},parent:{page:{pageNumber:S}}}=t;i=t={annotationType:jt.INK,color:Array.from(p),thickness:v,opacity:y,paths:{points:l},boxes:null,pageIndex:S-1,rect:u.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:b,comment:T?.str||null}}const a=await super.deserialize(t,e,n);return a._initialData=i,t.comment&&a.setCommentData(t.comment),a}get toolbarButtons(){return this._colorPicker||=new Ku(this),[["colorPicker",this._colorPicker]]}get colorType(){return ne.INK_COLOR}get colorValue(){return this._drawingOptions.stroke}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:n}=this;e.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:n}){this._drawingOptions=cv.getDefaultDrawingOptions({stroke:St.makeHexColor(...t),"stroke-width":e,"stroke-opacity":n})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:n,rect:i}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":l,"stroke-width":u}}=this,h={annotationType:jt.INK,color:kt._colorManager.convert(a),opacity:l,thickness:u,paths:{lines:e,points:n},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(h),t?(h.isCopy=!0,h):this.annotationElementId&&!this.#t(h)?null:(h.id=this.annotationElementId,h)}#t(t){const{color:e,thickness:n,opacity:i,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,u)=>l!==e[u])||t.thickness!==n||t.opacity!==i||t.pageIndex!==a}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:n}=this.serializeDraw(!1),i={rect:n,thickness:this._drawingOptions["stroke-width"],points:e};return this.hasEditedComment&&(i.popup=this.comment),t.updateEdited(i),null}}class Vy extends yh{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const rf=8,hu=3;class Rl{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,n,i){return n-=t,i-=e,n===0?i>0?0:4:n===1?i+6:2-i}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,e,n,i,a,l,u){const h=this.#e(n,i,a,l);for(let f=0;f<8;f++){const p=(-f+h-u+16)%8,y=this.#n[2*p],v=this.#n[2*p+1];if(t[(n+y)*e+(i+v)]!==0)return p}return-1}static#r(t,e,n,i,a,l,u){const h=this.#e(n,i,a,l);for(let f=0;f<8;f++){const p=(f+h+u+16)%8,y=this.#n[2*p],v=this.#n[2*p+1];if(t[(n+y)*e+(i+v)]!==0)return p}return-1}static#s(t,e,n,i){const a=t.length,l=new Int32Array(a);for(let p=0;p<a;p++)l[p]=t[p]<=i?1:0;for(let p=1;p<n-1;p++)l[p*e]=l[p*e+e-1]=0;for(let p=0;p<e;p++)l[p]=l[e*n-1-p]=0;let u=1,h;const f=[];for(let p=1;p<n-1;p++){h=1;for(let y=1;y<e-1;y++){const v=p*e+y,b=l[v];if(b===0)continue;let T=p,S=y;if(b===1&&l[v-1]===0)u+=1,S-=1;else if(b>=1&&l[v+1]===0)u+=1,S+=1,b>1&&(h=b);else{b!==1&&(h=Math.abs(b));continue}const I=[y,p],x=S===y+1,k={isHole:x,points:I,id:u,parent:0};f.push(k);let O;for(const V of f)if(V.id===h){O=V;break}O?O.isHole?k.parent=x?O.parent:h:k.parent=x?h:O.parent:k.parent=x?h:0;const G=this.#i(l,e,p,y,T,S,0);if(G===-1){l[v]=-u,l[v]!==1&&(h=Math.abs(l[v]));continue}let H=this.#n[2*G],K=this.#n[2*G+1];const P=p+H,N=y+K;T=P,S=N;let B=p,j=y;for(;;){const V=this.#r(l,e,B,j,T,S,1);H=this.#n[2*V],K=this.#n[2*V+1];const Y=B+H,U=j+K;I.push(U,Y);const Nt=B*e+j;if(l[Nt+1]===0?l[Nt]=-u:l[Nt]===1&&(l[Nt]=u),Y===p&&U===y&&B===P&&j===N){l[v]!==1&&(h=Math.abs(l[v]));break}else T=B,S=j,B=Y,j=U}}}return f}static#a(t,e,n,i){if(n-e<=4){for(let P=e;P<n-2;P+=2)i.push(t[P],t[P+1]);return}const a=t[e],l=t[e+1],u=t[n-4]-a,h=t[n-3]-l,f=Math.hypot(u,h),p=u/f,y=h/f,v=p*l-y*a,b=h/u,T=1/f,S=Math.atan(b),I=Math.cos(S),x=Math.sin(S),k=T*(Math.abs(I)+Math.abs(x)),O=T*(1-k+k**2),G=Math.max(Math.atan(Math.abs(x+I)*O),Math.atan(Math.abs(x-I)*O));let H=0,K=e;for(let P=e+2;P<n-2;P+=2){const N=Math.abs(v-p*t[P+1]+y*t[P]);N>H&&(K=P,H=N)}H>(f*G)**2?(this.#a(t,e,K+2,i),this.#a(t,K,n,i)):i.push(a,l)}static#o(t){const e=[],n=t.length;return this.#a(t,0,n,e),e.push(t[n-2],t[n-1]),e.length<=4?null:e}static#l(t,e,n,i,a,l){const u=new Float32Array(l**2),h=-2*i**2,f=l>>1;for(let S=0;S<l;S++){const I=(S-f)**2;for(let x=0;x<l;x++)u[S*l+x]=Math.exp((I+(x-f)**2)/h)}const p=new Float32Array(256),y=-2*a**2;for(let S=0;S<256;S++)p[S]=Math.exp(S**2/y);const v=t.length,b=new Uint8Array(v),T=new Uint32Array(256);for(let S=0;S<n;S++)for(let I=0;I<e;I++){const x=S*e+I,k=t[x];let O=0,G=0;for(let K=0;K<l;K++){const P=S+K-f;if(!(P<0||P>=n))for(let N=0;N<l;N++){const B=I+N-f;if(B<0||B>=e)continue;const j=t[P*e+B],V=u[K*l+N]*p[Math.abs(j-k)];O+=j*V,G+=V}}const H=b[x]=Math.round(O/G);T[H]++}return[b,T]}static#c(t){const e=new Uint32Array(256);for(const n of t)e[n]++;return e}static#d(t){const e=t.length,n=new Uint8ClampedArray(e>>2);let i=-1/0,a=1/0;for(let u=0,h=n.length;u<h;u++){const f=n[u]=t[u<<2];i=Math.max(i,f),a=Math.min(a,f)}const l=255/(i-a);for(let u=0,h=n.length;u<h;u++)n[u]=(n[u]-a)*l;return n}static#u(t){let e,n=-1/0,i=-1/0;const a=t.findIndex(h=>h!==0);let l=a,u=a;for(e=a;e<256;e++){const h=t[e];h>n&&(e-l>i&&(i=e-l,u=e-1),n=h,l=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:n,height:i}=t,{maxDim:a}=this.#t;let l=n,u=i;if(n>a||i>a){let v=n,b=i,T=Math.log2(Math.max(n,i)/a);const S=Math.floor(T);T=T===S?S-1:S;for(let x=0;x<T;x++){l=Math.ceil(v/2),u=Math.ceil(b/2);const k=new OffscreenCanvas(l,u);k.getContext("2d").drawImage(t,0,0,v,b,0,0,l,u),v=l,b=u,t!==e&&t.close(),t=k.transferToImageBitmap()}const I=Math.min(a/l,a/u);l=Math.round(l*I),u=Math.round(u*I)}const f=new OffscreenCanvas(l,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,l,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,l,u);const p=f.getImageData(0,0,l,u).data;return[this.#d(p),l,u]}static extractContoursFromText(t,{fontFamily:e,fontStyle:n,fontWeight:i},a,l,u,h){let f=new OffscreenCanvas(1,1),p=f.getContext("2d",{alpha:!1});const y=200,v=p.font=`${n} ${i} ${y}px ${e}`,{actualBoundingBoxLeft:b,actualBoundingBoxRight:T,actualBoundingBoxAscent:S,actualBoundingBoxDescent:I,fontBoundingBoxAscent:x,fontBoundingBoxDescent:k,width:O}=p.measureText(t),G=1.5,H=Math.ceil(Math.max(Math.abs(b)+Math.abs(T)||0,O)*G),K=Math.ceil(Math.max(Math.abs(S)+Math.abs(I)||y,Math.abs(x)+Math.abs(k)||y)*G);f=new OffscreenCanvas(H,K),p=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=v,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,H,K),p.fillStyle="black",p.fillText(t,H*(G-1)/2,K*(3-G)/2);const P=this.#d(p.getImageData(0,0,H,K).data),N=this.#c(P),B=this.#u(N),j=this.#s(P,H,K,B);return this.processDrawnLines({lines:{curves:j,width:H,height:K},pageWidth:a,pageHeight:l,rotation:u,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,e,n,i,a){const[l,u,h]=this.#f(t),[f,p]=this.#l(l,u,h,Math.hypot(u,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),y=this.#u(p),v=this.#s(f,u,h,y);return this.processDrawnLines({lines:{curves:v,width:u,height:h},pageWidth:e,pageHeight:n,rotation:i,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:i,innerMargin:a,mustSmooth:l,areContours:u}){i%180!==0&&([e,n]=[n,e]);const{curves:h,width:f,height:p}=t,y=t.thickness??0,v=[],b=Math.min(e/f,n/p),T=b/e,S=b/n,I=[];for(const{points:k}of h){const O=l?this.#o(k):k;if(!O)continue;I.push(O);const G=O.length,H=new Float32Array(G),K=new Float32Array(3*(G===2?2:G-2));if(v.push({line:K,points:H}),G===2){H[0]=O[0]*T,H[1]=O[1]*S,K.set([NaN,NaN,NaN,NaN,H[0],H[1]],0);continue}let[P,N,B,j]=O;P*=T,N*=S,B*=T,j*=S,H.set([P,N,B,j],0),K.set([NaN,NaN,NaN,NaN,P,N],0);for(let V=4;V<G;V+=2){const Y=H[V]=O[V]*T,U=H[V+1]=O[V+1]*S;K.set(wt.createBezierPoints(P,N,B,j,Y,U),(V-2)*3),[P,N,B,j]=[B,j,Y,U]}}if(v.length===0)return null;const x=u?new Vy:new yh;return x.build(v,e,n,1,i,u?0:y,a),{outline:x,newCurves:I,areContours:u,thickness:y,width:f,height:p}}static async compressSignature({outlines:t,areContours:e,thickness:n,width:i,height:a}){let l=1/0,u=-1/0,h=0;for(const O of t){h+=O.length;for(let G=2,H=O.length;G<H;G++){const K=O[G]-O[G-2];l=Math.min(l,K),u=Math.max(u,K)}}let f;l>=-128&&u<=127?f=Int8Array:l>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const p=t.length,y=rf+hu*p,v=new Uint32Array(y);let b=0;v[b++]=y*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*f.BYTES_PER_ELEMENT,v[b++]=0,v[b++]=i,v[b++]=a,v[b++]=e?0:1,v[b++]=Math.max(0,Math.floor(n??0)),v[b++]=p,v[b++]=f.BYTES_PER_ELEMENT;for(const O of t)v[b++]=O.length-2,v[b++]=O[0],v[b++]=O[1];const T=new CompressionStream("deflate-raw"),S=T.writable.getWriter();await S.ready,S.write(v);const I=f.prototype.constructor;for(const O of t){const G=new I(O.length-2);for(let H=2,K=O.length;H<K;H++)G[H-2]=O[H]-O[H-2];S.write(G)}S.close();const x=await new Response(T.readable).arrayBuffer(),k=new Uint8Array(x);return dC(k)}static async decompressSignature(t){try{const e=AF(t),{readable:n,writable:i}=new DecompressionStream("deflate-raw"),a=i.getWriter();await a.ready,a.write(e).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let l=null,u=0;for await(const O of n)l||=new Uint8Array(new Uint32Array(O.buffer,0,4)[0]),l.set(O,u),u+=O.length;const h=new Uint32Array(l.buffer,0,l.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const p=h[2],y=h[3],v=h[4]===0,b=h[5],T=h[6],S=h[7],I=[],x=(rf+hu*T)*Uint32Array.BYTES_PER_ELEMENT;let k;switch(S){case Int8Array.BYTES_PER_ELEMENT:k=new Int8Array(l.buffer,x);break;case Int16Array.BYTES_PER_ELEMENT:k=new Int16Array(l.buffer,x);break;case Int32Array.BYTES_PER_ELEMENT:k=new Int32Array(l.buffer,x);break}u=0;for(let O=0;O<T;O++){const G=h[hu*O+rf],H=new Float32Array(G+2);I.push(H);for(let K=0;K<hu-1;K++)H[K]=h[hu*O+rf+K+1];for(let K=0;K<G;K++)H[K+2]=H[K]+k[u++]}return{areContours:v,thickness:b,outlines:I,width:p,height:y}}catch(e){return Gt(`decompressSignature: ${e}`),null}}}class uv extends FC{constructor(){super(),super.updateProperties({fill:kt._defaultLineColor,"stroke-width":0})}clone(){const t=new uv;return t.updateAll(this),t}}class hv extends wp{constructor(t){super(t),super.updateProperties({stroke:kt._defaultLineColor,"stroke-width":1})}clone(){const t=new hv(this._viewParameters);return t.updateAll(this),t}}class As extends Bt{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=jt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){kt.initialize(t,e),this._defaultDrawingOptions=new uv,this._defaultDrawnSignatureOptions=new hv(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Kt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:i,mustSmooth:a,areContours:l,description:u,uuid:h,heightInPage:f}=this.#n,{rawDims:{pageWidth:p,pageHeight:y},rotation:v}=this.parent.viewport,b=Rl.processDrawnLines({lines:i,pageWidth:p,pageHeight:y,rotation:v,innerMargin:As._INNER_MARGIN,mustSmooth:a,areContours:l});this.addSignature(b,f,u,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:n,width:i,height:a}=this.#n,l=Math.max(i,a),u=Rl.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:n,width:i,height:a},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,n,i){const{x:a,y:l}=this,{outline:u}=this.#n=t;this.#t=u instanceof Vy,this.description=n;let h;this.#t?h=As.getDefaultDrawingOptions():(h=As._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:h});const[f,p]=this.parentDimensions,[,y]=this.pageDimensions;let v=e/y;v=v>=1?.5:v,this.width*=v/this.height,this.width>=1&&(v*=.9/this.width,this.width=.9),this.height=v,this.setDims(f*this.width,p*this.height),this.x=a,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:i}=this.parent.viewport;return Rl.process(t,e,n,i,As._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:n,pageHeight:i},rotation:a}=this.parent.viewport;return Rl.extractContoursFromText(t,e,n,i,a,As._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:i}=this.parent.viewport;return Rl.processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:i,innerMargin:As._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=As.getDefaultDrawingOptions():(this._drawingOptions=As._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:n,rect:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,l={annotationType:jt.SIGNATURE,isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:a,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(l),t?(l.paths={lines:e,points:n},l.uuid=this.#i,l.isCopy=!0):l.lines=e,this.#e&&(l.accessibilityData={type:"Figure",alt:this.#e}),l}static deserializeDraw(t,e,n,i,a,l){return l.areContours?Vy.deserialize(t,e,n,i,a,l):yh.deserialize(t,e,n,i,a,l)}static async deserialize(t,e,n){const i=await super.deserialize(t,e,n);return i.#t=t.areContours,i.description=t.accessibilityData?.alt||"",i.#i=t.uuid,i}}class nV extends kt{#t=null;#e=null;#n=null;#i=null;#r=null;#s="";#a=null;#o=!1;#l=null;#c=!1;#d=!1;static _type="stamp";static _editorType=jt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#r=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){kt.initialize(t,e)}static isHandlingMimeForPasting(t){return ky.includes(t)}static paste(t,e){e.pasteEditor({mode:jt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#u(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#c=t.isSvg),t.file&&(this.#s=t.file.name),this.#p()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#a){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:a,height:l}=t||this.copyCanvas(null,null,!0).imageData,u=await n.guess({name:"altText",request:{data:i,width:a,height:l,channels:i.length/(a*l)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const h=u.output;return await this.setGuessedAltText(h),e&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#g(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(n=>this.#u(n,!0)).finally(()=>this.#f());return}if(this.#i){const n=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(n).then(i=>this.#u(i)).finally(()=>this.#f());return}if(this.#r){const n=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(n).then(i=>this.#u(i)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=ky.join(",");const e=this._uiManager._signal;this.#n=new Promise(n=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(i)}n()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),n()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#l&&(clearTimeout(this.#l),this.#l=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#g();return}super.rebuild(),this.div!==null&&(this.#e&&this.#a===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#r||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#p():this.#g()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:n,bitmap:i}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#e=n,i&&(this.#t=i),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#l!==null&&clearTimeout(this.#l);const t=200;this.#l=setTimeout(()=>{this.#l=null,this.#m()},t)}#p(){const{div:t}=this;let{width:e,height:n}=this.#t;const[i,a]=this.pageDimensions,l=.75;if(this.width)e=this.width*i,n=this.height*a;else if(e>l*i||n>l*a){const p=Math.min(l*i/e,l*a/n);e*=p,n*=p}const[u,h]=this.parentDimensions;this.setDims(e*u/i,n*h/a),this._uiManager.enableWaiting(!1);const f=this.#a=document.createElement("canvas");f.setAttribute("role","img"),this.addContainer(f),this.width=e/i,this.height=n/a,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&this.div.setAttribute("aria-description",this.#s),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,n=!1){t||(t=224);const{width:i,height:a}=this.#t,l=new Ps;let u=this.#t,h=i,f=a,p=null;if(e){if(i>e||a>e){const K=Math.min(e/i,e/a);h=Math.floor(i*K),f=Math.floor(a*K)}p=document.createElement("canvas");const v=p.width=Math.ceil(h*l.sx),b=p.height=Math.ceil(f*l.sy);this.#c||(u=this.#h(v,b));const T=p.getContext("2d");T.filter=this._uiManager.hcmFilter;let S="white",I="#cfcfd8";this._uiManager.hcmFilter!=="none"?I="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(S="#8f8f9d",I="#42414d");const x=15,k=x*l.sx,O=x*l.sy,G=new OffscreenCanvas(k*2,O*2),H=G.getContext("2d");H.fillStyle=S,H.fillRect(0,0,k*2,O*2),H.fillStyle=I,H.fillRect(0,0,k,O),H.fillRect(k,O,k,O),T.fillStyle=T.createPattern(G,"repeat"),T.fillRect(0,0,v,b),T.drawImage(u,0,0,u.width,u.height,0,0,v,b)}let y=null;if(n){let v,b;if(l.symmetric&&u.width<t&&u.height<t)v=u.width,b=u.height;else if(u=this.#t,i>t||a>t){const I=Math.min(t/i,t/a);v=Math.floor(i*I),b=Math.floor(a*I),this.#c||(u=this.#h(v,b))}const S=new OffscreenCanvas(v,b).getContext("2d",{willReadFrequently:!0});S.drawImage(u,0,0,u.width,u.height,0,0,v,b),y={width:v,height:b,data:S.getImageData(0,0,v,b).data}}return{canvas:p,width:h,height:f,imageData:y}}#h(t,e){const{width:n,height:i}=this.#t;let a=n,l=i,u=this.#t;for(;a>2*t||l>2*e;){const h=a,f=l;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const p=new OffscreenCanvas(a,l);p.getContext("2d").drawImage(u,0,0,h,f,0,0,a,l),u=p.transferToImageBitmap()}return u}#m(){const[t,e]=this.parentDimensions,{width:n,height:i}=this,a=new Ps,l=Math.ceil(n*t*a.sx),u=Math.ceil(i*e*a.sy),h=this.#a;if(!h||h.width===l&&h.height===u)return;h.width=l,h.height=u;const f=this.#c?this.#t:this.#h(l,u),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(f,0,0,f.width,f.height,0,0,l,u)}#v(t){if(t){if(this.#c){const i=this._uiManager.imageManager.getSvgUrl(this.#e);if(i)return i}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#c){const[e,n]=this.pageDimensions,i=Math.round(this.width*e*Gl.PDF_TO_CSS_UNITS),a=Math.round(this.height*n*Gl.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(i,a);return l.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,i,a),l.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,n){let i=null,a=!1;if(t instanceof LC){const{data:{rect:S,rotation:I,id:x,structParent:k,popupRef:O,contentsObj:G},container:H,parent:{page:{pageNumber:K}},canvas:P}=t;let N,B;P?(delete t.canvas,{id:N,bitmap:B}=n.imageManager.getFromCanvas(H.id,P),P.remove()):(a=!0,t._hasNoCanvas=!0);const j=(await e._structTree.getAriaAttributes(`${W_}${x}`))?.get("aria-label")||"";i=t={annotationType:jt.STAMP,bitmapId:N,bitmap:B,pageIndex:K-1,rect:S.slice(0),rotation:I,annotationElementId:x,id:x,deleted:!1,accessibilityData:{decorative:!1,altText:j},isSvg:!1,structParent:k,popupRef:O,comment:G?.str||null}}const l=await super.deserialize(t,e,n),{rect:u,bitmap:h,bitmapUrl:f,bitmapId:p,isSvg:y,accessibilityData:v}=t;a?(n.addMissingCanvas(t.id,l),l.#o=!0):p&&n.imageManager.isValidId(p)?(l.#e=p,h&&(l.#t=h)):l.#i=f,l.#c=y;const[b,T]=l.pageDimensions;return l.width=(u[2]-u[0])/b,l.height=(u[3]-u[1])/T,v&&(l.altTextData=v),l._initialData=i,t.comment&&l.setCommentData(t.comment),l.#d=!!i,l}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:jt.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(this.addComment(n),t)return n.bitmapUrl=this.#v(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:i,altText:a}=this.serializeAltText(!1);if(!i&&a&&(n.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const u=this.#y(n);if(u.isSame)return null;u.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,e===null)return n;e.stamps||=new Map;const l=this.#c?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:l,serialized:n}),n.bitmap=this.#v(!1);else if(this.#c){const u=e.stamps.get(this.#e);l>u.area&&(u.area=l,u.serialized.bitmap.close(),u.serialized.bitmap=this.#v(!1))}return n}#y(t){const{pageIndex:e,accessibilityData:{altText:n}}=this._initialData,i=t.pageIndex===e,a=(t.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&i&&a,isSameAltText:a}}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const e={rect:this.getPDFRect()};return this.hasEditedComment&&(e.popup=this.comment),t.updateEdited(e),null}}class hr{#t;#e=!1;#n=null;#i=null;#r=null;#s=new Map;#a=!1;#o=!1;#l=!1;#c=null;#d=null;#u=null;#f=null;#g=null;#p=-1;#h;static _initialized=!1;static#m=new Map([En,cv,nV,$e,As].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:i,accessibilityManager:a,annotationLayer:l,drawLayer:u,textLayer:h,viewport:f,l10n:p}){const y=[...hr.#m.values()];if(!hr._initialized){hr._initialized=!0;for(const v of y)v.initialize(p,t)}t.registerEditorTypes(y),this.#h=t,this.pageIndex=e,this.div=n,this.#t=a,this.#n=l,this.viewport=f,this.#u=h,this.drawLayer=u,this._structTree=i,this.#h.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#h.getMode()===jt.NONE}updateToolbar(t){this.#h.updateToolbar(t)}updateMode(t=this.#h.getMode()){switch(this.#_(),t){case jt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case jt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case jt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of hr.#m.values())e.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#u?.div}setEditingState(t){this.#h.setEditingState(t)}addCommands(t){this.#h.addCommands(t)}cleanUndoStack(t){this.#h.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}async enable(){this.#l=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.#g?.abort(),this.#g=null;const t=new Set;for(const n of this.#s.values())n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#h.removeChangedExistingAnnotation(n),t.add(n.annotationElementId));if(!this.#n){this.#l=!1;return}const e=this.#n.getEditableAnnotations();for(const n of e){if(n.hide(),this.#h.isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const i=await this.deserialize(n);i&&(this.addOrRebuild(i),i.enableEditing())}this.#l=!1}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.#u&&!this.#g){this.#g=new AbortController;const i=this.#h.combinedSignal(this.#g);this.#u.div.addEventListener("pointerdown",a=>{const{clientX:u,clientY:h,timeStamp:f}=a,p=this.#p;if(f-p>500){this.#p=f;return}this.#p=-1;const{classList:y}=this.div;y.toggle("getElements",!0);const v=document.elementsFromPoint(u,h);if(y.toggle("getElements",!1),!this.div.contains(v[0]))return;let b;const T=new RegExp(`^${oC}[0-9]+$`);for(const I of v)if(T.test(I.id)){b=I.id;break}if(!b)return;const S=this.#s.get(b);S?.annotationElementId===null&&(a.stopPropagation(),a.preventDefault(),S.dblclick())},{signal:i,capture:!0})}const t=new Map,e=new Map;for(const i of this.#s.values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){t.set(i.annotationElementId,i);continue}else e.set(i.annotationElementId,i);this.getEditableAnnotation(i.annotationElementId)?.show(),i.remove()}if(this.#n){const i=this.#n.getEditableAnnotations();for(const a of i){const{id:l}=a.data;if(this.#h.isDeletedAnnotationElement(l)){a.updateEdited({deleted:!0});continue}let u=e.get(l);if(u){u.resetAnnotationElement(a),u.show(!1),a.show();continue}u=t.get(l),u&&(this.#h.addChangedExistingAnnotation(u),u.renderAnnotationElement(a)&&u.show(!1)),a.show()}}this.#_(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const i of hr.#m.values())n.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#h.getActive()!==t&&this.#h.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#f){this.#f=new AbortController;const t=this.#h.combinedSignal(this.#f);this.#u.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#u.div.classList.remove("highlighting"))}#v(t){this.#h.unselectAll();const{target:e}=t;if(e===this.#u.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#u.div.contains(e)){const{isMac:n}=Pn.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#h.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),$e.startHighlighting(this,this.#h.direction==="ltr",{target:this.#u.div,x:t.x,y:t.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#h._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#h.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#s.set(t.id,t);const{annotationElementId:e}=t;e&&this.#h.isDeletedAnnotationElement(e)&&this.#h.removeDeletedAnnotationElement(t)}detach(t){this.#s.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#h.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#h.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#h.addDeletedAnnotationElement(t.annotationElementId),kt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#h.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#l),this.#h.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#h._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getNextId(){return this.#h.getId()}get#y(){return hr.#m.get(this.#h.getMode())}combinedSignal(t){return this.#h.combinedSignal(t)}#E(t){const e=this.#y;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#h.updateMode(t.mode);const{offsetX:n,offsetY:i}=this.#A(),a=this.getNextId(),l=this.#E({parent:this,id:a,x:n,y:i,uiManager:this.#h,isCentered:!0,...e});l&&this.add(l)}async deserialize(t){return await hr.#m.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#h)||null}createAndAddNewEditor(t,e,n={}){const i=this.getNextId(),a=this.#E({parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:this.#h,isCentered:e,...n});return a&&this.add(a),a}#A(){const{x:t,y:e,width:n,height:i}=this.div.getBoundingClientRect(),a=Math.max(0,t),l=Math.max(0,e),u=Math.min(window.innerWidth,t+n),h=Math.min(window.innerHeight,e+i),f=(a+u)/2-t,p=(l+h)/2-e,[y,v]=this.viewport.rotation%180===0?[f,p]:[p,f];return{offsetX:y,offsetY:v}}addNewEditor(t={}){this.createAndAddNewEditor(this.#A(),!0,t)}setSelected(t){this.#h.setSelected(t)}toggleSelected(t){this.#h.toggleSelected(t)}unselect(t){this.#h.unselect(t)}pointerup(t){const{isMac:e}=Pn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#a||(this.#a=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const n=this.#h.getMode();if(n===jt.STAMP||n===jt.SIGNATURE){this.#h.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#h.getMode()===jt.HIGHLIGHT&&this.enableTextSelection(),this.#a){this.#a=!1;return}const{isMac:e}=Pn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#a=!0,this.#y?.isDrawer){this.startDrawingSession(t);return}const n=this.#h.getActive();this.#e=!n||n.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#c){this.#y.startDrawing(this,this.#h,!1,t);return}this.#h.setCurrentDrawingSession(this),this.#c=new AbortController;const e=this.#h.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#y.startDrawing(this,this.#h,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#c?(this.#h.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#d=null,this.#y.endDrawing(t)):null}findNewParent(t,e,n){const i=this.#h.findParent(e,n);return i===null||i===this?!1:(i.changeParent(t),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#h.getActive()?.parent===this&&(this.#h.commitOrRemove(),this.#h.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#s.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#s.clear(),this.#h.removeLayer(this)}#_(){for(const t of this.#s.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,vo(this.div,t);for(const e of this.#h.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#h.commitOrRemove(),this.#_();const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,vo(this.div,{rotation:n}),e!==n)for(const i of this.#s.values())i.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#h.viewParameters.realScale}}class Dn{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Kt(this,"_svgFactory",new Yf)}static#r(t,[e,n,i,a]){const{style:l}=t;l.top=`${100*n}%`,l.left=`${100*e}%`,l.width=`${100*i}%`,l.height=`${100*a}%`}#s(){const t=Dn._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#a(t,e){const n=Dn._svgFactory.createElement("clipPath");t.append(n);const i=`clip_${e}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const a=Dn._svgFactory.createElement("use");return n.append(a),a.setAttribute("href",`#${e}`),a.classList.add("clip"),i}#o(t,e){for(const[n,i]of Object.entries(e))i===null?t.removeAttribute(n):t.setAttribute(n,i)}draw(t,e=!1,n=!1){const i=Dn.#i++,a=this.#s(),l=Dn._svgFactory.createElement("defs");a.append(l);const u=Dn._svgFactory.createElement("path");l.append(u);const h=`path_p${this.pageIndex}_${i}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#n.set(i,u);const f=n?this.#a(l,h):null,p=Dn._svgFactory.createElement("use");return a.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(a,t),this.#e.set(i,a),{id:i,clipPathId:`url(#${f})`}}drawOutline(t,e){const n=Dn.#i++,i=this.#s(),a=Dn._svgFactory.createElement("defs");i.append(a);const l=Dn._svgFactory.createElement("path");a.append(l);const u=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const y=Dn._svgFactory.createElement("mask");a.append(y),h=`mask_p${this.pageIndex}_${n}`,y.setAttribute("id",h),y.setAttribute("maskUnits","objectBoundingBox");const v=Dn._svgFactory.createElement("rect");y.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const b=Dn._svgFactory.createElement("use");y.append(b),b.setAttribute("href",`#${u}`),b.setAttribute("stroke","none"),b.setAttribute("fill","black"),b.setAttribute("fill-rule","nonzero"),b.classList.add("mask")}const f=Dn._svgFactory.createElement("use");i.append(f),f.setAttribute("href",`#${u}`),h&&f.setAttribute("mask",`url(#${h})`);const p=f.cloneNode();return i.append(p),f.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(i,t),this.#e.set(n,i),n}finalizeDraw(t,e){this.#n.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:n,bbox:i,rootClass:a,path:l}=e,u=typeof t=="number"?this.#e.get(t):t;if(u){if(n&&this.#o(u,n),i&&Dn.#r(u,i),a){const{classList:h}=u;for(const[f,p]of Object.entries(a))h.toggle(f,p)}if(l){const f=u.firstChild.firstChild;this.#o(f,l)}}}updateParent(t,e){if(e===this)return;const n=this.#e.get(t);n&&(e.#t.append(n),this.#e.delete(t),e.#e.set(t,n))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Fy};globalThis.pdfjsLib={AbortException:Aa,AnnotationEditorLayer:hr,AnnotationEditorParamsType:ne,AnnotationEditorType:jt,AnnotationEditorUIManager:wa,AnnotationLayer:lv,AnnotationMode:oa,AnnotationType:nn,build:kU,ColorPicker:Fi,createValidAbsoluteUrl:lC,DOMSVGFactory:Yf,DrawLayer:Dn,FeatureTest:Pn,fetchData:fh,getDocument:RU,getFilenameFromUrl:wF,getPdfFilenameFromUrl:TF,getRGB:bp,getUuid:hC,getXfaPageViewport:CF,GlobalWorkerOptions:Ll,ImageKind:vf,InvalidPDFException:Ny,isDataScheme:vp,isPdfFile:J_,isValidExplicitDest:BF,MathClamp:Qn,noContextMenu:zi,normalizeUnicode:bF,OPS:$u,OutputScale:Ps,PasswordResponses:hF,PDFDataRangeTransport:IC,PDFDateString:My,PDFWorker:Xu,PermissionFlag:uF,PixelsPerInch:Gl,RenderingCancelledException:Q_,ResponseException:qf,setLayerDimensions:vo,shadow:Kt,SignatureExtractor:Rl,stopEvent:rn,SupportedImageMimeTypes:ky,TextLayer:Kn,TouchManager:Ep,updateUrlHash:cC,Util:St,VerbosityLevel:mp,version:MU,XfaLayer:NC};var Hw;(function(s){s.STRING="string",s.NUMBER="number",s.INTEGER="integer",s.BOOLEAN="boolean",s.ARRAY="array",s.OBJECT="object"})(Hw||(Hw={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zw;(function(s){s.LANGUAGE_UNSPECIFIED="language_unspecified",s.PYTHON="python"})(zw||(zw={}));var Gw;(function(s){s.OUTCOME_UNSPECIFIED="outcome_unspecified",s.OUTCOME_OK="outcome_ok",s.OUTCOME_FAILED="outcome_failed",s.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(Gw||(Gw={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw=["user","model","function","system"];var $w;(function(s){s.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",s.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",s.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",s.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",s.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",s.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})($w||($w={}));var Yw;(function(s){s.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",s.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",s.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",s.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",s.BLOCK_NONE="BLOCK_NONE"})(Yw||(Yw={}));var Xw;(function(s){s.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",s.NEGLIGIBLE="NEGLIGIBLE",s.LOW="LOW",s.MEDIUM="MEDIUM",s.HIGH="HIGH"})(Xw||(Xw={}));var Kw;(function(s){s.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",s.SAFETY="SAFETY",s.OTHER="OTHER"})(Kw||(Kw={}));var ku;(function(s){s.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",s.STOP="STOP",s.MAX_TOKENS="MAX_TOKENS",s.SAFETY="SAFETY",s.RECITATION="RECITATION",s.LANGUAGE="LANGUAGE",s.BLOCKLIST="BLOCKLIST",s.PROHIBITED_CONTENT="PROHIBITED_CONTENT",s.SPII="SPII",s.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",s.OTHER="OTHER"})(ku||(ku={}));var Ww;(function(s){s.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",s.RETRIEVAL_QUERY="RETRIEVAL_QUERY",s.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",s.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",s.CLASSIFICATION="CLASSIFICATION",s.CLUSTERING="CLUSTERING"})(Ww||(Ww={}));var Qw;(function(s){s.MODE_UNSPECIFIED="MODE_UNSPECIFIED",s.AUTO="AUTO",s.ANY="ANY",s.NONE="NONE"})(Qw||(Qw={}));var Jw;(function(s){s.MODE_UNSPECIFIED="MODE_UNSPECIFIED",s.MODE_DYNAMIC="MODE_DYNAMIC"})(Jw||(Jw={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn extends Error{constructor(t){super(`[GoogleGenerativeAI Error]: ${t}`)}}class vl extends Hn{constructor(t,e){super(t),this.response=e}}class UC extends Hn{constructor(t,e,n,i){super(t),this.status=e,this.statusText=n,this.errorDetails=i}}class pa extends Hn{}class VC extends Hn{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iV="https://generativelanguage.googleapis.com",sV="v1beta",rV="0.24.1",aV="genai-js";var Eo;(function(s){s.GENERATE_CONTENT="generateContent",s.STREAM_GENERATE_CONTENT="streamGenerateContent",s.COUNT_TOKENS="countTokens",s.EMBED_CONTENT="embedContent",s.BATCH_EMBED_CONTENTS="batchEmbedContents"})(Eo||(Eo={}));class oV{constructor(t,e,n,i,a){this.model=t,this.task=e,this.apiKey=n,this.stream=i,this.requestOptions=a}toString(){var t,e;const n=((t=this.requestOptions)===null||t===void 0?void 0:t.apiVersion)||sV;let a=`${((e=this.requestOptions)===null||e===void 0?void 0:e.baseUrl)||iV}/${n}/${this.model}:${this.task}`;return this.stream&&(a+="?alt=sse"),a}}function lV(s){const t=[];return s?.apiClient&&t.push(s.apiClient),t.push(`${aV}/${rV}`),t.join(" ")}async function cV(s){var t;const e=new Headers;e.append("Content-Type","application/json"),e.append("x-goog-api-client",lV(s.requestOptions)),e.append("x-goog-api-key",s.apiKey);let n=(t=s.requestOptions)===null||t===void 0?void 0:t.customHeaders;if(n){if(!(n instanceof Headers))try{n=new Headers(n)}catch(i){throw new pa(`unable to convert customHeaders value ${JSON.stringify(n)} to Headers: ${i.message}`)}for(const[i,a]of n.entries()){if(i==="x-goog-api-key")throw new pa(`Cannot set reserved header name ${i}`);if(i==="x-goog-api-client")throw new pa(`Header name ${i} can only be set using the apiClient field`);e.append(i,a)}}return e}async function uV(s,t,e,n,i,a){const l=new oV(s,t,e,n,a);return{url:l.toString(),fetchOptions:Object.assign(Object.assign({},pV(a)),{method:"POST",headers:await cV(l),body:i})}}async function _h(s,t,e,n,i,a={},l=fetch){const{url:u,fetchOptions:h}=await uV(s,t,e,n,i,a);return hV(u,h,l)}async function hV(s,t,e=fetch){let n;try{n=await e(s,t)}catch(i){dV(i,s)}return n.ok||await fV(n,s),n}function dV(s,t){let e=s;throw e.name==="AbortError"?(e=new VC(`Request aborted when fetching ${t.toString()}: ${s.message}`),e.stack=s.stack):s instanceof UC||s instanceof pa||(e=new Hn(`Error fetching from ${t.toString()}: ${s.message}`),e.stack=s.stack),e}async function fV(s,t){let e="",n;try{const i=await s.json();e=i.error.message,i.error.details&&(e+=` ${JSON.stringify(i.error.details)}`,n=i.error.details)}catch{}throw new UC(`Error fetching from ${t.toString()}: [${s.status} ${s.statusText}] ${e}`,s.status,s.statusText,n)}function pV(s){const t={};if(s?.signal!==void 0||s?.timeout>=0){const e=new AbortController;s?.timeout>=0&&setTimeout(()=>e.abort(),s.timeout),s?.signal&&s.signal.addEventListener("abort",()=>{e.abort()}),t.signal=e.signal}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dv(s){return s.text=()=>{if(s.candidates&&s.candidates.length>0){if(s.candidates.length>1&&console.warn(`This response had ${s.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Af(s.candidates[0]))throw new vl(`${na(s)}`,s);return gV(s)}else if(s.promptFeedback)throw new vl(`Text not available. ${na(s)}`,s);return""},s.functionCall=()=>{if(s.candidates&&s.candidates.length>0){if(s.candidates.length>1&&console.warn(`This response had ${s.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Af(s.candidates[0]))throw new vl(`${na(s)}`,s);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),Zw(s)[0]}else if(s.promptFeedback)throw new vl(`Function call not available. ${na(s)}`,s)},s.functionCalls=()=>{if(s.candidates&&s.candidates.length>0){if(s.candidates.length>1&&console.warn(`This response had ${s.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Af(s.candidates[0]))throw new vl(`${na(s)}`,s);return Zw(s)}else if(s.promptFeedback)throw new vl(`Function call not available. ${na(s)}`,s)},s}function gV(s){var t,e,n,i;const a=[];if(!((e=(t=s.candidates)===null||t===void 0?void 0:t[0].content)===null||e===void 0)&&e.parts)for(const l of(i=(n=s.candidates)===null||n===void 0?void 0:n[0].content)===null||i===void 0?void 0:i.parts)l.text&&a.push(l.text),l.executableCode&&a.push("\n```"+l.executableCode.language+`
`+l.executableCode.code+"\n```\n"),l.codeExecutionResult&&a.push("\n```\n"+l.codeExecutionResult.output+"\n```\n");return a.length>0?a.join(""):""}function Zw(s){var t,e,n,i;const a=[];if(!((e=(t=s.candidates)===null||t===void 0?void 0:t[0].content)===null||e===void 0)&&e.parts)for(const l of(i=(n=s.candidates)===null||n===void 0?void 0:n[0].content)===null||i===void 0?void 0:i.parts)l.functionCall&&a.push(l.functionCall);if(a.length>0)return a}const mV=[ku.RECITATION,ku.SAFETY,ku.LANGUAGE];function Af(s){return!!s.finishReason&&mV.includes(s.finishReason)}function na(s){var t,e,n;let i="";if((!s.candidates||s.candidates.length===0)&&s.promptFeedback)i+="Response was blocked",!((t=s.promptFeedback)===null||t===void 0)&&t.blockReason&&(i+=` due to ${s.promptFeedback.blockReason}`),!((e=s.promptFeedback)===null||e===void 0)&&e.blockReasonMessage&&(i+=`: ${s.promptFeedback.blockReasonMessage}`);else if(!((n=s.candidates)===null||n===void 0)&&n[0]){const a=s.candidates[0];Af(a)&&(i+=`Candidate was blocked due to ${a.finishReason}`,a.finishMessage&&(i+=`: ${a.finishMessage}`))}return i}function Wu(s){return this instanceof Wu?(this.v=s,this):new Wu(s)}function yV(s,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(s,t||[]),i,a=[];return i={},l("next"),l("throw"),l("return"),i[Symbol.asyncIterator]=function(){return this},i;function l(v){n[v]&&(i[v]=function(b){return new Promise(function(T,S){a.push([v,b,T,S])>1||u(v,b)})})}function u(v,b){try{h(n[v](b))}catch(T){y(a[0][3],T)}}function h(v){v.value instanceof Wu?Promise.resolve(v.value.v).then(f,p):y(a[0][2],v)}function f(v){u("next",v)}function p(v){u("throw",v)}function y(v,b){v(b),a.shift(),a.length&&u(a[0][0],a[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tT=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function _V(s){const t=s.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),e=EV(t),[n,i]=e.tee();return{stream:bV(n),response:vV(i)}}async function vV(s){const t=[],e=s.getReader();for(;;){const{done:n,value:i}=await e.read();if(n)return dv(AV(t));t.push(i)}}function bV(s){return yV(this,arguments,function*(){const e=s.getReader();for(;;){const{value:n,done:i}=yield Wu(e.read());if(i)break;yield yield Wu(dv(n))}})}function EV(s){const t=s.getReader();return new ReadableStream({start(n){let i="";return a();function a(){return t.read().then(({value:l,done:u})=>{if(u){if(i.trim()){n.error(new Hn("Failed to parse stream"));return}n.close();return}i+=l;let h=i.match(tT),f;for(;h;){try{f=JSON.parse(h[1])}catch{n.error(new Hn(`Error parsing JSON response: "${h[1]}"`));return}n.enqueue(f),i=i.substring(h[0].length),h=i.match(tT)}return a()}).catch(l=>{let u=l;throw u.stack=l.stack,u.name==="AbortError"?u=new VC("Request aborted when reading from the stream"):u=new Hn("Error reading from the stream"),u})}}})}function AV(s){const t=s[s.length-1],e={promptFeedback:t?.promptFeedback};for(const n of s){if(n.candidates){let i=0;for(const a of n.candidates)if(e.candidates||(e.candidates=[]),e.candidates[i]||(e.candidates[i]={index:i}),e.candidates[i].citationMetadata=a.citationMetadata,e.candidates[i].groundingMetadata=a.groundingMetadata,e.candidates[i].finishReason=a.finishReason,e.candidates[i].finishMessage=a.finishMessage,e.candidates[i].safetyRatings=a.safetyRatings,a.content&&a.content.parts){e.candidates[i].content||(e.candidates[i].content={role:a.content.role||"user",parts:[]});const l={};for(const u of a.content.parts)u.text&&(l.text=u.text),u.functionCall&&(l.functionCall=u.functionCall),u.executableCode&&(l.executableCode=u.executableCode),u.codeExecutionResult&&(l.codeExecutionResult=u.codeExecutionResult),Object.keys(l).length===0&&(l.text=""),e.candidates[i].content.parts.push(l)}i++}n.usageMetadata&&(e.usageMetadata=n.usageMetadata)}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jC(s,t,e,n){const i=await _h(t,Eo.STREAM_GENERATE_CONTENT,s,!0,JSON.stringify(e),n);return _V(i)}async function HC(s,t,e,n){const a=await(await _h(t,Eo.GENERATE_CONTENT,s,!1,JSON.stringify(e),n)).json();return{response:dv(a)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zC(s){if(s!=null){if(typeof s=="string")return{role:"system",parts:[{text:s}]};if(s.text)return{role:"system",parts:[s]};if(s.parts)return s.role?s:{role:"system",parts:s.parts}}}function Qu(s){let t=[];if(typeof s=="string")t=[{text:s}];else for(const e of s)typeof e=="string"?t.push({text:e}):t.push(e);return wV(t)}function wV(s){const t={role:"user",parts:[]},e={role:"function",parts:[]};let n=!1,i=!1;for(const a of s)"functionResponse"in a?(e.parts.push(a),i=!0):(t.parts.push(a),n=!0);if(n&&i)throw new Hn("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!n&&!i)throw new Hn("No content is provided for sending chat message.");return n?t:e}function TV(s,t){var e;let n={model:t?.model,generationConfig:t?.generationConfig,safetySettings:t?.safetySettings,tools:t?.tools,toolConfig:t?.toolConfig,systemInstruction:t?.systemInstruction,cachedContent:(e=t?.cachedContent)===null||e===void 0?void 0:e.name,contents:[]};const i=s.generateContentRequest!=null;if(s.contents){if(i)throw new pa("CountTokensRequest must have one of contents or generateContentRequest, not both.");n.contents=s.contents}else if(i)n=Object.assign(Object.assign({},n),s.generateContentRequest);else{const a=Qu(s);n.contents=[a]}return{generateContentRequest:n}}function eT(s){let t;return s.contents?t=s:t={contents:[Qu(s)]},s.systemInstruction&&(t.systemInstruction=zC(s.systemInstruction)),t}function SV(s){return typeof s=="string"||Array.isArray(s)?{content:Qu(s)}:s}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nT=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],CV={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function RV(s){let t=!1;for(const e of s){const{role:n,parts:i}=e;if(!t&&n!=="user")throw new Hn(`First content should be with role 'user', got ${n}`);if(!qw.includes(n))throw new Hn(`Each item should include role field. Got ${n} but valid roles are: ${JSON.stringify(qw)}`);if(!Array.isArray(i))throw new Hn("Content should have 'parts' property with an array of Parts");if(i.length===0)throw new Hn("Each Content should have at least one part");const a={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const u of i)for(const h of nT)h in u&&(a[h]+=1);const l=CV[n];for(const u of nT)if(!l.includes(u)&&a[u]>0)throw new Hn(`Content with role '${n}' can't contain '${u}' part`);t=!0}}function iT(s){var t;if(s.candidates===void 0||s.candidates.length===0)return!1;const e=(t=s.candidates[0])===null||t===void 0?void 0:t.content;if(e===void 0||e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT="SILENT_ERROR";class IV{constructor(t,e,n,i={}){this.model=e,this.params=n,this._requestOptions=i,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=t,n?.history&&(RV(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(t,e={}){var n,i,a,l,u,h;await this._sendPromise;const f=Qu(t),p={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(a=this.params)===null||a===void 0?void 0:a.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(u=this.params)===null||u===void 0?void 0:u.systemInstruction,cachedContent:(h=this.params)===null||h===void 0?void 0:h.cachedContent,contents:[...this._history,f]},y=Object.assign(Object.assign({},this._requestOptions),e);let v;return this._sendPromise=this._sendPromise.then(()=>HC(this._apiKey,this.model,p,y)).then(b=>{var T;if(iT(b.response)){this._history.push(f);const S=Object.assign({parts:[],role:"model"},(T=b.response.candidates)===null||T===void 0?void 0:T[0].content);this._history.push(S)}else{const S=na(b.response);S&&console.warn(`sendMessage() was unsuccessful. ${S}. Inspect response object for details.`)}v=b}).catch(b=>{throw this._sendPromise=Promise.resolve(),b}),await this._sendPromise,v}async sendMessageStream(t,e={}){var n,i,a,l,u,h;await this._sendPromise;const f=Qu(t),p={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(a=this.params)===null||a===void 0?void 0:a.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(u=this.params)===null||u===void 0?void 0:u.systemInstruction,cachedContent:(h=this.params)===null||h===void 0?void 0:h.cachedContent,contents:[...this._history,f]},y=Object.assign(Object.assign({},this._requestOptions),e),v=jC(this._apiKey,this.model,p,y);return this._sendPromise=this._sendPromise.then(()=>v).catch(b=>{throw new Error(sT)}).then(b=>b.response).then(b=>{if(iT(b)){this._history.push(f);const T=Object.assign({},b.candidates[0].content);T.role||(T.role="model"),this._history.push(T)}else{const T=na(b);T&&console.warn(`sendMessageStream() was unsuccessful. ${T}. Inspect response object for details.`)}}).catch(b=>{b.message!==sT&&console.error(b)}),v}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xV(s,t,e,n){return(await _h(t,Eo.COUNT_TOKENS,s,!1,JSON.stringify(e),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DV(s,t,e,n){return(await _h(t,Eo.EMBED_CONTENT,s,!1,JSON.stringify(e),n)).json()}async function NV(s,t,e,n){const i=e.requests.map(l=>Object.assign(Object.assign({},l),{model:t}));return(await _h(t,Eo.BATCH_EMBED_CONTENTS,s,!1,JSON.stringify({requests:i}),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(t,e,n={}){this.apiKey=t,this._requestOptions=n,e.model.includes("/")?this.model=e.model:this.model=`models/${e.model}`,this.generationConfig=e.generationConfig||{},this.safetySettings=e.safetySettings||[],this.tools=e.tools,this.toolConfig=e.toolConfig,this.systemInstruction=zC(e.systemInstruction),this.cachedContent=e.cachedContent}async generateContent(t,e={}){var n;const i=eT(t),a=Object.assign(Object.assign({},this._requestOptions),e);return HC(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},i),a)}async generateContentStream(t,e={}){var n;const i=eT(t),a=Object.assign(Object.assign({},this._requestOptions),e);return jC(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},i),a)}startChat(t){var e;return new IV(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(e=this.cachedContent)===null||e===void 0?void 0:e.name},t),this._requestOptions)}async countTokens(t,e={}){const n=TV(t,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),i=Object.assign(Object.assign({},this._requestOptions),e);return xV(this.apiKey,this.model,n,i)}async embedContent(t,e={}){const n=SV(t),i=Object.assign(Object.assign({},this._requestOptions),e);return DV(this.apiKey,this.model,n,i)}async batchEmbedContents(t,e={}){const n=Object.assign(Object.assign({},this._requestOptions),e);return NV(this.apiKey,this.model,t,n)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(t){this.apiKey=t}getGenerativeModel(t,e){if(!t.model)throw new Hn("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new rT(this.apiKey,t,e)}getGenerativeModelFromCachedContent(t,e,n){if(!t.name)throw new pa("Cached content must contain a `name` field.");if(!t.model)throw new pa("Cached content must contain a `model` field.");const i=["model","systemInstruction"];for(const l of i)if(e?.[l]&&t[l]&&e?.[l]!==t[l]){if(l==="model"){const u=e.model.startsWith("models/")?e.model.replace("models/",""):e.model,h=t.model.startsWith("models/")?t.model.replace("models/",""):t.model;if(u===h)continue}throw new pa(`Different value for "${l}" specified in modelParams (${e[l]}) and cachedContent (${t[l]})`)}const a=Object.assign(Object.assign({},e),{model:t.model,tools:t.tools,toolConfig:t.toolConfig,systemInstruction:t.systemInstruction,cachedContent:t});return new rT(this.apiKey,a,n)}}var Jm={},du={},aT;function kV(){if(aT)return du;aT=1,du.byteLength=u,du.toByteArray=f,du.fromByteArray=v;for(var s=[],t=[],e=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,a=n.length;i<a;++i)s[i]=n[i],t[n.charCodeAt(i)]=i;t[45]=62,t[95]=63;function l(b){var T=b.length;if(T%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var S=b.indexOf("=");S===-1&&(S=T);var I=S===T?0:4-S%4;return[S,I]}function u(b){var T=l(b),S=T[0],I=T[1];return(S+I)*3/4-I}function h(b,T,S){return(T+S)*3/4-S}function f(b){var T,S=l(b),I=S[0],x=S[1],k=new e(h(b,I,x)),O=0,G=x>0?I-4:I,H;for(H=0;H<G;H+=4)T=t[b.charCodeAt(H)]<<18|t[b.charCodeAt(H+1)]<<12|t[b.charCodeAt(H+2)]<<6|t[b.charCodeAt(H+3)],k[O++]=T>>16&255,k[O++]=T>>8&255,k[O++]=T&255;return x===2&&(T=t[b.charCodeAt(H)]<<2|t[b.charCodeAt(H+1)]>>4,k[O++]=T&255),x===1&&(T=t[b.charCodeAt(H)]<<10|t[b.charCodeAt(H+1)]<<4|t[b.charCodeAt(H+2)]>>2,k[O++]=T>>8&255,k[O++]=T&255),k}function p(b){return s[b>>18&63]+s[b>>12&63]+s[b>>6&63]+s[b&63]}function y(b,T,S){for(var I,x=[],k=T;k<S;k+=3)I=(b[k]<<16&16711680)+(b[k+1]<<8&65280)+(b[k+2]&255),x.push(p(I));return x.join("")}function v(b){for(var T,S=b.length,I=S%3,x=[],k=16383,O=0,G=S-I;O<G;O+=k)x.push(y(b,O,O+k>G?G:O+k));return I===1?(T=b[S-1],x.push(s[T>>2]+s[T<<4&63]+"==")):I===2&&(T=(b[S-2]<<8)+b[S-1],x.push(s[T>>10]+s[T>>4&63]+s[T<<2&63]+"=")),x.join("")}return du}var af={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var oT;function PV(){return oT||(oT=1,af.read=function(s,t,e,n,i){var a,l,u=i*8-n-1,h=(1<<u)-1,f=h>>1,p=-7,y=e?i-1:0,v=e?-1:1,b=s[t+y];for(y+=v,a=b&(1<<-p)-1,b>>=-p,p+=u;p>0;a=a*256+s[t+y],y+=v,p-=8);for(l=a&(1<<-p)-1,a>>=-p,p+=n;p>0;l=l*256+s[t+y],y+=v,p-=8);if(a===0)a=1-f;else{if(a===h)return l?NaN:(b?-1:1)*(1/0);l=l+Math.pow(2,n),a=a-f}return(b?-1:1)*l*Math.pow(2,a-n)},af.write=function(s,t,e,n,i,a){var l,u,h,f=a*8-i-1,p=(1<<f)-1,y=p>>1,v=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=n?0:a-1,T=n?1:-1,S=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,l=p):(l=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-l))<1&&(l--,h*=2),l+y>=1?t+=v/h:t+=v*Math.pow(2,1-y),t*h>=2&&(l++,h/=2),l+y>=p?(u=0,l=p):l+y>=1?(u=(t*h-1)*Math.pow(2,i),l=l+y):(u=t*Math.pow(2,y-1)*Math.pow(2,i),l=0));i>=8;s[e+b]=u&255,b+=T,u/=256,i-=8);for(l=l<<i|u,f+=i;f>0;s[e+b]=l&255,b+=T,l/=256,f-=8);s[e+b-T]|=S*128}),af}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var lT;function OV(){return lT||(lT=1,(function(s){const t=kV(),e=PV(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;s.Buffer=u,s.SlowBuffer=k,s.INSPECT_MAX_BYTES=50;const i=2147483647;s.kMaxLength=i,u.TYPED_ARRAY_SUPPORT=a(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const D=new Uint8Array(1),A={foo:function(){return 42}};return Object.setPrototypeOf(A,Uint8Array.prototype),Object.setPrototypeOf(D,A),D.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function l(D){if(D>i)throw new RangeError('The value "'+D+'" is invalid for option "size"');const A=new Uint8Array(D);return Object.setPrototypeOf(A,u.prototype),A}function u(D,A,w){if(typeof D=="number"){if(typeof A=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(D)}return h(D,A,w)}u.poolSize=8192;function h(D,A,w){if(typeof D=="string")return v(D,A);if(ArrayBuffer.isView(D))return T(D);if(D==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof D);if(Ln(D,ArrayBuffer)||D&&Ln(D.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ln(D,SharedArrayBuffer)||D&&Ln(D.buffer,SharedArrayBuffer)))return S(D,A,w);if(typeof D=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const F=D.valueOf&&D.valueOf();if(F!=null&&F!==D)return u.from(F,A,w);const W=I(D);if(W)return W;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof D[Symbol.toPrimitive]=="function")return u.from(D[Symbol.toPrimitive]("string"),A,w);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof D)}u.from=function(D,A,w){return h(D,A,w)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function f(D){if(typeof D!="number")throw new TypeError('"size" argument must be of type number');if(D<0)throw new RangeError('The value "'+D+'" is invalid for option "size"')}function p(D,A,w){return f(D),D<=0?l(D):A!==void 0?typeof w=="string"?l(D).fill(A,w):l(D).fill(A):l(D)}u.alloc=function(D,A,w){return p(D,A,w)};function y(D){return f(D),l(D<0?0:x(D)|0)}u.allocUnsafe=function(D){return y(D)},u.allocUnsafeSlow=function(D){return y(D)};function v(D,A){if((typeof A!="string"||A==="")&&(A="utf8"),!u.isEncoding(A))throw new TypeError("Unknown encoding: "+A);const w=O(D,A)|0;let F=l(w);const W=F.write(D,A);return W!==w&&(F=F.slice(0,W)),F}function b(D){const A=D.length<0?0:x(D.length)|0,w=l(A);for(let F=0;F<A;F+=1)w[F]=D[F]&255;return w}function T(D){if(Ln(D,Uint8Array)){const A=new Uint8Array(D);return S(A.buffer,A.byteOffset,A.byteLength)}return b(D)}function S(D,A,w){if(A<0||D.byteLength<A)throw new RangeError('"offset" is outside of buffer bounds');if(D.byteLength<A+(w||0))throw new RangeError('"length" is outside of buffer bounds');let F;return A===void 0&&w===void 0?F=new Uint8Array(D):w===void 0?F=new Uint8Array(D,A):F=new Uint8Array(D,A,w),Object.setPrototypeOf(F,u.prototype),F}function I(D){if(u.isBuffer(D)){const A=x(D.length)|0,w=l(A);return w.length===0||D.copy(w,0,0,A),w}if(D.length!==void 0)return typeof D.length!="number"||wi(D.length)?l(0):b(D);if(D.type==="Buffer"&&Array.isArray(D.data))return b(D.data)}function x(D){if(D>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return D|0}function k(D){return+D!=D&&(D=0),u.alloc(+D)}u.isBuffer=function(A){return A!=null&&A._isBuffer===!0&&A!==u.prototype},u.compare=function(A,w){if(Ln(A,Uint8Array)&&(A=u.from(A,A.offset,A.byteLength)),Ln(w,Uint8Array)&&(w=u.from(w,w.offset,w.byteLength)),!u.isBuffer(A)||!u.isBuffer(w))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(A===w)return 0;let F=A.length,W=w.length;for(let rt=0,dt=Math.min(F,W);rt<dt;++rt)if(A[rt]!==w[rt]){F=A[rt],W=w[rt];break}return F<W?-1:W<F?1:0},u.isEncoding=function(A){switch(String(A).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(A,w){if(!Array.isArray(A))throw new TypeError('"list" argument must be an Array of Buffers');if(A.length===0)return u.alloc(0);let F;if(w===void 0)for(w=0,F=0;F<A.length;++F)w+=A[F].length;const W=u.allocUnsafe(w);let rt=0;for(F=0;F<A.length;++F){let dt=A[F];if(Ln(dt,Uint8Array))rt+dt.length>W.length?(u.isBuffer(dt)||(dt=u.from(dt)),dt.copy(W,rt)):Uint8Array.prototype.set.call(W,dt,rt);else if(u.isBuffer(dt))dt.copy(W,rt);else throw new TypeError('"list" argument must be an Array of Buffers');rt+=dt.length}return W};function O(D,A){if(u.isBuffer(D))return D.length;if(ArrayBuffer.isView(D)||Ln(D,ArrayBuffer))return D.byteLength;if(typeof D!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof D);const w=D.length,F=arguments.length>2&&arguments[2]===!0;if(!F&&w===0)return 0;let W=!1;for(;;)switch(A){case"ascii":case"latin1":case"binary":return w;case"utf8":case"utf-8":return Fe(D).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w*2;case"hex":return w>>>1;case"base64":return Gi(D).length;default:if(W)return F?-1:Fe(D).length;A=(""+A).toLowerCase(),W=!0}}u.byteLength=O;function G(D,A,w){let F=!1;if((A===void 0||A<0)&&(A=0),A>this.length||((w===void 0||w>this.length)&&(w=this.length),w<=0)||(w>>>=0,A>>>=0,w<=A))return"";for(D||(D="utf8");;)switch(D){case"hex":return Mt(this,A,w);case"utf8":case"utf-8":return Nt(this,A,w);case"ascii":return ct(this,A,w);case"latin1":case"binary":return mt(this,A,w);case"base64":return U(this,A,w);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $(this,A,w);default:if(F)throw new TypeError("Unknown encoding: "+D);D=(D+"").toLowerCase(),F=!0}}u.prototype._isBuffer=!0;function H(D,A,w){const F=D[A];D[A]=D[w],D[w]=F}u.prototype.swap16=function(){const A=this.length;if(A%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let w=0;w<A;w+=2)H(this,w,w+1);return this},u.prototype.swap32=function(){const A=this.length;if(A%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let w=0;w<A;w+=4)H(this,w,w+3),H(this,w+1,w+2);return this},u.prototype.swap64=function(){const A=this.length;if(A%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let w=0;w<A;w+=8)H(this,w,w+7),H(this,w+1,w+6),H(this,w+2,w+5),H(this,w+3,w+4);return this},u.prototype.toString=function(){const A=this.length;return A===0?"":arguments.length===0?Nt(this,0,A):G.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(A){if(!u.isBuffer(A))throw new TypeError("Argument must be a Buffer");return this===A?!0:u.compare(this,A)===0},u.prototype.inspect=function(){let A="";const w=s.INSPECT_MAX_BYTES;return A=this.toString("hex",0,w).replace(/(.{2})/g,"$1 ").trim(),this.length>w&&(A+=" ... "),"<Buffer "+A+">"},n&&(u.prototype[n]=u.prototype.inspect),u.prototype.compare=function(A,w,F,W,rt){if(Ln(A,Uint8Array)&&(A=u.from(A,A.offset,A.byteLength)),!u.isBuffer(A))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof A);if(w===void 0&&(w=0),F===void 0&&(F=A?A.length:0),W===void 0&&(W=0),rt===void 0&&(rt=this.length),w<0||F>A.length||W<0||rt>this.length)throw new RangeError("out of range index");if(W>=rt&&w>=F)return 0;if(W>=rt)return-1;if(w>=F)return 1;if(w>>>=0,F>>>=0,W>>>=0,rt>>>=0,this===A)return 0;let dt=rt-W,Ht=F-w;const ie=Math.min(dt,Ht),ue=this.slice(W,rt),de=A.slice(w,F);for(let le=0;le<ie;++le)if(ue[le]!==de[le]){dt=ue[le],Ht=de[le];break}return dt<Ht?-1:Ht<dt?1:0};function K(D,A,w,F,W){if(D.length===0)return-1;if(typeof w=="string"?(F=w,w=0):w>2147483647?w=2147483647:w<-2147483648&&(w=-2147483648),w=+w,wi(w)&&(w=W?0:D.length-1),w<0&&(w=D.length+w),w>=D.length){if(W)return-1;w=D.length-1}else if(w<0)if(W)w=0;else return-1;if(typeof A=="string"&&(A=u.from(A,F)),u.isBuffer(A))return A.length===0?-1:P(D,A,w,F,W);if(typeof A=="number")return A=A&255,typeof Uint8Array.prototype.indexOf=="function"?W?Uint8Array.prototype.indexOf.call(D,A,w):Uint8Array.prototype.lastIndexOf.call(D,A,w):P(D,[A],w,F,W);throw new TypeError("val must be string, number or Buffer")}function P(D,A,w,F,W){let rt=1,dt=D.length,Ht=A.length;if(F!==void 0&&(F=String(F).toLowerCase(),F==="ucs2"||F==="ucs-2"||F==="utf16le"||F==="utf-16le")){if(D.length<2||A.length<2)return-1;rt=2,dt/=2,Ht/=2,w/=2}function ie(de,le){return rt===1?de[le]:de.readUInt16BE(le*rt)}let ue;if(W){let de=-1;for(ue=w;ue<dt;ue++)if(ie(D,ue)===ie(A,de===-1?0:ue-de)){if(de===-1&&(de=ue),ue-de+1===Ht)return de*rt}else de!==-1&&(ue-=ue-de),de=-1}else for(w+Ht>dt&&(w=dt-Ht),ue=w;ue>=0;ue--){let de=!0;for(let le=0;le<Ht;le++)if(ie(D,ue+le)!==ie(A,le)){de=!1;break}if(de)return ue}return-1}u.prototype.includes=function(A,w,F){return this.indexOf(A,w,F)!==-1},u.prototype.indexOf=function(A,w,F){return K(this,A,w,F,!0)},u.prototype.lastIndexOf=function(A,w,F){return K(this,A,w,F,!1)};function N(D,A,w,F){w=Number(w)||0;const W=D.length-w;F?(F=Number(F),F>W&&(F=W)):F=W;const rt=A.length;F>rt/2&&(F=rt/2);let dt;for(dt=0;dt<F;++dt){const Ht=parseInt(A.substr(dt*2,2),16);if(wi(Ht))return dt;D[w+dt]=Ht}return dt}function B(D,A,w,F){return ti(Fe(A,D.length-w),D,w,F)}function j(D,A,w,F){return ti(Ca(A),D,w,F)}function V(D,A,w,F){return ti(Gi(A),D,w,F)}function Y(D,A,w,F){return ti(Bs(A,D.length-w),D,w,F)}u.prototype.write=function(A,w,F,W){if(w===void 0)W="utf8",F=this.length,w=0;else if(F===void 0&&typeof w=="string")W=w,F=this.length,w=0;else if(isFinite(w))w=w>>>0,isFinite(F)?(F=F>>>0,W===void 0&&(W="utf8")):(W=F,F=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const rt=this.length-w;if((F===void 0||F>rt)&&(F=rt),A.length>0&&(F<0||w<0)||w>this.length)throw new RangeError("Attempt to write outside buffer bounds");W||(W="utf8");let dt=!1;for(;;)switch(W){case"hex":return N(this,A,w,F);case"utf8":case"utf-8":return B(this,A,w,F);case"ascii":case"latin1":case"binary":return j(this,A,w,F);case"base64":return V(this,A,w,F);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,A,w,F);default:if(dt)throw new TypeError("Unknown encoding: "+W);W=(""+W).toLowerCase(),dt=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function U(D,A,w){return A===0&&w===D.length?t.fromByteArray(D):t.fromByteArray(D.slice(A,w))}function Nt(D,A,w){w=Math.min(D.length,w);const F=[];let W=A;for(;W<w;){const rt=D[W];let dt=null,Ht=rt>239?4:rt>223?3:rt>191?2:1;if(W+Ht<=w){let ie,ue,de,le;switch(Ht){case 1:rt<128&&(dt=rt);break;case 2:ie=D[W+1],(ie&192)===128&&(le=(rt&31)<<6|ie&63,le>127&&(dt=le));break;case 3:ie=D[W+1],ue=D[W+2],(ie&192)===128&&(ue&192)===128&&(le=(rt&15)<<12|(ie&63)<<6|ue&63,le>2047&&(le<55296||le>57343)&&(dt=le));break;case 4:ie=D[W+1],ue=D[W+2],de=D[W+3],(ie&192)===128&&(ue&192)===128&&(de&192)===128&&(le=(rt&15)<<18|(ie&63)<<12|(ue&63)<<6|de&63,le>65535&&le<1114112&&(dt=le))}}dt===null?(dt=65533,Ht=1):dt>65535&&(dt-=65536,F.push(dt>>>10&1023|55296),dt=56320|dt&1023),F.push(dt),W+=Ht}return J(F)}const Dt=4096;function J(D){const A=D.length;if(A<=Dt)return String.fromCharCode.apply(String,D);let w="",F=0;for(;F<A;)w+=String.fromCharCode.apply(String,D.slice(F,F+=Dt));return w}function ct(D,A,w){let F="";w=Math.min(D.length,w);for(let W=A;W<w;++W)F+=String.fromCharCode(D[W]&127);return F}function mt(D,A,w){let F="";w=Math.min(D.length,w);for(let W=A;W<w;++W)F+=String.fromCharCode(D[W]);return F}function Mt(D,A,w){const F=D.length;(!A||A<0)&&(A=0),(!w||w<0||w>F)&&(w=F);let W="";for(let rt=A;rt<w;++rt)W+=Fs[D[rt]];return W}function $(D,A,w){const F=D.slice(A,w);let W="";for(let rt=0;rt<F.length-1;rt+=2)W+=String.fromCharCode(F[rt]+F[rt+1]*256);return W}u.prototype.slice=function(A,w){const F=this.length;A=~~A,w=w===void 0?F:~~w,A<0?(A+=F,A<0&&(A=0)):A>F&&(A=F),w<0?(w+=F,w<0&&(w=0)):w>F&&(w=F),w<A&&(w=A);const W=this.subarray(A,w);return Object.setPrototypeOf(W,u.prototype),W};function ut(D,A,w){if(D%1!==0||D<0)throw new RangeError("offset is not uint");if(D+A>w)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(A,w,F){A=A>>>0,w=w>>>0,F||ut(A,w,this.length);let W=this[A],rt=1,dt=0;for(;++dt<w&&(rt*=256);)W+=this[A+dt]*rt;return W},u.prototype.readUintBE=u.prototype.readUIntBE=function(A,w,F){A=A>>>0,w=w>>>0,F||ut(A,w,this.length);let W=this[A+--w],rt=1;for(;w>0&&(rt*=256);)W+=this[A+--w]*rt;return W},u.prototype.readUint8=u.prototype.readUInt8=function(A,w){return A=A>>>0,w||ut(A,1,this.length),this[A]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(A,w){return A=A>>>0,w||ut(A,2,this.length),this[A]|this[A+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(A,w){return A=A>>>0,w||ut(A,2,this.length),this[A]<<8|this[A+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(A,w){return A=A>>>0,w||ut(A,4,this.length),(this[A]|this[A+1]<<8|this[A+2]<<16)+this[A+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(A,w){return A=A>>>0,w||ut(A,4,this.length),this[A]*16777216+(this[A+1]<<16|this[A+2]<<8|this[A+3])},u.prototype.readBigUInt64LE=ui(function(A){A=A>>>0,We(A,"offset");const w=this[A],F=this[A+7];(w===void 0||F===void 0)&&we(A,this.length-8);const W=w+this[++A]*2**8+this[++A]*2**16+this[++A]*2**24,rt=this[++A]+this[++A]*2**8+this[++A]*2**16+F*2**24;return BigInt(W)+(BigInt(rt)<<BigInt(32))}),u.prototype.readBigUInt64BE=ui(function(A){A=A>>>0,We(A,"offset");const w=this[A],F=this[A+7];(w===void 0||F===void 0)&&we(A,this.length-8);const W=w*2**24+this[++A]*2**16+this[++A]*2**8+this[++A],rt=this[++A]*2**24+this[++A]*2**16+this[++A]*2**8+F;return(BigInt(W)<<BigInt(32))+BigInt(rt)}),u.prototype.readIntLE=function(A,w,F){A=A>>>0,w=w>>>0,F||ut(A,w,this.length);let W=this[A],rt=1,dt=0;for(;++dt<w&&(rt*=256);)W+=this[A+dt]*rt;return rt*=128,W>=rt&&(W-=Math.pow(2,8*w)),W},u.prototype.readIntBE=function(A,w,F){A=A>>>0,w=w>>>0,F||ut(A,w,this.length);let W=w,rt=1,dt=this[A+--W];for(;W>0&&(rt*=256);)dt+=this[A+--W]*rt;return rt*=128,dt>=rt&&(dt-=Math.pow(2,8*w)),dt},u.prototype.readInt8=function(A,w){return A=A>>>0,w||ut(A,1,this.length),this[A]&128?(255-this[A]+1)*-1:this[A]},u.prototype.readInt16LE=function(A,w){A=A>>>0,w||ut(A,2,this.length);const F=this[A]|this[A+1]<<8;return F&32768?F|4294901760:F},u.prototype.readInt16BE=function(A,w){A=A>>>0,w||ut(A,2,this.length);const F=this[A+1]|this[A]<<8;return F&32768?F|4294901760:F},u.prototype.readInt32LE=function(A,w){return A=A>>>0,w||ut(A,4,this.length),this[A]|this[A+1]<<8|this[A+2]<<16|this[A+3]<<24},u.prototype.readInt32BE=function(A,w){return A=A>>>0,w||ut(A,4,this.length),this[A]<<24|this[A+1]<<16|this[A+2]<<8|this[A+3]},u.prototype.readBigInt64LE=ui(function(A){A=A>>>0,We(A,"offset");const w=this[A],F=this[A+7];(w===void 0||F===void 0)&&we(A,this.length-8);const W=this[A+4]+this[A+5]*2**8+this[A+6]*2**16+(F<<24);return(BigInt(W)<<BigInt(32))+BigInt(w+this[++A]*2**8+this[++A]*2**16+this[++A]*2**24)}),u.prototype.readBigInt64BE=ui(function(A){A=A>>>0,We(A,"offset");const w=this[A],F=this[A+7];(w===void 0||F===void 0)&&we(A,this.length-8);const W=(w<<24)+this[++A]*2**16+this[++A]*2**8+this[++A];return(BigInt(W)<<BigInt(32))+BigInt(this[++A]*2**24+this[++A]*2**16+this[++A]*2**8+F)}),u.prototype.readFloatLE=function(A,w){return A=A>>>0,w||ut(A,4,this.length),e.read(this,A,!0,23,4)},u.prototype.readFloatBE=function(A,w){return A=A>>>0,w||ut(A,4,this.length),e.read(this,A,!1,23,4)},u.prototype.readDoubleLE=function(A,w){return A=A>>>0,w||ut(A,8,this.length),e.read(this,A,!0,52,8)},u.prototype.readDoubleBE=function(A,w){return A=A>>>0,w||ut(A,8,this.length),e.read(this,A,!1,52,8)};function Q(D,A,w,F,W,rt){if(!u.isBuffer(D))throw new TypeError('"buffer" argument must be a Buffer instance');if(A>W||A<rt)throw new RangeError('"value" argument is out of bounds');if(w+F>D.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(A,w,F,W){if(A=+A,w=w>>>0,F=F>>>0,!W){const Ht=Math.pow(2,8*F)-1;Q(this,A,w,F,Ht,0)}let rt=1,dt=0;for(this[w]=A&255;++dt<F&&(rt*=256);)this[w+dt]=A/rt&255;return w+F},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(A,w,F,W){if(A=+A,w=w>>>0,F=F>>>0,!W){const Ht=Math.pow(2,8*F)-1;Q(this,A,w,F,Ht,0)}let rt=F-1,dt=1;for(this[w+rt]=A&255;--rt>=0&&(dt*=256);)this[w+rt]=A/dt&255;return w+F},u.prototype.writeUint8=u.prototype.writeUInt8=function(A,w,F){return A=+A,w=w>>>0,F||Q(this,A,w,1,255,0),this[w]=A&255,w+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(A,w,F){return A=+A,w=w>>>0,F||Q(this,A,w,2,65535,0),this[w]=A&255,this[w+1]=A>>>8,w+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(A,w,F){return A=+A,w=w>>>0,F||Q(this,A,w,2,65535,0),this[w]=A>>>8,this[w+1]=A&255,w+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(A,w,F){return A=+A,w=w>>>0,F||Q(this,A,w,4,4294967295,0),this[w+3]=A>>>24,this[w+2]=A>>>16,this[w+1]=A>>>8,this[w]=A&255,w+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(A,w,F){return A=+A,w=w>>>0,F||Q(this,A,w,4,4294967295,0),this[w]=A>>>24,this[w+1]=A>>>16,this[w+2]=A>>>8,this[w+3]=A&255,w+4};function at(D,A,w,F,W){ln(A,F,W,D,w,7);let rt=Number(A&BigInt(4294967295));D[w++]=rt,rt=rt>>8,D[w++]=rt,rt=rt>>8,D[w++]=rt,rt=rt>>8,D[w++]=rt;let dt=Number(A>>BigInt(32)&BigInt(4294967295));return D[w++]=dt,dt=dt>>8,D[w++]=dt,dt=dt>>8,D[w++]=dt,dt=dt>>8,D[w++]=dt,w}function yt(D,A,w,F,W){ln(A,F,W,D,w,7);let rt=Number(A&BigInt(4294967295));D[w+7]=rt,rt=rt>>8,D[w+6]=rt,rt=rt>>8,D[w+5]=rt,rt=rt>>8,D[w+4]=rt;let dt=Number(A>>BigInt(32)&BigInt(4294967295));return D[w+3]=dt,dt=dt>>8,D[w+2]=dt,dt=dt>>8,D[w+1]=dt,dt=dt>>8,D[w]=dt,w+8}u.prototype.writeBigUInt64LE=ui(function(A,w=0){return at(this,A,w,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=ui(function(A,w=0){return yt(this,A,w,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(A,w,F,W){if(A=+A,w=w>>>0,!W){const ie=Math.pow(2,8*F-1);Q(this,A,w,F,ie-1,-ie)}let rt=0,dt=1,Ht=0;for(this[w]=A&255;++rt<F&&(dt*=256);)A<0&&Ht===0&&this[w+rt-1]!==0&&(Ht=1),this[w+rt]=(A/dt>>0)-Ht&255;return w+F},u.prototype.writeIntBE=function(A,w,F,W){if(A=+A,w=w>>>0,!W){const ie=Math.pow(2,8*F-1);Q(this,A,w,F,ie-1,-ie)}let rt=F-1,dt=1,Ht=0;for(this[w+rt]=A&255;--rt>=0&&(dt*=256);)A<0&&Ht===0&&this[w+rt+1]!==0&&(Ht=1),this[w+rt]=(A/dt>>0)-Ht&255;return w+F},u.prototype.writeInt8=function(A,w,F){return A=+A,w=w>>>0,F||Q(this,A,w,1,127,-128),A<0&&(A=255+A+1),this[w]=A&255,w+1},u.prototype.writeInt16LE=function(A,w,F){return A=+A,w=w>>>0,F||Q(this,A,w,2,32767,-32768),this[w]=A&255,this[w+1]=A>>>8,w+2},u.prototype.writeInt16BE=function(A,w,F){return A=+A,w=w>>>0,F||Q(this,A,w,2,32767,-32768),this[w]=A>>>8,this[w+1]=A&255,w+2},u.prototype.writeInt32LE=function(A,w,F){return A=+A,w=w>>>0,F||Q(this,A,w,4,2147483647,-2147483648),this[w]=A&255,this[w+1]=A>>>8,this[w+2]=A>>>16,this[w+3]=A>>>24,w+4},u.prototype.writeInt32BE=function(A,w,F){return A=+A,w=w>>>0,F||Q(this,A,w,4,2147483647,-2147483648),A<0&&(A=4294967295+A+1),this[w]=A>>>24,this[w+1]=A>>>16,this[w+2]=A>>>8,this[w+3]=A&255,w+4},u.prototype.writeBigInt64LE=ui(function(A,w=0){return at(this,A,w,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=ui(function(A,w=0){return yt(this,A,w,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function bt(D,A,w,F,W,rt){if(w+F>D.length)throw new RangeError("Index out of range");if(w<0)throw new RangeError("Index out of range")}function Et(D,A,w,F,W){return A=+A,w=w>>>0,W||bt(D,A,w,4),e.write(D,A,w,F,23,4),w+4}u.prototype.writeFloatLE=function(A,w,F){return Et(this,A,w,!0,F)},u.prototype.writeFloatBE=function(A,w,F){return Et(this,A,w,!1,F)};function It(D,A,w,F,W){return A=+A,w=w>>>0,W||bt(D,A,w,8),e.write(D,A,w,F,52,8),w+8}u.prototype.writeDoubleLE=function(A,w,F){return It(this,A,w,!0,F)},u.prototype.writeDoubleBE=function(A,w,F){return It(this,A,w,!1,F)},u.prototype.copy=function(A,w,F,W){if(!u.isBuffer(A))throw new TypeError("argument should be a Buffer");if(F||(F=0),!W&&W!==0&&(W=this.length),w>=A.length&&(w=A.length),w||(w=0),W>0&&W<F&&(W=F),W===F||A.length===0||this.length===0)return 0;if(w<0)throw new RangeError("targetStart out of bounds");if(F<0||F>=this.length)throw new RangeError("Index out of range");if(W<0)throw new RangeError("sourceEnd out of bounds");W>this.length&&(W=this.length),A.length-w<W-F&&(W=A.length-w+F);const rt=W-F;return this===A&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(w,F,W):Uint8Array.prototype.set.call(A,this.subarray(F,W),w),rt},u.prototype.fill=function(A,w,F,W){if(typeof A=="string"){if(typeof w=="string"?(W=w,w=0,F=this.length):typeof F=="string"&&(W=F,F=this.length),W!==void 0&&typeof W!="string")throw new TypeError("encoding must be a string");if(typeof W=="string"&&!u.isEncoding(W))throw new TypeError("Unknown encoding: "+W);if(A.length===1){const dt=A.charCodeAt(0);(W==="utf8"&&dt<128||W==="latin1")&&(A=dt)}}else typeof A=="number"?A=A&255:typeof A=="boolean"&&(A=Number(A));if(w<0||this.length<w||this.length<F)throw new RangeError("Out of range index");if(F<=w)return this;w=w>>>0,F=F===void 0?this.length:F>>>0,A||(A=0);let rt;if(typeof A=="number")for(rt=w;rt<F;++rt)this[rt]=A;else{const dt=u.isBuffer(A)?A:u.from(A,W),Ht=dt.length;if(Ht===0)throw new TypeError('The value "'+A+'" is invalid for argument "value"');for(rt=0;rt<F-w;++rt)this[rt+w]=dt[rt%Ht]}return this};const xt={};function ee(D,A,w){xt[D]=class extends w{constructor(){super(),Object.defineProperty(this,"message",{value:A.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${D}]`,this.stack,delete this.name}get code(){return D}set code(W){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:W,writable:!0})}toString(){return`${this.name} [${D}]: ${this.message}`}}}ee("ERR_BUFFER_OUT_OF_BOUNDS",function(D){return D?`${D} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ee("ERR_INVALID_ARG_TYPE",function(D,A){return`The "${D}" argument must be of type number. Received type ${typeof A}`},TypeError),ee("ERR_OUT_OF_RANGE",function(D,A,w){let F=`The value of "${D}" is out of range.`,W=w;return Number.isInteger(w)&&Math.abs(w)>2**32?W=Me(String(w)):typeof w=="bigint"&&(W=String(w),(w>BigInt(2)**BigInt(32)||w<-(BigInt(2)**BigInt(32)))&&(W=Me(W)),W+="n"),F+=` It must be ${A}. Received ${W}`,F},RangeError);function Me(D){let A="",w=D.length;const F=D[0]==="-"?1:0;for(;w>=F+4;w-=3)A=`_${D.slice(w-3,w)}${A}`;return`${D.slice(0,w)}${A}`}function ke(D,A,w){We(A,"offset"),(D[A]===void 0||D[A+w]===void 0)&&we(A,D.length-(w+1))}function ln(D,A,w,F,W,rt){if(D>w||D<A){const dt=typeof A=="bigint"?"n":"";let Ht;throw A===0||A===BigInt(0)?Ht=`>= 0${dt} and < 2${dt} ** ${(rt+1)*8}${dt}`:Ht=`>= -(2${dt} ** ${(rt+1)*8-1}${dt}) and < 2 ** ${(rt+1)*8-1}${dt}`,new xt.ERR_OUT_OF_RANGE("value",Ht,D)}ke(F,W,rt)}function We(D,A){if(typeof D!="number")throw new xt.ERR_INVALID_ARG_TYPE(A,"number",D)}function we(D,A,w){throw Math.floor(D)!==D?(We(D,w),new xt.ERR_OUT_OF_RANGE("offset","an integer",D)):A<0?new xt.ERR_BUFFER_OUT_OF_BOUNDS:new xt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${A}`,D)}const ci=/[^+/0-9A-Za-z-_]/g;function Ai(D){if(D=D.split("=")[0],D=D.trim().replace(ci,""),D.length<2)return"";for(;D.length%4!==0;)D=D+"=";return D}function Fe(D,A){A=A||1/0;let w;const F=D.length;let W=null;const rt=[];for(let dt=0;dt<F;++dt){if(w=D.charCodeAt(dt),w>55295&&w<57344){if(!W){if(w>56319){(A-=3)>-1&&rt.push(239,191,189);continue}else if(dt+1===F){(A-=3)>-1&&rt.push(239,191,189);continue}W=w;continue}if(w<56320){(A-=3)>-1&&rt.push(239,191,189),W=w;continue}w=(W-55296<<10|w-56320)+65536}else W&&(A-=3)>-1&&rt.push(239,191,189);if(W=null,w<128){if((A-=1)<0)break;rt.push(w)}else if(w<2048){if((A-=2)<0)break;rt.push(w>>6|192,w&63|128)}else if(w<65536){if((A-=3)<0)break;rt.push(w>>12|224,w>>6&63|128,w&63|128)}else if(w<1114112){if((A-=4)<0)break;rt.push(w>>18|240,w>>12&63|128,w>>6&63|128,w&63|128)}else throw new Error("Invalid code point")}return rt}function Ca(D){const A=[];for(let w=0;w<D.length;++w)A.push(D.charCodeAt(w)&255);return A}function Bs(D,A){let w,F,W;const rt=[];for(let dt=0;dt<D.length&&!((A-=2)<0);++dt)w=D.charCodeAt(dt),F=w>>8,W=w%256,rt.push(W),rt.push(F);return rt}function Gi(D){return t.toByteArray(Ai(D))}function ti(D,A,w,F){let W;for(W=0;W<F&&!(W+w>=A.length||W>=D.length);++W)A[W+w]=D[W];return W}function Ln(D,A){return D instanceof A||D!=null&&D.constructor!=null&&D.constructor.name!=null&&D.constructor.name===A.name}function wi(D){return D!==D}const Fs=(function(){const D="0123456789abcdef",A=new Array(256);for(let w=0;w<16;++w){const F=w*16;for(let W=0;W<16;++W)A[F+W]=D[w]+D[W]}return A})();function ui(D){return typeof BigInt>"u"?Ce:D}function Ce(){throw new Error("BigInt not supported")}})(Jm)),Jm}var LV=OV();Ll.workerSrc=new URL("/AuthentiDoc/assets/pdf.worker.min-r-TJsTTt.mjs",import.meta.url).href;const BV="AIzaSyDQzh6Fj-vVi6_4IS5i3yV0lh4HhrEgMPQ",FV=new MV(BV),UV=FV.getGenerativeModel({model:"gemini-2.0-flash"}),VV=()=>{const[s,t]=st.useState(null),[e,n]=st.useState(null),[i,a]=st.useState(null),[l,u]=st.useState(null),[h,f]=st.useState(!1),[p,y]=st.useState(""),[v,b]=st.useState(""),[T,S]=st.useState([]),[I,x]=st.useState(null),[k,O]=st.useState(null),G=Xl(),[H,K]=K_(bi),[P,N]=st.useState({sales:{cost:"",saleDate:"",ownerName:"",salespersonName:"",location:""},gift:{giftDate:"",giverName:"",receiverName:"",location:"",giftType:""},rental:{rentAmount:"",startDate:"",endDate:"",tenantName:"",landlordName:"",propertyLocation:""},authority:{grantorName:"",granteeName:"",authorityType:"",validity:"",location:""}}),B=Q=>Q?String(Q).trim().toLowerCase().replace(/[\s,-.]+/g,""):"",j=(Q,at)=>{if(!Q||!at)return!1;const yt=["mr","mrs","ms","dr","prof","miss"],bt=ee=>ee.trim().toLowerCase().replace(/[.,]/g,""),Et=ee=>bt(ee).split(/\s+/).filter(Me=>Me&&!yt.includes(Me)),It=Et(Q),xt=Et(at);return It.every(ee=>xt.includes(ee))},V=Q=>{switch(Q){case"sales":return{fields:[{key:"cost",label:"Cost"},{key:"saleDate",label:"Sale Date"},{key:"ownerName",label:"Owner Name"},{key:"salespersonName",label:"Salesperson Name"},{key:"location",label:"Location"}],prompt:"From the attached sales document PDF, extract the following information and return it as a JSON object: cost, sale date (format YYYY-MM-DD), owner name, salesperson name, and location. Also, provide a brief summary for each page of the document. If a value is not found, return null for that key.",schemaProperties:{cost:{type:"string"},saleDate:{type:"string"},ownerName:{type:"string"},salespersonName:{type:"string"},location:{type:"string"}},required:["cost","saleDate","ownerName","salespersonName","location"]};case"gift":return{fields:[{key:"giftDate",label:"Gift Date"},{key:"giverName",label:"Giver Name"},{key:"receiverName",label:"Receiver Name"},{key:"location",label:"Enter Location where gift is received"},{key:"giftType",label:"Gift Type"}],prompt:"From the attached gift giving document PDF, extract the following information and return it as a JSON object: gift date (format YYYY-MM-DD), giver name (donor name, which may be in any format), receiver name (donee name, which may be in any format), location (the address following the phrase 'Location of where the gift deed is received/ registered - '), and gift type. If the document contains keywords such as 'apartment' or 'car parking', set gift type to 'Immovable property'. Also, provide a brief summary for each page of the document. If a value is not found, return null for that key.",schemaProperties:{giftDate:{type:"string"},giverName:{type:"string"},receiverName:{type:"string"},location:{type:"string"},giftType:{type:"string"}},required:["giftDate","giverName","receiverName","location","giftType"]};case"rental":return{fields:[{key:"rentAmount",label:"Rent Amount"},{key:"startDate",label:"Start Date"},{key:"endDate",label:"End Date"},{key:"tenantName",label:"Tenant Name"},{key:"landlordName",label:"Landlord Name"},{key:"propertyLocation",label:"Property Location"}],prompt:"From the attached rental agreement PDF, extract the following information and return it as a JSON object: rent amount, start date (format YYYY-MM-DD), end date (format YYYY-MM-DD), tenant name, landlord name, and property location. Also, provide a brief summary for each page of the document. If a value is not found, return null for that key.",schemaProperties:{rentAmount:{type:"string"},startDate:{type:"string"},endDate:{type:"string"},tenantName:{type:"string"},landlordName:{type:"string"},propertyLocation:{type:"string"}},required:["rentAmount","startDate","endDate","tenantName","landlordName","propertyLocation"]};case"authority":return{fields:[{key:"grantorName",label:"Grantor Name"},{key:"granteeName",label:"Grantee Name"},{key:"authorityType",label:"Authority Type"},{key:"validity",label:"Validity"},{key:"location",label:"Location"}],prompt:"From the attached power of authority document PDF, extract the following information and return it as a JSON object: grantor name, grantee name, authority type, validity date (format YYYY-MM-DD), and location. Also, provide a brief summary for each page of the document. If a value is not found, return null for that key.",schemaProperties:{grantorName:{type:"string"},granteeName:{type:"string"},authorityType:{type:"string"},validity:{type:"string"},location:{type:"string"}},required:["grantorName","granteeName","authorityType","validity","location"]};default:throw new Error(`Unsupported document type: ${Q}`)}},Y=async Q=>{try{const at=await pdfjsLib.getDocument({data:Q}).promise,yt=at.numPages,bt=[];for(let Et=1;Et<=yt;Et++){const It=await at.getPage(Et),xt=It.getViewport({scale:2}),ee=document.createElement("canvas"),Me=ee.getContext("2d");ee.height=xt.height,ee.width=xt.width,await It.render({canvasContext:Me,viewport:xt}).promise;const ke=ee.toDataURL("image/png").split(",")[1];bt.push(ke)}return bt}catch(at){return console.error("PDF to image conversion error:",at.message),y(`PDF to image conversion failed: ${at.message}`),[]}},U=async(Q,at,yt)=>{const bt=V(yt),Et={type:"object",properties:{...bt.schemaProperties,pageSummaries:{type:"array",items:{type:"string",description:"A brief summary of the content on a single page."},description:"An array of strings, where each string is a summary of the corresponding page in the document."}},required:[...bt.required,"pageSummaries"]},It=[{inlineData:{mimeType:"application/pdf",data:Q}},{text:bt.prompt}],xt={responseMimeType:"application/json",responseSchema:Et};try{const Me=(await UV.generateContent({contents:[{role:"user",parts:It}],generationConfig:xt})).response.candidates[0]?.content?.parts[0]?.text;if(!Me)throw new Error("No valid response text received from Gemini API");let ke;try{ke=JSON.parse(Me.trim())||{}}catch(we){throw console.error("Failed to parse Gemini response as JSON:",we.message),new Error("Invalid JSON response from Gemini API")}const ln=bt.fields.map(we=>{const ci=at[we.key]||"",Ai=ke[we.key]||"Not Found";let Fe;return we.key==="giverName"||we.key==="receiverName"?Fe=j(ci,Ai)?"✅ Match":"❌ Mismatch":Fe=B(ci)===B(Ai)?"✅ Match":"❌ Mismatch",{field:we.label,userData:ci,dataFromDocument:Ai,status:Fe}});return{status:ln.every(we=>we.status==="✅ Match")?"Original":"Fake",details:ln,pageSummaries:ke.pageSummaries||[]}}catch(ee){return console.error("Gemini API error:",ee.message),y(`Failed to extract details using Gemini API: ${ee.message}`),{status:"Error",details:[],pageSummaries:[]}}},Nt=(Q,at)=>{const yt=bt=>at.find(Et=>Et.field===bt)?.dataFromDocument||"[not found]";switch(Q){case"sales":const bt=yt("Cost"),Et=yt("Sale Date"),It=yt("Owner Name"),xt=yt("Salesperson Name"),ee=yt("Location");return`This appears to be a sales document for a transaction costing ${bt} on ${Et}, involving owner ${It} and salesperson ${xt} at location ${ee}.`;case"gift":const Me=yt("Gift Date"),ke=yt("Giver Name"),ln=yt("Receiver Name"),We=yt("Enter Location where gift is received");return`This appears to be a gift giving document for a ${yt("Gift Type")}, given on ${Me} from ${ke} to ${ln} at location ${We}.`;case"rental":const ci=yt("Landlord Name"),Ai=yt("Tenant Name"),Fe=yt("Rent Amount"),Ca=yt("Start Date"),Bs=yt("Property Location");return`This appears to be a rental agreement between the landlord, ${ci}, and the tenant, ${Ai}. The agreement, starting on ${Ca}, is for the property located at ${Bs}. The specified monthly rent is ₹${Fe}.`;case"authority":const Gi=yt("Grantor Name"),ti=yt("Grantee Name"),Ln=yt("Authority Type"),wi=yt("Validity"),Fs=yt("Location");return`This appears to be a power of authority document granting ${Ln} from ${Gi} to ${ti}, valid until ${wi}, at location ${Fs}.`;default:return"Analysis for this document type has not been implemented."}},Dt=async()=>{if(!H||!Ui){y("Authentication or storage not initialized.");return}try{const Q=Gf(Ui,`uploads/${H.uid}/`),yt=(await sC(Q)).items.map(bt=>bt.name);S(yt)}catch(Q){y(`Failed to list files. [${Q.message}]`)}};st.useEffect(()=>{H&&!K&&Ui&&Dt()},[H,K,Ui]);const J=async Q=>{if(!H){y("No authenticated user found.");return}f(!0),y(""),b("");try{const at=H.uid||"test-user",yt=Gf(Ui,`uploads/${at}/${Date.now()}_${Q.name}`),bt=await RB(yt,Q),Et=await IB(bt.ref);x(Et),n(bt.ref.fullPath),a(Q.name),b("✅ File uploaded successfully!"),setTimeout(Dt,1e3)}catch(at){y(`Failed to upload. [${at.message}]`)}finally{f(!1)}},ct=Q=>{const at=Q.target.files[0];at&&(t(at),n(at.name),a(at.name),J(at))},mt=(Q,at,yt)=>{N(bt=>({...bt,[Q]:{...bt[Q],[at]:yt}}))},Mt=Q=>{switch(Q){case"Sales Document":return"sales";case"Gift Giving Document":return"gift";case"Rental Document":return"rental";case"Power of Authority":return"authority";default:return null}},$=async Q=>{if(Q.preventDefault(),!s||!l){y("Please upload or select a document and select its type first.");return}const at=Mt(l);if(!at){y("Invalid document type selected.");return}f(!0),y(""),b("");try{const yt=await s.arrayBuffer(),bt=LV.Buffer.from(yt),Et=bt.toString("base64"),It=await Y(bt),xt=await U(Et,P[at],at),ee={status:xt.status,details:xt.details,verificationId:crypto.randomUUID(),images:It,pageSummaries:xt.pageSummaries,analysis:Nt(at,xt.details),docType:at};G("/results",{state:{result:ee}})}catch(yt){console.error("Verification failed:",yt.message),y(`Verification failed: ${yt.message}`)}finally{f(!1)}},ut=["Rental Document","Gift Giving Document","Sales Document","Power of Authority"];return K?z.jsx("div",{children:"Loading authentication state..."}):H?z.jsxs("form",{className:"upload-container",onSubmit:$,children:[z.jsx("div",{className:"upload-box",children:z.jsxs("label",{className:"upload-label",children:[z.jsx("input",{type:"file",onChange:ct,className:"file-input",accept:"application/pdf"}),z.jsx(cF,{size:40,className:"upload-icon"}),z.jsx("p",{className:"upload-text",children:i||"Click or Drag & Drop your document here"})]})}),z.jsx("div",{className:"options-row",children:ut.map((Q,at)=>z.jsx("button",{type:"button",className:`option-btn ${l===Q?"active":""}`,onClick:()=>u(Q),children:Q},at))}),p&&z.jsx("div",{className:"error-message",children:p}),v&&z.jsx("div",{className:"success-message",children:v}),l&&z.jsxs("div",{className:"input-section",children:[z.jsx("h3",{className:"form-title",children:"Enter Document Details"}),l==="Sales Document"&&z.jsxs(z.Fragment,{children:[z.jsx("input",{type:"text",placeholder:"Enter Cost",value:P.sales.cost,onChange:Q=>mt("sales","cost",Q.target.value)}),z.jsx("input",{type:"date",value:P.sales.saleDate,onChange:Q=>mt("sales","saleDate",Q.target.value)}),z.jsx("input",{type:"text",placeholder:"Enter Owner Name",value:P.sales.ownerName,onChange:Q=>mt("sales","ownerName",Q.target.value)}),z.jsx("input",{type:"text",placeholder:"Enter Salesperson Name",value:P.sales.salespersonName,onChange:Q=>mt("sales","salespersonName",Q.target.value)}),z.jsx("input",{type:"text",placeholder:"Enter Location",value:P.sales.location,onChange:Q=>mt("sales","location",Q.target.value)})]}),l==="Gift Giving Document"&&z.jsxs(z.Fragment,{children:[z.jsx("input",{type:"date",value:P.gift.giftDate,onChange:Q=>mt("gift","giftDate",Q.target.value)}),z.jsx("input",{type:"text",placeholder:"Enter Donor's Name",value:P.gift.giverName,onChange:Q=>mt("gift","giverName",Q.target.value)}),z.jsx("input",{type:"text",placeholder:"Enter Donee's Name",value:P.gift.receiverName,onChange:Q=>mt("gift","receiverName",Q.target.value)}),z.jsx("input",{type:"text",placeholder:"Enter Location",value:P.gift.location,onChange:Q=>mt("gift","location",Q.target.value)}),z.jsx("input",{type:"text",placeholder:"Type of Gift",value:P.gift.giftType,onChange:Q=>mt("gift","giftType",Q.target.value)})]}),l==="Rental Document"&&z.jsxs(z.Fragment,{children:[z.jsx("input",{type:"text",placeholder:"Rent Amount",value:P.rental.rentAmount,onChange:Q=>mt("rental","rentAmount",Q.target.value)}),z.jsx("input",{type:"date",value:P.rental.startDate,onChange:Q=>mt("rental","startDate",Q.target.value)}),z.jsx("input",{type:"date",value:P.rental.endDate,onChange:Q=>mt("rental","endDate",Q.target.value)}),z.jsx("input",{type:"text",placeholder:"Tenant Name",value:P.rental.tenantName,onChange:Q=>mt("rental","tenantName",Q.target.value)}),z.jsx("input",{type:"text",placeholder:"Landlord Name",value:P.rental.landlordName,onChange:Q=>mt("rental","landlordName",Q.target.value)}),z.jsx("input",{type:"text",placeholder:"Property Location",value:P.rental.propertyLocation,onChange:Q=>mt("rental","propertyLocation",Q.target.value)})]}),l==="Power of Authority"&&z.jsxs(z.Fragment,{children:[z.jsx("input",{type:"text",placeholder:"Grantor Name",value:P.authority.grantorName,onChange:Q=>mt("authority","grantorName",Q.target.value)}),z.jsx("input",{type:"text",placeholder:"Grantee Name",value:P.authority.granteeName,onChange:Q=>mt("authority","granteeName",Q.target.value)}),z.jsx("input",{type:"text",placeholder:"Authority Type",value:P.authority.authorityType,onChange:Q=>mt("authority","authorityType",Q.target.value)}),z.jsx("input",{type:"date",value:P.authority.validity,onChange:Q=>mt("authority","validity",Q.target.value)}),z.jsx("input",{type:"text",placeholder:"Location",value:P.authority.location,onChange:Q=>mt("authority","location",Q.target.value)})]}),z.jsx("button",{type:"submit",className:"submit-btn",disabled:h,children:h?"Verifying...":"Submit"})]})]}):z.jsxs("div",{className:"upload-component",children:[z.jsx("p",{children:"Please login to upload documents."}),z.jsx("button",{onClick:()=>bi.signInWithPopup(xy),children:"Sign in with Google"})]})},GC=()=>(st.useEffect(()=>{const s=document.createElement("script");return s.src="https://cdn.voiceflow.com/widget-next/bundle.mjs",s.type="text/javascript",s.onload=()=>{window.voiceflow.chat.load({verify:{projectID:"68b71538a629cab2e98a6cfd"},url:"https://general-runtime.voiceflow.com",versionID:"production",voice:{url:"https://runtime-api.voiceflow.com"}})},document.body.appendChild(s),()=>{document.body.removeChild(s)}},[]),z.jsx(ET,{children:z.jsxs("div",{className:"App",children:[z.jsx(UB,{}),z.jsxs(gx,{children:[z.jsx(bl,{path:"/auth",element:z.jsx(VB,{})}),z.jsx(bl,{path:"/results",element:z.jsx(jB,{})}),z.jsx(bl,{path:"/",element:z.jsxs(z.Fragment,{children:[z.jsx(GB,{}),z.jsxs("main",{className:"container",children:[z.jsx(vw,{subTitle:"Our Services",title:"Types of Documents"}),z.jsx(ZB,{}),z.jsx(eF,{}),z.jsx(vw,{subTitle:"Try now!!!!",title:"Upload your Document Here"}),z.jsx(VV,{})]})]})}),z.jsx(bl,{path:"/profile",element:z.jsx(zB,{})}),z.jsx(bl,{path:"*",element:z.jsx(fx,{to:"/",replace:!0})})]})]})}));TI.createRoot(document.getElementById("root")).render(z.jsx(st.StrictMode,{children:z.jsx(GC,{})}));ReactDOM.createRoot(document.getElementById("root")).render(z.jsx(React.StrictMode,{children:z.jsx(ET,{children:z.jsx(GC,{})})}));
